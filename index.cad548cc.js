var $parcel$global="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{};function $parcel$interopDefault(e){return e&&e.__esModule?e.default:e}var $parcel$modules={},$parcel$inits={},parcelRequire=$parcel$global.parcelRequire957c;null==parcelRequire&&(parcelRequire=function(e){if(e in $parcel$modules)return $parcel$modules[e].exports;if(e in $parcel$inits){var t=$parcel$inits[e];delete $parcel$inits[e];var i={id:e,exports:{}};return $parcel$modules[e]=i,t.call(i.exports,i,i.exports),i.exports}var n=new Error("Cannot find module '"+e+"'");throw n.code="MODULE_NOT_FOUND",n},parcelRequire.register=function(e,t){$parcel$inits[e]=t},$parcel$global.parcelRequire957c=parcelRequire),parcelRequire.register("7mbQa",(function(e,t){var i=$b63e377f8a561b77$exports.Global;function n(){return i.localStorage}function s(e){return n().getItem(e)}e.exports={name:"localStorage",read:s,write:function(e,t){return n().setItem(e,t)},each:function(e){for(var t=n().length-1;t>=0;t--){var i=n().key(t);e(s(i),i)}},remove:function(e){return n().removeItem(e)},clearAll:function(){return n().clear()}}}));var $b63e377f8a561b77$exports={},$b63e377f8a561b77$var$assign=$b63e377f8a561b77$var$make_assign(),$b63e377f8a561b77$var$create=$b63e377f8a561b77$var$make_create(),$b63e377f8a561b77$var$trim=$b63e377f8a561b77$var$make_trim(),$b63e377f8a561b77$var$Global="undefined"!=typeof window?window:$parcel$global;function $b63e377f8a561b77$var$make_assign(){return Object.assign?Object.assign:function(e,t,i,n){for(var s=1;s<arguments.length;s++)$b63e377f8a561b77$var$each(Object(arguments[s]),(function(t,i){e[i]=t}));return e}}function $b63e377f8a561b77$var$make_create(){if(Object.create)return function(e,t,i,n){var s=$b63e377f8a561b77$var$slice(arguments,1);return $b63e377f8a561b77$var$assign.apply(this,[Object.create(e)].concat(s))};{function e(){}return function(t,i,n,s){var r=$b63e377f8a561b77$var$slice(arguments,1);return e.prototype=t,$b63e377f8a561b77$var$assign.apply(this,[new e].concat(r))}}}function $b63e377f8a561b77$var$make_trim(){return String.prototype.trim?function(e){return String.prototype.trim.call(e)}:function(e){return e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}}function $b63e377f8a561b77$var$bind(e,t){return function(){return t.apply(e,Array.prototype.slice.call(arguments,0))}}function $b63e377f8a561b77$var$slice(e,t){return Array.prototype.slice.call(e,t||0)}function $b63e377f8a561b77$var$each(e,t){$b63e377f8a561b77$var$pluck(e,(function(e,i){return t(e,i),!1}))}function $b63e377f8a561b77$var$map(e,t){var i=$b63e377f8a561b77$var$isList(e)?[]:{};return $b63e377f8a561b77$var$pluck(e,(function(e,n){return i[n]=t(e,n),!1})),i}function $b63e377f8a561b77$var$pluck(e,t){if($b63e377f8a561b77$var$isList(e)){for(var i=0;i<e.length;i++)if(t(e[i],i))return e[i]}else for(var n in e)if(e.hasOwnProperty(n)&&t(e[n],n))return e[n]}function $b63e377f8a561b77$var$isList(e){return null!=e&&"function"!=typeof e&&"number"==typeof e.length}function $b63e377f8a561b77$var$isFunction(e){return e&&"[object Function]"==={}.toString.call(e)}function $b63e377f8a561b77$var$isObject(e){return e&&"[object Object]"==={}.toString.call(e)}$b63e377f8a561b77$exports={assign:$b63e377f8a561b77$var$assign,create:$b63e377f8a561b77$var$create,trim:$b63e377f8a561b77$var$trim,bind:$b63e377f8a561b77$var$bind,slice:$b63e377f8a561b77$var$slice,each:$b63e377f8a561b77$var$each,map:$b63e377f8a561b77$var$map,pluck:$b63e377f8a561b77$var$pluck,isList:$b63e377f8a561b77$var$isList,isFunction:$b63e377f8a561b77$var$isFunction,isObject:$b63e377f8a561b77$var$isObject,Global:$b63e377f8a561b77$var$Global},parcelRequire.register("deyjU",(function(e,t){var i=$b63e377f8a561b77$exports.Global;e.exports={name:"oldFF-globalStorage",read:function(e){return n[e]},write:function(e,t){n[e]=t},each:s,remove:function(e){return n.removeItem(e)},clearAll:function(){s((function(e,t){delete n[e]}))}};var n=i.globalStorage;function s(e){for(var t=n.length-1;t>=0;t--){var i=n.key(t);e(n[i],i)}}})),parcelRequire.register("eCrE3",(function(e,t){var i=$b63e377f8a561b77$exports.Global;e.exports={name:"oldIE-userDataStorage",write:function(e,t){if(o)return;var i=l(e);r((function(e){e.setAttribute(i,t),e.save(n)}))},read:function(e){if(o)return;var t=l(e),i=null;return r((function(e){i=e.getAttribute(t)})),i},each:function(e){r((function(t){for(var i=t.XMLDocument.documentElement.attributes,n=i.length-1;n>=0;n--){var s=i[n];e(t.getAttribute(s.name),s.name)}}))},remove:function(e){var t=l(e);r((function(e){e.removeAttribute(t),e.save(n)}))},clearAll:function(){r((function(e){var t=e.XMLDocument.documentElement.attributes;e.load(n);for(var i=t.length-1;i>=0;i--)e.removeAttribute(t[i].name);e.save(n)}))}};var n="storejs",s=i.document,r=function(){if(!s||!s.documentElement||!s.documentElement.addBehavior)return null;var e,t,i;try{(t=new ActiveXObject("htmlfile")).open(),t.write('<script>document.w=window<\/script><iframe src="/favicon.ico"></iframe>'),t.close(),e=t.w.frames[0].document,i=e.createElement("div")}catch(t){i=s.createElement("div"),e=s.body}return function(t){var s=[].slice.call(arguments,0);s.unshift(i),e.appendChild(i),i.addBehavior("#default#userData"),i.load(n),t.apply(this,s),e.removeChild(i)}}(),o=(i.navigator?i.navigator.userAgent:"").match(/ (MSIE 8|MSIE 9|MSIE 10)\./);var a=new RegExp("[!\"#$%&'()*+,/\\\\:;<=>?@[\\]^`{|}~]","g");function l(e){return e.replace(/^\d/,"___$&").replace(a,"___")}})),parcelRequire.register("hmYM5",(function(e,t){var i=$b63e377f8a561b77$exports.Global,n=$b63e377f8a561b77$exports.trim;e.exports={name:"cookieStorage",read:function(e){if(!e||!a(e))return null;var t="(?:^|.*;\\s*)"+escape(e).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=\\s*((?:[^;](?!;))*[^;]?).*";return unescape(s.cookie.replace(new RegExp(t),"$1"))},write:function(e,t){if(!e)return;s.cookie=escape(e)+"="+escape(t)+"; expires=Tue, 19 Jan 2038 03:14:07 GMT; path=/"},each:r,remove:o,clearAll:function(){r((function(e,t){o(t)}))}};var s=i.document;function r(e){for(var t=s.cookie.split(/; ?/g),i=t.length-1;i>=0;i--)if(n(t[i])){var r=t[i].split("="),o=unescape(r[0]);e(unescape(r[1]),o)}}function o(e){e&&a(e)&&(s.cookie=escape(e)+"=; expires=Thu, 01 Jan 1970 00:00:00 GMT; path=/")}function a(e){return new RegExp("(?:^|;\\s*)"+escape(e).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=").test(s.cookie)}})),parcelRequire.register("64b1H",(function(e,t){var i=$b63e377f8a561b77$exports.Global;function n(){return i.sessionStorage}function s(e){return n().getItem(e)}e.exports={name:"sessionStorage",read:s,write:function(e,t){return n().setItem(e,t)},each:function(e){for(var t=n().length-1;t>=0;t--){var i=n().key(t);e(s(i),i)}},remove:function(e){return n().removeItem(e)},clearAll:function(){return n().clear()}}})),parcelRequire.register("ibNr9",(function(e,t){e.exports={name:"memoryStorage",read:function(e){return i[e]},write:function(e,t){i[e]=t},each:function(e){for(var t in i)i.hasOwnProperty(t)&&e(i[t],t)},remove:function(e){delete i[e]},clearAll:function(e){i={}}};var i={}})),parcelRequire.register("8RueS",(function(e,t){e.exports=function(){return parcelRequire("fZtw7"),{}}})),parcelRequire.register("fZtw7",(function(module,exports){"object"!=typeof JSON&&(JSON={}),function(){var rx_one=/^[\],:{}\s]*$/,rx_two=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,rx_three=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,rx_four=/(?:^|:|,)(?:\s*\[)+/g,rx_escapable=/[\\"\u0000-\u001f\u007f-\u009f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,rx_dangerous=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta,rep;function f(e){return e<10?"0"+e:e}function this_value(){return this.valueOf()}function quote(e){return rx_escapable.lastIndex=0,rx_escapable.test(e)?'"'+e.replace(rx_escapable,(function(e){var t=meta[e];return"string"==typeof t?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)}))+'"':'"'+e+'"'}function str(e,t){var i,n,s,r,o,a=gap,l=t[e];switch(l&&"object"==typeof l&&"function"==typeof l.toJSON&&(l=l.toJSON(e)),"function"==typeof rep&&(l=rep.call(t,e,l)),typeof l){case"string":return quote(l);case"number":return isFinite(l)?String(l):"null";case"boolean":case"null":return String(l);case"object":if(!l)return"null";if(gap+=indent,o=[],"[object Array]"===Object.prototype.toString.apply(l)){for(r=l.length,i=0;i<r;i+=1)o[i]=str(i,l)||"null";return s=0===o.length?"[]":gap?"[\n"+gap+o.join(",\n"+gap)+"\n"+a+"]":"["+o.join(",")+"]",gap=a,s}if(rep&&"object"==typeof rep)for(r=rep.length,i=0;i<r;i+=1)"string"==typeof rep[i]&&(s=str(n=rep[i],l))&&o.push(quote(n)+(gap?": ":":")+s);else for(n in l)Object.prototype.hasOwnProperty.call(l,n)&&(s=str(n,l))&&o.push(quote(n)+(gap?": ":":")+s);return s=0===o.length?"{}":gap?"{\n"+gap+o.join(",\n"+gap)+"\n"+a+"}":"{"+o.join(",")+"}",gap=a,s}}"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},Boolean.prototype.toJSON=this_value,Number.prototype.toJSON=this_value,String.prototype.toJSON=this_value),"function"!=typeof JSON.stringify&&(meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},JSON.stringify=function(e,t,i){var n;if(gap="",indent="","number"==typeof i)for(n=0;n<i;n+=1)indent+=" ";else"string"==typeof i&&(indent=i);if(rep=t,t&&"function"!=typeof t&&("object"!=typeof t||"number"!=typeof t.length))throw new Error("JSON.stringify");return str("",{"":e})}),"function"!=typeof JSON.parse&&(JSON.parse=function(text,reviver){var j;function walk(e,t){var i,n,s=e[t];if(s&&"object"==typeof s)for(i in s)Object.prototype.hasOwnProperty.call(s,i)&&(void 0!==(n=walk(s,i))?s[i]=n:delete s[i]);return reviver.call(e,t,s)}if(text=String(text),rx_dangerous.lastIndex=0,rx_dangerous.test(text)&&(text=text.replace(rx_dangerous,(function(e){return"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)}))),rx_one.test(text.replace(rx_two,"@").replace(rx_three,"]").replace(rx_four,"")))return j=eval("("+text+")"),"function"==typeof reviver?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})}()}));var $jgD1p=parcelRequire("jgD1p"),$1b5031d44df7baeb$exports={},$b56da5de5b72d494$exports={},$b56da5de5b72d494$var$slice=$b63e377f8a561b77$exports.slice,$b56da5de5b72d494$var$pluck=$b63e377f8a561b77$exports.pluck,$b56da5de5b72d494$var$each=$b63e377f8a561b77$exports.each,$b56da5de5b72d494$var$bind=$b63e377f8a561b77$exports.bind,$b56da5de5b72d494$var$create=$b63e377f8a561b77$exports.create,$b56da5de5b72d494$var$isList=$b63e377f8a561b77$exports.isList,$b56da5de5b72d494$var$isFunction=$b63e377f8a561b77$exports.isFunction,$b56da5de5b72d494$var$isObject=$b63e377f8a561b77$exports.isObject;$b56da5de5b72d494$exports={createStore:$b56da5de5b72d494$var$createStore};var $b56da5de5b72d494$var$storeAPI={version:"2.0.12",enabled:!1,get:function(e,t){var i=this.storage.read(this._namespacePrefix+e);return this._deserialize(i,t)},set:function(e,t){return void 0===t?this.remove(e):(this.storage.write(this._namespacePrefix+e,this._serialize(t)),t)},remove:function(e){this.storage.remove(this._namespacePrefix+e)},each:function(e){var t=this;this.storage.each((function(i,n){e.call(t,t._deserialize(i),(n||"").replace(t._namespaceRegexp,""))}))},clearAll:function(){this.storage.clearAll()},hasNamespace:function(e){return this._namespacePrefix=="__storejs_"+e+"_"},createStore:function(){return $b56da5de5b72d494$var$createStore.apply(this,arguments)},addPlugin:function(e){this._addPlugin(e)},namespace:function(e){return $b56da5de5b72d494$var$createStore(this.storage,this.plugins,e)}};function $b56da5de5b72d494$var$_warn(){var e="undefined"==typeof console?null:console;if(e){var t=e.warn?e.warn:e.log;t.apply(e,arguments)}}function $b56da5de5b72d494$var$createStore(e,t,i){i||(i=""),e&&!$b56da5de5b72d494$var$isList(e)&&(e=[e]),t&&!$b56da5de5b72d494$var$isList(t)&&(t=[t]);var n=i?"__storejs_"+i+"_":"",s=i?new RegExp("^"+n):null;if(!/^[a-zA-Z0-9_\-]*$/.test(i))throw new Error("store.js namespaces can only have alphanumerics + underscores and dashes");var r={_namespacePrefix:n,_namespaceRegexp:s,_testStorage:function(e){try{var t="__storejs__test__";e.write(t,t);var i=e.read(t)===t;return e.remove(t),i}catch(e){return!1}},_assignPluginFnProp:function(e,t){var i=this[t];this[t]=function(){var t=$b56da5de5b72d494$var$slice(arguments,0),n=this;function s(){if(i)return $b56da5de5b72d494$var$each(arguments,(function(e,i){t[i]=e})),i.apply(n,t)}var r=[s].concat(t);return e.apply(n,r)}},_serialize:function(e){return JSON.stringify(e)},_deserialize:function(e,t){if(!e)return t;var i="";try{i=JSON.parse(e)}catch(t){i=e}return void 0!==i?i:t},_addStorage:function(e){this.enabled||this._testStorage(e)&&(this.storage=e,this.enabled=!0)},_addPlugin:function(e){var t=this;if($b56da5de5b72d494$var$isList(e))$b56da5de5b72d494$var$each(e,(function(e){t._addPlugin(e)}));else if(!$b56da5de5b72d494$var$pluck(this.plugins,(function(t){return e===t}))){if(this.plugins.push(e),!$b56da5de5b72d494$var$isFunction(e))throw new Error("Plugins must be function values that return objects");var i=e.call(this);if(!$b56da5de5b72d494$var$isObject(i))throw new Error("Plugins must return an object of function properties");$b56da5de5b72d494$var$each(i,(function(i,n){if(!$b56da5de5b72d494$var$isFunction(i))throw new Error("Bad plugin property: "+n+" from plugin "+e.name+". Plugins should only return functions.");t._assignPluginFnProp(i,n)}))}},addStorage:function(e){$b56da5de5b72d494$var$_warn("store.addStorage(storage) is deprecated. Use createStore([storages])"),this._addStorage(e)}},o=$b56da5de5b72d494$var$create(r,$b56da5de5b72d494$var$storeAPI,{plugins:[]});return o.raw={},$b56da5de5b72d494$var$each(o,(function(e,t){$b56da5de5b72d494$var$isFunction(e)&&(o.raw[t]=$b56da5de5b72d494$var$bind(o,e))})),$b56da5de5b72d494$var$each(e,(function(e){o._addStorage(e)})),$b56da5de5b72d494$var$each(t,(function(e){o._addPlugin(e)})),o}var $f590d80a5de1f4a7$exports={};$f590d80a5de1f4a7$exports=[parcelRequire("7mbQa"),parcelRequire("deyjU"),parcelRequire("eCrE3"),parcelRequire("hmYM5"),parcelRequire("64b1H"),parcelRequire("ibNr9")];var $1b5031d44df7baeb$var$plugins=[parcelRequire("8RueS")];$1b5031d44df7baeb$exports=$b56da5de5b72d494$exports.createStore($f590d80a5de1f4a7$exports,$1b5031d44df7baeb$var$plugins);let $3d149cbfd3136500$export$6b7b6cff4ccb438b={muteBackgroundMusic:!1,muteAll:!1},$3d149cbfd3136500$var$_origPreferences={...$3d149cbfd3136500$export$6b7b6cff4ccb438b};function $3d149cbfd3136500$export$de31a87075fdbfcc(){$3d149cbfd3136500$export$6b7b6cff4ccb438b={...$3d149cbfd3136500$var$_origPreferences}}function $3d149cbfd3136500$export$f1786e2fa4419c16(){$parcel$interopDefault($1b5031d44df7baeb$exports).set("pref",$3d149cbfd3136500$export$6b7b6cff4ccb438b)}function $3d149cbfd3136500$export$add4fa36ca2fc569(){$3d149cbfd3136500$export$6b7b6cff4ccb438b={...$3d149cbfd3136500$export$6b7b6cff4ccb438b,...$parcel$interopDefault($1b5031d44df7baeb$exports).get("pref")}}var $jgD1p=parcelRequire("jgD1p"),$cT3l2=parcelRequire("cT3l2"),$3OncY=parcelRequire("3OncY"),$jgD1p=parcelRequire("jgD1p"),$cT3l2=parcelRequire("cT3l2");class $1b9c19121388f259$export$ef2184bd89960b14{constructor(e,t,i,n,s){this.tileMap=new $jgD1p.TileMap({name:"Sand Grid",pos:e,width:i,height:t,tileWidth:n,tileHeight:s}),this.tileMap.z=-1;const r=$cT3l2.Resources.Sand.toSprite();for(let e of this.tileMap.tiles)e.addGraphic(r)}}var $3OncY=parcelRequire("3OncY"),$jgD1p=parcelRequire("jgD1p"),$cT3l2=parcelRequire("cT3l2"),$1Raww=parcelRequire("1Raww"),$cTIIG=parcelRequire("cTIIG");class $202a856f300cb394$export$6d3bb735c0cfe084 extends $jgD1p.Actor{constructor(e,t,i){super({name:"Sand Castle",pos:e.tileMap.pos.add($jgD1p.vec(-$3OncY.default.grid.tileWidth/2,i*$3OncY.default.grid.tileHeight+$3OncY.default.grid.tileHeight/2)),width:$3OncY.default.grid.tileWidth,height:$3OncY.default.grid.tileHeight,collisionType:$jgD1p.CollisionType.Fixed,collisionGroup:$jgD1p.CollisionGroup.collidesWith([$1Raww.Enemy.CollisionGroupGround,$1Raww.Enemy.CollisionGroupFlying])}),this.gameOver=t,this.maxHp=$3OncY.default.sandcastle.maxHealth,this.currentHp=this.maxHp,this.on("postcollision",(e=>this.onPostCollision(e))),this.sandcastle=$cT3l2.Resources.SandCastle.toSprite(),this.graphics.add("default",this.sandcastle),this.healthBar=new $cTIIG.Healthbar(this.maxHp),this.addChild(this.healthBar)}onPostCollision(e){this.takeDamage(),e.other.kill()}takeDamage(){this.currentHp-=1,this.healthBar.takeDamage(1);const e=this.pos.clone();this.actions.easeTo(e.add($jgD1p.vec(3,0)),50).easeTo(e.add($jgD1p.vec(-3,0)),70).easeTo(e,50),$cT3l2.Resources.FxImpactCastleByEnemy.play(),this.currentHp<=0&&(this.kill(),this.gameOver.triggerGameOver())}}var $3OncY=parcelRequire("3OncY"),$jgD1p=parcelRequire("jgD1p"),$1Raww=parcelRequire("1Raww");class $de8be84271b58ead$export$be9b8cc71a71c056{constructor(e,t){this.level=e,this.random=t,this.possibleSpawnTiles=[];for(let e=0;e<$3OncY.default.grid.height;e++)this.possibleSpawnTiles.push(this.level.grid.tileMap.getTile($3OncY.default.grid.width-1,e))}spawnEnemy(e,t,i){const n=this.level.grid.tileMap.getTile(t,i),s=new $1Raww.Enemy(e,this.level.grid,n.pos.x+$3OncY.default.grid.tileWidth/2,n.pos.y+$3OncY.default.grid.tileHeight/2);return this.level.add(s),s.claimTiles(n,n),s}spawnEnemyAtRandomTile(e,t){const i=this.random.integer(0,this.possibleSpawnTiles.length-1);return this.spawnEnemy(e,$3OncY.default.grid.width-1,i)}spawnEnemies(e,t){const i=this.random.pickSet($jgD1p.range(0,this.possibleSpawnTiles.length-1),t,!0);let n=[];for(let t of i)n.push(this.spawnEnemy(e,$3OncY.default.grid.width-1,t));return n}}var $1Raww=parcelRequire("1Raww"),$3HlYA=parcelRequire("3HlYA"),$jgD1p=parcelRequire("jgD1p"),$3HlYA=parcelRequire("3HlYA"),$3OncY=parcelRequire("3OncY"),$1Raww=parcelRequire("1Raww"),$f836V=parcelRequire("f836V"),$4TY6b=parcelRequire("4TY6b"),$cT3l2=parcelRequire("cT3l2");class $26db8c8762619bb5$export$d97afb273a2ed2b9{_highlightedTile=null;selectedTowerType=$3HlYA.TowerType.default;towerPlacementBlockedOrDisallowed=!1;constructor(e,t){this._grid=e,this._engine=t,t.input.pointers.primary.on("move",(e=>this.onPointerMove(e))),t.input.pointers.primary.on("down",(e=>this.onConfirm(e))),this._highlight=new $jgD1p.Actor({pos:$jgD1p.vec(-100,-100)}),this.ghostTower=new $jgD1p.Actor,this.ghostTower.graphics.opacity=.5,this._highlight.onPostUpdate=()=>{if(null!=this._highlightedTile){if(this._highlightedTile.data.has("tower"))this._rect.strokeColor=$jgD1p.Color.Yellow,this._placeable=!1,this.towerPlacementBlockedOrDisallowed=!1;else if($1Raww.Enemy.enemiesInTile(this._highlightedTile)>0||this._highlightedTile.data.has("water")){this._placeable=!this._highlightedTile.data.has("water"),this._rect.strokeColor=$jgD1p.Color.Red,this.towerPlacementBlockedOrDisallowed=!0;const e=$cT3l2.Resources.BlockedCursor.toSprite();this.ghostTower.graphics.use(e)}else{this._rect.strokeColor=$jgD1p.Color.Green,this._placeable=!0,this.towerPlacementBlockedOrDisallowed=!1;const e=$3OncY.default.tower[window.TowerPickerUI.selectedTower()]?.sprite?.toSprite();this.ghostTower.graphics.use(e)}this.updateGhostTowerVisibility()}},this._rect=new $jgD1p.Rectangle({width:$3OncY.default.grid.tileWidth,height:$3OncY.default.grid.tileHeight,color:$jgD1p.Color.Transparent,strokeColor:$jgD1p.Color.Green,lineWidth:3,lineDash:[3,3]}),this._highlight.graphics.use(this._rect),t.add(this._highlight),t.add(this.ghostTower)}_placeable=!0;_hasSprite=!0;showGhostTower(){return this._placeable&&this._hasSprite}updateGhostTowerVisibility(){this.ghostTower.graphics.visible=this.showGhostTower()}onPointerMove(e){const t=this._grid.tileMap.getTileByPoint(e.worldPos),i=$3OncY.default.tower[window.TowerPickerUI.selectedTower()]?.sprite?.toSprite();if(i)if(this.towerPlacementBlockedOrDisallowed){const e=$cT3l2.Resources.BlockedCursor.toSprite();this.ghostTower.graphics.use(e),this._hasSprite=!0}else this.ghostTower.graphics.use(i),this._hasSprite=!0;else this._hasSprite=!1;this.updateGhostTowerVisibility(),t&&(this._highlightedTile=t,this._highlight.pos=this._highlightedTile.pos.add($jgD1p.vec($3OncY.default.grid.tileWidth/2,$3OncY.default.grid.tileHeight/2)),this.ghostTower.pos=this._highlight.pos)}onConfirm(e){if(e.pointerType===$jgD1p.Input.PointerType.Touch){const t=this._grid.tileMap.getTileByPoint(e.worldPos);t&&(this._highlightedTile=t,this._highlight.pos=this._highlightedTile.pos.add($jgD1p.vec($3OncY.default.grid.tileWidth/2,$3OncY.default.grid.tileHeight/2)))}if(e.pointerType===$jgD1p.Input.PointerType.Mouse){if(2===e.nativeEvent.button)return}if(this._highlightedTile)if(this._highlightedTile.data.has("tower")||this._highlightedTile.data.has("water"))console.log("Tower already there!");else if($1Raww.Enemy.enemiesInTile(this._highlightedTile)>0)console.log("Enemy already there!");else{const e=window.TowerPickerUI.selectedTower(),t=new $3HlYA.Tower(e,this._grid,this._highlightedTile.x,this._highlightedTile.y);$f836V.PlayerState.SubtractMoney(t.cost)&&(this._highlightedTile.data.set("tower",t),$4TY6b.TowerBroken.removeBrokenTower(this._highlightedTile),this._engine.add(t),$cT3l2.Resources.FxPlaceTower.play())}}}var $3OncY=parcelRequire("3OncY"),$jgD1p=parcelRequire("jgD1p"),$1Raww=parcelRequire("1Raww"),$cT3l2=parcelRequire("cT3l2");class $143290d3d7adafdc$export$75538c773353a2ee extends $jgD1p.Actor{constructor(e,t){super({name:"WaveDispatcher"}),this._spawner=e,this._random=t,this._textActor=new $jgD1p.Actor({pos:$jgD1p.vec($3OncY.default.grid.width*$3OncY.default.grid.tileWidth+500,$3OncY.default.grid.height/2*$3OncY.default.grid.tileHeight),z:10}),this._text=new $jgD1p.Text({text:"Wave 1",font:new $jgD1p.Font({size:32,family:"Kanit, sans-serif",quality:8,smoothing:!0})}),this._textActor.graphics.use(this._text),this.addChild(this._textActor)}onInitialize(e){}_stopped=!1;stop(){this._stopped=!0}_currentTime=0;_currentWave=0;_currentEnemies=[];_dispatched=[];onPostUpdate(e,t){if(this._stopped)return;this._currentTime+=t;let i=$3OncY.default.waves[this._currentWave];if(!i){let e=`Wave ${this._currentWave}`,t={};for(let n of $jgD1p.range(0,this._currentWave)){for(let e of Object.values($1Raww.EnemyType)){let i=0,s=this._currentWave;switch(e){case $1Raww.EnemyType.Crab:i=s+5;break;case $1Raww.EnemyType.Seagull:i=s+3;break;case $1Raww.EnemyType.Turtle:i=s+7}let r=2+5*n;t[r]||(t[r]=[]),t[r].push({type:e,count:this._random.range(1,s,i)[0]})}i={name:e,offsets:t},$3OncY.default.waves[this._currentWave]=i,console.log(i)}}if(this._dispatched.length===Object.keys($3OncY.default.waves[this._currentWave].offsets).length&&this.enemiesComplete()&&(this._currentWave++,this._currentTime=0,this._dispatched.length=0,this._currentEnemies.length=0,console.log("Wave Complete")),i)for(let e in i.offsets)if(!this._dispatched.find((t=>t===Number(e)))&&this._currentTime/1e3>=Number(e)){if(this.isBeginningOfWave()){const e=$3OncY.default.waves[this._currentWave];this._text.text=e.name,this.showWaveBanner(`Wave: ${this._currentWave}`)}this._dispatched.push(Number(e));for(let t of i.offsets[e])this._currentEnemies=this._currentEnemies.concat(this._spawner.spawnEnemies(t.type,t.count))}}enemiesComplete(){return this._currentEnemies.every((e=>!e.active))}isBeginningOfWave(){return 0===this._dispatched.length}showWaveBanner(e){$cT3l2.Resources.FxWaveAppear.play(),this._textActor.actions.easeTo($jgD1p.vec($3OncY.default.grid.tileWidth*$3OncY.default.grid.width/1.33,$3OncY.default.grid.height/2*$3OncY.default.grid.tileHeight),1e3,$jgD1p.EasingFunctions.EaseInOutCubic),this._textActor.actions.delay(1e3),this._textActor.actions.easeTo(this._textActor.pos.add($jgD1p.vec(1e3,0)),1e3,$jgD1p.EasingFunctions.EaseInOutCubic),this._textActor.actions.callMethod((()=>{this._textActor.pos=$jgD1p.vec($3OncY.default.grid.width*$3OncY.default.grid.tileWidth+500,$3OncY.default.grid.height/2*$3OncY.default.grid.tileHeight)}))}}var $jgD1p=parcelRequire("jgD1p");class $3ce5eaa42dfda069$export$5b8da01f83922c02{constructor(e,t,i){this.engine=e,this.level=t,this.waveDispatcher=i,this.enemyQuery=this.engine.currentScene.world.queryManager.createQuery(["enemy"]);const n=new $jgD1p.Text({text:"Game Over",font:new $jgD1p.Font({size:64,family:"Kanit, sans-serif",quality:4,smoothing:!0,filtering:$jgD1p.ImageFiltering.Blended})});this.gameOverActor=new $jgD1p.Actor({pos:$jgD1p.vec(e.screen.center.x,800),z:10,collisionType:$jgD1p.CollisionType.PreventCollision}),this.gameOverActor.graphics.use(n),e.currentScene.add(this.gameOverActor);const s=document.getElementById("restart-game");s?.addEventListener("click",(()=>this.restart())),this.restartGame$=s}triggerGameOver(){this.waveDispatcher.stop();const e=this.enemyQuery.getEntities();for(let t of e){const e=t.get($jgD1p.MotionComponent);e&&setTimeout((()=>{t.stop(),e.vel=$jgD1p.Vector.Zero}))}this.gameOverActor.actions.easeTo($jgD1p.vec(this.engine.screen.center.x,200),1e3,$jgD1p.EasingFunctions.EaseInOutCubic).blink(2e3,1e3),this.restartGame$.style.visibility="visible"}restart(){this.level.restart(),this.restartGame$.style.visibility="hidden"}}var $jgD1p=parcelRequire("jgD1p"),$60313e3b9e75c852$exports={};
/*!
  Copyright (c) 2018 Jed Watson.
  Licensed under the MIT License (MIT), see
  http://jedwatson.github.io/classnames
*/!function(){var e={}.hasOwnProperty;function t(){for(var i=[],n=0;n<arguments.length;n++){var s=arguments[n];if(s){var r=typeof s;if("string"===r||"number"===r)i.push(s);else if(Array.isArray(s)){if(s.length){var o=t.apply(null,s);o&&i.push(o)}}else if("object"===r)if(s.toString===Object.prototype.toString)for(var a in s)e.call(s,a)&&s[a]&&i.push(a);else i.push(s.toString())}}return i.join(" ")}$60313e3b9e75c852$exports?(t.default=t,$60313e3b9e75c852$exports=t):"function"==typeof define&&"object"==typeof define.amd&&define.amd?define("classnames",[],(function(){return t})):window.classNames=t}();var $cT3l2=parcelRequire("cT3l2"),$3OncY=parcelRequire("3OncY");class $613a632b39062363$export$a62869ddf53aa3e3{static setSoundSpecificVolume(){$cT3l2.Resources.Clank.volume=.5,$cT3l2.Resources.FxWaveAppear.volume=.8,$cT3l2.Resources.FxImpactEnemyBall.volume=.7,$cT3l2.Resources.FxImpactTowerByEnemy.volume=.5,$cT3l2.Resources.FxImpactCastleByEnemy.volume=.7,$cT3l2.Resources.FxDeathCrabForCutie.volume=.6,$cT3l2.Resources.FxDeathGull.volume=.6,$cT3l2.Resources.FxDeathTurtle.volume=.6,$cT3l2.Resources.FxPlaceTower.volume=1,$cT3l2.Resources.FxHarvestTower.volume=.5,$cT3l2.Resources.UiPickTower.volume=.3}static init(){$613a632b39062363$export$a62869ddf53aa3e3.setSoundSpecificVolume(),$3d149cbfd3136500$export$6b7b6cff4ccb438b.muteBackgroundMusic&&$613a632b39062363$export$a62869ddf53aa3e3.muteBackgroundMusic(),$3d149cbfd3136500$export$6b7b6cff4ccb438b.muteAll&&$613a632b39062363$export$a62869ddf53aa3e3.muteAll(),$("#mute-music").on("click",(()=>($3d149cbfd3136500$export$6b7b6cff4ccb438b.muteBackgroundMusic?$613a632b39062363$export$a62869ddf53aa3e3.unmuteBackgroundMusic():$613a632b39062363$export$a62869ddf53aa3e3.muteBackgroundMusic(),$3d149cbfd3136500$export$f1786e2fa4419c16(),!1))),$("#mute-all").on("click",(()=>($3d149cbfd3136500$export$6b7b6cff4ccb438b.muteAll?$613a632b39062363$export$a62869ddf53aa3e3.unmuteAll():$613a632b39062363$export$a62869ddf53aa3e3.muteAll(),$3d149cbfd3136500$export$f1786e2fa4419c16(),!1)))}static muteAll(){$3d149cbfd3136500$export$6b7b6cff4ccb438b.muteAll=!0,$3d149cbfd3136500$export$6b7b6cff4ccb438b.muteBackgroundMusic=!0;for(let e in $cT3l2.Resources){let t=$cT3l2.Resources[e];t instanceof $jgD1p.Sound&&(t.volume=0)}$613a632b39062363$export$a62869ddf53aa3e3.muteBackgroundMusic(),$613a632b39062363$export$a62869ddf53aa3e3._updateMuteAllButton()}static unmuteAll(){for(var e in $3d149cbfd3136500$export$6b7b6cff4ccb438b.muteAll=!1,$3d149cbfd3136500$export$6b7b6cff4ccb438b.muteBackgroundMusic=!1,$cT3l2.Resources){let t=$cT3l2.Resources[e];t instanceof $jgD1p.Sound&&(t.volume=$3OncY.default.SoundVolume)}$613a632b39062363$export$a62869ddf53aa3e3.setSoundSpecificVolume(),$613a632b39062363$export$a62869ddf53aa3e3.unmuteBackgroundMusic(),$613a632b39062363$export$a62869ddf53aa3e3._updateMuteAllButton()}static startBackgroundMusic(){$cT3l2.Resources.BackgroundAmbiance.volume=$3d149cbfd3136500$export$6b7b6cff4ccb438b.muteBackgroundMusic?0:$3OncY.default.BackgroundAmbianceVolume,$cT3l2.Resources.BackgroundAmbiance.loop=!0,$cT3l2.Resources.BackgroundAmbiance.isPlaying()||$cT3l2.Resources.BackgroundAmbiance.play(),$cT3l2.Resources.BackgroundMusic.volume=$3d149cbfd3136500$export$6b7b6cff4ccb438b.muteBackgroundMusic?0:$3OncY.default.BackgroundMusicVolume,$cT3l2.Resources.BackgroundMusic.loop=!0,$cT3l2.Resources.BackgroundMusic.isPlaying()||$cT3l2.Resources.BackgroundMusic.play()}static stopBackgroundMusic(){$cT3l2.Resources.BackgroundAmbiance.loop=!1,$cT3l2.Resources.BackgroundMusic.loop=!1}static muteBackgroundMusic(){$3d149cbfd3136500$export$6b7b6cff4ccb438b.muteBackgroundMusic=!0,$cT3l2.Resources.BackgroundAmbiance.volume=0,$cT3l2.Resources.BackgroundMusic.volume=0,$613a632b39062363$export$a62869ddf53aa3e3._updateMusicButton()}static unmuteBackgroundMusic(){$3d149cbfd3136500$export$6b7b6cff4ccb438b.muteBackgroundMusic=!1,$cT3l2.Resources.BackgroundAmbiance.volume=$3OncY.default.BackgroundAmbianceVolume,$cT3l2.Resources.BackgroundMusic.volume=$3OncY.default.BackgroundMusicVolume,$613a632b39062363$export$a62869ddf53aa3e3._updateMusicButton()}static _updateMusicButton(){$("#mute-music i").get(0).className=$parcel$interopDefault($60313e3b9e75c852$exports)("fa",{"fa-music":!$3d149cbfd3136500$export$6b7b6cff4ccb438b.muteBackgroundMusic,"fa-play":$3d149cbfd3136500$export$6b7b6cff4ccb438b.muteBackgroundMusic})}static _updateMuteAllButton(){$("#mute-all i").get(0).className=$parcel$interopDefault($60313e3b9e75c852$exports)("fa",{"fa-volume-up":!$3d149cbfd3136500$export$6b7b6cff4ccb438b.muteAll,"fa-volume-off":$3d149cbfd3136500$export$6b7b6cff4ccb438b.muteAll})}}var $3OncY=parcelRequire("3OncY"),$jgD1p=parcelRequire("jgD1p"),$cT3l2=parcelRequire("cT3l2");class $25cac55b35f98e31$export$1832bdd7a783545e extends $jgD1p.Actor{constructor(e,t,i,n,s){const r=e.tileMap.getTile($3OncY.default.grid.width-1,0).pos;super({name:"Water",pos:$jgD1p.vec(r.x+t,i*$3OncY.default.grid.tileHeight-2*$3OncY.default.grid.tileHeight+n),width:$3OncY.default.grid.tileWidth,height:$3OncY.default.grid.tileHeight,collisionType:$jgD1p.CollisionType.PreventCollision}),this.grid=e,this.phaseYOffset=n,this.delay=s;const o=$cT3l2.Resources.Water.toSprite();this.graphics.use(o)}onInitialize(){const e=this.pos.clone();this.actions.delay(this.delay),this.actions.repeatForever((t=>{t.easeTo(e.add($jgD1p.vec(-20,0)),3e3,$jgD1p.EasingFunctions.EaseInOutCubic),t.easeTo(e.add($jgD1p.vec(20,0)),3e3,$jgD1p.EasingFunctions.EaseInOutCubic)}))}}var $f836V=parcelRequire("f836V");class $84ab826914df134a$export$ca664994d1d54bff extends $jgD1p.Scene{random=new $jgD1p.Random(Date.now());sandCastles=[];_playerWealthTick=0;_playerWealthGeneration=$3OncY.default.player.passiveWealthTick;onPostUpdate(e,t){this._playerWealthTick+=t/1e3,this._playerWealthTick>=this._playerWealthGeneration&&($f836V.PlayerState.AddMoney($3OncY.default.player.passiveWealthAmt),this._playerWealthTick=0)}onInitialize(e){$613a632b39062363$export$a62869ddf53aa3e3.startBackgroundMusic(),$3OncY.default.Seed=this.random.seed,this.grid=new $1b9c19121388f259$export$ef2184bd89960b14($jgD1p.vec($3OncY.default.grid.tileWidth,0),$3OncY.default.grid.height,$3OncY.default.grid.width,$3OncY.default.grid.tileWidth,$3OncY.default.grid.tileHeight),this.add(this.grid.tileMap);for(let e=0;e<2*$3OncY.default.grid.height;e++){const t=new $25cac55b35f98e31$export$1832bdd7a783545e(this.grid,$3OncY.default.grid.tileWidth/2,e,0,0);t.z=0,this.add(t);const i=new $25cac55b35f98e31$export$1832bdd7a783545e(this.grid,$3OncY.default.grid.tileWidth,e,$3OncY.default.grid.tileHeight/2,500);i.z=5,this.add(i);const n=this.grid.tileMap.getTile($3OncY.default.grid.width-1,e);n&&n.data.set("water",!0)}this.enemyGenerator=new $de8be84271b58ead$export$be9b8cc71a71c056(this,this.random);const t=new $3HlYA.Tower($3HlYA.TowerType.default,this.grid,4,3);this.grid.tileMap.getTile(4,3).data.set("tower",t),this.add(t);const i=new $3HlYA.Tower($3HlYA.TowerType.sandBucket,this.grid,0,3);this.grid.tileMap.getTile(0,3).data.set("tower",i),this.add(i);const n=()=>{console.log("adding tutorial enemy");const e=this.enemyGenerator.spawnEnemy($1Raww.EnemyType.Crab,7,3);this.add(e)},s=new $jgD1p.Timer({interval:5e3,fcn:()=>{n()}});this.add(s),s.start(),this.towerPlacer=new $26db8c8762619bb5$export$d97afb273a2ed2b9(this.grid,e),this.waveDispatcher=new $143290d3d7adafdc$export$75538c773353a2ee(this.enemyGenerator,this.random),this.add(this.waveDispatcher),this.gameOver=new $3ce5eaa42dfda069$export$5b8da01f83922c02(e,this,this.waveDispatcher);for(let e=0;e<$3OncY.default.grid.height;e++){const t=new $202a856f300cb394$export$6d3bb735c0cfe084(this.grid,this.gameOver,e);this.sandCastles.push(t),this.add(t)}const r=new $jgD1p.Actor({pos:$jgD1p.vec(e.screen.resolution.width/2,e.screen.resolution.height-32),height:50,width:50,color:$jgD1p.Color.Orange,z:-1});r.graphics.use($cT3l2.Resources.BottomBorder.toSprite()),this.add(r);const o=new $jgD1p.Actor({pos:$jgD1p.vec(32,e.screen.resolution.height/2),height:50,width:50,color:$jgD1p.Color.Orange,z:-1});o.graphics.use($cT3l2.Resources.SideBorder.toSprite()),this.add(o);document.getElementById("towerSelection").style.display="flex"}restart(){this.engine.currentScene.entities.forEach((e=>e.kill())),this.engine.currentScene.onInitialize(this.engine),$f836V.PlayerState.moneyResource=$3OncY.default.player.startingMonies}}var $cT3l2=parcelRequire("cT3l2"),$d82f9d57af76c42b$exports={},t1;self,t1=parcelRequire("jgD1p"),$d82f9d57af76c42b$exports=(()=>{var e={"./picker-system.ts":(e,t,i)=>{i.r(t),i.d(t,{PickerSystem:()=>s});var n=i("excalibur");class s extends n.System{constructor(){super(...arguments),this.types=["ex.transform"],this.systemType=n.SystemType.Update,this.priority=99,this.lastFrameEntityToPointers=new Map,this.currentFrameEntityToPointers=new Map}initialize(e){this._engine=e.engine,this._receiver=this._engine.input.pointers}addPointerToEntity(e,t){if(!this.currentFrameEntityToPointers.has(e.id))return void this.currentFrameEntityToPointers.set(e.id,[t]);const i=this.currentFrameEntityToPointers.get(e.id);this.currentFrameEntityToPointers.set(e.id,i.concat(t))}_processPointerToEntity(e){var t;let i,s,r;for(const o of e)if(!(o instanceof n.Particle)){if(i=o.get(n.TransformComponent),s=o.get(n.ColliderComponent),s){const e=s.get();if(e)for(const[t,s]of this._receiver.currentFramePointerCoords.entries())e.contains(i.coordPlane===n.CoordPlane.World?s.worldPos:s.screenPos)&&this.addPointerToEntity(o,t)}if(r=o.get(n.GraphicsComponent),r){const e=r.localBounds.transform(i.getGlobalMatrix());for(const[t,s]of this._receiver.currentFramePointerCoords.entries())e.contains(i.coordPlane===n.CoordPlane.World?s.worldPos:s.screenPos)&&this.addPointerToEntity(o,t)}if(!(null===(t=null==r?void 0:r.current)||void 0===t?void 0:t.length)&&!(null==s?void 0:s.get())||o instanceof n.ParticleEmitter){const e=n.BoundingBox.fromDimension(100,100).transform(i.getGlobalMatrix());for(const[t,s]of this._receiver.currentFramePointerCoords.entries())e.contains(i.coordPlane===n.CoordPlane.World?s.worldPos:s.screenPos)&&this.addPointerToEntity(o,t)}}}update(e,t){this._processPointerToEntity(e),this.lastFrameEntityToPointers.clear(),this.lastFrameEntityToPointers=new Map(this.currentFrameEntityToPointers),this.currentFrameEntityToPointers.clear()}}},"./node_modules/tweakpane/dist/tweakpane.js":function(e,t){!function(e){class t{constructor(e){this.controller_=e}get disabled(){return this.controller_.viewProps.get("disabled")}set disabled(e){this.controller_.viewProps.set("disabled",e)}get hidden(){return this.controller_.viewProps.get("hidden")}set hidden(e){this.controller_.viewProps.set("hidden",e)}dispose(){this.controller_.viewProps.set("disposed",!0)}}class i{constructor(e){this.target=e}}class n extends i{constructor(e,t,i,n){super(e),this.value=t,this.presetKey=i,this.last=null==n||n}}class s extends i{constructor(e,t,i){super(e),this.value=t,this.presetKey=i}}class r extends i{constructor(e,t){super(e),this.expanded=t}}function o(e){return null==e}function a(e,t){if(e.length!==t.length)return!1;for(let i=0;i<e.length;i++)if(e[i]!==t[i])return!1;return!0}const l={alreadydisposed:()=>"View has been already disposed",invalidparams:e=>`Invalid parameters for '${e.name}'`,nomatchingcontroller:e=>`No matching controller for '${e.key}'`,nomatchingview:e=>`No matching view for '${JSON.stringify(e.params)}'`,notbindable:()=>"Value is not bindable",propertynotfound:e=>`Property '${e.name}' not found`,shouldneverhappen:()=>"This error should never happen"};class c{constructor(e){var t;this.message=null!==(t=l[e.type](e.context))&&void 0!==t?t:"Unexpected error",this.name=this.constructor.name,this.stack=new Error(this.message).stack,this.type=e.type}static alreadyDisposed(){return new c({type:"alreadydisposed"})}static notBindable(){return new c({type:"notbindable"})}static propertyNotFound(e){return new c({type:"propertynotfound",context:{name:e}})}static shouldNeverHappen(){return new c({type:"shouldneverhappen"})}}class d{constructor(e,t,i){this.obj_=e,this.key_=t,this.presetKey_=null!=i?i:t}static isBindable(e){return null!==e&&"object"==typeof e}get key(){return this.key_}get presetKey(){return this.presetKey_}read(){return this.obj_[this.key_]}write(e){this.obj_[this.key_]=e}writeProperty(e,t){const i=this.read();if(!d.isBindable(i))throw c.notBindable();if(!(e in i))throw c.propertyNotFound(e);i[e]=t}}class p extends t{get label(){return this.controller_.props.get("label")}set label(e){this.controller_.props.set("label",e)}get title(){var e;return null!==(e=this.controller_.valueController.props.get("title"))&&void 0!==e?e:""}set title(e){this.controller_.valueController.props.set("title",e)}on(e,t){const n=t.bind(this);return this.controller_.valueController.emitter.on(e,(()=>{n(new i(this))})),this}}class h{constructor(){this.observers_={}}on(e,t){let i=this.observers_[e];return i||(i=this.observers_[e]=[]),i.push({handler:t}),this}off(e,t){const i=this.observers_[e];return i&&(this.observers_[e]=i.filter((e=>e.handler!==t))),this}emit(e,t){const i=this.observers_[e];i&&i.forEach((e=>{e.handler(t)}))}}const u="tp";function v(e){return(t,i)=>[u,"-",e,"v",t?`_${t}`:"",i?`-${i}`:""].join("")}function b(e){return e.rawValue}function m(e,t){var i,n;e.emitter.on("change",(i=b,n=t,e=>n(i(e)))),t(e.rawValue)}function g(e,t,i){m(e.value(t),i)}function f(e,t){return i=>{!function(e,t,i){i?e.classList.add(t):e.classList.remove(t)}(e,t,i)}}function _(e,t){m(e,(e=>{t.textContent=null!=e?e:""}))}const w=v("btn");class x{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(w()),t.viewProps.bindClassModifiers(this.element);const i=e.createElement("button");i.classList.add(w("b")),t.viewProps.bindDisabled(i),this.element.appendChild(i),this.buttonElement=i;const n=e.createElement("div");n.classList.add(w("t")),_(t.props.value("title"),n),this.buttonElement.appendChild(n)}}class y{constructor(e,t){this.emitter=new h,this.onClick_=this.onClick_.bind(this),this.props=t.props,this.viewProps=t.viewProps,this.view=new x(e,{props:this.props,viewProps:this.viewProps}),this.view.buttonElement.addEventListener("click",this.onClick_)}onClick_(){this.emitter.emit("click",{sender:this})}}class ${constructor(e,t){var i;this.constraint_=null==t?void 0:t.constraint,this.equals_=null!==(i=null==t?void 0:t.equals)&&void 0!==i?i:(e,t)=>e===t,this.emitter=new h,this.rawValue_=e}get constraint(){return this.constraint_}get rawValue(){return this.rawValue_}set rawValue(e){this.setRawValue(e,{forceEmit:!1,last:!0})}setRawValue(e,t){const i=null!=t?t:{forceEmit:!1,last:!0},n=this.constraint_?this.constraint_.constrain(e):e;(!this.equals_(this.rawValue_,n)||i.forceEmit)&&(this.emitter.emit("beforechange",{sender:this}),this.rawValue_=n,this.emitter.emit("change",{options:i,rawValue:n,sender:this}))}}class C{constructor(e){this.emitter=new h,this.value_=e}get rawValue(){return this.value_}set rawValue(e){this.setRawValue(e,{forceEmit:!1,last:!0})}setRawValue(e,t){const i=null!=t?t:{forceEmit:!1,last:!0};(this.value_!==e||i.forceEmit)&&(this.emitter.emit("beforechange",{sender:this}),this.value_=e,this.emitter.emit("change",{options:i,rawValue:this.value_,sender:this}))}}function P(e,t){const i=null==t?void 0:t.constraint,n=null==t?void 0:t.equals;return i||n?new $(e,t):new C(e)}class k{constructor(e){this.emitter=new h,this.valMap_=e;for(const e in this.valMap_)this.valMap_[e].emitter.on("change",(()=>{this.emitter.emit("change",{key:e,sender:this})}))}static createCore(e){return Object.keys(e).reduce(((t,i)=>Object.assign(t,{[i]:P(e[i])})),{})}static fromObject(e){const t=this.createCore(e);return new k(t)}get(e){return this.valMap_[e].rawValue}set(e,t){this.valMap_[e].rawValue=t}value(e){return this.valMap_[e]}}function E(e){return t=>i=>{if(!t&&void 0===i)return{succeeded:!1,value:void 0};if(t&&void 0===i)return{succeeded:!0,value:void 0};const n=e(i);return void 0!==n?{succeeded:!0,value:n}:{succeeded:!1,value:void 0}}}function S(e){return{custom:t=>E(t)(e),boolean:E((e=>"boolean"==typeof e?e:void 0))(e),number:E((e=>"number"==typeof e?e:void 0))(e),string:E((e=>"string"==typeof e?e:void 0))(e),function:E((e=>"function"==typeof e?e:void 0))(e),constant:t=>E((e=>e===t?t:void 0))(e),raw:E((e=>e))(e),object:t=>E((e=>{if(null!==(i=e)&&"object"==typeof i)return function(e,t){return Object.keys(t).reduce(((i,n)=>{if(void 0===i)return;const s=(0,t[n])(e[n]);return s.succeeded?Object.assign(Object.assign({},i),{[n]:s.value}):void 0}),{})}(e,t);var i}))(e),array:t=>E((e=>{if(Array.isArray(e))return i=t,e.reduce(((e,t)=>{if(void 0===e)return;const n=i(t);return n.succeeded&&void 0!==n.value?[...e,n.value]:void 0}),[]);var i}))(e)}}const V={optional:S(!0),required:S(!1)};function T(e,t){const i=V.required.object(t)(e);return i.succeeded?i.value:void 0}const M=v(""),D={veryfirst:"vfst",first:"fst",last:"lst",verylast:"vlst"};class O{constructor(e){this.parent_=null,this.blade=e.blade,this.view=e.view,this.viewProps=e.viewProps;const t=this.view.element;this.blade.value("positions").emitter.on("change",(()=>{["veryfirst","first","last","verylast"].forEach((e=>{t.classList.remove(M(void 0,D[e]))})),this.blade.get("positions").forEach((e=>{t.classList.add(M(void 0,D[e]))}))})),this.viewProps.handleDispose((()=>{!function(e){e&&e.parentElement&&e.parentElement.removeChild(e)}(t)}))}get parent(){return this.parent_}}const A="http://www.w3.org/2000/svg";function j(e){e.offsetHeight}function R(e){return void 0!==e.ontouchstart}function L(){return new Function("return this")().document}const I={check:'<path d="M2 8l4 4l8 -8"/>',dropdown:'<path d="M5 7h6l-3 3 z"/>',p2dpad:'<path d="M8 4v8"/><path d="M4 8h8"/><circle cx="12" cy="12" r="1.2"/>'};function B(e,t){const i=e.createElementNS(A,"svg");return i.innerHTML=I[t],i}function F(e,t,i){e.insertBefore(t,e.children[i])}function N(e){e.parentElement&&e.parentElement.removeChild(e)}function U(e){for(;e.children.length>0;)e.removeChild(e.children[0])}function Y(e){return e.relatedTarget?e.relatedTarget:"explicitOriginalTarget"in e?e.explicitOriginalTarget:null}const q=v("lbl");class K{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(q()),t.viewProps.bindClassModifiers(this.element);const i=e.createElement("div");i.classList.add(q("l")),g(t.props,"label",(t=>{o(t)?this.element.classList.add(q(void 0,"nol")):(this.element.classList.remove(q(void 0,"nol")),function(e){for(;e.childNodes.length>0;)e.removeChild(e.childNodes[0])}(i),i.appendChild(function(e,t){const i=e.createDocumentFragment();return t.split("\n").map((t=>e.createTextNode(t))).forEach(((t,n)=>{n>0&&i.appendChild(e.createElement("br")),i.appendChild(t)})),i}(e,t)))})),this.element.appendChild(i),this.labelElement=i;const n=e.createElement("div");n.classList.add(q("v")),this.element.appendChild(n),this.valueElement=n}}class H extends O{constructor(e,t){const i=t.valueController.viewProps;super(Object.assign(Object.assign({},t),{view:new K(e,{props:t.props,viewProps:i}),viewProps:i})),this.props=t.props,this.valueController=t.valueController,this.view.valueElement.appendChild(this.valueController.view.element)}}const z={id:"button",type:"blade",accept(e){const t=V,i=T(e,{title:t.required.string,view:t.required.constant("button"),label:t.optional.string});return i?{params:i}:null},controller:e=>new H(e.document,{blade:e.blade,props:k.fromObject({label:e.params.label}),valueController:new y(e.document,{props:k.fromObject({title:e.params.title}),viewProps:e.viewProps})}),api:e=>e.controller instanceof H&&e.controller.valueController instanceof y?new p(e.controller):null};class G extends O{constructor(e){super(e),this.value=e.value}}function W(){return new k({positions:P([],{equals:a})})}class J extends k{constructor(e){super(e)}static create(e){const t={completed:!0,expanded:e,expandedHeight:null,shouldFixHeight:!1,temporaryExpanded:null},i=k.createCore(t);return new J(i)}get styleExpanded(){var e;return null!==(e=this.get("temporaryExpanded"))&&void 0!==e?e:this.get("expanded")}get styleHeight(){if(!this.styleExpanded)return"0";const e=this.get("expandedHeight");return this.get("shouldFixHeight")&&!o(e)?`${e}px`:"auto"}bindExpandedClass(e,t){g(this,"expanded",(()=>{this.styleExpanded?e.classList.add(t):e.classList.remove(t)}))}}function X(e,t){t.style.height=e.styleHeight}function Q(e,t){e.value("expanded").emitter.on("beforechange",(()=>{e.set("completed",!1),o(e.get("expandedHeight"))&&e.set("expandedHeight",function(e,t){let i=0;return function(e,t){const i=e.style.transition;e.style.transition="none",t(),e.style.transition=i}(t,(()=>{e.set("expandedHeight",null),e.set("temporaryExpanded",!0),j(t),i=t.clientHeight,e.set("temporaryExpanded",null),j(t)})),i}(e,t)),e.set("shouldFixHeight",!0),j(t)})),e.emitter.on("change",(()=>{X(e,t)})),X(e,t),t.addEventListener("transitionend",(t=>{"height"===t.propertyName&&(e.set("shouldFixHeight",!1),e.set("expandedHeight",null),e.set("completed",!0))}))}class Z extends t{constructor(e,t){super(e),this.rackApi_=t}}class ee{constructor(e){this.emitter=new h,this.items_=[],this.cache_=new Set,this.onSubListAdd_=this.onSubListAdd_.bind(this),this.onSubListRemove_=this.onSubListRemove_.bind(this),this.extract_=e}get items(){return this.items_}allItems(){return Array.from(this.cache_)}find(e){for(const t of this.allItems())if(e(t))return t;return null}includes(e){return this.cache_.has(e)}add(e,t){if(this.includes(e))throw c.shouldNeverHappen();const i=void 0!==t?t:this.items_.length;this.items_.splice(i,0,e),this.cache_.add(e);const n=this.extract_(e);n&&(n.emitter.on("add",this.onSubListAdd_),n.emitter.on("remove",this.onSubListRemove_),n.allItems().forEach((e=>{this.cache_.add(e)}))),this.emitter.emit("add",{index:i,item:e,root:this,target:this})}remove(e){const t=this.items_.indexOf(e);if(t<0)return;this.items_.splice(t,1),this.cache_.delete(e);const i=this.extract_(e);i&&(i.emitter.off("add",this.onSubListAdd_),i.emitter.off("remove",this.onSubListRemove_)),this.emitter.emit("remove",{index:t,item:e,root:this,target:this})}onSubListAdd_(e){this.cache_.add(e.item),this.emitter.emit("add",{index:e.index,item:e.item,root:this,target:e.target})}onSubListRemove_(e){this.cache_.delete(e.item),this.emitter.emit("remove",{index:e.index,item:e.item,root:this,target:e.target})}}class te extends t{constructor(e){super(e),this.onBindingChange_=this.onBindingChange_.bind(this),this.emitter_=new h,this.controller_.binding.emitter.on("change",this.onBindingChange_)}get label(){return this.controller_.props.get("label")}set label(e){this.controller_.props.set("label",e)}on(e,t){const i=t.bind(this);return this.emitter_.on(e,(e=>{i(e.event)})),this}refresh(){this.controller_.binding.read()}onBindingChange_(e){const t=e.sender.target.read();this.emitter_.emit("change",{event:new n(this,t,this.controller_.binding.target.presetKey,e.options.last)})}}class ie extends H{constructor(e,t){super(e,t),this.binding=t.binding}}class ne extends t{constructor(e){super(e),this.onBindingUpdate_=this.onBindingUpdate_.bind(this),this.emitter_=new h,this.controller_.binding.emitter.on("update",this.onBindingUpdate_)}get label(){return this.controller_.props.get("label")}set label(e){this.controller_.props.set("label",e)}on(e,t){const i=t.bind(this);return this.emitter_.on(e,(e=>{i(e.event)})),this}refresh(){this.controller_.binding.read()}onBindingUpdate_(e){const t=e.sender.target.read();this.emitter_.emit("update",{event:new s(this,t,this.controller_.binding.target.presetKey)})}}class se extends H{constructor(e,t){super(e,t),this.binding=t.binding,this.viewProps.bindDisabled(this.binding.ticker),this.viewProps.handleDispose((()=>{this.binding.dispose()}))}}function re(e){return e instanceof le?e.apiSet_:e instanceof Z?e.rackApi_.apiSet_:null}function oe(e,t){const i=e.find((e=>e.controller_===t));if(!i)throw c.shouldNeverHappen();return i}function ae(e,t,i){if(!d.isBindable(e))throw c.notBindable();return new d(e,t,i)}class le extends t{constructor(e,t){super(e),this.onRackAdd_=this.onRackAdd_.bind(this),this.onRackRemove_=this.onRackRemove_.bind(this),this.onRackInputChange_=this.onRackInputChange_.bind(this),this.onRackMonitorUpdate_=this.onRackMonitorUpdate_.bind(this),this.emitter_=new h,this.apiSet_=new ee(re),this.pool_=t;const i=this.controller_.rack;i.emitter.on("add",this.onRackAdd_),i.emitter.on("remove",this.onRackRemove_),i.emitter.on("inputchange",this.onRackInputChange_),i.emitter.on("monitorupdate",this.onRackMonitorUpdate_),i.children.forEach((e=>{this.setUpApi_(e)}))}get children(){return this.controller_.rack.children.map((e=>oe(this.apiSet_,e)))}addInput(e,t,i){const n=i||{},s=this.controller_.view.element.ownerDocument,r=this.pool_.createInput(s,ae(e,t,n.presetKey),n),o=new te(r);return this.add(o,n.index)}addMonitor(e,t,i){const n=i||{},s=this.controller_.view.element.ownerDocument,r=this.pool_.createMonitor(s,ae(e,t),n),o=new ne(r);return this.add(o,n.index)}addFolder(e){return function(e,t){return e.addBlade(Object.assign(Object.assign({},t),{view:"folder"}))}(this,e)}addButton(e){return function(e,t){return e.addBlade(Object.assign(Object.assign({},t),{view:"button"}))}(this,e)}addSeparator(e){return function(e,t){const i=t||{};return e.addBlade(Object.assign(Object.assign({},i),{view:"separator"}))}(this,e)}addTab(e){return function(e,t){return e.addBlade(Object.assign(Object.assign({},t),{view:"tab"}))}(this,e)}add(e,t){this.controller_.rack.add(e.controller_,t);const i=this.apiSet_.find((t=>t.controller_===e.controller_));return i&&this.apiSet_.remove(i),this.apiSet_.add(e),e}remove(e){this.controller_.rack.remove(e.controller_)}addBlade(e){const t=this.controller_.view.element.ownerDocument,i=this.pool_.createBlade(t,e),n=this.pool_.createBladeApi(i);return this.add(n,e.index)}on(e,t){const i=t.bind(this);return this.emitter_.on(e,(e=>{i(e.event)})),this}setUpApi_(e){this.apiSet_.find((t=>t.controller_===e))||this.apiSet_.add(this.pool_.createBladeApi(e))}onRackAdd_(e){this.setUpApi_(e.bladeController)}onRackRemove_(e){if(e.isRoot){const t=oe(this.apiSet_,e.bladeController);this.apiSet_.remove(t)}}onRackInputChange_(e){const t=e.bladeController;if(t instanceof ie){const i=oe(this.apiSet_,t),s=t.binding;this.emitter_.emit("change",{event:new n(i,s.target.read(),s.target.presetKey,e.options.last)})}else if(t instanceof G){const i=oe(this.apiSet_,t);this.emitter_.emit("change",{event:new n(i,t.value.rawValue,void 0,e.options.last)})}}onRackMonitorUpdate_(e){if(!(e.bladeController instanceof se))throw c.shouldNeverHappen();const t=oe(this.apiSet_,e.bladeController),i=e.bladeController.binding;this.emitter_.emit("update",{event:new s(t,i.target.read(),i.target.presetKey)})}}class ce extends Z{constructor(e,t){super(e,new le(e.rackController,t)),this.emitter_=new h,this.controller_.foldable.value("expanded").emitter.on("change",(e=>{this.emitter_.emit("fold",{event:new r(this,e.sender.rawValue)})})),this.rackApi_.on("change",(e=>{this.emitter_.emit("change",{event:e})})),this.rackApi_.on("update",(e=>{this.emitter_.emit("update",{event:e})}))}get expanded(){return this.controller_.foldable.get("expanded")}set expanded(e){this.controller_.foldable.set("expanded",e)}get title(){return this.controller_.props.get("title")}set title(e){this.controller_.props.set("title",e)}get children(){return this.rackApi_.children}addInput(e,t,i){return this.rackApi_.addInput(e,t,i)}addMonitor(e,t,i){return this.rackApi_.addMonitor(e,t,i)}addFolder(e){return this.rackApi_.addFolder(e)}addButton(e){return this.rackApi_.addButton(e)}addSeparator(e){return this.rackApi_.addSeparator(e)}addTab(e){return this.rackApi_.addTab(e)}add(e,t){return this.rackApi_.add(e,t)}remove(e){this.rackApi_.remove(e)}addBlade(e){return this.rackApi_.addBlade(e)}on(e,t){const i=t.bind(this);return this.emitter_.on(e,(e=>{i(e.event)})),this}}class de extends O{constructor(e){super({blade:e.blade,view:e.view,viewProps:e.rackController.viewProps}),this.rackController=e.rackController}}class pe{constructor(e,t){const i=v(t.viewName);this.element=e.createElement("div"),this.element.classList.add(i()),t.viewProps.bindClassModifiers(this.element)}}function he(e){return e instanceof be?e.rack:e instanceof de?e.rackController.rack:null}function ue(e){const t=he(e);return t?t.bcSet_:null}class ve{constructor(e){var t;this.onBladePositionsChange_=this.onBladePositionsChange_.bind(this),this.onSetAdd_=this.onSetAdd_.bind(this),this.onSetRemove_=this.onSetRemove_.bind(this),this.onChildDispose_=this.onChildDispose_.bind(this),this.onChildPositionsChange_=this.onChildPositionsChange_.bind(this),this.onChildInputChange_=this.onChildInputChange_.bind(this),this.onChildMonitorUpdate_=this.onChildMonitorUpdate_.bind(this),this.onChildValueChange_=this.onChildValueChange_.bind(this),this.onChildViewPropsChange_=this.onChildViewPropsChange_.bind(this),this.onDescendantLayout_=this.onDescendantLayout_.bind(this),this.onDescendantInputChange_=this.onDescendantInputChange_.bind(this),this.onDescendantMonitorUpdate_=this.onDescendantMonitorUpdate_.bind(this),this.emitter=new h,this.blade_=null!=e?e:null,null===(t=this.blade_)||void 0===t||t.value("positions").emitter.on("change",this.onBladePositionsChange_),this.bcSet_=new ee(ue),this.bcSet_.emitter.on("add",this.onSetAdd_),this.bcSet_.emitter.on("remove",this.onSetRemove_)}get children(){return this.bcSet_.items}add(e,t){e.parent&&e.parent.remove(e),e.parent_=this,this.bcSet_.add(e,t)}remove(e){e.parent_=null,this.bcSet_.remove(e)}find(e){return this.bcSet_.allItems().filter((t=>t instanceof e))}onSetAdd_(e){this.updatePositions_();const t=e.target===e.root;if(this.emitter.emit("add",{bladeController:e.item,index:e.index,isRoot:t,sender:this}),!t)return;const i=e.item;if(i.viewProps.emitter.on("change",this.onChildViewPropsChange_),i.blade.value("positions").emitter.on("change",this.onChildPositionsChange_),i.viewProps.handleDispose(this.onChildDispose_),i instanceof ie)i.binding.emitter.on("change",this.onChildInputChange_);else if(i instanceof se)i.binding.emitter.on("update",this.onChildMonitorUpdate_);else if(i instanceof G)i.value.emitter.on("change",this.onChildValueChange_);else{const e=he(i);if(e){const t=e.emitter;t.on("layout",this.onDescendantLayout_),t.on("inputchange",this.onDescendantInputChange_),t.on("monitorupdate",this.onDescendantMonitorUpdate_)}}}onSetRemove_(e){this.updatePositions_();const t=e.target===e.root;if(this.emitter.emit("remove",{bladeController:e.item,isRoot:t,sender:this}),!t)return;const i=e.item;if(i instanceof ie)i.binding.emitter.off("change",this.onChildInputChange_);else if(i instanceof se)i.binding.emitter.off("update",this.onChildMonitorUpdate_);else if(i instanceof G)i.value.emitter.off("change",this.onChildValueChange_);else{const e=he(i);if(e){const t=e.emitter;t.off("layout",this.onDescendantLayout_),t.off("inputchange",this.onDescendantInputChange_),t.off("monitorupdate",this.onDescendantMonitorUpdate_)}}}updatePositions_(){const e=this.bcSet_.items.filter((e=>!e.viewProps.get("hidden"))),t=e[0],i=e[e.length-1];this.bcSet_.items.forEach((e=>{const n=[];e===t&&(n.push("first"),this.blade_&&!this.blade_.get("positions").includes("veryfirst")||n.push("veryfirst")),e===i&&(n.push("last"),this.blade_&&!this.blade_.get("positions").includes("verylast")||n.push("verylast")),e.blade.set("positions",n)}))}onChildPositionsChange_(){this.updatePositions_(),this.emitter.emit("layout",{sender:this})}onChildViewPropsChange_(e){this.updatePositions_(),this.emitter.emit("layout",{sender:this})}onChildDispose_(){this.bcSet_.items.filter((e=>e.viewProps.get("disposed"))).forEach((e=>{this.bcSet_.remove(e)}))}onChildInputChange_(e){const t=function(e,t){for(let i=0;i<e.length;i++){const n=e[i];if(n instanceof ie&&n.binding===t)return n}return null}(this.find(ie),e.sender);if(!t)throw c.shouldNeverHappen();this.emitter.emit("inputchange",{bladeController:t,options:e.options,sender:this})}onChildMonitorUpdate_(e){const t=function(e,t){for(let i=0;i<e.length;i++){const n=e[i];if(n instanceof se&&n.binding===t)return n}return null}(this.find(se),e.sender);if(!t)throw c.shouldNeverHappen();this.emitter.emit("monitorupdate",{bladeController:t,sender:this})}onChildValueChange_(e){const t=function(e,t){for(let i=0;i<e.length;i++){const n=e[i];if(n instanceof G&&n.value===t)return n}return null}(this.find(G),e.sender);if(!t)throw c.shouldNeverHappen();this.emitter.emit("inputchange",{bladeController:t,options:e.options,sender:this})}onDescendantLayout_(e){this.updatePositions_(),this.emitter.emit("layout",{sender:this})}onDescendantInputChange_(e){this.emitter.emit("inputchange",{bladeController:e.bladeController,options:e.options,sender:this})}onDescendantMonitorUpdate_(e){this.emitter.emit("monitorupdate",{bladeController:e.bladeController,sender:this})}onBladePositionsChange_(){this.updatePositions_()}}class be extends O{constructor(e,t){super(Object.assign(Object.assign({},t),{view:new pe(e,{viewName:"brk",viewProps:t.viewProps})})),this.onRackAdd_=this.onRackAdd_.bind(this),this.onRackRemove_=this.onRackRemove_.bind(this);const i=new ve(t.root?void 0:t.blade);i.emitter.on("add",this.onRackAdd_),i.emitter.on("remove",this.onRackRemove_),this.rack=i,this.viewProps.handleDispose((()=>{for(let e=this.rack.children.length-1;e>=0;e--)this.rack.children[e].viewProps.set("disposed",!0)}))}onRackAdd_(e){e.isRoot&&F(this.view.element,e.bladeController.view.element,e.index)}onRackRemove_(e){e.isRoot&&N(e.bladeController.view.element)}}const me=v("cnt");class ge{constructor(e,t){this.className_=v(t.viewName||"fld"),this.element=e.createElement("div"),this.element.classList.add(this.className_(),me()),t.viewProps.bindClassModifiers(this.element),this.foldable_=t.foldable,this.foldable_.bindExpandedClass(this.element,this.className_(void 0,"expanded")),g(this.foldable_,"completed",f(this.element,this.className_(void 0,"cpl")));const i=e.createElement("button");i.classList.add(this.className_("b")),g(t.props,"title",(e=>{o(e)?this.element.classList.add(this.className_(void 0,"not")):this.element.classList.remove(this.className_(void 0,"not"))})),t.viewProps.bindDisabled(i),this.element.appendChild(i),this.buttonElement=i;const n=e.createElement("div");n.classList.add(this.className_("t")),_(t.props.value("title"),n),this.buttonElement.appendChild(n),this.titleElement=n;const s=e.createElement("div");s.classList.add(this.className_("m")),this.buttonElement.appendChild(s);const r=t.containerElement;r.classList.add(this.className_("c")),this.element.appendChild(r),this.containerElement=r}}class fe extends de{constructor(e,t){var i;const n=J.create(null===(i=t.expanded)||void 0===i||i),s=new be(e,{blade:t.blade,root:t.root,viewProps:t.viewProps});super(Object.assign(Object.assign({},t),{rackController:s,view:new ge(e,{containerElement:s.view.element,foldable:n,props:t.props,viewName:t.root?"rot":void 0,viewProps:t.viewProps})})),this.onTitleClick_=this.onTitleClick_.bind(this),this.props=t.props,this.foldable=n,Q(this.foldable,this.view.containerElement),this.view.buttonElement.addEventListener("click",this.onTitleClick_)}get document(){return this.view.element.ownerDocument}onTitleClick_(){this.foldable.set("expanded",!this.foldable.get("expanded"))}}const _e={id:"folder",type:"blade",accept(e){const t=V,i=T(e,{title:t.required.string,view:t.required.constant("folder"),expanded:t.optional.boolean});return i?{params:i}:null},controller:e=>new fe(e.document,{blade:e.blade,expanded:e.params.expanded,props:k.fromObject({title:e.params.title}),viewProps:e.viewProps}),api:e=>e.controller instanceof fe?new ce(e.controller,e.pool):null};class we extends G{constructor(e,t){const i=t.valueController.viewProps;super(Object.assign(Object.assign({},t),{value:t.valueController.value,view:new K(e,{props:t.props,viewProps:i}),viewProps:i})),this.props=t.props,this.valueController=t.valueController,this.view.valueElement.appendChild(this.valueController.view.element)}}class xe extends t{}const ye=v("spr");class $e{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(ye()),t.viewProps.bindClassModifiers(this.element);const i=e.createElement("hr");i.classList.add(ye("r")),this.element.appendChild(i)}}class Ce extends O{constructor(e,t){super(Object.assign(Object.assign({},t),{view:new $e(e,{viewProps:t.viewProps})}))}}const Pe={id:"separator",type:"blade",accept(e){const t=T(e,{view:V.required.constant("separator")});return t?{params:t}:null},controller:e=>new Ce(e.document,{blade:e.blade,viewProps:e.viewProps}),api:e=>e.controller instanceof Ce?new xe(e.controller):null},ke=v("");function Ee(e,t){return f(e,ke(void 0,t))}class Se extends k{constructor(e){super(e)}static create(e){var t,i;const n=null!=e?e:{},s={disabled:null!==(t=n.disabled)&&void 0!==t&&t,disposed:!1,hidden:null!==(i=n.hidden)&&void 0!==i&&i},r=k.createCore(s);return new Se(r)}bindClassModifiers(e){g(this,"disabled",Ee(e,"disabled")),g(this,"hidden",Ee(e,"hidden"))}bindDisabled(e){g(this,"disabled",(t=>{e.disabled=t}))}bindTabIndex(e){g(this,"disabled",(t=>{e.tabIndex=t?-1:0}))}handleDispose(e){this.value("disposed").emitter.on("change",(t=>{t&&e()}))}}const Ve=v("tbi");class Te{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(Ve()),t.viewProps.bindClassModifiers(this.element),g(t.props,"selected",(e=>{e?this.element.classList.add(Ve(void 0,"sel")):this.element.classList.remove(Ve(void 0,"sel"))}));const i=e.createElement("button");i.classList.add(Ve("b")),t.viewProps.bindDisabled(i),this.element.appendChild(i),this.buttonElement=i;const n=e.createElement("div");n.classList.add(Ve("t")),_(t.props.value("title"),n),this.buttonElement.appendChild(n),this.titleElement=n}}class Me{constructor(e,t){this.emitter=new h,this.onClick_=this.onClick_.bind(this),this.props=t.props,this.viewProps=t.viewProps,this.view=new Te(e,{props:t.props,viewProps:t.viewProps}),this.view.buttonElement.addEventListener("click",this.onClick_)}onClick_(){this.emitter.emit("click",{sender:this})}}class De{constructor(e,t){this.onItemClick_=this.onItemClick_.bind(this),this.ic_=new Me(e,{props:t.itemProps,viewProps:Se.create()}),this.ic_.emitter.on("click",this.onItemClick_),this.cc_=new be(e,{blade:W(),viewProps:Se.create()}),this.props=t.props,g(this.props,"selected",(e=>{this.itemController.props.set("selected",e),this.contentController.viewProps.set("hidden",!e)}))}get itemController(){return this.ic_}get contentController(){return this.cc_}onItemClick_(){this.props.set("selected",!0)}}class Oe{constructor(e,t){this.controller_=e,this.rackApi_=t}get title(){var e;return null!==(e=this.controller_.itemController.props.get("title"))&&void 0!==e?e:""}set title(e){this.controller_.itemController.props.set("title",e)}get selected(){return this.controller_.props.get("selected")}set selected(e){this.controller_.props.set("selected",e)}get children(){return this.rackApi_.children}addButton(e){return this.rackApi_.addButton(e)}addFolder(e){return this.rackApi_.addFolder(e)}addSeparator(e){return this.rackApi_.addSeparator(e)}addTab(e){return this.rackApi_.addTab(e)}add(e,t){this.rackApi_.add(e,t)}remove(e){this.rackApi_.remove(e)}addInput(e,t,i){return this.rackApi_.addInput(e,t,i)}addMonitor(e,t,i){return this.rackApi_.addMonitor(e,t,i)}addBlade(e){return this.rackApi_.addBlade(e)}}class Ae extends Z{constructor(e,t){super(e,new le(e.rackController,t)),this.onPageAdd_=this.onPageAdd_.bind(this),this.onPageRemove_=this.onPageRemove_.bind(this),this.emitter_=new h,this.pageApiMap_=new Map,this.rackApi_.on("change",(e=>{this.emitter_.emit("change",{event:e})})),this.rackApi_.on("update",(e=>{this.emitter_.emit("update",{event:e})})),this.controller_.pageSet.emitter.on("add",this.onPageAdd_),this.controller_.pageSet.emitter.on("remove",this.onPageRemove_),this.controller_.pageSet.items.forEach((e=>{this.setUpPageApi_(e)}))}get pages(){return this.controller_.pageSet.items.map((e=>{const t=this.pageApiMap_.get(e);if(!t)throw c.shouldNeverHappen();return t}))}addPage(e){const t=this.controller_.view.element.ownerDocument,i=new De(t,{itemProps:k.fromObject({selected:!1,title:e.title}),props:k.fromObject({selected:!1})});this.controller_.add(i,e.index);const n=this.pageApiMap_.get(i);if(!n)throw c.shouldNeverHappen();return n}removePage(e){this.controller_.remove(e)}on(e,t){const i=t.bind(this);return this.emitter_.on(e,(e=>{i(e.event)})),this}setUpPageApi_(e){const t=this.rackApi_.apiSet_.find((t=>t.controller_===e.contentController));if(!t)throw c.shouldNeverHappen();const i=new Oe(e,t);this.pageApiMap_.set(e,i)}onPageAdd_(e){this.setUpPageApi_(e.item)}onPageRemove_(e){if(!this.pageApiMap_.get(e.item))throw c.shouldNeverHappen();this.pageApiMap_.delete(e.item)}}const je=v("tab");class Re{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(je(),me()),t.viewProps.bindClassModifiers(this.element),m(t.empty,f(this.element,je(void 0,"nop")));const i=e.createElement("div");i.classList.add(je("i")),this.element.appendChild(i),this.itemsElement=i;const n=t.contentsElement;n.classList.add(je("c")),this.element.appendChild(n),this.contentsElement=n}}class Le extends de{constructor(e,t){const i=new be(e,{blade:t.blade,viewProps:t.viewProps}),n=P(!0);super({blade:t.blade,rackController:i,view:new Re(e,{contentsElement:i.view.element,empty:n,viewProps:t.viewProps})}),this.onPageAdd_=this.onPageAdd_.bind(this),this.onPageRemove_=this.onPageRemove_.bind(this),this.onPageSelectedChange_=this.onPageSelectedChange_.bind(this),this.pageSet_=new ee((()=>null)),this.pageSet_.emitter.on("add",this.onPageAdd_),this.pageSet_.emitter.on("remove",this.onPageRemove_),this.empty_=n,this.applyPages_()}get pageSet(){return this.pageSet_}add(e,t){this.pageSet_.add(e,null!=t?t:this.pageSet_.items.length)}remove(e){this.pageSet_.remove(this.pageSet_.items[e])}applyPages_(){this.keepSelection_(),this.empty_.rawValue=0===this.pageSet_.items.length}onPageAdd_(e){const t=e.item;F(this.view.itemsElement,t.itemController.view.element,e.index),this.rackController.rack.add(t.contentController,e.index),t.props.value("selected").emitter.on("change",this.onPageSelectedChange_),this.applyPages_()}onPageRemove_(e){const t=e.item;N(t.itemController.view.element),this.rackController.rack.remove(t.contentController),t.props.value("selected").emitter.off("change",this.onPageSelectedChange_),this.applyPages_()}keepSelection_(){if(0===this.pageSet_.items.length)return;const e=this.pageSet_.items.findIndex((e=>e.props.get("selected")));e<0?this.pageSet_.items.forEach(((e,t)=>{e.props.set("selected",0===t)})):this.pageSet_.items.forEach(((t,i)=>{t.props.set("selected",i===e)}))}onPageSelectedChange_(e){if(e.rawValue){const t=this.pageSet_.items.findIndex((t=>t.props.value("selected")===e.sender));this.pageSet_.items.forEach(((e,i)=>{e.props.set("selected",i===t)}))}else this.keepSelection_()}}const Ie={id:"tab",type:"blade",accept(e){const t=V,i=T(e,{pages:t.required.array(t.required.object({title:t.required.string})),view:t.required.constant("tab")});return i&&0!==i.pages.length?{params:i}:null},controller(e){const t=new Le(e.document,{blade:e.blade,viewProps:e.viewProps});return e.params.pages.forEach((i=>{const n=new De(e.document,{itemProps:k.fromObject({selected:!1,title:i.title}),props:k.fromObject({selected:!1})});t.add(n)})),t},api:e=>e.controller instanceof Le?new Ae(e.controller,e.pool):null};class Be{constructor(){this.disabled=!1,this.emitter=new h}dispose(){}tick(){this.disabled||this.emitter.emit("tick",{sender:this})}}class Fe{constructor(e,t){this.disabled_=!1,this.timerId_=null,this.onTick_=this.onTick_.bind(this),this.doc_=e,this.emitter=new h,this.interval_=t,this.setTimer_()}get disabled(){return this.disabled_}set disabled(e){this.disabled_=e,this.disabled_?this.clearTimer_():this.setTimer_()}dispose(){this.clearTimer_()}clearTimer_(){if(null===this.timerId_)return;const e=this.doc_.defaultView;e&&e.clearInterval(this.timerId_),this.timerId_=null}setTimer_(){if(this.clearTimer_(),this.interval_<=0)return;const e=this.doc_.defaultView;e&&(this.timerId_=e.setInterval(this.onTick_,this.interval_))}onTick_(){this.disabled_||this.emitter.emit("tick",{sender:this})}}class Ne{constructor(e){this.constraints=e}constrain(e){return this.constraints.reduce(((e,t)=>t.constrain(e)),e)}}function Ue(e,t){if(e instanceof t)return e;if(e instanceof Ne){const i=e.constraints.reduce(((e,i)=>e||(i instanceof t?i:null)),null);if(i)return i}return null}class Ye{constructor(e){this.options=e}constrain(e){const t=this.options;return 0===t.length||t.filter((t=>t.value===e)).length>0?e:t[0].value}}class qe{constructor(e){this.maxValue=e.max,this.minValue=e.min}constrain(e){let t=e;return o(this.minValue)||(t=Math.max(t,this.minValue)),o(this.maxValue)||(t=Math.min(t,this.maxValue)),t}}class Ke{constructor(e){this.step=e}constrain(e){return(e<0?-Math.round(-e/this.step):Math.round(e/this.step))*this.step}}const He=v("lst");class ze{constructor(e,t){this.onValueChange_=this.onValueChange_.bind(this),this.props_=t.props,this.element=e.createElement("div"),this.element.classList.add(He()),t.viewProps.bindClassModifiers(this.element);const i=e.createElement("select");i.classList.add(He("s")),g(this.props_,"options",(t=>{U(i),t.forEach(((t,n)=>{const s=e.createElement("option");s.dataset.index=String(n),s.textContent=t.text,s.value=String(t.value),i.appendChild(s)}))})),t.viewProps.bindDisabled(i),this.element.appendChild(i),this.selectElement=i;const n=e.createElement("div");n.classList.add(He("m")),n.appendChild(B(e,"dropdown")),this.element.appendChild(n),t.value.emitter.on("change",this.onValueChange_),this.value_=t.value,this.update_()}update_(){this.selectElement.value=String(this.value_.rawValue)}onValueChange_(){this.update_()}}class Ge{constructor(e,t){this.onSelectChange_=this.onSelectChange_.bind(this),this.props=t.props,this.value=t.value,this.viewProps=t.viewProps,this.view=new ze(e,{props:this.props,value:this.value,viewProps:this.viewProps}),this.view.selectElement.addEventListener("change",this.onSelectChange_)}onSelectChange_(e){const t=e.currentTarget.selectedOptions.item(0);if(!t)return;const i=Number(t.dataset.index);this.value.rawValue=this.props.get("options")[i].value}}const We=v("pop");class Je{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(We()),t.viewProps.bindClassModifiers(this.element),m(t.shows,f(this.element,We(void 0,"v")))}}class Xe{constructor(e,t){this.shows=P(!1),this.viewProps=t.viewProps,this.view=new Je(e,{shows:this.shows,viewProps:this.viewProps})}}const Qe=v("txt");class Ze{constructor(e,t){this.onChange_=this.onChange_.bind(this),this.element=e.createElement("div"),this.element.classList.add(Qe()),t.viewProps.bindClassModifiers(this.element),this.props_=t.props,this.props_.emitter.on("change",this.onChange_);const i=e.createElement("input");i.classList.add(Qe("i")),i.type="text",t.viewProps.bindDisabled(i),this.element.appendChild(i),this.inputElement=i,t.value.emitter.on("change",this.onChange_),this.value_=t.value,this.refresh()}refresh(){const e=this.props_.get("formatter");this.inputElement.value=e(this.value_.rawValue)}onChange_(){this.refresh()}}class et{constructor(e,t){this.onInputChange_=this.onInputChange_.bind(this),this.parser_=t.parser,this.props=t.props,this.value=t.value,this.viewProps=t.viewProps,this.view=new Ze(e,{props:t.props,value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_)}onInputChange_(e){const t=e.currentTarget.value,i=this.parser_(t);o(i)||(this.value.rawValue=i),this.view.refresh()}}function tt(e){return"false"!==e&&!!e}function it(e){return function(e){return String(e)}(e)}class nt{constructor(e){this.text=e}evaluate(){return Number(this.text)}toString(){return this.text}}const st={"**":(e,t)=>Math.pow(e,t),"*":(e,t)=>e*t,"/":(e,t)=>e/t,"%":(e,t)=>e%t,"+":(e,t)=>e+t,"-":(e,t)=>e-t,"<<":(e,t)=>e<<t,">>":(e,t)=>e>>t,">>>":(e,t)=>e>>>t,"&":(e,t)=>e&t,"^":(e,t)=>e^t,"|":(e,t)=>e|t};class rt{constructor(e,t,i){this.left=t,this.operator=e,this.right=i}evaluate(){const e=st[this.operator];if(!e)throw new Error(`unexpected binary operator: '${this.operator}`);return e(this.left.evaluate(),this.right.evaluate())}toString(){return["b(",this.left.toString(),this.operator,this.right.toString(),")"].join(" ")}}const ot={"+":e=>e,"-":e=>-e,"~":e=>~e};class at{constructor(e,t){this.operator=e,this.expression=t}evaluate(){const e=ot[this.operator];if(!e)throw new Error(`unexpected unary operator: '${this.operator}`);return e(this.expression.evaluate())}toString(){return["u(",this.operator,this.expression.toString(),")"].join(" ")}}function lt(e){return(t,i)=>{for(let n=0;n<e.length;n++){const s=e[n](t,i);if(""!==s)return s}return""}}function ct(e,t){var i;const n=e.substr(t).match(/^\s+/);return null!==(i=n&&n[0])&&void 0!==i?i:""}function dt(e,t){var i;const n=e.substr(t).match(/^[0-9]+/);return null!==(i=n&&n[0])&&void 0!==i?i:""}function pt(e,t){const i=e.substr(t,1);if(t+=1,"e"!==i.toLowerCase())return"";const n=function(e,t){const i=dt(e,t);if(""!==i)return i;const n=e.substr(t,1);if("-"!==n&&"+"!==n)return"";const s=dt(e,t+=1);return""===s?"":n+s}(e,t);return""===n?"":i+n}function ht(e,t){const i=e.substr(t,1);if("0"===i)return i;const n=function(e,t){const i=e.substr(t,1);return i.match(/^[1-9]$/)?i:""}(e,t);return t+=n.length,""===n?"":n+dt(e,t)}const ut=lt([function(e,t){const i=ht(e,t);if(t+=i.length,""===i)return"";const n=e.substr(t,1);if(t+=n.length,"."!==n)return"";const s=dt(e,t);return i+n+s+pt(e,t+=s.length)},function(e,t){const i=e.substr(t,1);if(t+=i.length,"."!==i)return"";const n=dt(e,t);return t+=n.length,""===n?"":i+n+pt(e,t)},function(e,t){const i=ht(e,t);return t+=i.length,""===i?"":i+pt(e,t)}]),vt=lt([function(e,t){const i=e.substr(t,2);if(t+=i.length,"0b"!==i.toLowerCase())return"";const n=function(e,t){var i;const n=e.substr(t).match(/^[01]+/);return null!==(i=n&&n[0])&&void 0!==i?i:""}(e,t);return""===n?"":i+n},function(e,t){const i=e.substr(t,2);if(t+=i.length,"0o"!==i.toLowerCase())return"";const n=function(e,t){var i;const n=e.substr(t).match(/^[0-7]+/);return null!==(i=n&&n[0])&&void 0!==i?i:""}(e,t);return""===n?"":i+n},function(e,t){const i=e.substr(t,2);if(t+=i.length,"0x"!==i.toLowerCase())return"";const n=function(e,t){var i;const n=e.substr(t).match(/^[0-9a-f]+/i);return null!==(i=n&&n[0])&&void 0!==i?i:""}(e,t);return""===n?"":i+n}]),bt=lt([vt,ut]);function mt(e,t){return function(e,t){const i=bt(e,t);return t+=i.length,""===i?null:{evaluable:new nt(i),cursor:t}}(e,t)||function(e,t){const i=e.substr(t,1);if(t+=i.length,"("!==i)return null;const n=_t(e,t);if(!n)return null;t=n.cursor,t+=ct(e,t).length;const s=e.substr(t,1);return t+=s.length,")"!==s?null:{evaluable:n.evaluable,cursor:t}}(e,t)}function gt(e,t,i){i+=ct(t,i).length;const n=e.filter((e=>t.startsWith(e,i)))[0];return n?(i+=n.length,{cursor:i+=ct(t,i).length,operator:n}):null}const ft=[["**"],["*","/","%"],["+","-"],["<<",">>>",">>"],["&"],["^"],["|"]].reduce(((e,t)=>function(e,t){return(i,n)=>{const s=e(i,n);if(!s)return null;n=s.cursor;let r=s.evaluable;for(;;){const s=gt(t,i,n);if(!s)break;n=s.cursor;const o=e(i,n);if(!o)return null;n=o.cursor,r=new rt(s.operator,r,o.evaluable)}return r?{cursor:n,evaluable:r}:null}}(e,t)),(function e(t,i){const n=mt(t,i);if(n)return n;const s=t.substr(i,1);if(i+=s.length,"+"!==s&&"-"!==s&&"~"!==s)return null;const r=e(t,i);return r?{cursor:i=r.cursor,evaluable:new at(s,r.evaluable)}:null}));function _t(e,t){return t+=ct(e,t).length,ft(e,t)}function wt(e){var t;const i=function(e){const t=_t(e,0);return t?t.cursor+ct(e,t.cursor).length!==e.length?null:t.evaluable:null}(e);return null!==(t=null==i?void 0:i.evaluate())&&void 0!==t?t:null}function xt(e){if("number"==typeof e)return e;if("string"==typeof e){const t=wt(e);if(!o(t))return t}return 0}function yt(e){return String(e)}function $t(e){return t=>t.toFixed(Math.max(Math.min(e,20),0))}const Ct=$t(0);function Pt(e){return Ct(e)+"%"}function kt(e){return String(e)}function Et(e){return e}function St(e,t){for(;e.length<t;)e.push(void 0)}function Vt(e){const t=[];return St(t,e),P(t)}function Tt(e){const t=e.indexOf(void 0);return t<0?e:e.slice(0,t)}function Mt({primary:e,secondary:t,forward:i,backward:n}){let s=!1;function r(e){s||(s=!0,e(),s=!1)}e.emitter.on("change",(n=>{r((()=>{t.setRawValue(i(e,t),n.options)}))})),t.emitter.on("change",(s=>{r((()=>{e.setRawValue(n(e,t),s.options)})),r((()=>{t.setRawValue(i(e,t),s.options)}))})),r((()=>{t.setRawValue(i(e,t),{forceEmit:!1,last:!0})}))}function Dt(e,t){const i=e*(t.altKey?.1:1)*(t.shiftKey?10:1);return t.upKey?+i:t.downKey?-i:0}function Ot(e){return{altKey:e.altKey,downKey:"ArrowDown"===e.key,shiftKey:e.shiftKey,upKey:"ArrowUp"===e.key}}function At(e){return{altKey:e.altKey,downKey:"ArrowLeft"===e.key,shiftKey:e.shiftKey,upKey:"ArrowRight"===e.key}}function jt(e){return function(e){return"ArrowUp"===e||"ArrowDown"===e}(e)||"ArrowLeft"===e||"ArrowRight"===e}function Rt(e,t){const i=t.ownerDocument.defaultView,n=t.getBoundingClientRect();return{x:e.pageX-((i&&i.scrollX||0)+n.left),y:e.pageY-((i&&i.scrollY||0)+n.top)}}class Lt{constructor(e){this.lastTouch_=null,this.onDocumentMouseMove_=this.onDocumentMouseMove_.bind(this),this.onDocumentMouseUp_=this.onDocumentMouseUp_.bind(this),this.onMouseDown_=this.onMouseDown_.bind(this),this.onTouchEnd_=this.onTouchEnd_.bind(this),this.onTouchMove_=this.onTouchMove_.bind(this),this.onTouchStart_=this.onTouchStart_.bind(this),this.elem_=e,this.emitter=new h,e.addEventListener("touchstart",this.onTouchStart_,{passive:!1}),e.addEventListener("touchmove",this.onTouchMove_,{passive:!0}),e.addEventListener("touchend",this.onTouchEnd_),e.addEventListener("mousedown",this.onMouseDown_)}computePosition_(e){const t=this.elem_.getBoundingClientRect();return{bounds:{width:t.width,height:t.height},point:e?{x:e.x,y:e.y}:null}}onMouseDown_(e){var t;e.preventDefault(),null===(t=e.currentTarget)||void 0===t||t.focus();const i=this.elem_.ownerDocument;i.addEventListener("mousemove",this.onDocumentMouseMove_),i.addEventListener("mouseup",this.onDocumentMouseUp_),this.emitter.emit("down",{altKey:e.altKey,data:this.computePosition_(Rt(e,this.elem_)),sender:this,shiftKey:e.shiftKey})}onDocumentMouseMove_(e){this.emitter.emit("move",{altKey:e.altKey,data:this.computePosition_(Rt(e,this.elem_)),sender:this,shiftKey:e.shiftKey})}onDocumentMouseUp_(e){const t=this.elem_.ownerDocument;t.removeEventListener("mousemove",this.onDocumentMouseMove_),t.removeEventListener("mouseup",this.onDocumentMouseUp_),this.emitter.emit("up",{altKey:e.altKey,data:this.computePosition_(Rt(e,this.elem_)),sender:this,shiftKey:e.shiftKey})}onTouchStart_(e){e.preventDefault();const t=e.targetTouches.item(0),i=this.elem_.getBoundingClientRect();this.emitter.emit("down",{altKey:e.altKey,data:this.computePosition_(t?{x:t.clientX-i.left,y:t.clientY-i.top}:void 0),sender:this,shiftKey:e.shiftKey}),this.lastTouch_=t}onTouchMove_(e){const t=e.targetTouches.item(0),i=this.elem_.getBoundingClientRect();this.emitter.emit("move",{altKey:e.altKey,data:this.computePosition_(t?{x:t.clientX-i.left,y:t.clientY-i.top}:void 0),sender:this,shiftKey:e.shiftKey}),this.lastTouch_=t}onTouchEnd_(e){var t;const i=null!==(t=e.targetTouches.item(0))&&void 0!==t?t:this.lastTouch_,n=this.elem_.getBoundingClientRect();this.emitter.emit("up",{altKey:e.altKey,data:this.computePosition_(i?{x:i.clientX-n.left,y:i.clientY-n.top}:void 0),sender:this,shiftKey:e.shiftKey})}}function It(e,t,i,n,s){return n+(e-t)/(i-t)*(s-n)}function Bt(e){return String(e.toFixed(10)).split(".")[1].replace(/0+$/,"").length}function Ft(e,t,i){return Math.min(Math.max(e,t),i)}function Nt(e,t){return(e%t+t)%t}const Ut=v("txt");class Yt{constructor(e,t){this.onChange_=this.onChange_.bind(this),this.props_=t.props,this.props_.emitter.on("change",this.onChange_),this.element=e.createElement("div"),this.element.classList.add(Ut(),Ut(void 0,"num")),t.arrayPosition&&this.element.classList.add(Ut(void 0,t.arrayPosition)),t.viewProps.bindClassModifiers(this.element);const i=e.createElement("input");i.classList.add(Ut("i")),i.type="text",t.viewProps.bindDisabled(i),this.element.appendChild(i),this.inputElement=i,this.onDraggingChange_=this.onDraggingChange_.bind(this),this.dragging_=t.dragging,this.dragging_.emitter.on("change",this.onDraggingChange_),this.element.classList.add(Ut()),this.inputElement.classList.add(Ut("i"));const n=e.createElement("div");n.classList.add(Ut("k")),this.element.appendChild(n),this.knobElement=n;const s=e.createElementNS(A,"svg");s.classList.add(Ut("g")),this.knobElement.appendChild(s);const r=e.createElementNS(A,"path");r.classList.add(Ut("gb")),s.appendChild(r),this.guideBodyElem_=r;const o=e.createElementNS(A,"path");o.classList.add(Ut("gh")),s.appendChild(o),this.guideHeadElem_=o;const a=e.createElement("div");a.classList.add(v("tt")()),this.knobElement.appendChild(a),this.tooltipElem_=a,t.value.emitter.on("change",this.onChange_),this.value=t.value,this.refresh()}onDraggingChange_(e){if(null===e.rawValue)return void this.element.classList.remove(Ut(void 0,"drg"));this.element.classList.add(Ut(void 0,"drg"));const t=e.rawValue/this.props_.get("draggingScale"),i=t+(t>0?-1:t<0?1:0),n=Ft(-i,-4,4);this.guideHeadElem_.setAttributeNS(null,"d",[`M ${i+n},0 L${i},4 L${i+n},8`,`M ${t},-1 L${t},9`].join(" ")),this.guideBodyElem_.setAttributeNS(null,"d",`M 0,4 L${t},4`);const s=this.props_.get("formatter");this.tooltipElem_.textContent=s(this.value.rawValue),this.tooltipElem_.style.left=`${t}px`}refresh(){const e=this.props_.get("formatter");this.inputElement.value=e(this.value.rawValue)}onChange_(){this.refresh()}}class qt{constructor(e,t){this.originRawValue_=0,this.onInputChange_=this.onInputChange_.bind(this),this.onInputKeyDown_=this.onInputKeyDown_.bind(this),this.onInputKeyUp_=this.onInputKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.baseStep_=t.baseStep,this.parser_=t.parser,this.props=t.props,this.value=t.value,this.viewProps=t.viewProps,this.dragging_=P(null),this.view=new Yt(e,{arrayPosition:t.arrayPosition,dragging:this.dragging_,props:this.props,value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_),this.view.inputElement.addEventListener("keydown",this.onInputKeyDown_),this.view.inputElement.addEventListener("keyup",this.onInputKeyUp_);const i=new Lt(this.view.knobElement);i.emitter.on("down",this.onPointerDown_),i.emitter.on("move",this.onPointerMove_),i.emitter.on("up",this.onPointerUp_)}onInputChange_(e){const t=e.currentTarget.value,i=this.parser_(t);o(i)||(this.value.rawValue=i),this.view.refresh()}onInputKeyDown_(e){const t=Dt(this.baseStep_,Ot(e));0!==t&&this.value.setRawValue(this.value.rawValue+t,{forceEmit:!1,last:!1})}onInputKeyUp_(e){0!==Dt(this.baseStep_,Ot(e))&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}onPointerDown_(){this.originRawValue_=this.value.rawValue,this.dragging_.rawValue=0}computeDraggingValue_(e){if(!e.point)return null;const t=e.point.x-e.bounds.width/2;return this.originRawValue_+t*this.props.get("draggingScale")}onPointerMove_(e){const t=this.computeDraggingValue_(e.data);null!==t&&(this.value.setRawValue(t,{forceEmit:!1,last:!1}),this.dragging_.rawValue=this.value.rawValue-this.originRawValue_)}onPointerUp_(e){const t=this.computeDraggingValue_(e.data);null!==t&&(this.value.setRawValue(t,{forceEmit:!0,last:!0}),this.dragging_.rawValue=null)}}const Kt=v("sld");class Ht{constructor(e,t){this.onChange_=this.onChange_.bind(this),this.props_=t.props,this.props_.emitter.on("change",this.onChange_),this.element=e.createElement("div"),this.element.classList.add(Kt()),t.viewProps.bindClassModifiers(this.element);const i=e.createElement("div");i.classList.add(Kt("t")),t.viewProps.bindTabIndex(i),this.element.appendChild(i),this.trackElement=i;const n=e.createElement("div");n.classList.add(Kt("k")),this.trackElement.appendChild(n),this.knobElement=n,t.value.emitter.on("change",this.onChange_),this.value=t.value,this.update_()}update_(){const e=Ft(It(this.value.rawValue,this.props_.get("minValue"),this.props_.get("maxValue"),0,100),0,100);this.knobElement.style.width=`${e}%`}onChange_(){this.update_()}}class zt{constructor(e,t){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDownOrMove_=this.onPointerDownOrMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.baseStep_=t.baseStep,this.value=t.value,this.viewProps=t.viewProps,this.props=t.props,this.view=new Ht(e,{props:this.props,value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Lt(this.view.trackElement),this.ptHandler_.emitter.on("down",this.onPointerDownOrMove_),this.ptHandler_.emitter.on("move",this.onPointerDownOrMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.trackElement.addEventListener("keydown",this.onKeyDown_),this.view.trackElement.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(e,t){e.point&&this.value.setRawValue(It(Ft(e.point.x,0,e.bounds.width),0,e.bounds.width,this.props.get("minValue"),this.props.get("maxValue")),t)}onPointerDownOrMove_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerUp_(e){this.handlePointerEvent_(e.data,{forceEmit:!0,last:!0})}onKeyDown_(e){const t=Dt(this.baseStep_,At(e));0!==t&&this.value.setRawValue(this.value.rawValue+t,{forceEmit:!1,last:!1})}onKeyUp_(e){0!==Dt(this.baseStep_,At(e))&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}const Gt=v("sldtxt");class Wt{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(Gt());const i=e.createElement("div");i.classList.add(Gt("s")),this.sliderView_=t.sliderView,i.appendChild(this.sliderView_.element),this.element.appendChild(i);const n=e.createElement("div");n.classList.add(Gt("t")),this.textView_=t.textView,n.appendChild(this.textView_.element),this.element.appendChild(n)}}class Jt{constructor(e,t){this.value=t.value,this.viewProps=t.viewProps,this.sliderC_=new zt(e,{baseStep:t.baseStep,props:t.sliderProps,value:t.value,viewProps:this.viewProps}),this.textC_=new qt(e,{baseStep:t.baseStep,parser:t.parser,props:t.textProps,value:t.value,viewProps:t.viewProps}),this.view=new Wt(e,{sliderView:this.sliderC_.view,textView:this.textC_.view})}get sliderController(){return this.sliderC_}get textController(){return this.textC_}}function Xt(e,t){e.write(t)}function Qt(e){const t=V;return Array.isArray(e)?t.required.array(t.required.object({text:t.required.string,value:t.required.raw}))(e).value:"object"==typeof e?t.required.raw(e).value:void 0}function Zt(e){if("inline"===e||"popup"===e)return e}function ei(e){const t=V;return t.required.object({max:t.optional.number,min:t.optional.number,step:t.optional.number})(e).value}function ti(e){if(Array.isArray(e))return e;const t=[];return Object.keys(e).forEach((i=>{t.push({text:i,value:e[i]})})),t}function ii(e){return o(e)?null:new Ye(ti(e))}function ni(e){const t=e?Ue(e,Ye):null;return t?t.options:null}function si(e,t){const i=e&&Ue(e,Ke);return i?Bt(i.step):Math.max(Bt(t),2)}function ri(e){const t=function(e){const t=e?Ue(e,Ke):null;return t?t.step:null}(e);return null!=t?t:1}function oi(e,t){var i;const n=e&&Ue(e,Ke),s=Math.abs(null!==(i=null==n?void 0:n.step)&&void 0!==i?i:t);return 0===s?.1:Math.pow(10,Math.floor(Math.log10(s))-1)}const ai=v("ckb");class li{constructor(e,t){this.onValueChange_=this.onValueChange_.bind(this),this.element=e.createElement("div"),this.element.classList.add(ai()),t.viewProps.bindClassModifiers(this.element);const i=e.createElement("label");i.classList.add(ai("l")),this.element.appendChild(i);const n=e.createElement("input");n.classList.add(ai("i")),n.type="checkbox",i.appendChild(n),this.inputElement=n,t.viewProps.bindDisabled(this.inputElement);const s=e.createElement("div");s.classList.add(ai("w")),i.appendChild(s);const r=B(e,"check");s.appendChild(r),t.value.emitter.on("change",this.onValueChange_),this.value=t.value,this.update_()}update_(){this.inputElement.checked=this.value.rawValue}onValueChange_(){this.update_()}}class ci{constructor(e,t){this.onInputChange_=this.onInputChange_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.view=new li(e,{value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_)}onInputChange_(e){const t=e.currentTarget;this.value.rawValue=t.checked}}const di={id:"input-bool",type:"input",accept:(e,t)=>{if("boolean"!=typeof e)return null;const i=T(t,{options:V.optional.custom(Qt)});return i?{initialValue:e,params:i}:null},binding:{reader:e=>tt,constraint:e=>function(e){const t=[],i=ii(e.options);return i&&t.push(i),new Ne(t)}(e.params),writer:e=>Xt},controller:e=>{var t;const i=e.document,n=e.value,s=e.constraint;return s&&Ue(s,Ye)?new Ge(i,{props:k.fromObject({options:null!==(t=ni(s))&&void 0!==t?t:[]}),value:n,viewProps:e.viewProps}):new ci(i,{value:n,viewProps:e.viewProps})}},pi=v("col");class hi{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(pi()),t.foldable.bindExpandedClass(this.element,pi(void 0,"expanded")),g(t.foldable,"completed",f(this.element,pi(void 0,"cpl")));const i=e.createElement("div");i.classList.add(pi("h")),this.element.appendChild(i);const n=e.createElement("div");n.classList.add(pi("s")),i.appendChild(n),this.swatchElement=n;const s=e.createElement("div");if(s.classList.add(pi("t")),i.appendChild(s),this.textElement=s,"inline"===t.pickerLayout){const t=e.createElement("div");t.classList.add(pi("p")),this.element.appendChild(t),this.pickerElement=t}else this.pickerElement=null}}function ui(e,t,i){const n=Nt(e,360),s=Ft(t/100,0,1),r=Ft(i/100,0,1),o=r*s,a=o*(1-Math.abs(n/60%2-1)),l=r-o;let c,d,p;return[c,d,p]=n>=0&&n<60?[o,a,0]:n>=60&&n<120?[a,o,0]:n>=120&&n<180?[0,o,a]:n>=180&&n<240?[0,a,o]:n>=240&&n<300?[a,0,o]:[o,0,a],[255*(c+l),255*(d+l),255*(p+l)]}function vi(e){return[e[0],e[1],e[2]]}function bi(e,t){return[e[0],e[1],e[2],t]}const mi={hsl:{hsl:(e,t,i)=>[e,t,i],hsv:function(e,t,i){const n=i+t*(100-Math.abs(2*i-100))/200;return[e,0!==n?t*(100-Math.abs(2*i-100))/n:0,i+t*(100-Math.abs(2*i-100))/200]},rgb:function(e,t,i){const n=(e%360+360)%360,s=Ft(t/100,0,1),r=Ft(i/100,0,1),o=(1-Math.abs(2*r-1))*s,a=o*(1-Math.abs(n/60%2-1)),l=r-o/2;let c,d,p;return[c,d,p]=n>=0&&n<60?[o,a,0]:n>=60&&n<120?[a,o,0]:n>=120&&n<180?[0,o,a]:n>=180&&n<240?[0,a,o]:n>=240&&n<300?[a,0,o]:[o,0,a],[255*(c+l),255*(d+l),255*(p+l)]}},hsv:{hsl:function(e,t,i){const n=100-Math.abs(i*(200-t)/100-100);return[e,0!==n?t*i/n:0,i*(200-t)/200]},hsv:(e,t,i)=>[e,t,i],rgb:ui},rgb:{hsl:function(e,t,i){const n=Ft(e/255,0,1),s=Ft(t/255,0,1),r=Ft(i/255,0,1),o=Math.max(n,s,r),a=Math.min(n,s,r),l=o-a;let c=0,d=0;const p=(a+o)/2;return 0!==l&&(d=l/(1-Math.abs(o+a-1)),c=n===o?(s-r)/l:s===o?2+(r-n)/l:4+(n-s)/l,c=c/6+(c<0?1:0)),[360*c,100*d,100*p]},hsv:function(e,t,i){const n=Ft(e/255,0,1),s=Ft(t/255,0,1),r=Ft(i/255,0,1),o=Math.max(n,s,r),a=o-Math.min(n,s,r);let l;return l=0===a?0:o===n?((s-r)/a%6+6)%6*60:o===s?60*((r-n)/a+2):60*((n-s)/a+4),[l,100*(0===o?0:a/o),100*o]},rgb:(e,t,i)=>[e,t,i]}},gi={hsl:e=>{var t;return[Nt(e[0],360),Ft(e[1],0,100),Ft(e[2],0,100),Ft(null!==(t=e[3])&&void 0!==t?t:1,0,1)]},hsv:e=>{var t;return[Nt(e[0],360),Ft(e[1],0,100),Ft(e[2],0,100),Ft(null!==(t=e[3])&&void 0!==t?t:1,0,1)]},rgb:e=>{var t;return[Ft(e[0],0,255),Ft(e[1],0,255),Ft(e[2],0,255),Ft(null!==(t=e[3])&&void 0!==t?t:1,0,1)]}};function fi(e,t){return"object"==typeof e&&!o(e)&&t in e&&"number"==typeof e[t]}class _i{constructor(e,t){this.mode_=t,this.comps_=gi[t](e)}static black(){return new _i([0,0,0],"rgb")}static fromObject(e){const t="a"in e?[e.r,e.g,e.b,e.a]:[e.r,e.g,e.b];return new _i(t,"rgb")}static toRgbaObject(e){return e.toRgbaObject()}static isRgbColorObject(e){return fi(e,"r")&&fi(e,"g")&&fi(e,"b")}static isRgbaColorObject(e){return this.isRgbColorObject(e)&&fi(e,"a")}static isColorObject(e){return this.isRgbColorObject(e)}static equals(e,t){if(e.mode_!==t.mode_)return!1;const i=e.comps_,n=t.comps_;for(let e=0;e<i.length;e++)if(i[e]!==n[e])return!1;return!0}get mode(){return this.mode_}getComponents(e){var t,i,n;return bi((t=vi(this.comps_),i=this.mode_,n=e||this.mode_,mi[i][n](...t)),this.comps_[3])}toRgbaObject(){const e=this.getComponents("rgb");return{r:e[0],g:e[1],b:e[2],a:e[3]}}}const wi=v("colp");class xi{constructor(e,t){this.alphaViews_=null,this.element=e.createElement("div"),this.element.classList.add(wi());const i=e.createElement("div");i.classList.add(wi("hsv"));const n=e.createElement("div");n.classList.add(wi("sv")),this.svPaletteView_=t.svPaletteView,n.appendChild(this.svPaletteView_.element),i.appendChild(n);const s=e.createElement("div");s.classList.add(wi("h")),this.hPaletteView_=t.hPaletteView,s.appendChild(this.hPaletteView_.element),i.appendChild(s),this.element.appendChild(i);const r=e.createElement("div");if(r.classList.add(wi("rgb")),this.textView_=t.textView,r.appendChild(this.textView_.element),this.element.appendChild(r),t.alphaViews){this.alphaViews_={palette:t.alphaViews.palette,text:t.alphaViews.text};const i=e.createElement("div");i.classList.add(wi("a"));const n=e.createElement("div");n.classList.add(wi("ap")),n.appendChild(this.alphaViews_.palette.element),i.appendChild(n);const s=e.createElement("div");s.classList.add(wi("at")),s.appendChild(this.alphaViews_.text.element),i.appendChild(s),this.element.appendChild(i)}}get allFocusableElements(){const e=[this.svPaletteView_.element,this.hPaletteView_.element,this.textView_.modeSelectElement,...this.textView_.textViews.map((e=>e.inputElement))];return this.alphaViews_&&e.push(this.alphaViews_.palette.element,this.alphaViews_.text.inputElement),e}}function yi(e){const t=V;return T(e,{alpha:t.optional.boolean,expanded:t.optional.boolean,picker:t.optional.custom(Zt)})}function $i(e){return e?.1:1}function Ci(e,t){const i=e.match(/^(.+)%$/);return i?Math.min(.01*parseFloat(i[1])*t,t):Math.min(parseFloat(e),t)}const Pi={deg:e=>e,grad:e=>360*e/400,rad:e=>360*e/(2*Math.PI),turn:e=>360*e};function ki(e){const t=e.match(/^([0-9.]+?)(deg|grad|rad|turn)$/);if(!t)return parseFloat(e);const i=parseFloat(t[1]),n=t[2];return Pi[n](i)}const Ei={"func.rgb":e=>{const t=e.match(/^rgb\(\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!t)return null;const i=[Ci(t[1],255),Ci(t[2],255),Ci(t[3],255)];return isNaN(i[0])||isNaN(i[1])||isNaN(i[2])?null:new _i(i,"rgb")},"func.rgba":e=>{const t=e.match(/^rgba\(\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!t)return null;const i=[Ci(t[1],255),Ci(t[2],255),Ci(t[3],255),Ci(t[4],1)];return isNaN(i[0])||isNaN(i[1])||isNaN(i[2])||isNaN(i[3])?null:new _i(i,"rgb")},"func.hsl":e=>{const t=e.match(/^hsl\(\s*([0-9A-Fa-f.]+(?:deg|grad|rad|turn)?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!t)return null;const i=[ki(t[1]),Ci(t[2],100),Ci(t[3],100)];return isNaN(i[0])||isNaN(i[1])||isNaN(i[2])?null:new _i(i,"hsl")},"func.hsla":e=>{const t=e.match(/^hsla\(\s*([0-9A-Fa-f.]+(?:deg|grad|rad|turn)?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!t)return null;const i=[ki(t[1]),Ci(t[2],100),Ci(t[3],100),Ci(t[4],1)];return isNaN(i[0])||isNaN(i[1])||isNaN(i[2])||isNaN(i[3])?null:new _i(i,"hsl")},"hex.rgb":e=>{const t=e.match(/^#([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])$/);if(t)return new _i([parseInt(t[1]+t[1],16),parseInt(t[2]+t[2],16),parseInt(t[3]+t[3],16)],"rgb");const i=e.match(/^(?:#|0x)([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})$/);return i?new _i([parseInt(i[1],16),parseInt(i[2],16),parseInt(i[3],16)],"rgb"):null},"hex.rgba":e=>{const t=e.match(/^#?([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])$/);if(t)return new _i([parseInt(t[1]+t[1],16),parseInt(t[2]+t[2],16),parseInt(t[3]+t[3],16),It(parseInt(t[4]+t[4],16),0,255,0,1)],"rgb");const i=e.match(/^(?:#|0x)?([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})$/);return i?new _i([parseInt(i[1],16),parseInt(i[2],16),parseInt(i[3],16),It(parseInt(i[4],16),0,255,0,1)],"rgb"):null}};function Si(e){return Object.keys(Ei).reduce(((t,i)=>t||((0,Ei[i])(e)?i:null)),null)}const Vi=e=>{const t=Si(e);return t?Ei[t](e):null};function Ti(e){return"func.hsla"===e||"func.rgba"===e||"hex.rgba"===e}function Mi(e){if("string"==typeof e){const t=Vi(e);if(t)return t}return _i.black()}function Di(e){const t=Ft(Math.floor(e),0,255).toString(16);return 1===t.length?`0${t}`:t}function Oi(e,t="#"){return`${t}${vi(e.getComponents("rgb")).map(Di).join("")}`}function Ai(e,t="#"){const i=e.getComponents("rgb");return`${t}${[i[0],i[1],i[2],255*i[3]].map(Di).join("")}`}function ji(e){const t=$t(0);return`rgb(${vi(e.getComponents("rgb")).map((e=>t(e))).join(", ")})`}function Ri(e){const t=$t(2),i=$t(0);return`rgba(${e.getComponents("rgb").map(((e,n)=>(3===n?t:i)(e))).join(", ")})`}const Li={"func.hsl":function(e){const t=[$t(0),Pt,Pt];return`hsl(${vi(e.getComponents("hsl")).map(((e,i)=>t[i](e))).join(", ")})`},"func.hsla":function(e){const t=[$t(0),Pt,Pt,$t(2)];return`hsla(${e.getComponents("hsl").map(((e,i)=>t[i](e))).join(", ")})`},"func.rgb":ji,"func.rgba":Ri,"hex.rgb":Oi,"hex.rgba":Ai};function Ii(e){return Li[e]}const Bi=v("apl");class Fi{constructor(e,t){this.onValueChange_=this.onValueChange_.bind(this),this.value=t.value,this.value.emitter.on("change",this.onValueChange_),this.element=e.createElement("div"),this.element.classList.add(Bi()),t.viewProps.bindTabIndex(this.element);const i=e.createElement("div");i.classList.add(Bi("b")),this.element.appendChild(i);const n=e.createElement("div");n.classList.add(Bi("c")),i.appendChild(n),this.colorElem_=n;const s=e.createElement("div");s.classList.add(Bi("m")),this.element.appendChild(s),this.markerElem_=s;const r=e.createElement("div");r.classList.add(Bi("p")),this.markerElem_.appendChild(r),this.previewElem_=r,this.update_()}update_(){const e=this.value.rawValue,t=e.getComponents("rgb"),i=new _i([t[0],t[1],t[2],0],"rgb"),n=new _i([t[0],t[1],t[2],255],"rgb"),s=["to right",Ri(i),Ri(n)];this.colorElem_.style.background=`linear-gradient(${s.join(",")})`,this.previewElem_.style.backgroundColor=Ri(e);const r=It(t[3],0,1,0,100);this.markerElem_.style.left=`${r}%`}onValueChange_(){this.update_()}}class Ni{constructor(e,t){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.view=new Fi(e,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Lt(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(e,t){if(!e.point)return;const i=e.point.x/e.bounds.width,n=this.value.rawValue,[s,r,o]=n.getComponents("hsv");this.value.setRawValue(new _i([s,r,o,i],"hsv"),t)}onPointerDown_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerMove_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerUp_(e){this.handlePointerEvent_(e.data,{forceEmit:!0,last:!0})}onKeyDown_(e){const t=Dt($i(!0),At(e));if(0===t)return;const i=this.value.rawValue,[n,s,r,o]=i.getComponents("hsv");this.value.setRawValue(new _i([n,s,r,o+t],"hsv"),{forceEmit:!1,last:!1})}onKeyUp_(e){0!==Dt($i(!0),At(e))&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}const Ui=v("coltxt");class Yi{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(Ui());const i=e.createElement("div");i.classList.add(Ui("m")),this.modeElem_=function(e){const t=e.createElement("select");return t.appendChild([{text:"RGB",value:"rgb"},{text:"HSL",value:"hsl"},{text:"HSV",value:"hsv"}].reduce(((t,i)=>{const n=e.createElement("option");return n.textContent=i.text,n.value=i.value,t.appendChild(n),t}),e.createDocumentFragment())),t}(e),this.modeElem_.classList.add(Ui("ms")),i.appendChild(this.modeSelectElement);const n=e.createElement("div");n.classList.add(Ui("mm")),n.appendChild(B(e,"dropdown")),i.appendChild(n),this.element.appendChild(i);const s=e.createElement("div");s.classList.add(Ui("w")),this.element.appendChild(s),this.textsElem_=s,this.textViews_=t.textViews,this.applyTextViews_(),m(t.colorMode,(e=>{this.modeElem_.value=e}))}get modeSelectElement(){return this.modeElem_}get textViews(){return this.textViews_}set textViews(e){this.textViews_=e,this.applyTextViews_()}applyTextViews_(){U(this.textsElem_);const e=this.element.ownerDocument;this.textViews_.forEach((t=>{const i=e.createElement("div");i.classList.add(Ui("c")),i.appendChild(t.element),this.textsElem_.appendChild(i)}))}}const qi=$t(0),Ki={rgb:()=>new qe({min:0,max:255}),hsl:e=>new qe(0===e?{min:0,max:360}:{min:0,max:100}),hsv:e=>new qe(0===e?{min:0,max:360}:{min:0,max:100})};function Hi(e,t,i){return new qt(e,{arrayPosition:0===i?"fst":2===i?"lst":"mid",baseStep:$i(!1),parser:t.parser,props:k.fromObject({draggingScale:1,formatter:qi}),value:P(0,{constraint:Ki[t.colorMode](i)}),viewProps:t.viewProps})}class zi{constructor(e,t){this.onModeSelectChange_=this.onModeSelectChange_.bind(this),this.parser_=t.parser,this.value=t.value,this.viewProps=t.viewProps,this.colorMode=P(this.value.rawValue.mode),this.ccs_=this.createComponentControllers_(e),this.view=new Yi(e,{colorMode:this.colorMode,textViews:[this.ccs_[0].view,this.ccs_[1].view,this.ccs_[2].view]}),this.view.modeSelectElement.addEventListener("change",this.onModeSelectChange_)}createComponentControllers_(e){const t={colorMode:this.colorMode.rawValue,parser:this.parser_,viewProps:this.viewProps},i=[Hi(e,t,0),Hi(e,t,1),Hi(e,t,2)];return i.forEach(((e,t)=>{Mt({primary:this.value,secondary:e.value,forward:e=>e.rawValue.getComponents(this.colorMode.rawValue)[t],backward:(e,i)=>{const n=this.colorMode.rawValue,s=e.rawValue.getComponents(n);return s[t]=i.rawValue,new _i(bi(vi(s),s[3]),n)}})})),i}onModeSelectChange_(e){const t=e.currentTarget;this.colorMode.rawValue=t.value,this.ccs_=this.createComponentControllers_(this.view.element.ownerDocument),this.view.textViews=[this.ccs_[0].view,this.ccs_[1].view,this.ccs_[2].view]}}const Gi=v("hpl");class Wi{constructor(e,t){this.onValueChange_=this.onValueChange_.bind(this),this.value=t.value,this.value.emitter.on("change",this.onValueChange_),this.element=e.createElement("div"),this.element.classList.add(Gi()),t.viewProps.bindTabIndex(this.element);const i=e.createElement("div");i.classList.add(Gi("c")),this.element.appendChild(i);const n=e.createElement("div");n.classList.add(Gi("m")),this.element.appendChild(n),this.markerElem_=n,this.update_()}update_(){const e=this.value.rawValue,[t]=e.getComponents("hsv");this.markerElem_.style.backgroundColor=ji(new _i([t,100,100],"hsv"));const i=It(t,0,360,0,100);this.markerElem_.style.left=`${i}%`}onValueChange_(){this.update_()}}class Ji{constructor(e,t){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.view=new Wi(e,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Lt(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(e,t){if(!e.point)return;const i=It(e.point.x,0,e.bounds.width,0,360),n=this.value.rawValue,[,s,r,o]=n.getComponents("hsv");this.value.setRawValue(new _i([i,s,r,o],"hsv"),t)}onPointerDown_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerMove_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerUp_(e){this.handlePointerEvent_(e.data,{forceEmit:!0,last:!0})}onKeyDown_(e){const t=Dt($i(!1),At(e));if(0===t)return;const i=this.value.rawValue,[n,s,r,o]=i.getComponents("hsv");this.value.setRawValue(new _i([n+t,s,r,o],"hsv"),{forceEmit:!1,last:!1})}onKeyUp_(e){0!==Dt($i(!1),At(e))&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}const Xi=v("svp");class Qi{constructor(e,t){this.onValueChange_=this.onValueChange_.bind(this),this.value=t.value,this.value.emitter.on("change",this.onValueChange_),this.element=e.createElement("div"),this.element.classList.add(Xi()),t.viewProps.bindTabIndex(this.element);const i=e.createElement("canvas");i.height=64,i.width=64,i.classList.add(Xi("c")),this.element.appendChild(i),this.canvasElement=i;const n=e.createElement("div");n.classList.add(Xi("m")),this.element.appendChild(n),this.markerElem_=n,this.update_()}update_(){const e=function(e){const t=e.ownerDocument.defaultView;return t&&"document"in t?e.getContext("2d"):null}(this.canvasElement);if(!e)return;const t=this.value.rawValue.getComponents("hsv"),i=this.canvasElement.width,n=this.canvasElement.height,s=e.getImageData(0,0,i,n),r=s.data;for(let e=0;e<n;e++)for(let s=0;s<i;s++){const o=It(s,0,i,0,100),a=It(e,0,n,100,0),l=ui(t[0],o,a),c=4*(e*i+s);r[c]=l[0],r[c+1]=l[1],r[c+2]=l[2],r[c+3]=255}e.putImageData(s,0,0);const o=It(t[1],0,100,0,100);this.markerElem_.style.left=`${o}%`;const a=It(t[2],0,100,100,0);this.markerElem_.style.top=`${a}%`}onValueChange_(){this.update_()}}class Zi{constructor(e,t){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.view=new Qi(e,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Lt(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(e,t){if(!e.point)return;const i=It(e.point.x,0,e.bounds.width,0,100),n=It(e.point.y,0,e.bounds.height,100,0),[s,,,r]=this.value.rawValue.getComponents("hsv");this.value.setRawValue(new _i([s,i,n,r],"hsv"),t)}onPointerDown_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerMove_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerUp_(e){this.handlePointerEvent_(e.data,{forceEmit:!0,last:!0})}onKeyDown_(e){jt(e.key)&&e.preventDefault();const[t,i,n,s]=this.value.rawValue.getComponents("hsv"),r=$i(!1),o=Dt(r,At(e)),a=Dt(r,Ot(e));0===o&&0===a||this.value.setRawValue(new _i([t,i+o,n+a,s],"hsv"),{forceEmit:!1,last:!1})}onKeyUp_(e){const t=$i(!1),i=Dt(t,At(e)),n=Dt(t,Ot(e));0===i&&0===n||this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}class en{constructor(e,t){this.value=t.value,this.viewProps=t.viewProps,this.hPaletteC_=new Ji(e,{value:this.value,viewProps:this.viewProps}),this.svPaletteC_=new Zi(e,{value:this.value,viewProps:this.viewProps}),this.alphaIcs_=t.supportsAlpha?{palette:new Ni(e,{value:this.value,viewProps:this.viewProps}),text:new qt(e,{parser:wt,baseStep:.1,props:k.fromObject({draggingScale:.01,formatter:$t(2)}),value:P(0,{constraint:new qe({min:0,max:1})}),viewProps:this.viewProps})}:null,this.alphaIcs_&&Mt({primary:this.value,secondary:this.alphaIcs_.text.value,forward:e=>e.rawValue.getComponents()[3],backward:(e,t)=>{const i=e.rawValue.getComponents();return i[3]=t.rawValue,new _i(i,e.rawValue.mode)}}),this.textC_=new zi(e,{parser:wt,value:this.value,viewProps:this.viewProps}),this.view=new xi(e,{alphaViews:this.alphaIcs_?{palette:this.alphaIcs_.palette.view,text:this.alphaIcs_.text.view}:null,hPaletteView:this.hPaletteC_.view,supportsAlpha:t.supportsAlpha,svPaletteView:this.svPaletteC_.view,textView:this.textC_.view})}get textController(){return this.textC_}}const tn=v("colsw");class nn{constructor(e,t){this.onValueChange_=this.onValueChange_.bind(this),t.value.emitter.on("change",this.onValueChange_),this.value=t.value,this.element=e.createElement("div"),this.element.classList.add(tn()),t.viewProps.bindClassModifiers(this.element);const i=e.createElement("div");i.classList.add(tn("sw")),this.element.appendChild(i),this.swatchElem_=i;const n=e.createElement("button");n.classList.add(tn("b")),t.viewProps.bindDisabled(n),this.element.appendChild(n),this.buttonElement=n,this.update_()}update_(){const e=this.value.rawValue;this.swatchElem_.style.backgroundColor=Ai(e)}onValueChange_(){this.update_()}}class sn{constructor(e,t){this.value=t.value,this.viewProps=t.viewProps,this.view=new nn(e,{value:this.value,viewProps:this.viewProps})}}class rn{constructor(e,t){this.onButtonBlur_=this.onButtonBlur_.bind(this),this.onButtonClick_=this.onButtonClick_.bind(this),this.onPopupChildBlur_=this.onPopupChildBlur_.bind(this),this.onPopupChildKeydown_=this.onPopupChildKeydown_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.foldable_=J.create(t.expanded),this.swatchC_=new sn(e,{value:this.value,viewProps:this.viewProps});const i=this.swatchC_.view.buttonElement;i.addEventListener("blur",this.onButtonBlur_),i.addEventListener("click",this.onButtonClick_),this.textC_=new et(e,{parser:t.parser,props:k.fromObject({formatter:t.formatter}),value:this.value,viewProps:this.viewProps}),this.view=new hi(e,{foldable:this.foldable_,pickerLayout:t.pickerLayout}),this.view.swatchElement.appendChild(this.swatchC_.view.element),this.view.textElement.appendChild(this.textC_.view.element),this.popC_="popup"===t.pickerLayout?new Xe(e,{viewProps:this.viewProps}):null;const n=new en(e,{supportsAlpha:t.supportsAlpha,value:this.value,viewProps:this.viewProps});n.view.allFocusableElements.forEach((e=>{e.addEventListener("blur",this.onPopupChildBlur_),e.addEventListener("keydown",this.onPopupChildKeydown_)})),this.pickerC_=n,this.popC_?(this.view.element.appendChild(this.popC_.view.element),this.popC_.view.element.appendChild(n.view.element),Mt({primary:this.foldable_.value("expanded"),secondary:this.popC_.shows,forward:e=>e.rawValue,backward:(e,t)=>t.rawValue})):this.view.pickerElement&&(this.view.pickerElement.appendChild(this.pickerC_.view.element),Q(this.foldable_,this.view.pickerElement))}get textController(){return this.textC_}onButtonBlur_(e){if(!this.popC_)return;const t=this.view.element,i=e.relatedTarget;i&&t.contains(i)||(this.popC_.shows.rawValue=!1)}onButtonClick_(){this.foldable_.set("expanded",!this.foldable_.get("expanded")),this.foldable_.get("expanded")&&this.pickerC_.view.allFocusableElements[0].focus()}onPopupChildBlur_(e){if(!this.popC_)return;const t=this.popC_.view.element,i=Y(e);i&&t.contains(i)||i&&i===this.swatchC_.view.buttonElement&&!R(t.ownerDocument)||(this.popC_.shows.rawValue=!1)}onPopupChildKeydown_(e){this.popC_?"Escape"===e.key&&(this.popC_.shows.rawValue=!1):this.view.pickerElement&&"Escape"===e.key&&this.swatchC_.view.buttonElement.focus()}}function on(e){return _i.isColorObject(e)?_i.fromObject(e):_i.black()}function an(e){return vi(e.getComponents("rgb")).reduce(((e,t)=>e<<8|255&Math.floor(t)),0)}function ln(e){return e.getComponents("rgb").reduce(((e,t,i)=>e<<8|255&Math.floor(3===i?255*t:t)),0)>>>0}function cn(e){var t;return"number"!=typeof e?_i.black():new _i([(t=e)>>16&255,t>>8&255,255&t],"rgb")}function dn(e){var t;return"number"!=typeof e?_i.black():new _i([(t=e)>>24&255,t>>16&255,t>>8&255,It(255&t,0,255,0,1)],"rgb")}function pn(e,t){const i=t.toRgbaObject();e.writeProperty("r",i.r),e.writeProperty("g",i.g),e.writeProperty("b",i.b),e.writeProperty("a",i.a)}function hn(e,t){const i=t.toRgbaObject();e.writeProperty("r",i.r),e.writeProperty("g",i.g),e.writeProperty("b",i.b)}function un(e){return"alpha"in e&&!0===e.alpha}function vn(e){return e?e=>Ai(e,"0x"):e=>Oi(e,"0x")}const bn={id:"input-color-number",type:"input",accept:(e,t)=>{if("number"!=typeof e)return null;if(!("view"in t))return null;if("color"!==t.view)return null;const i=yi(t);return i?{initialValue:e,params:i}:null},binding:{reader:e=>un(e.params)?dn:cn,equals:_i.equals,writer:e=>function(e){const t=e?ln:an;return(e,i)=>{Xt(e,t(i))}}(un(e.params))},controller:e=>{const t=un(e.params),i="expanded"in e.params?e.params.expanded:void 0,n="picker"in e.params?e.params.picker:void 0;return new rn(e.document,{expanded:null!=i&&i,formatter:vn(t),parser:Vi,pickerLayout:null!=n?n:"popup",supportsAlpha:t,value:e.value,viewProps:e.viewProps})}},mn={id:"input-color-object",type:"input",accept:(e,t)=>{if(!_i.isColorObject(e))return null;const i=yi(t);return i?{initialValue:e,params:i}:null},binding:{reader:e=>on,equals:_i.equals,writer:e=>{var t;return t=e.initialValue,_i.isRgbaColorObject(t)?pn:hn}},controller:e=>{const t=_i.isRgbaColorObject(e.initialValue),i="expanded"in e.params?e.params.expanded:void 0,n="picker"in e.params?e.params.picker:void 0,s=t?Ai:Oi;return new rn(e.document,{expanded:null!=i&&i,formatter:s,parser:Vi,pickerLayout:null!=n?n:"popup",supportsAlpha:t,value:e.value,viewProps:e.viewProps})}},gn={id:"input-color-string",type:"input",accept:(e,t)=>{if("string"!=typeof e)return null;if("view"in t&&"text"===t.view)return null;if(!Si(e))return null;const i=yi(t);return i?{initialValue:e,params:i}:null},binding:{reader:e=>Mi,equals:_i.equals,writer:e=>{const t=Si(e.initialValue);if(!t)throw c.shouldNeverHappen();return function(e){const t=Ii(e);return(e,i)=>{Xt(e,t(i))}}(t)}},controller:e=>{const t=Si(e.initialValue);if(!t)throw c.shouldNeverHappen();const i=Ii(t),n="expanded"in e.params?e.params.expanded:void 0,s="picker"in e.params?e.params.picker:void 0;return new rn(e.document,{expanded:null!=n&&n,formatter:i,parser:Vi,pickerLayout:null!=s?s:"popup",supportsAlpha:Ti(t),value:e.value,viewProps:e.viewProps})}};class fn{constructor(e){this.components=e.components,this.asm_=e.assembly}constrain(e){const t=this.asm_.toComponents(e).map(((e,t)=>{var i,n;return null!==(n=null===(i=this.components[t])||void 0===i?void 0:i.constrain(e))&&void 0!==n?n:e}));return this.asm_.fromComponents(t)}}const _n=v("pndtxt");class wn{constructor(e,t){this.textViews=t.textViews,this.element=e.createElement("div"),this.element.classList.add(_n()),this.textViews.forEach((t=>{const i=e.createElement("div");i.classList.add(_n("a")),i.appendChild(t.element),this.element.appendChild(i)}))}}class xn{constructor(e,t){this.value=t.value,this.viewProps=t.viewProps,this.acs_=t.axes.map(((i,n)=>function(e,t,i){return new qt(e,{arrayPosition:0===i?"fst":i===t.axes.length-1?"lst":"mid",baseStep:t.axes[i].baseStep,parser:t.parser,props:t.axes[i].textProps,value:P(0,{constraint:t.axes[i].constraint}),viewProps:t.viewProps})}(e,t,n))),this.acs_.forEach(((e,i)=>{Mt({primary:this.value,secondary:e.value,forward:e=>t.assembly.toComponents(e.rawValue)[i],backward:(e,n)=>{const s=t.assembly.toComponents(e.rawValue);return s[i]=n.rawValue,t.assembly.fromComponents(s)}})})),this.view=new wn(e,{textViews:this.acs_.map((e=>e.view))})}}function yn(e){const t=[],i=function(e){return"step"in e&&!o(e.step)?new Ke(e.step):null}(e);i&&t.push(i);const n=function(e){return"max"in e&&!o(e.max)||"min"in e&&!o(e.min)?new qe({max:e.max,min:e.min}):null}(e);n&&t.push(n);const s=ii(e.options);return s&&t.push(s),new Ne(t)}function $n(e){const[t,i]=function(e){const t=e?Ue(e,qe):null;return t?[t.minValue,t.maxValue]:[void 0,void 0]}(e);return[null!=t?t:0,null!=i?i:100]}const Cn={id:"input-number",type:"input",accept:(e,t)=>{if("number"!=typeof e)return null;const i=V,n=T(t,{format:i.optional.function,max:i.optional.number,min:i.optional.number,options:i.optional.custom(Qt),step:i.optional.number});return n?{initialValue:e,params:n}:null},binding:{reader:e=>xt,constraint:e=>yn(e.params),writer:e=>Xt},controller:e=>{var t,i;const n=e.value,s=e.constraint;if(s&&Ue(s,Ye))return new Ge(e.document,{props:k.fromObject({options:null!==(t=ni(s))&&void 0!==t?t:[]}),value:n,viewProps:e.viewProps});const r=null!==(i="format"in e.params?e.params.format:void 0)&&void 0!==i?i:$t(si(s,n.rawValue));if(s&&Ue(s,qe)){const[t,i]=$n(s);return new Jt(e.document,{baseStep:ri(s),parser:wt,sliderProps:k.fromObject({maxValue:i,minValue:t}),textProps:k.fromObject({draggingScale:oi(s,n.rawValue),formatter:r}),value:n,viewProps:e.viewProps})}return new qt(e.document,{baseStep:ri(s),parser:wt,props:k.fromObject({draggingScale:oi(s,n.rawValue),formatter:r}),value:n,viewProps:e.viewProps})}};class Pn{constructor(e=0,t=0){this.x=e,this.y=t}getComponents(){return[this.x,this.y]}static isObject(e){if(o(e))return!1;const t=e.x,i=e.y;return"number"==typeof t&&"number"==typeof i}static equals(e,t){return e.x===t.x&&e.y===t.y}toObject(){return{x:this.x,y:this.y}}}const kn={toComponents:e=>e.getComponents(),fromComponents:e=>new Pn(...e)},En=v("p2d");class Sn{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(En()),t.viewProps.bindClassModifiers(this.element),m(t.expanded,f(this.element,En(void 0,"expanded")));const i=e.createElement("div");i.classList.add(En("h")),this.element.appendChild(i);const n=e.createElement("button");n.classList.add(En("b")),n.appendChild(B(e,"p2dpad")),t.viewProps.bindDisabled(n),i.appendChild(n),this.buttonElement=n;const s=e.createElement("div");if(s.classList.add(En("t")),i.appendChild(s),this.textElement=s,"inline"===t.pickerLayout){const t=e.createElement("div");t.classList.add(En("p")),this.element.appendChild(t),this.pickerElement=t}else this.pickerElement=null}}const Vn=v("p2dp");class Tn{constructor(e,t){this.onFoldableChange_=this.onFoldableChange_.bind(this),this.onValueChange_=this.onValueChange_.bind(this),this.invertsY_=t.invertsY,this.maxValue_=t.maxValue,this.element=e.createElement("div"),this.element.classList.add(Vn()),"popup"===t.layout&&this.element.classList.add(Vn(void 0,"p"));const i=e.createElement("div");i.classList.add(Vn("p")),t.viewProps.bindTabIndex(i),this.element.appendChild(i),this.padElement=i;const n=e.createElementNS(A,"svg");n.classList.add(Vn("g")),this.padElement.appendChild(n),this.svgElem_=n;const s=e.createElementNS(A,"line");s.classList.add(Vn("ax")),s.setAttributeNS(null,"x1","0"),s.setAttributeNS(null,"y1","50%"),s.setAttributeNS(null,"x2","100%"),s.setAttributeNS(null,"y2","50%"),this.svgElem_.appendChild(s);const r=e.createElementNS(A,"line");r.classList.add(Vn("ax")),r.setAttributeNS(null,"x1","50%"),r.setAttributeNS(null,"y1","0"),r.setAttributeNS(null,"x2","50%"),r.setAttributeNS(null,"y2","100%"),this.svgElem_.appendChild(r);const o=e.createElementNS(A,"line");o.classList.add(Vn("l")),o.setAttributeNS(null,"x1","50%"),o.setAttributeNS(null,"y1","50%"),this.svgElem_.appendChild(o),this.lineElem_=o;const a=e.createElement("div");a.classList.add(Vn("m")),this.padElement.appendChild(a),this.markerElem_=a,t.value.emitter.on("change",this.onValueChange_),this.value=t.value,this.update_()}get allFocusableElements(){return[this.padElement]}update_(){const[e,t]=this.value.rawValue.getComponents(),i=this.maxValue_,n=It(e,-i,+i,0,100),s=It(t,-i,+i,0,100),r=this.invertsY_?100-s:s;this.lineElem_.setAttributeNS(null,"x2",`${n}%`),this.lineElem_.setAttributeNS(null,"y2",`${r}%`),this.markerElem_.style.left=`${n}%`,this.markerElem_.style.top=`${r}%`}onValueChange_(){this.update_()}onFoldableChange_(){this.update_()}}function Mn(e,t,i){return[Dt(t[0],At(e)),Dt(t[1],Ot(e))*(i?1:-1)]}class Dn{constructor(e,t){this.onPadKeyDown_=this.onPadKeyDown_.bind(this),this.onPadKeyUp_=this.onPadKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.baseSteps_=t.baseSteps,this.maxValue_=t.maxValue,this.invertsY_=t.invertsY,this.view=new Tn(e,{invertsY:this.invertsY_,layout:t.layout,maxValue:this.maxValue_,value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Lt(this.view.padElement),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.padElement.addEventListener("keydown",this.onPadKeyDown_),this.view.padElement.addEventListener("keyup",this.onPadKeyUp_)}handlePointerEvent_(e,t){if(!e.point)return;const i=this.maxValue_,n=It(e.point.x,0,e.bounds.width,-i,+i),s=It(this.invertsY_?e.bounds.height-e.point.y:e.point.y,0,e.bounds.height,-i,+i);this.value.setRawValue(new Pn(n,s),t)}onPointerDown_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerMove_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerUp_(e){this.handlePointerEvent_(e.data,{forceEmit:!0,last:!0})}onPadKeyDown_(e){jt(e.key)&&e.preventDefault();const[t,i]=Mn(e,this.baseSteps_,this.invertsY_);0===t&&0===i||this.value.setRawValue(new Pn(this.value.rawValue.x+t,this.value.rawValue.y+i),{forceEmit:!1,last:!1})}onPadKeyUp_(e){const[t,i]=Mn(e,this.baseSteps_,this.invertsY_);0===t&&0===i||this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}class On{constructor(e,t){var i,n;this.onPopupChildBlur_=this.onPopupChildBlur_.bind(this),this.onPopupChildKeydown_=this.onPopupChildKeydown_.bind(this),this.onPadButtonBlur_=this.onPadButtonBlur_.bind(this),this.onPadButtonClick_=this.onPadButtonClick_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.foldable_=J.create(t.expanded),this.popC_="popup"===t.pickerLayout?new Xe(e,{viewProps:this.viewProps}):null;const s=new Dn(e,{baseSteps:[t.axes[0].baseStep,t.axes[1].baseStep],invertsY:t.invertsY,layout:t.pickerLayout,maxValue:t.maxValue,value:this.value,viewProps:this.viewProps});s.view.allFocusableElements.forEach((e=>{e.addEventListener("blur",this.onPopupChildBlur_),e.addEventListener("keydown",this.onPopupChildKeydown_)})),this.pickerC_=s,this.textC_=new xn(e,{assembly:kn,axes:t.axes,parser:t.parser,value:this.value,viewProps:this.viewProps}),this.view=new Sn(e,{expanded:this.foldable_.value("expanded"),pickerLayout:t.pickerLayout,viewProps:this.viewProps}),this.view.textElement.appendChild(this.textC_.view.element),null===(i=this.view.buttonElement)||void 0===i||i.addEventListener("blur",this.onPadButtonBlur_),null===(n=this.view.buttonElement)||void 0===n||n.addEventListener("click",this.onPadButtonClick_),this.popC_?(this.view.element.appendChild(this.popC_.view.element),this.popC_.view.element.appendChild(this.pickerC_.view.element),Mt({primary:this.foldable_.value("expanded"),secondary:this.popC_.shows,forward:e=>e.rawValue,backward:(e,t)=>t.rawValue})):this.view.pickerElement&&(this.view.pickerElement.appendChild(this.pickerC_.view.element),Q(this.foldable_,this.view.pickerElement))}onPadButtonBlur_(e){if(!this.popC_)return;const t=this.view.element,i=e.relatedTarget;i&&t.contains(i)||(this.popC_.shows.rawValue=!1)}onPadButtonClick_(){this.foldable_.set("expanded",!this.foldable_.get("expanded")),this.foldable_.get("expanded")&&this.pickerC_.view.allFocusableElements[0].focus()}onPopupChildBlur_(e){if(!this.popC_)return;const t=this.popC_.view.element,i=Y(e);i&&t.contains(i)||i&&i===this.view.buttonElement&&!R(t.ownerDocument)||(this.popC_.shows.rawValue=!1)}onPopupChildKeydown_(e){this.popC_?"Escape"===e.key&&(this.popC_.shows.rawValue=!1):this.view.pickerElement&&"Escape"===e.key&&this.view.buttonElement.focus()}}function An(e){return Pn.isObject(e)?new Pn(e.x,e.y):new Pn}function jn(e,t){e.writeProperty("x",t.x),e.writeProperty("y",t.y)}function Rn(e){if(!e)return;const t=[];return o(e.step)||t.push(new Ke(e.step)),o(e.max)&&o(e.min)||t.push(new qe({max:e.max,min:e.min})),new Ne(t)}function Ln(e,t){const i=e&&Ue(e,qe);if(i)return Math.max(Math.abs(i.minValue||0),Math.abs(i.maxValue||0));const n=ri(e);return Math.max(10*Math.abs(n),10*Math.abs(t))}function In(e,t){const i=t instanceof fn?t.components[0]:void 0,n=t instanceof fn?t.components[1]:void 0,s=Ln(i,e.x),r=Ln(n,e.y);return Math.max(s,r)}function Bn(e,t){return{baseStep:ri(t),constraint:t,textProps:k.fromObject({draggingScale:oi(t,e),formatter:$t(si(t,e))})}}function Fn(e){if(!("y"in e))return!1;const t=e.y;return!!t&&"inverted"in t&&!!t.inverted}const Nn={id:"input-point2d",type:"input",accept:(e,t)=>{if(!Pn.isObject(e))return null;const i=V,n=T(t,{expanded:i.optional.boolean,picker:i.optional.custom(Zt),x:i.optional.custom(ei),y:i.optional.object({inverted:i.optional.boolean,max:i.optional.number,min:i.optional.number,step:i.optional.number})});return n?{initialValue:e,params:n}:null},binding:{reader:e=>An,constraint:e=>{var t;return t=e.params,new fn({assembly:kn,components:[Rn("x"in t?t.x:void 0),Rn("y"in t?t.y:void 0)]})},equals:Pn.equals,writer:e=>jn},controller:e=>{const t=e.document,i=e.value,n=e.constraint;if(!(n instanceof fn))throw c.shouldNeverHappen();const s="expanded"in e.params?e.params.expanded:void 0,r="picker"in e.params?e.params.picker:void 0;return new On(t,{axes:[Bn(i.rawValue.x,n.components[0]),Bn(i.rawValue.y,n.components[1])],expanded:null!=s&&s,invertsY:Fn(e.params),maxValue:In(i.rawValue,n),parser:wt,pickerLayout:null!=r?r:"popup",value:i,viewProps:e.viewProps})}};class Un{constructor(e=0,t=0,i=0){this.x=e,this.y=t,this.z=i}getComponents(){return[this.x,this.y,this.z]}static isObject(e){if(o(e))return!1;const t=e.x,i=e.y,n=e.z;return"number"==typeof t&&"number"==typeof i&&"number"==typeof n}static equals(e,t){return e.x===t.x&&e.y===t.y&&e.z===t.z}toObject(){return{x:this.x,y:this.y,z:this.z}}}const Yn={toComponents:e=>e.getComponents(),fromComponents:e=>new Un(...e)};function qn(e){return Un.isObject(e)?new Un(e.x,e.y,e.z):new Un}function Kn(e,t){e.writeProperty("x",t.x),e.writeProperty("y",t.y),e.writeProperty("z",t.z)}function Hn(e){if(!e)return;const t=[];return o(e.step)||t.push(new Ke(e.step)),o(e.max)&&o(e.min)||t.push(new qe({max:e.max,min:e.min})),new Ne(t)}function zn(e,t){return{baseStep:ri(t),constraint:t,textProps:k.fromObject({draggingScale:oi(t,e),formatter:$t(si(t,e))})}}const Gn={id:"input-point3d",type:"input",accept:(e,t)=>{if(!Un.isObject(e))return null;const i=V,n=T(t,{x:i.optional.custom(ei),y:i.optional.custom(ei),z:i.optional.custom(ei)});return n?{initialValue:e,params:n}:null},binding:{reader:e=>qn,constraint:e=>{var t;return t=e.params,new fn({assembly:Yn,components:[Hn("x"in t?t.x:void 0),Hn("y"in t?t.y:void 0),Hn("z"in t?t.z:void 0)]})},equals:Un.equals,writer:e=>Kn},controller:e=>{const t=e.value,i=e.constraint;if(!(i instanceof fn))throw c.shouldNeverHappen();return new xn(e.document,{assembly:Yn,axes:[zn(t.rawValue.x,i.components[0]),zn(t.rawValue.y,i.components[1]),zn(t.rawValue.z,i.components[2])],parser:wt,value:t,viewProps:e.viewProps})}};class Wn{constructor(e=0,t=0,i=0,n=0){this.x=e,this.y=t,this.z=i,this.w=n}getComponents(){return[this.x,this.y,this.z,this.w]}static isObject(e){if(o(e))return!1;const t=e.x,i=e.y,n=e.z,s=e.w;return"number"==typeof t&&"number"==typeof i&&"number"==typeof n&&"number"==typeof s}static equals(e,t){return e.x===t.x&&e.y===t.y&&e.z===t.z&&e.w===t.w}toObject(){return{x:this.x,y:this.y,z:this.z,w:this.w}}}const Jn={toComponents:e=>e.getComponents(),fromComponents:e=>new Wn(...e)};function Xn(e){return Wn.isObject(e)?new Wn(e.x,e.y,e.z,e.w):new Wn}function Qn(e,t){e.writeProperty("x",t.x),e.writeProperty("y",t.y),e.writeProperty("z",t.z),e.writeProperty("w",t.w)}function Zn(e){if(!e)return;const t=[];return o(e.step)||t.push(new Ke(e.step)),o(e.max)&&o(e.min)||t.push(new qe({max:e.max,min:e.min})),new Ne(t)}const es={id:"input-point4d",type:"input",accept:(e,t)=>{if(!Wn.isObject(e))return null;const i=V,n=T(t,{x:i.optional.custom(ei),y:i.optional.custom(ei),z:i.optional.custom(ei),w:i.optional.custom(ei)});return n?{initialValue:e,params:n}:null},binding:{reader:e=>Xn,constraint:e=>{var t;return t=e.params,new fn({assembly:Jn,components:[Zn("x"in t?t.x:void 0),Zn("y"in t?t.y:void 0),Zn("z"in t?t.z:void 0),Zn("w"in t?t.w:void 0)]})},equals:Wn.equals,writer:e=>Qn},controller:e=>{const t=e.value,i=e.constraint;if(!(i instanceof fn))throw c.shouldNeverHappen();return new xn(e.document,{assembly:Jn,axes:t.rawValue.getComponents().map(((e,t)=>{var n,s;return n=e,{baseStep:ri(s=i.components[t]),constraint:s,textProps:k.fromObject({draggingScale:oi(s,n),formatter:$t(si(s,n))})}})),parser:wt,value:t,viewProps:e.viewProps})}},ts={id:"input-string",type:"input",accept:(e,t)=>{if("string"!=typeof e)return null;const i=T(t,{options:V.optional.custom(Qt)});return i?{initialValue:e,params:i}:null},binding:{reader:e=>kt,constraint:e=>function(e){const t=[],i=ii(e.options);return i&&t.push(i),new Ne(t)}(e.params),writer:e=>Xt},controller:e=>{var t;const i=e.document,n=e.value,s=e.constraint;return s&&Ue(s,Ye)?new Ge(i,{props:k.fromObject({options:null!==(t=ni(s))&&void 0!==t?t:[]}),value:n,viewProps:e.viewProps}):new et(i,{parser:e=>e,props:k.fromObject({formatter:Et}),value:n,viewProps:e.viewProps})}},is={defaultInterval:200,defaultLineCount:3},ns=v("mll");class ss{constructor(e,t){this.onValueUpdate_=this.onValueUpdate_.bind(this),this.formatter_=t.formatter,this.element=e.createElement("div"),this.element.classList.add(ns()),t.viewProps.bindClassModifiers(this.element);const i=e.createElement("textarea");i.classList.add(ns("i")),i.style.height=`calc(var(--bld-us) * ${t.lineCount})`,i.readOnly=!0,t.viewProps.bindDisabled(i),this.element.appendChild(i),this.textareaElem_=i,t.value.emitter.on("change",this.onValueUpdate_),this.value=t.value,this.update_()}update_(){const e=this.textareaElem_,t=e.scrollTop===e.scrollHeight-e.clientHeight,i=[];this.value.rawValue.forEach((e=>{void 0!==e&&i.push(this.formatter_(e))})),e.textContent=i.join("\n"),t&&(e.scrollTop=e.scrollHeight)}onValueUpdate_(){this.update_()}}class rs{constructor(e,t){this.value=t.value,this.viewProps=t.viewProps,this.view=new ss(e,{formatter:t.formatter,lineCount:t.lineCount,value:this.value,viewProps:this.viewProps})}}const os=v("sgl");class as{constructor(e,t){this.onValueUpdate_=this.onValueUpdate_.bind(this),this.formatter_=t.formatter,this.element=e.createElement("div"),this.element.classList.add(os()),t.viewProps.bindClassModifiers(this.element);const i=e.createElement("input");i.classList.add(os("i")),i.readOnly=!0,i.type="text",t.viewProps.bindDisabled(i),this.element.appendChild(i),this.inputElement=i,t.value.emitter.on("change",this.onValueUpdate_),this.value=t.value,this.update_()}update_(){const e=this.value.rawValue,t=e[e.length-1];this.inputElement.value=void 0!==t?this.formatter_(t):""}onValueUpdate_(){this.update_()}}class ls{constructor(e,t){this.value=t.value,this.viewProps=t.viewProps,this.view=new as(e,{formatter:t.formatter,value:this.value,viewProps:this.viewProps})}}const cs={id:"monitor-bool",type:"monitor",accept:(e,t)=>{if("boolean"!=typeof e)return null;const i=T(t,{lineCount:V.optional.number});return i?{initialValue:e,params:i}:null},binding:{reader:e=>tt},controller:e=>{var t;return 1===e.value.rawValue.length?new ls(e.document,{formatter:it,value:e.value,viewProps:e.viewProps}):new rs(e.document,{formatter:it,lineCount:null!==(t=e.params.lineCount)&&void 0!==t?t:is.defaultLineCount,value:e.value,viewProps:e.viewProps})}};class ds{constructor(){this.emitter=new h,this.index_=-1}get index(){return this.index_}set index(e){this.index_!==e&&(this.index_=e,this.emitter.emit("change",{index:e,sender:this}))}}const ps=v("grl");class hs{constructor(e,t){this.onCursorChange_=this.onCursorChange_.bind(this),this.onValueUpdate_=this.onValueUpdate_.bind(this),this.element=e.createElement("div"),this.element.classList.add(ps()),t.viewProps.bindClassModifiers(this.element),this.formatter_=t.formatter,this.minValue_=t.minValue,this.maxValue_=t.maxValue,this.cursor_=t.cursor,this.cursor_.emitter.on("change",this.onCursorChange_);const i=e.createElementNS(A,"svg");i.classList.add(ps("g")),i.style.height=`calc(var(--bld-us) * ${t.lineCount})`,this.element.appendChild(i),this.svgElem_=i;const n=e.createElementNS(A,"polyline");this.svgElem_.appendChild(n),this.lineElem_=n;const s=e.createElement("div");s.classList.add(ps("t"),v("tt")()),this.element.appendChild(s),this.tooltipElem_=s,t.value.emitter.on("change",this.onValueUpdate_),this.value=t.value,this.update_()}get graphElement(){return this.svgElem_}update_(){const e=this.svgElem_.getBoundingClientRect(),t=this.value.rawValue.length-1,i=this.minValue_,n=this.maxValue_,s=[];this.value.rawValue.forEach(((r,o)=>{if(void 0===r)return;const a=It(o,0,t,0,e.width),l=It(r,i,n,e.height,0);s.push([a,l].join(","))})),this.lineElem_.setAttributeNS(null,"points",s.join(" "));const r=this.tooltipElem_,o=this.value.rawValue[this.cursor_.index];if(void 0===o)return void r.classList.remove(ps("t","a"));const a=It(this.cursor_.index,0,t,0,e.width),l=It(o,i,n,e.height,0);r.style.left=`${a}px`,r.style.top=`${l}px`,r.textContent=`${this.formatter_(o)}`,r.classList.contains(ps("t","a"))||(r.classList.add(ps("t","a"),ps("t","in")),j(r),r.classList.remove(ps("t","in")))}onValueUpdate_(){this.update_()}onCursorChange_(){this.update_()}}class us{constructor(e,t){if(this.onGraphMouseMove_=this.onGraphMouseMove_.bind(this),this.onGraphMouseLeave_=this.onGraphMouseLeave_.bind(this),this.onGraphPointerDown_=this.onGraphPointerDown_.bind(this),this.onGraphPointerMove_=this.onGraphPointerMove_.bind(this),this.onGraphPointerUp_=this.onGraphPointerUp_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.cursor_=new ds,this.view=new hs(e,{cursor:this.cursor_,formatter:t.formatter,lineCount:t.lineCount,maxValue:t.maxValue,minValue:t.minValue,value:this.value,viewProps:this.viewProps}),R(e)){const e=new Lt(this.view.element);e.emitter.on("down",this.onGraphPointerDown_),e.emitter.on("move",this.onGraphPointerMove_),e.emitter.on("up",this.onGraphPointerUp_)}else this.view.element.addEventListener("mousemove",this.onGraphMouseMove_),this.view.element.addEventListener("mouseleave",this.onGraphMouseLeave_)}onGraphMouseLeave_(){this.cursor_.index=-1}onGraphMouseMove_(e){const t=this.view.element.getBoundingClientRect();this.cursor_.index=Math.floor(It(e.offsetX,0,t.width,0,this.value.rawValue.length))}onGraphPointerDown_(e){this.onGraphPointerMove_(e)}onGraphPointerMove_(e){e.data.point?this.cursor_.index=Math.floor(It(e.data.point.x,0,e.data.bounds.width,0,this.value.rawValue.length)):this.cursor_.index=-1}onGraphPointerUp_(){this.cursor_.index=-1}}function vs(e){return"format"in e&&!o(e.format)?e.format:$t(2)}function bs(e){return"view"in e&&"graph"===e.view}const ms={id:"monitor-number",type:"monitor",accept:(e,t)=>{if("number"!=typeof e)return null;const i=V,n=T(t,{format:i.optional.function,lineCount:i.optional.number,max:i.optional.number,min:i.optional.number,view:i.optional.string});return n?{initialValue:e,params:n}:null},binding:{defaultBufferSize:e=>bs(e)?64:1,reader:e=>xt},controller:e=>bs(e.params)?function(e){var t,i,n;return new us(e.document,{formatter:vs(e.params),lineCount:null!==(t=e.params.lineCount)&&void 0!==t?t:is.defaultLineCount,maxValue:null!==(i="max"in e.params?e.params.max:null)&&void 0!==i?i:100,minValue:null!==(n="min"in e.params?e.params.min:null)&&void 0!==n?n:0,value:e.value,viewProps:e.viewProps})}(e):function(e){var t;return 1===e.value.rawValue.length?new ls(e.document,{formatter:vs(e.params),value:e.value,viewProps:e.viewProps}):new rs(e.document,{formatter:vs(e.params),lineCount:null!==(t=e.params.lineCount)&&void 0!==t?t:is.defaultLineCount,value:e.value,viewProps:e.viewProps})}(e)},gs={id:"monitor-string",type:"monitor",accept:(e,t)=>{if("string"!=typeof e)return null;const i=V,n=T(t,{lineCount:i.optional.number,multiline:i.optional.boolean});return n?{initialValue:e,params:n}:null},binding:{reader:e=>kt},controller:e=>{var t;const i=e.value;return i.rawValue.length>1||"multiline"in e.params&&e.params.multiline?new rs(e.document,{formatter:Et,lineCount:null!==(t=e.params.lineCount)&&void 0!==t?t:is.defaultLineCount,value:i,viewProps:e.viewProps}):new ls(e.document,{formatter:Et,value:i,viewProps:e.viewProps})}};class fs{constructor(e){this.onValueChange_=this.onValueChange_.bind(this),this.reader=e.reader,this.writer=e.writer,this.emitter=new h,this.value=e.value,this.value.emitter.on("change",this.onValueChange_),this.target=e.target,this.read()}read(){const e=this.target.read();void 0!==e&&(this.value.rawValue=this.reader(e))}write_(e){this.writer(this.target,e)}onValueChange_(e){this.write_(e.rawValue),this.emitter.emit("change",{options:e.options,rawValue:e.rawValue,sender:this})}}class _s{constructor(e){this.onTick_=this.onTick_.bind(this),this.reader_=e.reader,this.target=e.target,this.emitter=new h,this.value=e.value,this.ticker=e.ticker,this.ticker.emitter.on("tick",this.onTick_),this.read()}dispose(){this.ticker.dispose()}read(){const e=this.target.read();if(void 0===e)return;const t=this.value.rawValue,i=this.reader_(e);this.value.rawValue=function(e,t){const i=[...Tt(e),t];return i.length>e.length?i.splice(0,i.length-e.length):St(i,e.length),i}(t,i),this.emitter.emit("update",{rawValue:i,sender:this})}onTick_(e){this.read()}}function ws(e,t){return 0===t?new Be:new Fe(e,null!=t?t:is.defaultInterval)}class xs{constructor(){this.pluginsMap_={blades:[],inputs:[],monitors:[]}}getAll(){return[...this.pluginsMap_.blades,...this.pluginsMap_.inputs,...this.pluginsMap_.monitors]}register(e){"blade"===e.type?this.pluginsMap_.blades.unshift(e):"input"===e.type?this.pluginsMap_.inputs.unshift(e):"monitor"===e.type&&this.pluginsMap_.monitors.unshift(e)}createInput(e,t,i){if(o(t.read()))throw new c({context:{key:t.key},type:"nomatchingcontroller"});const n=this.pluginsMap_.inputs.reduce(((n,s)=>n||function(e,t){const i=e.accept(t.target.read(),t.params);if(o(i))return null;const n=V,s={target:t.target,initialValue:i.initialValue,params:i.params},r=e.binding.reader(s),a=e.binding.constraint?e.binding.constraint(s):void 0,l=P(r(i.initialValue),{constraint:a,equals:e.binding.equals}),c=new fs({reader:r,target:t.target,value:l,writer:e.binding.writer(s)}),d=n.optional.boolean(t.params.disabled).value,p=n.optional.boolean(t.params.hidden).value,h=e.controller({constraint:a,document:t.document,initialValue:i.initialValue,params:i.params,value:c.value,viewProps:Se.create({disabled:d,hidden:p})}),u=n.optional.string(t.params.label).value;return new ie(t.document,{binding:c,blade:W(),props:k.fromObject({label:u||t.target.key}),valueController:h})}(s,{document:e,target:t,params:i})),null);if(n)return n;throw new c({context:{key:t.key},type:"nomatchingcontroller"})}createMonitor(e,t,i){const n=this.pluginsMap_.monitors.reduce(((n,s)=>n||function(e,t){var i,n,s;const r=V,a=e.accept(t.target.read(),t.params);if(o(a))return null;const l={target:t.target,initialValue:a.initialValue,params:a.params},c=e.binding.reader(l),d=null!==(n=null!==(i=r.optional.number(t.params.bufferSize).value)&&void 0!==i?i:e.binding.defaultBufferSize&&e.binding.defaultBufferSize(a.params))&&void 0!==n?n:1,p=r.optional.number(t.params.interval).value,h=new _s({reader:c,target:t.target,ticker:ws(t.document,p),value:Vt(d)}),u=r.optional.boolean(t.params.disabled).value,v=r.optional.boolean(t.params.hidden).value,b=e.controller({document:t.document,params:a.params,value:h.value,viewProps:Se.create({disabled:u,hidden:v})}),m=null!==(s=r.optional.string(t.params.label).value)&&void 0!==s?s:t.target.key;return new se(t.document,{binding:h,blade:W(),props:k.fromObject({label:m}),valueController:b})}(s,{document:e,params:i,target:t})),null);if(n)return n;throw new c({context:{key:t.key},type:"nomatchingcontroller"})}createBlade(e,t){const i=this.pluginsMap_.blades.reduce(((i,n)=>i||function(e,t){const i=e.accept(t.params);if(!i)return null;const n=V.optional.boolean(t.params.disabled).value,s=V.optional.boolean(t.params.hidden).value;return e.controller({blade:W(),document:t.document,params:Object.assign(Object.assign({},i.params),{disabled:n,hidden:s}),viewProps:Se.create({disabled:n,hidden:s})})}(n,{document:e,params:t})),null);if(!i)throw new c({type:"nomatchingview",context:{params:t}});return i}createBladeApi(e){if(e instanceof ie)return new te(e);if(e instanceof se)return new ne(e);if(e instanceof be)return new le(e,this);const t=this.pluginsMap_.blades.reduce(((t,i)=>t||i.api({controller:e,pool:this})),null);if(!t)throw c.shouldNeverHappen();return t}}class ys extends t{constructor(e){super(e),this.emitter_=new h,this.controller_.valueController.value.emitter.on("change",(e=>{this.emitter_.emit("change",{event:new n(this,e.rawValue)})}))}get label(){return this.controller_.props.get("label")}set label(e){this.controller_.props.set("label",e)}get options(){return this.controller_.valueController.props.get("options")}set options(e){this.controller_.valueController.props.set("options",e)}get value(){return this.controller_.valueController.value.rawValue}set value(e){this.controller_.valueController.value.rawValue=e}on(e,t){const i=t.bind(this);return this.emitter_.on(e,(e=>{i(e.event)})),this}}class $s extends t{constructor(e){super(e),this.emitter_=new h,this.controller_.valueController.value.emitter.on("change",(e=>{this.emitter_.emit("change",{event:new n(this,e.rawValue)})}))}get label(){return this.controller_.props.get("label")}set label(e){this.controller_.props.set("label",e)}get maxValue(){return this.controller_.valueController.sliderController.props.get("maxValue")}set maxValue(e){this.controller_.valueController.sliderController.props.set("maxValue",e)}get minValue(){return this.controller_.valueController.sliderController.props.get("minValue")}set minValue(e){this.controller_.valueController.sliderController.props.set("minValue",e)}get value(){return this.controller_.valueController.value.rawValue}set value(e){this.controller_.valueController.value.rawValue=e}on(e,t){const i=t.bind(this);return this.emitter_.on(e,(e=>{i(e.event)})),this}}class Cs extends t{constructor(e){super(e),this.emitter_=new h,this.controller_.valueController.value.emitter.on("change",(e=>{this.emitter_.emit("change",{event:new n(this,e.rawValue)})}))}get label(){return this.controller_.props.get("label")}set label(e){this.controller_.props.set("label",e)}get formatter(){return this.controller_.valueController.props.get("formatter")}set formatter(e){this.controller_.valueController.props.set("formatter",e)}get value(){return this.controller_.valueController.value.rawValue}set value(e){this.controller_.valueController.value.rawValue=e}on(e,t){const i=t.bind(this);return this.emitter_.on(e,(e=>{i(e.event)})),this}}const Ps={id:"list",type:"blade",accept(e){const t=V,i=T(e,{options:t.required.custom(Qt),value:t.required.raw,view:t.required.constant("list"),label:t.optional.string});return i?{params:i}:null},controller(e){const t=new Ge(e.document,{props:k.fromObject({options:ti(e.params.options)}),value:P(e.params.value),viewProps:e.viewProps});return new we(e.document,{blade:e.blade,props:k.fromObject({label:e.params.label}),valueController:t})},api:e=>e.controller instanceof we&&e.controller.valueController instanceof Ge?new ys(e.controller):null};class ks extends ce{constructor(e,t){super(e,t)}get element(){return this.controller_.view.element}importPreset(e){(function(e,t){e.forEach((e=>{const i=t[e.presetKey];void 0!==i&&e.write(i)}))})(this.controller_.rackController.rack.find(ie).map((e=>e.binding.target)),e),this.refresh()}exportPreset(){return this.controller_.rackController.rack.find(ie).map((e=>e.binding.target)).reduce(((e,t)=>Object.assign(e,{[t.presetKey]:t.read()})),{})}refresh(){this.controller_.rackController.rack.find(ie).forEach((e=>{e.binding.read()})),this.controller_.rackController.rack.find(se).forEach((e=>{e.binding.read()}))}}class Es extends fe{constructor(e,t){super(e,{expanded:t.expanded,blade:t.blade,props:t.props,root:!0,viewProps:t.viewProps})}}const Ss={id:"slider",type:"blade",accept(e){const t=V,i=T(e,{max:t.required.number,min:t.required.number,view:t.required.constant("slider"),format:t.optional.function,label:t.optional.string,value:t.optional.number});return i?{params:i}:null},controller(e){var t,i;const n=null!==(t=e.params.value)&&void 0!==t?t:0,s=new Jt(e.document,{baseStep:1,parser:wt,sliderProps:k.fromObject({maxValue:e.params.max,minValue:e.params.min}),textProps:k.fromObject({draggingScale:oi(void 0,n),formatter:null!==(i=e.params.format)&&void 0!==i?i:yt}),value:P(n),viewProps:e.viewProps});return new we(e.document,{blade:e.blade,props:k.fromObject({label:e.params.label}),valueController:s})},api:e=>e.controller instanceof we&&e.controller.valueController instanceof Jt?new $s(e.controller):null},Vs={id:"text",type:"blade",accept(e){const t=V,i=T(e,{parse:t.required.function,value:t.required.raw,view:t.required.constant("text"),format:t.optional.function,label:t.optional.string});return i?{params:i}:null},controller(e){var t;const i=new et(e.document,{parser:e.params.parse,props:k.fromObject({formatter:null!==(t=e.params.format)&&void 0!==t?t:e=>String(e)}),value:P(e.params.value),viewProps:e.viewProps});return new we(e.document,{blade:e.blade,props:k.fromObject({label:e.params.label}),valueController:i})},api:e=>e.controller instanceof we&&e.controller.valueController instanceof et?new Cs(e.controller):null};function Ts(e,t,i){if(e.querySelector(`style[data-tp-style=${t}]`))return;const n=e.createElement("style");n.dataset.tpStyle=t,n.textContent=i,e.head.appendChild(n)}const Ms=new class{constructor(e){const[t,i]=e.split("-"),n=t.split(".");this.major=parseInt(n[0],10),this.minor=parseInt(n[1],10),this.patch=parseInt(n[2],10),this.prerelease=null!=i?i:null}toString(){const e=[this.major,this.minor,this.patch].join(".");return null!==this.prerelease?[e,this.prerelease].join("-"):e}}("3.0.7");e.BladeApi=t,e.ButtonApi=p,e.FolderApi=ce,e.InputBindingApi=te,e.ListApi=ys,e.MonitorBindingApi=ne,e.Pane=class extends ks{constructor(e){var t;const i=e||{},n=null!==(t=i.document)&&void 0!==t?t:L(),s=function(){const e=new xs;return[Nn,Gn,es,ts,Cn,gn,mn,bn,di,cs,gs,ms,z,_e,Pe,Ie].forEach((t=>{e.register(t)})),e}();super(new Es(n,{expanded:i.expanded,blade:W(),props:k.fromObject({title:i.title}),viewProps:Se.create()}),s),this.pool_=s,this.containerElem_=i.container||function(e){const t=e.createElement("div");return t.classList.add(v("dfw")()),e.body&&e.body.appendChild(t),t}(n),this.containerElem_.appendChild(this.element),this.doc_=n,this.usesDefaultWrapper_=!i.container,this.setUpDefaultPlugins_()}get document(){if(!this.doc_)throw c.alreadyDisposed();return this.doc_}dispose(){const e=this.containerElem_;if(!e)throw c.alreadyDisposed();if(this.usesDefaultWrapper_){const t=e.parentElement;t&&t.removeChild(e)}this.containerElem_=null,this.doc_=null,super.dispose()}registerPlugin(e){("plugin"in e?[e.plugin]:"plugins"in e?e.plugins:[]).forEach((e=>{this.pool_.register(e),this.embedPluginStyle_(e)}))}embedPluginStyle_(e){e.css&&Ts(this.document,`plugin-${e.id}`,e.css)}setUpDefaultPlugins_(){Ts(this.document,"default",".tp-lstv_s,.tp-btnv_b,.tp-p2dv_b,.tp-colswv_sw,.tp-p2dpv_p,.tp-txtv_i,.tp-grlv_g,.tp-sglv_i,.tp-mllv_i,.tp-fldv_b,.tp-rotv_b,.tp-ckbv_i,.tp-coltxtv_ms,.tp-tbiv_b{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border-width:0;font-family:inherit;font-size:inherit;font-weight:inherit;margin:0;outline:none;padding:0}.tp-lstv_s,.tp-btnv_b,.tp-p2dv_b{background-color:var(--btn-bg);border-radius:var(--elm-br);color:var(--btn-fg);cursor:pointer;display:block;font-weight:bold;height:var(--bld-us);line-height:var(--bld-us);overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.tp-lstv_s:hover,.tp-btnv_b:hover,.tp-p2dv_b:hover{background-color:var(--btn-bg-h)}.tp-lstv_s:focus,.tp-btnv_b:focus,.tp-p2dv_b:focus{background-color:var(--btn-bg-f)}.tp-lstv_s:active,.tp-btnv_b:active,.tp-p2dv_b:active{background-color:var(--btn-bg-a)}.tp-lstv_s:disabled,.tp-btnv_b:disabled,.tp-p2dv_b:disabled{opacity:0.5}.tp-colswv_sw,.tp-p2dpv_p,.tp-txtv_i{background-color:var(--in-bg);border-radius:var(--elm-br);box-sizing:border-box;color:var(--in-fg);font-family:inherit;height:var(--bld-us);line-height:var(--bld-us);min-width:0;width:100%}.tp-colswv_sw:hover,.tp-p2dpv_p:hover,.tp-txtv_i:hover{background-color:var(--in-bg-h)}.tp-colswv_sw:focus,.tp-p2dpv_p:focus,.tp-txtv_i:focus{background-color:var(--in-bg-f)}.tp-colswv_sw:active,.tp-p2dpv_p:active,.tp-txtv_i:active{background-color:var(--in-bg-a)}.tp-colswv_sw:disabled,.tp-p2dpv_p:disabled,.tp-txtv_i:disabled{opacity:0.5}.tp-grlv_g,.tp-sglv_i,.tp-mllv_i{background-color:var(--mo-bg);border-radius:var(--elm-br);box-sizing:border-box;color:var(--mo-fg);height:var(--bld-us);width:100%}.tp-rotv{--font-family: var(--tp-font-family, Roboto Mono,Source Code Pro,Menlo,Courier,monospace);--bs-br: var(--tp-base-border-radius, 6px);--cnt-h-p: var(--tp-container-horizontal-padding, 4px);--cnt-v-p: var(--tp-container-vertical-padding, 4px);--elm-br: var(--tp-element-border-radius, 2px);--bld-s: var(--tp-blade-spacing, 4px);--bld-us: var(--tp-blade-unit-size, 20px);--bs-bg: var(--tp-base-background-color, #2f3137);--bs-sh: var(--tp-base-shadow-color, rgba(0,0,0,0.2));--btn-bg: var(--tp-button-background-color, #adafb8);--btn-bg-a: var(--tp-button-background-color-active, #d6d7db);--btn-bg-f: var(--tp-button-background-color-focus, #c8cad0);--btn-bg-h: var(--tp-button-background-color-hover, #bbbcc4);--btn-fg: var(--tp-button-foreground-color, #2f3137);--cnt-bg: var(--tp-container-background-color, rgba(187,188,196,0.1));--cnt-bg-a: var(--tp-container-background-color-active, rgba(187,188,196,0.25));--cnt-bg-f: var(--tp-container-background-color-focus, rgba(187,188,196,0.2));--cnt-bg-h: var(--tp-container-background-color-hover, rgba(187,188,196,0.15));--cnt-fg: var(--tp-container-foreground-color, #bbbcc4);--in-bg: var(--tp-input-background-color, rgba(187,188,196,0.1));--in-bg-a: var(--tp-input-background-color-active, rgba(187,188,196,0.25));--in-bg-f: var(--tp-input-background-color-focus, rgba(187,188,196,0.2));--in-bg-h: var(--tp-input-background-color-hover, rgba(187,188,196,0.15));--in-fg: var(--tp-input-foreground-color, #bbbcc4);--lbl-fg: var(--tp-label-foreground-color, rgba(187,188,196,0.7));--mo-bg: var(--tp-monitor-background-color, rgba(0,0,0,0.2));--mo-fg: var(--tp-monitor-foreground-color, rgba(187,188,196,0.7));--grv-fg: var(--tp-groove-foreground-color, rgba(0,0,0,0.2))}.tp-fldv_c>.tp-cntv.tp-v-lst,.tp-tabv_c .tp-brkv>.tp-cntv.tp-v-lst,.tp-rotv_c>.tp-cntv.tp-v-lst{margin-bottom:calc(-1 * var(--cnt-v-p))}.tp-fldv_c>.tp-fldv.tp-v-lst .tp-fldv_c,.tp-tabv_c .tp-brkv>.tp-fldv.tp-v-lst .tp-fldv_c,.tp-rotv_c>.tp-fldv.tp-v-lst .tp-fldv_c{border-bottom-left-radius:0}.tp-fldv_c>.tp-fldv.tp-v-lst .tp-fldv_b,.tp-tabv_c .tp-brkv>.tp-fldv.tp-v-lst .tp-fldv_b,.tp-rotv_c>.tp-fldv.tp-v-lst .tp-fldv_b{border-bottom-left-radius:0}.tp-fldv_c>*:not(.tp-v-fst),.tp-tabv_c .tp-brkv>*:not(.tp-v-fst),.tp-rotv_c>*:not(.tp-v-fst){margin-top:var(--bld-s)}.tp-fldv_c>.tp-sprv:not(.tp-v-fst),.tp-tabv_c .tp-brkv>.tp-sprv:not(.tp-v-fst),.tp-rotv_c>.tp-sprv:not(.tp-v-fst),.tp-fldv_c>.tp-cntv:not(.tp-v-fst),.tp-tabv_c .tp-brkv>.tp-cntv:not(.tp-v-fst),.tp-rotv_c>.tp-cntv:not(.tp-v-fst){margin-top:var(--cnt-v-p)}.tp-fldv_c>.tp-sprv+*:not(.tp-v-hidden),.tp-tabv_c .tp-brkv>.tp-sprv+*:not(.tp-v-hidden),.tp-rotv_c>.tp-sprv+*:not(.tp-v-hidden),.tp-fldv_c>.tp-cntv+*:not(.tp-v-hidden),.tp-tabv_c .tp-brkv>.tp-cntv+*:not(.tp-v-hidden),.tp-rotv_c>.tp-cntv+*:not(.tp-v-hidden){margin-top:var(--cnt-v-p)}.tp-fldv_c>.tp-sprv:not(.tp-v-hidden)+.tp-sprv,.tp-tabv_c .tp-brkv>.tp-sprv:not(.tp-v-hidden)+.tp-sprv,.tp-rotv_c>.tp-sprv:not(.tp-v-hidden)+.tp-sprv,.tp-fldv_c>.tp-cntv:not(.tp-v-hidden)+.tp-cntv,.tp-tabv_c .tp-brkv>.tp-cntv:not(.tp-v-hidden)+.tp-cntv,.tp-rotv_c>.tp-cntv:not(.tp-v-hidden)+.tp-cntv{margin-top:0}.tp-fldv_c>.tp-cntv,.tp-tabv_c .tp-brkv>.tp-cntv{margin-left:4px}.tp-fldv_c>.tp-fldv>.tp-fldv_b,.tp-tabv_c .tp-brkv>.tp-fldv>.tp-fldv_b{border-top-left-radius:var(--elm-br);border-bottom-left-radius:var(--elm-br)}.tp-fldv_c>.tp-fldv.tp-fldv-expanded>.tp-fldv_b,.tp-tabv_c .tp-brkv>.tp-fldv.tp-fldv-expanded>.tp-fldv_b{border-bottom-left-radius:0}.tp-fldv_c .tp-fldv>.tp-fldv_c,.tp-tabv_c .tp-brkv .tp-fldv>.tp-fldv_c{border-bottom-left-radius:var(--elm-br)}.tp-fldv_c>.tp-tabv>.tp-tabv_i,.tp-tabv_c .tp-brkv>.tp-tabv>.tp-tabv_i{border-top-left-radius:var(--elm-br)}.tp-fldv_c .tp-tabv>.tp-tabv_c,.tp-tabv_c .tp-brkv .tp-tabv>.tp-tabv_c{border-bottom-left-radius:var(--elm-br)}.tp-fldv_b,.tp-rotv_b{background-color:var(--cnt-bg);color:var(--cnt-fg);cursor:pointer;display:block;height:calc(var(--bld-us) + 4px);line-height:calc(var(--bld-us) + 4px);overflow:hidden;padding-left:var(--cnt-h-p);padding-right:calc(2px * 2 + var(--bld-us) + var(--cnt-h-p));position:relative;text-align:left;text-overflow:ellipsis;white-space:nowrap;width:100%;transition:border-radius .2s ease-in-out .2s}.tp-fldv_b:hover,.tp-rotv_b:hover{background-color:var(--cnt-bg-h)}.tp-fldv_b:focus,.tp-rotv_b:focus{background-color:var(--cnt-bg-f)}.tp-fldv_b:active,.tp-rotv_b:active{background-color:var(--cnt-bg-a)}.tp-fldv_b:disabled,.tp-rotv_b:disabled{opacity:0.5}.tp-fldv_m,.tp-rotv_m{background:linear-gradient(to left, var(--cnt-fg), var(--cnt-fg) 2px, transparent 2px, transparent 4px, var(--cnt-fg) 4px);border-radius:2px;bottom:0;content:'';display:block;height:6px;right:calc(var(--cnt-h-p) + (var(--bld-us) + 4px - 6px) / 2 - 2px);margin:auto;opacity:0.5;position:absolute;top:0;transform:rotate(90deg);transition:transform .2s ease-in-out;width:6px}.tp-fldv.tp-fldv-expanded>.tp-fldv_b>.tp-fldv_m,.tp-rotv.tp-rotv-expanded .tp-rotv_m{transform:none}.tp-fldv_c,.tp-rotv_c{box-sizing:border-box;height:0;opacity:0;overflow:hidden;padding-bottom:0;padding-top:0;position:relative;transition:height .2s ease-in-out,opacity .2s linear,padding .2s ease-in-out}.tp-fldv.tp-fldv-cpl:not(.tp-fldv-expanded)>.tp-fldv_c,.tp-rotv.tp-rotv-cpl:not(.tp-rotv-expanded) .tp-rotv_c{display:none}.tp-fldv.tp-fldv-expanded>.tp-fldv_c,.tp-rotv.tp-rotv-expanded .tp-rotv_c{opacity:1;padding-bottom:var(--cnt-v-p);padding-top:var(--cnt-v-p);transform:none;overflow:visible;transition:height .2s ease-in-out,opacity .2s linear .2s,padding .2s ease-in-out}.tp-coltxtv_m,.tp-lstv{position:relative}.tp-lstv_s{padding:0 20px 0 4px;width:100%}.tp-coltxtv_mm,.tp-lstv_m{bottom:0;margin:auto;pointer-events:none;position:absolute;right:2px;top:0}.tp-coltxtv_mm svg,.tp-lstv_m svg{bottom:0;height:16px;margin:auto;position:absolute;right:0;top:0;width:16px}.tp-coltxtv_mm svg path,.tp-lstv_m svg path{fill:currentColor}.tp-coltxtv_w,.tp-pndtxtv{display:flex}.tp-coltxtv_c,.tp-pndtxtv_a{width:100%}.tp-coltxtv_c+.tp-coltxtv_c,.tp-pndtxtv_a+.tp-coltxtv_c,.tp-coltxtv_c+.tp-pndtxtv_a,.tp-pndtxtv_a+.tp-pndtxtv_a{margin-left:2px}.tp-btnv_b{width:100%}.tp-btnv_t{text-align:center}.tp-ckbv_l{display:block;position:relative}.tp-ckbv_i{left:0;opacity:0;position:absolute;top:0}.tp-ckbv_w{background-color:var(--in-bg);border-radius:var(--elm-br);cursor:pointer;display:block;height:var(--bld-us);position:relative;width:var(--bld-us)}.tp-ckbv_w svg{bottom:0;display:block;height:16px;left:0;margin:auto;opacity:0;position:absolute;right:0;top:0;width:16px}.tp-ckbv_w svg path{fill:none;stroke:var(--in-fg);stroke-width:2}.tp-ckbv_i:hover+.tp-ckbv_w{background-color:var(--in-bg-h)}.tp-ckbv_i:focus+.tp-ckbv_w{background-color:var(--in-bg-f)}.tp-ckbv_i:active+.tp-ckbv_w{background-color:var(--in-bg-a)}.tp-ckbv_i:checked+.tp-ckbv_w svg{opacity:1}.tp-ckbv.tp-v-disabled .tp-ckbv_w{opacity:0.5}.tp-colv{position:relative}.tp-colv_h{display:flex}.tp-colv_s{flex-grow:0;flex-shrink:0;width:var(--bld-us)}.tp-colv_t{flex:1;margin-left:4px}.tp-colv_p{height:0;margin-top:0;opacity:0;overflow:hidden;transition:height .2s ease-in-out,opacity .2s linear,margin .2s ease-in-out}.tp-colv.tp-colv-cpl .tp-colv_p{overflow:visible}.tp-colv.tp-colv-expanded .tp-colv_p{margin-top:var(--bld-s);opacity:1}.tp-colv .tp-popv{left:calc(-1 * var(--cnt-h-p));right:calc(-1 * var(--cnt-h-p));top:var(--bld-us)}.tp-colpv_h,.tp-colpv_ap{margin-left:6px;margin-right:6px}.tp-colpv_h{margin-top:var(--bld-s)}.tp-colpv_rgb{display:flex;margin-top:var(--bld-s);width:100%}.tp-colpv_a{display:flex;margin-top:var(--cnt-v-p);padding-top:calc(var(--cnt-v-p) + 2px);position:relative}.tp-colpv_a:before{background-color:var(--grv-fg);content:'';height:2px;left:calc(-1 * var(--cnt-h-p));position:absolute;right:calc(-1 * var(--cnt-h-p));top:0}.tp-colpv_ap{align-items:center;display:flex;flex:3}.tp-colpv_at{flex:1;margin-left:4px}.tp-svpv{border-radius:var(--elm-br);outline:none;overflow:hidden;position:relative}.tp-svpv_c{cursor:crosshair;display:block;height:calc(var(--bld-us) * 4);width:100%}.tp-svpv_m{border-radius:100%;border:rgba(255,255,255,0.75) solid 2px;box-sizing:border-box;filter:drop-shadow(0 0 1px rgba(0,0,0,0.3));height:12px;margin-left:-6px;margin-top:-6px;pointer-events:none;position:absolute;width:12px}.tp-svpv:focus .tp-svpv_m{border-color:#fff}.tp-hplv{cursor:pointer;height:var(--bld-us);outline:none;position:relative}.tp-hplv_c{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAAABCAYAAABubagXAAAAQ0lEQVQoU2P8z8Dwn0GCgQEDi2OK/RBgYHjBgIpfovFh8j8YBIgzFGQxuqEgPhaDOT5gOhPkdCxOZeBg+IDFZZiGAgCaSSMYtcRHLgAAAABJRU5ErkJggg==);background-position:left top;background-repeat:no-repeat;background-size:100% 100%;border-radius:2px;display:block;height:4px;left:0;margin-top:-2px;position:absolute;top:50%;width:100%}.tp-hplv_m{border-radius:var(--elm-br);border:rgba(255,255,255,0.75) solid 2px;box-shadow:0 0 2px rgba(0,0,0,0.1);box-sizing:border-box;height:12px;left:50%;margin-left:-6px;margin-top:-6px;pointer-events:none;position:absolute;top:50%;width:12px}.tp-hplv:focus .tp-hplv_m{border-color:#fff}.tp-aplv{cursor:pointer;height:var(--bld-us);outline:none;position:relative;width:100%}.tp-aplv_b{background-color:#fff;background-image:linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%),linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%);background-size:4px 4px;background-position:0 0,2px 2px;border-radius:2px;display:block;height:4px;left:0;margin-top:-2px;overflow:hidden;position:absolute;top:50%;width:100%}.tp-aplv_c{bottom:0;left:0;position:absolute;right:0;top:0}.tp-aplv_m{background-color:#fff;background-image:linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%),linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%);background-size:12px 12px;background-position:0 0,6px 6px;border-radius:var(--elm-br);box-shadow:0 0 2px rgba(0,0,0,0.1);height:12px;left:50%;margin-left:-6px;margin-top:-6px;overflow:hidden;pointer-events:none;position:absolute;top:50%;width:12px}.tp-aplv_p{border-radius:var(--elm-br);border:rgba(255,255,255,0.75) solid 2px;box-sizing:border-box;bottom:0;left:0;position:absolute;right:0;top:0}.tp-aplv:focus .tp-aplv_p{border-color:#fff}.tp-colswv{background-color:#fff;background-image:linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%),linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%);background-size:10px 10px;background-position:0 0,5px 5px;border-radius:var(--elm-br)}.tp-colswv.tp-v-disabled{opacity:0.5}.tp-colswv_b{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border-width:0;cursor:pointer;display:block;height:var(--bld-us);left:0;margin:0;outline:none;padding:0;position:absolute;top:0;width:var(--bld-us)}.tp-colswv_b:focus::after{border:rgba(255,255,255,0.75) solid 2px;border-radius:var(--elm-br);bottom:0;content:'';display:block;left:0;position:absolute;right:0;top:0}.tp-coltxtv{display:flex;width:100%}.tp-coltxtv_m{margin-right:4px}.tp-coltxtv_ms{border-radius:var(--elm-br);color:var(--lbl-fg);cursor:pointer;height:var(--bld-us);line-height:var(--bld-us);padding:0 18px 0 4px}.tp-coltxtv_ms:hover{background-color:var(--in-bg-h)}.tp-coltxtv_ms:focus{background-color:var(--in-bg-f)}.tp-coltxtv_ms:active{background-color:var(--in-bg-a)}.tp-coltxtv_mm{color:var(--lbl-fg)}.tp-coltxtv_w{flex:1}.tp-dfwv{position:absolute;top:8px;right:8px;width:256px}.tp-fldv.tp-fldv-not .tp-fldv_b{display:none}.tp-fldv_t{padding-left:4px}.tp-fldv_c{border-left:var(--cnt-bg) solid 4px}.tp-fldv_b:hover+.tp-fldv_c{border-left-color:var(--cnt-bg-h)}.tp-fldv_b:focus+.tp-fldv_c{border-left-color:var(--cnt-bg-f)}.tp-fldv_b:active+.tp-fldv_c{border-left-color:var(--cnt-bg-a)}.tp-grlv{position:relative}.tp-grlv_g{display:block;height:calc(var(--bld-us) * 3)}.tp-grlv_g polyline{fill:none;stroke:var(--mo-fg);stroke-linejoin:round}.tp-grlv_t{margin-top:-4px;transition:left 0.05s, top 0.05s;visibility:hidden}.tp-grlv_t.tp-grlv_t-a{visibility:visible}.tp-grlv_t.tp-grlv_t-in{transition:none}.tp-grlv.tp-v-disabled .tp-grlv_g{opacity:0.5}.tp-grlv .tp-ttv{background-color:var(--mo-fg)}.tp-grlv .tp-ttv::before{border-top-color:var(--mo-fg)}.tp-lblv{align-items:center;display:flex;line-height:1.3;padding-left:var(--cnt-h-p);padding-right:var(--cnt-h-p)}.tp-lblv.tp-lblv-nol{display:block}.tp-lblv_l{color:var(--lbl-fg);flex:1;-webkit-hyphens:auto;-ms-hyphens:auto;hyphens:auto;overflow:hidden;padding-left:4px;padding-right:16px}.tp-lblv.tp-v-disabled .tp-lblv_l{opacity:0.5}.tp-lblv.tp-lblv-nol .tp-lblv_l{display:none}.tp-lblv_v{align-self:flex-start;flex-grow:0;flex-shrink:0;width:160px}.tp-lblv.tp-lblv-nol .tp-lblv_v{width:100%}.tp-lstv_s{padding:0 20px 0 4px;width:100%}.tp-lstv_m{color:var(--btn-fg)}.tp-sglv_i{padding:0 4px}.tp-sglv.tp-v-disabled .tp-sglv_i{opacity:0.5}.tp-mllv_i{display:block;height:calc(var(--bld-us) * 3);line-height:var(--bld-us);padding:0 4px;resize:none;white-space:pre}.tp-mllv.tp-v-disabled .tp-mllv_i{opacity:0.5}.tp-p2dv{position:relative}.tp-p2dv_h{display:flex}.tp-p2dv_b{height:var(--bld-us);margin-right:4px;position:relative;width:var(--bld-us)}.tp-p2dv_b svg{display:block;height:16px;left:50%;margin-left:-8px;margin-top:-8px;position:absolute;top:50%;width:16px}.tp-p2dv_b svg path{stroke:currentColor;stroke-width:2}.tp-p2dv_b svg circle{fill:currentColor}.tp-p2dv_t{flex:1}.tp-p2dv_p{height:0;margin-top:0;opacity:0;overflow:hidden;transition:height .2s ease-in-out,opacity .2s linear,margin .2s ease-in-out}.tp-p2dv.tp-p2dv-expanded .tp-p2dv_p{margin-top:var(--bld-s);opacity:1}.tp-p2dv .tp-popv{left:calc(-1 * var(--cnt-h-p));right:calc(-1 * var(--cnt-h-p));top:var(--bld-us)}.tp-p2dpv{padding-left:calc(var(--bld-us) + 4px)}.tp-p2dpv_p{cursor:crosshair;height:0;overflow:hidden;padding-bottom:100%;position:relative}.tp-p2dpv_g{display:block;height:100%;left:0;pointer-events:none;position:absolute;top:0;width:100%}.tp-p2dpv_ax{opacity:0.1;stroke:var(--in-fg);stroke-dasharray:1}.tp-p2dpv_l{opacity:0.5;stroke:var(--in-fg);stroke-dasharray:1}.tp-p2dpv_m{border:var(--in-fg) solid 1px;border-radius:50%;box-sizing:border-box;height:4px;margin-left:-2px;margin-top:-2px;position:absolute;width:4px}.tp-p2dpv_p:focus .tp-p2dpv_m{background-color:var(--in-fg);border-width:0}.tp-popv{background-color:var(--bs-bg);border-radius:6px;box-shadow:0 2px 4px var(--bs-sh);display:none;max-width:168px;padding:var(--cnt-v-p) var(--cnt-h-p);position:absolute;visibility:hidden;z-index:1000}.tp-popv.tp-popv-v{display:block;visibility:visible}.tp-sprv_r{background-color:var(--grv-fg);border-width:0;display:block;height:2px;margin:0;width:100%}.tp-sldv.tp-v-disabled{opacity:0.5}.tp-sldv_t{box-sizing:border-box;cursor:pointer;height:var(--bld-us);margin:0 6px;outline:none;position:relative}.tp-sldv_t::before{background-color:var(--in-bg);border-radius:1px;bottom:0;content:'';display:block;height:2px;left:0;margin:auto;position:absolute;right:0;top:0}.tp-sldv_k{height:100%;left:0;position:absolute;top:0}.tp-sldv_k::before{background-color:var(--in-fg);border-radius:1px;bottom:0;content:'';display:block;height:2px;left:0;margin-bottom:auto;margin-top:auto;position:absolute;right:0;top:0}.tp-sldv_k::after{background-color:var(--btn-bg);border-radius:var(--elm-br);bottom:0;content:'';display:block;height:12px;margin-bottom:auto;margin-top:auto;position:absolute;right:-6px;top:0;width:12px}.tp-sldv_t:hover .tp-sldv_k::after{background-color:var(--btn-bg-h)}.tp-sldv_t:focus .tp-sldv_k::after{background-color:var(--btn-bg-f)}.tp-sldv_t:active .tp-sldv_k::after{background-color:var(--btn-bg-a)}.tp-sldtxtv{display:flex}.tp-sldtxtv_s{flex:2}.tp-sldtxtv_t{flex:1;margin-left:4px}.tp-tabv.tp-v-disabled{opacity:0.5}.tp-tabv_i{align-items:flex-end;display:flex;overflow:hidden}.tp-tabv.tp-tabv-nop .tp-tabv_i{height:calc(var(--bld-us) + 4px);position:relative}.tp-tabv.tp-tabv-nop .tp-tabv_i::before{background-color:var(--cnt-bg);bottom:0;content:'';height:2px;left:0;position:absolute;right:0}.tp-tabv_c{border-left:var(--cnt-bg) solid 4px;padding-bottom:var(--cnt-v-p);padding-top:var(--cnt-v-p)}.tp-tbiv{flex:1;min-width:0;position:relative}.tp-tbiv+.tp-tbiv{margin-left:2px}.tp-tbiv+.tp-tbiv::before{background-color:var(--cnt-bg);bottom:0;content:'';height:2px;left:-2px;position:absolute;width:2px}.tp-tbiv_b{background-color:var(--cnt-bg);display:block;padding-left:calc(var(--cnt-h-p) + 4px);padding-right:calc(var(--cnt-h-p) + 4px);width:100%}.tp-tbiv_b:hover{background-color:var(--cnt-bg-h)}.tp-tbiv_b:focus{background-color:var(--cnt-bg-f)}.tp-tbiv_b:active{background-color:var(--cnt-bg-a)}.tp-tbiv_b:disabled{opacity:0.5}.tp-tbiv_t{color:var(--cnt-fg);height:calc(var(--bld-us) + 4px);line-height:calc(var(--bld-us) + 4px);opacity:0.5;overflow:hidden;text-overflow:ellipsis}.tp-tbiv.tp-tbiv-sel .tp-tbiv_t{opacity:1}.tp-txtv{position:relative}.tp-txtv_i{padding:0 4px}.tp-txtv.tp-txtv-fst .tp-txtv_i{border-bottom-right-radius:0;border-top-right-radius:0}.tp-txtv.tp-txtv-mid .tp-txtv_i{border-radius:0}.tp-txtv.tp-txtv-lst .tp-txtv_i{border-bottom-left-radius:0;border-top-left-radius:0}.tp-txtv.tp-txtv-num .tp-txtv_i{text-align:right}.tp-txtv.tp-txtv-drg .tp-txtv_i{opacity:0.3}.tp-txtv_k{cursor:pointer;height:100%;left:-3px;position:absolute;top:0;width:12px}.tp-txtv_k::before{background-color:var(--in-fg);border-radius:1px;bottom:0;content:'';height:calc(var(--bld-us) - 4px);left:50%;margin-bottom:auto;margin-left:-1px;margin-top:auto;opacity:0.1;position:absolute;top:0;transition:border-radius 0.1s, height 0.1s, transform 0.1s, width 0.1s;width:2px}.tp-txtv_k:hover::before,.tp-txtv.tp-txtv-drg .tp-txtv_k::before{opacity:1}.tp-txtv.tp-txtv-drg .tp-txtv_k::before{border-radius:50%;height:4px;transform:translateX(-1px);width:4px}.tp-txtv_g{bottom:0;display:block;height:8px;left:50%;margin:auto;overflow:visible;pointer-events:none;position:absolute;top:0;visibility:hidden;width:100%}.tp-txtv.tp-txtv-drg .tp-txtv_g{visibility:visible}.tp-txtv_gb{fill:none;stroke:var(--in-fg);stroke-dasharray:1}.tp-txtv_gh{fill:none;stroke:var(--in-fg)}.tp-txtv .tp-ttv{margin-left:6px;visibility:hidden}.tp-txtv.tp-txtv-drg .tp-ttv{visibility:visible}.tp-ttv{background-color:var(--in-fg);border-radius:var(--elm-br);color:var(--bs-bg);padding:2px 4px;pointer-events:none;position:absolute;transform:translate(-50%, -100%)}.tp-ttv::before{border-color:var(--in-fg) transparent transparent transparent;border-style:solid;border-width:2px;box-sizing:border-box;content:'';font-size:0.9em;height:4px;left:50%;margin-left:-2px;position:absolute;top:100%;width:4px}.tp-rotv{background-color:var(--bs-bg);border-radius:var(--bs-br);box-shadow:0 2px 4px var(--bs-sh);font-family:var(--font-family);font-size:11px;font-weight:500;line-height:1;text-align:left}.tp-rotv_b{border-bottom-left-radius:var(--bs-br);border-bottom-right-radius:var(--bs-br);border-top-left-radius:var(--bs-br);border-top-right-radius:var(--bs-br);padding-left:calc(2px * 2 + var(--bld-us) + var(--cnt-h-p));text-align:center}.tp-rotv.tp-rotv-expanded .tp-rotv_b{border-bottom-left-radius:0;border-bottom-right-radius:0}.tp-rotv.tp-rotv-not .tp-rotv_b{display:none}.tp-rotv_c>.tp-fldv.tp-v-lst>.tp-fldv_c,.tp-rotv_c>.tp-tabv.tp-v-lst>.tp-tabv_c{border-bottom-left-radius:var(--bs-br);border-bottom-right-radius:var(--bs-br)}.tp-rotv_c>.tp-fldv.tp-v-lst:not(.tp-fldv-expanded)>.tp-fldv_b{border-bottom-left-radius:var(--bs-br);border-bottom-right-radius:var(--bs-br)}.tp-rotv_c .tp-fldv.tp-v-vlst:not(.tp-fldv-expanded)>.tp-fldv_b{border-bottom-right-radius:var(--bs-br)}.tp-rotv.tp-rotv-not .tp-rotv_c>.tp-fldv.tp-v-fst{margin-top:calc(-1 * var(--cnt-v-p))}.tp-rotv.tp-rotv-not .tp-rotv_c>.tp-fldv.tp-v-fst>.tp-fldv_b{border-top-left-radius:var(--bs-br);border-top-right-radius:var(--bs-br)}.tp-rotv.tp-rotv-not .tp-rotv_c>.tp-tabv.tp-v-fst{margin-top:calc(-1 * var(--cnt-v-p))}.tp-rotv.tp-rotv-not .tp-rotv_c>.tp-tabv.tp-v-fst>.tp-tabv_i{border-top-left-radius:var(--bs-br);border-top-right-radius:var(--bs-br)}.tp-rotv.tp-v-disabled,.tp-rotv .tp-v-disabled{pointer-events:none}.tp-rotv.tp-v-hidden,.tp-rotv .tp-v-hidden{display:none}"),this.pool_.getAll().forEach((e=>{this.embedPluginStyle_(e)})),this.registerPlugin({plugins:[Ss,Ps,Ie,Vs]})}},e.SeparatorApi=xe,e.SliderApi=$s,e.TabApi=Ae,e.TabPageApi=Oe,e.TextApi=Cs,e.TpChangeEvent=n,e.VERSION=Ms,Object.defineProperty(e,"__esModule",{value:!0})}(t)},excalibur:e=>{e.exports=t1}},t={};function i(n){var s=t[n];if(void 0!==s)return s.exports;var r=t[n]={exports:{}};return e[n].call(r.exports,r,r.exports,i),r.exports}i.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return i.d(t,{a:t}),t},i.d=(e,t)=>{for(var n in t)i.o(t,n)&&!i.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var n={};return(()=>{i.r(n),i.d(n,{DevTool:()=>r});var e=i("excalibur"),t=i("./node_modules/tweakpane/dist/tweakpane.js"),s=i("./picker-system.ts");class r{constructor(e){this.engine=e,this.pointerPos={x:0,y:0},this.highlightedEntities=[-1],this.selectedEntity=null,this.selectedEntityId=-1,this.pane=new t.Pane({title:"Excalibur Dev Tools",expanded:!0});const i=document.createElement("style");i.innerText=".excalibur-tweakpane-custom { width: 405px; }",document.head.appendChild(i),this.pane.element.parentElement.classList.add("excalibur-tweakpane-custom"),this._buildMain(),this.tabs=this.pane.addTab({pages:[{title:"Entity"},{title:"Screen"},{title:"Camera"},{title:"Clock"},{title:"Timers"},{title:"Physics"},{title:"Settings"}]}),this.selectedEntityTab=this.tabs.pages[0],this.screenTab=this.tabs.pages[1],this.cameraTab=this.tabs.pages[2],this.clockTab=this.tabs.pages[3],this.timerTab=this.tabs.pages[4],this.physicsTab=this.tabs.pages[5],this.debugTab=this.tabs.pages[6],this._installPickerSystemIfNeeded(e.currentScene),e.debug.transform.showPosition=!0,e.debug.entity.showName=!0,this.selectedEntityFolder=this.selectedEntityTab.addFolder({title:"Selected"}),this._buildScreenTab(),this._buildCameraTab(),this._buildClockTab(),this._buildTimersTab(),this._buildPhysicsTab(),this._buildDebugSettingsTab(),setInterval((()=>{this.update(this)}),30),this.addListeners()}addListeners(){this.engine.canvas.addEventListener("click",(()=>{-1!==this.highlightedEntities[0]&&this.selectEntityById(this.highlightedEntities[0])}))}selectEntityById(t){const i=this.engine;this.selectedEntityId=t,this.selectedEntity=i.currentScene.world.entityManager.getById(t),this._buildEntityUI(this.selectedEntity);const n=this.selectedEntity.get(e.TransformComponent);this._buildTransformUI(n);const s=this.selectedEntity.get(e.MotionComponent);if(this._buildMotionUI(s),this.selectedEntity instanceof e.ParticleEmitter)this._buildParticleEmitterUI(this.selectedEntity);else{const t=this.selectedEntity.get(e.GraphicsComponent);this._buildGraphicsUI(t);const i=this.selectedEntity.get(e.ColliderComponent),n=this.selectedEntity.get(e.BodyComponent);this._buildColliderUI(i,n)}}update(e){const t=e.engine,i=t.input.pointers.primary.lastWorldPos;this.pointerPos.x=i.x,this.pointerPos.y=i.y,this.pointerPosInput.refresh();const n=[...this.pickerSystem.lastFrameEntityToPointers.keys(),...this.pickerSystem.currentFrameEntityToPointers.keys()];0===n.length&&(n.push(-1),n.push(this.selectedEntityId)),this.highlightedEntities=n,t.debug.filter.useFilter=!0,t.debug.filter.ids=n,this.currentResolution.width===t.screen.resolution.width&&this.currentResolution.height===t.screen.resolution.height&&this.currentViewport.width===t.screen.viewport.width&&this.currentViewport.height===t.screen.viewport.height||(this.resolutionText.dispose(),this.viewportText.dispose(),this.resolutionText=this.screenFolder.addBlade({view:"text",label:"resolution",value:`(${t.screen.resolution.width}x${t.screen.resolution.height})`,parse:e=>String(e),index:0}),this.viewportText=this.screenFolder.addBlade({view:"text",label:"viewport",value:`(${t.screen.viewport.width.toFixed(0)}x${t.screen.viewport.height.toFixed(0)})`,parse:e=>String(e),index:1})),this._buildTimersTab()}_installPickerSystemIfNeeded(e){this.pickerSystem=e.world.systemManager.get(s.PickerSystem),this.pickerSystem||(this.pickerSystem=new s.PickerSystem,e.world.systemManager.addSystem(this.pickerSystem))}_buildMain(){this.pane.addInput({debug:!1},"debug").on("change",(()=>{this.engine.toggleDebug()})),this.pane.addMonitor(this.engine.clock.fpsSampler,"fps",{view:"graph",label:"fps (0 - 120)",min:0,max:120});let e,t="",i=[];for(let e in this.engine.scenes)this.engine.currentScene===this.engine.scenes[e]&&(t=e),i.push({text:e,value:e});this.pane.addBlade({view:"list",label:"current scene",options:i,value:t}).on("change",(t=>{this.engine.goToScene(t.value),this._installPickerSystemIfNeeded(this.engine.currentScene),e.dispose(),e=this.pane.addBlade({view:"text",label:"number of entities",value:this.engine.currentScene.world.entityManager.entities.length,parse:e=>String(e),index:3})})),e=this.pane.addBlade({view:"text",label:"number of entities",value:this.engine.currentScene.world.entityManager.entities.length,parse:e=>String(e),index:3}),this.pointerPos={x:10,y:10},this.pointerPosInput=this.pane.addInput(this,"pointerPos",{label:"pointer pos (world)"}),this.pane.addInput(this,"selectedEntityId",{label:"Select By Id"}).on("change",(e=>this.selectEntityById(e.value)))}_buildEntityUI(t){var i,n;this.selectedEntityFolder&&(this.selectedEntityFolder.dispose(),this.selectedEntityFolder=this.selectedEntityTab.addFolder({title:"Selected"})),this.selectedEntityFolder.addBlade({view:"text",label:"id",value:t.id.toString(),parse:e=>String(e)}),this.selectedEntityFolder.addInput(this.selectedEntity,"name"),this.selectedEntityFolder.addBlade({view:"text",label:"tags",value:t.tags.join(",")||"none",parse:e=>String(e)}),t instanceof e.Actor&&t.color&&this.selectedEntityFolder.addInput(this.selectedEntity,"color").on("change",(i=>{t.color=new e.Color(i.value.r,i.value.g,i.value.b,i.value.a)})),this.selectedEntityFolder.addBlade({view:"text",label:"parent",value:t.parent?`(${null===(i=t.parent)||void 0===i?void 0:i.id}) ${null===(n=t.parent)||void 0===n?void 0:n.name}`:"none",parse:e=>String(e)}),this.selectedEntityFolder.addBlade({view:"list",label:"children",options:t.children.map((e=>({text:`(${e.id}) ${e.name}`,value:e.id}))),value:t.children.length?t.children[0].id:"none"}),this.selectedEntityFolder.addButton({title:"Kill Entity"}).on("click",(e=>{this.selectedEntity.kill(),this.selectedEntityFolder.dispose(),this.selectedEntityFolder=this.selectedEntityTab.addFolder({title:"Selected"})}))}_buildColliderUI(t,i){var n,s;if(t){const r=this.selectedEntityFolder.addFolder({title:"Collider & Body"});r.addBlade({view:"text",label:"type",value:null!==(s=null===(n=t.get())||void 0===n?void 0:n.constructor.name)&&void 0!==s?s:"none",parse:e=>String(e)}),i&&(r.addBlade({view:"list",label:"collisionType",options:[e.CollisionType.Active,e.CollisionType.Fixed,e.CollisionType.Passive,e.CollisionType.PreventCollision].map((e=>({text:e,value:e}))),value:i.collisionType}).on("change",(e=>{i.collisionType=e.value})),r.addBlade({view:"list",label:"collisionGroup",options:[e.CollisionGroup.All,...e.CollisionGroupManager.groups].map((e=>({text:e.name,value:e}))),value:i.group}).on("change",(e=>{i.group=e.value})))}}_buildParticleEmitterUI(e){const t=this.selectedEntityFolder.addFolder({title:"Particles"});t.addInput(e,"isEmitting"),t.addInput(e,"emitRate"),t.addInput(e,"fadeFlag"),t.addInput(e,"particleLife",{min:100,max:1e4,step:100}),t.addInput(e,"width"),t.addInput(e,"height"),t.addInput(e,"minVel"),t.addInput(e,"maxVel"),t.addInput(e,"minAngle",{min:0,max:2*Math.PI,step:.1}),t.addInput(e,"maxAngle",{min:0,max:2*Math.PI,step:.1}),t.addInput(e,"minSize"),t.addInput(e,"maxSize"),t.addInput(e,"beginColor"),t.addInput(e,"endColor"),t.addInput(e,"opacity",{min:0,max:1,step:.01}),t.addInput(e,"randomRotation"),t.addInput(e,"particleRotationalVelocity")}_buildGraphicsUI(e){var t;if(e){const i=this.selectedEntityFolder.addFolder({title:"Graphics"});i.addInput(e,"anchor"),i.addInput(e,"opacity",{min:0,max:1,step:.05}),i.addInput(e,"visible");const n=[],s=[],r=e.current.map((e=>e.graphic)),o=[];let a=0;for(let t in e.graphics)n.push({text:t,value:a++}),s.push(e.graphics[t]),o.push(e.graphics[t]);let l=0;for(let e of r)-1===o.indexOf(e)&&(n.push({text:"anonymous"+l++,value:a}),s.push(e));i.addBlade({view:"list",label:"graphics",options:n,value:s.indexOf(null===(t=e.current[0])||void 0===t?void 0:t.graphic)}).on("change",(t=>{e.use(s[t.value])}))}}_buildMotionUI(e){if(e){const t=this.selectedEntityFolder.addFolder({title:"Motion"});t.addInput(e,"vel"),t.addInput(e,"acc"),t.addInput(e,"angularVelocity",{step:.1}),t.addInput(e,"scaleFactor"),t.addInput(e,"inertia")}}_buildTransformUI(t){if(t){const i=this.selectedEntityFolder.addFolder({title:"Transform"});i.addBlade({view:"list",label:"coord plane",options:[e.CoordPlane.World,e.CoordPlane.Screen].map((e=>({text:e,value:e}))),value:t.coordPlane}).on("change",(e=>t.coordPlane=e.value));const n=i.addInput(t,"pos"),s=i.addInput(t,"rotation",{min:0,max:2*Math.PI}),r=i.addInput(t,"scale");i.addSeparator();const o=i.addInput(t,"globalPos",{label:"global pos"}),a=i.addInput(t,"globalRotation",{label:"global rot",min:0,max:2*Math.PI}),l=i.addInput(t,"globalScale",{label:"global pos"});o.on("change",(()=>n.refresh())),n.on("change",(()=>o.refresh())),a.on("change",(()=>s.refresh())),s.on("change",(()=>a.refresh())),l.on("change",(()=>r.refresh())),r.on("change",(()=>l.refresh())),i.addInput(t,"z",{label:"z-index"})}}_buildScreenTab(){this.screenFolder=this.screenTab.addFolder({title:"Screen"}),this.currentResolution=this.engine.screen.resolution,this.currentViewport=this.engine.screen.viewport,this.resolutionText=this.screenFolder.addBlade({view:"text",label:"resolution",value:`(${this.engine.screen.resolution.width}x${this.engine.screen.resolution.height})`,parse:e=>String(e),index:0}),this.viewportText=this.screenFolder.addBlade({view:"text",label:"viewport",value:`(${this.engine.screen.viewport.width.toFixed(0)}x${this.engine.screen.viewport.height.toFixed(0)})`,parse:e=>String(e),index:1}),this.screenFolder.addButton({title:"Fullscreen"}).on("click",(()=>{this.engine.screen.goFullScreen()})),this.screenFolder.addSeparator();const t=this.screenFolder.addBlade({view:"list",label:"Color Blindness Mode",options:[e.ColorBlindnessMode.Deuteranope,e.ColorBlindnessMode.Protanope,e.ColorBlindnessMode.Tritanope].map((e=>({text:e,value:e}))),value:e.ColorBlindnessMode.Deuteranope}),i={simulate:!1};this.screenFolder.addInput(i,"simulate"),this.screenFolder.addButton({title:"Apply"}).on("click",(()=>{i.simulate?this.engine.debug.colorBlindMode.simulate(t.value):this.engine.debug.colorBlindMode.correct(t.value)})),this.screenFolder.addButton({title:"Clear"}).on("click",(()=>{this.engine.debug.colorBlindMode.clear()}))}_buildCameraTab(){const e=this.cameraTab.addFolder({title:"Camera"});e.addInput(this.engine.currentScene.camera,"zoom",{min:.01,max:10,step:.1}),e.addInput(this.engine.currentScene.camera,"pos")}_buildClockTab(){const t=this.clockTab.addFolder({title:"Clock"});let i=this.engine.clock instanceof e.TestClock,n=16;const s=t.addButton({title:"step",disabled:!i,index:2}).on("click",(()=>this.engine.clock.step(n)));t.addBlade({view:"slider",label:"step (ms)",min:1,max:100,step:16,value:n}).on("change",(e=>n=e.value)),t.addButton({title:"Use Test Clock",index:0}).on("click",(()=>{this.engine.debug.useTestClock(),i=!0,s.disabled=!1})),t.addButton({title:"Use Standard Clock",index:1}).on("click",(()=>{this.engine.debug.useStandardClock(),i=!1,s.disabled=!0})),this.pane.addSeparator();const r=t.addButton({title:"Stop",disabled:!1}),o=t.addButton({title:"Start",disabled:!0});r.on("click",(()=>{this.engine.clock.stop(),o.disabled=!1,r.disabled=!0})),o.on("click",(()=>{this.engine.clock.start(),r.disabled=!1,o.disabled=!0}))}_buildTimersTab(){this.timerTab,this._timersFolder&&this._timersFolder.dispose(),this._timersFolder=this.timerTab.addFolder({title:"Timers"});for(let e of this.engine.currentScene.timers){let t=e.repeats&&-1===e.maxNumberOfRepeats?"repeats":e._numberOfTicks+1+" of "+(-1===e.maxNumberOfRepeats?1:e.maxNumberOfRepeats);e.isRunning||(t="stopped"),e.complete&&(t="complete"),this._timersFolder.addBlade({view:"text",label:`timer(${e.id})`,value:`${t} next(${e.timeToNextAction.toFixed(0)}ms)`,parse:e=>String(e)})}}_buildPhysicsTab(){const t=this.physicsTab,i={};for(let t in e.Physics)i[t]=e.Physics[t];t.addInput(i,"enabled").on("change",(t=>e.Physics.enabled=t.value)),t.addInput(i,"acc");const n=t.addInput(i,"collisionResolutionStrategy");t.addButton({title:"Use Arcade"}).on("click",(()=>{e.Physics.useArcadePhysics(),i.collisionResolutionStrategy=e.Physics.collisionResolutionStrategy,n.refresh()})),t.addButton({title:"Use Realistic"}).on("click",(()=>{e.Physics.useRealisticPhysics(),i.collisionResolutionStrategy=e.Physics.collisionResolutionStrategy,n.refresh()})),t.addInput(i,"bodiesCanSleepByDefault").on("change",(t=>e.Physics.bodiesCanSleepByDefault=t.value)),t.addInput(i,"warmStart").on("change",(t=>e.Physics.warmStart=t.value)),t.addInput(i,"sleepEpsilon",{min:.01,max:2,step:.05}).on("change",(t=>e.Physics.sleepEpsilon=t.value)),t.addInput(i,"wakeThreshold",{min:.01,max:2,step:.05}).on("change",(t=>e.Physics.wakeThreshold=t.value)),t.addInput(i,"positionIterations",{min:1,max:30,step:1}).on("change",(t=>e.Physics.positionIterations=t.value)),t.addInput(i,"velocityIterations",{min:1,max:30,step:1}).on("change",(t=>e.Physics.velocityIterations=t.value)),t.addInput(i,"checkForFastBodies").on("change",(t=>e.Physics.checkForFastBodies=t.value))}_buildDebugSettingsTab(){const e=this.debugTab;for(let t of["entity","transform","motion","body","collider","physics","graphics","camera"]){let i=e.addFolder({title:t});if(this.engine.debug[t])for(let e in this.engine.debug[t])if(e)if(e.toLocaleLowerCase().includes("color"))i.addInput(this.engine.debug[t],e);else{if(Array.isArray(this.engine.debug[t][e]))continue;i.addInput(this.engine.debug[t],e)}}}}})(),n})();var $3OncY=parcelRequire("3OncY");const $ad2bcec7a0192558$var$getNumDigits=e=>(`${e}`.match(/\d/g)||[]).length,$ad2bcec7a0192558$var$buildGui=(e,t,i)=>{for(const n in i)if(i.hasOwnProperty(n)){let s=i[n];if("number"==typeof s){$ad2bcec7a0192558$var$getNumDigits(s);let e,r;if(s>-1&&s<1)e=.1,r=1;else{const t=$ad2bcec7a0192558$var$getNumDigits(Math.round(s));r=Math.pow(10,t),e=1}t.add(i,n,0,r).step(e)}else if("object"==typeof s){let i=t.addFolder(n);$ad2bcec7a0192558$var$buildGui(e,i,s)}else t.add(i,n)}};$3d149cbfd3136500$export$add4fa36ca2fc569(),$613a632b39062363$export$a62869ddf53aa3e3.init();class $ad2bcec7a0192558$export$985739bfa5723e08 extends $jgD1p.Engine{showDevTool=$3OncY.default.ShowDevTool;constructor(){super({canvasElementId:"game",displayMode:$jgD1p.DisplayMode.FitScreen,antialiasing:!1,resolution:{width:$3OncY.default.grid.tileWidth*($3OncY.default.grid.width+$3OncY.default.grid.padding),height:$3OncY.default.grid.tileHeight*($3OncY.default.grid.height+$3OncY.default.grid.padding)}})}init(){this.startLevel();const e=new $jgD1p.Loader;for(const t of Object.values($cT3l2.Resources))e.addResource(t);this.start(e).then((()=>{this.screen.forceResize()}))}startLevel=()=>{const e=new $84ab826914df134a$export$ca664994d1d54bff;this.addScene("main",e),this.goToScene("main")};setupDevTool=()=>{if(this.showDevTool){this.devTool=new $d82f9d57af76c42b$exports.DevTool(this);let e=this.devTool.pane.addTab({pages:[{title:"Config"}]}).pages[0];const t=(i,n,s)=>{for(let r in i){if(s<=0)return;const o=(""===n?"":n+"_")+r;if(i[r]instanceof $jgD1p.Color)return void e.addInput(i,r,{label:o});"object"==typeof i[r]?t(i[r],o,s-1):e.addInput(i,r,{disabled:!0,label:o})}};t($3OncY.default,"",6)}}}const $ad2bcec7a0192558$export$119d2a93e2780362=new $ad2bcec7a0192558$export$985739bfa5723e08;$ad2bcec7a0192558$export$119d2a93e2780362.backgroundColor=$jgD1p.Color.fromHex("#eec39a"),$ad2bcec7a0192558$export$119d2a93e2780362.init();
//# sourceMappingURL=index.cad548cc.js.map
