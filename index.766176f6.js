function $parcel$export(e,t,i,n){Object.defineProperty(e,t,{get:i,set:n,enumerable:!0,configurable:!0})}var $parcel$global="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{};function $parcel$interopDefault(e){return e&&e.__esModule?e.default:e}var $parcel$modules={},$parcel$inits={},parcelRequire=$parcel$global.parcelRequire957c;null==parcelRequire&&(parcelRequire=function(e){if(e in $parcel$modules)return $parcel$modules[e].exports;if(e in $parcel$inits){var t=$parcel$inits[e];delete $parcel$inits[e];var i={id:e,exports:{}};return $parcel$modules[e]=i,t.call(i.exports,i,i.exports),i.exports}var n=new Error("Cannot find module '"+e+"'");throw n.code="MODULE_NOT_FOUND",n},parcelRequire.register=function(e,t){$parcel$inits[e]=t},$parcel$global.parcelRequire957c=parcelRequire),parcelRequire.register("27Lyk",(function(e,t){var i,n;$parcel$export(e.exports,"register",(()=>i),(e=>i=e)),$parcel$export(e.exports,"resolve",(()=>n),(e=>n=e));var r={};i=function(e){for(var t=Object.keys(e),i=0;i<t.length;i++)r[t[i]]=e[t[i]]},n=function(e){var t=r[e];if(null==t)throw new Error("Could not resolve bundle with id "+e);return t}})),parcelRequire.register("1b2ls",(function(e,t){var i,n,r;$parcel$export(e.exports,"Fragment",(()=>i),(e=>i=e)),$parcel$export(e.exports,"jsx",(()=>n),(e=>n=e)),$parcel$export(e.exports,"jsxs",(()=>r),(e=>r=e));var s=parcelRequire("acw62"),o=Symbol.for("react.element"),a=Symbol.for("react.fragment"),l=Object.prototype.hasOwnProperty,c=s.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,d={key:!0,ref:!0,__self:!0,__source:!0};function h(e,t,i){var n,r={},s=null,a=null;for(n in void 0!==i&&(s=""+i),void 0!==t.key&&(s=""+t.key),void 0!==t.ref&&(a=t.ref),t)l.call(t,n)&&!d.hasOwnProperty(n)&&(r[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps)void 0===r[n]&&(r[n]=t[n]);return{$$typeof:o,type:e,key:s,ref:a,props:r,_owner:c.current}}i=a,n=h,r=h})),parcelRequire.register("acw62",(function(e,t){e.exports=parcelRequire("2pUnB")})),parcelRequire.register("2pUnB",(function(e,t){var i,n,r,s,o,a,l,c,d,h,u,p,f,g,m,_,v,b,w,y,x,$,C,S,E,P,k,T,A,D,R,I,M,L,B;$parcel$export(e.exports,"Children",(()=>i),(e=>i=e)),$parcel$export(e.exports,"Component",(()=>n),(e=>n=e)),$parcel$export(e.exports,"Fragment",(()=>r),(e=>r=e)),$parcel$export(e.exports,"Profiler",(()=>s),(e=>s=e)),$parcel$export(e.exports,"PureComponent",(()=>o),(e=>o=e)),$parcel$export(e.exports,"StrictMode",(()=>a),(e=>a=e)),$parcel$export(e.exports,"Suspense",(()=>l),(e=>l=e)),$parcel$export(e.exports,"__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED",(()=>c),(e=>c=e)),$parcel$export(e.exports,"cloneElement",(()=>d),(e=>d=e)),$parcel$export(e.exports,"createContext",(()=>h),(e=>h=e)),$parcel$export(e.exports,"createElement",(()=>u),(e=>u=e)),$parcel$export(e.exports,"createFactory",(()=>p),(e=>p=e)),$parcel$export(e.exports,"createRef",(()=>f),(e=>f=e)),$parcel$export(e.exports,"forwardRef",(()=>g),(e=>g=e)),$parcel$export(e.exports,"isValidElement",(()=>m),(e=>m=e)),$parcel$export(e.exports,"lazy",(()=>_),(e=>_=e)),$parcel$export(e.exports,"memo",(()=>v),(e=>v=e)),$parcel$export(e.exports,"startTransition",(()=>b),(e=>b=e)),$parcel$export(e.exports,"unstable_act",(()=>w),(e=>w=e)),$parcel$export(e.exports,"useCallback",(()=>y),(e=>y=e)),$parcel$export(e.exports,"useContext",(()=>x),(e=>x=e)),$parcel$export(e.exports,"useDebugValue",(()=>$),(e=>$=e)),$parcel$export(e.exports,"useDeferredValue",(()=>C),(e=>C=e)),$parcel$export(e.exports,"useEffect",(()=>S),(e=>S=e)),$parcel$export(e.exports,"useId",(()=>E),(e=>E=e)),$parcel$export(e.exports,"useImperativeHandle",(()=>P),(e=>P=e)),$parcel$export(e.exports,"useInsertionEffect",(()=>k),(e=>k=e)),$parcel$export(e.exports,"useLayoutEffect",(()=>T),(e=>T=e)),$parcel$export(e.exports,"useMemo",(()=>A),(e=>A=e)),$parcel$export(e.exports,"useReducer",(()=>D),(e=>D=e)),$parcel$export(e.exports,"useRef",(()=>R),(e=>R=e)),$parcel$export(e.exports,"useState",(()=>I),(e=>I=e)),$parcel$export(e.exports,"useSyncExternalStore",(()=>M),(e=>M=e)),$parcel$export(e.exports,"useTransition",(()=>L),(e=>L=e)),$parcel$export(e.exports,"version",(()=>B),(e=>B=e));var F=Symbol.for("react.element"),O=Symbol.for("react.portal"),z=Symbol.for("react.fragment"),N=Symbol.for("react.strict_mode"),V=Symbol.for("react.profiler"),U=Symbol.for("react.provider"),H=Symbol.for("react.context"),j=Symbol.for("react.forward_ref"),W=Symbol.for("react.suspense"),G=Symbol.for("react.memo"),q=Symbol.for("react.lazy"),K=Symbol.iterator;var X={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Y=Object.assign,Q={};function Z(e,t,i){this.props=e,this.context=t,this.refs=Q,this.updater=i||X}function J(){}function ee(e,t,i){this.props=e,this.context=t,this.refs=Q,this.updater=i||X}Z.prototype.isReactComponent={},Z.prototype.setState=function(e,t){if("object"!=typeof e&&"function"!=typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},Z.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},J.prototype=Z.prototype;var te=ee.prototype=new J;te.constructor=ee,Y(te,Z.prototype),te.isPureReactComponent=!0;var ie=Array.isArray,ne=Object.prototype.hasOwnProperty,re={current:null},se={key:!0,ref:!0,__self:!0,__source:!0};function oe(e,t,i){var n,r={},s=null,o=null;if(null!=t)for(n in void 0!==t.ref&&(o=t.ref),void 0!==t.key&&(s=""+t.key),t)ne.call(t,n)&&!se.hasOwnProperty(n)&&(r[n]=t[n]);var a=arguments.length-2;if(1===a)r.children=i;else if(1<a){for(var l=Array(a),c=0;c<a;c++)l[c]=arguments[c+2];r.children=l}if(e&&e.defaultProps)for(n in a=e.defaultProps)void 0===r[n]&&(r[n]=a[n]);return{$$typeof:F,type:e,key:s,ref:o,props:r,_owner:re.current}}function ae(e){return"object"==typeof e&&null!==e&&e.$$typeof===F}var le=/\/+/g;function ce(e,t){return"object"==typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function de(e,t,i,n,r){var s=typeof e;"undefined"!==s&&"boolean"!==s||(e=null);var o,a=!1;if(null===e)a=!0;else switch(s){case"string":case"number":a=!0;break;case"object":switch(e.$$typeof){case F:case O:a=!0}}if(a)return r=r(a=e),e=""===n?"."+ce(a,0):n,ie(r)?(i="",null!=e&&(i=e.replace(le,"$&/")+"/"),de(r,t,i,"",(function(e){return e}))):null!=r&&(ae(r)&&(r=function(e,t){return{$$typeof:F,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(r,i+(!r.key||a&&a.key===r.key?"":(""+r.key).replace(le,"$&/")+"/")+e)),t.push(r)),1;if(a=0,n=""===n?".":n+":",ie(e))for(var l=0;l<e.length;l++){var c=n+ce(s=e[l],l);a+=de(s,t,i,c,r)}else if("function"==typeof(c=null===(o=e)||"object"!=typeof o?null:"function"==typeof(o=K&&o[K]||o["@@iterator"])?o:null))for(e=c.call(e),l=0;!(s=e.next()).done;)a+=de(s=s.value,t,i,c=n+ce(s,l++),r);else if("object"===s)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return a}function he(e,t,i){if(null==e)return e;var n=[],r=0;return de(e,n,"","",(function(e){return t.call(i,e,r++)})),n}function ue(e){if(-1===e._status){var t=e._result;(t=t()).then((function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)}),(function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)})),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var pe={current:null},fe={transition:null};i={map:he,forEach:function(e,t,i){he(e,(function(){t.apply(this,arguments)}),i)},count:function(e){var t=0;return he(e,(function(){t++})),t},toArray:function(e){return he(e,(function(e){return e}))||[]},only:function(e){if(!ae(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},n=Z,r=z,s=V,o=ee,a=N,l=W,c={ReactCurrentDispatcher:pe,ReactCurrentBatchConfig:fe,ReactCurrentOwner:re},d=function(e,t,i){if(null==e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=Y({},e.props),r=e.key,s=e.ref,o=e._owner;if(null!=t){if(void 0!==t.ref&&(s=t.ref,o=re.current),void 0!==t.key&&(r=""+t.key),e.type&&e.type.defaultProps)var a=e.type.defaultProps;for(l in t)ne.call(t,l)&&!se.hasOwnProperty(l)&&(n[l]=void 0===t[l]&&void 0!==a?a[l]:t[l])}var l=arguments.length-2;if(1===l)n.children=i;else if(1<l){a=Array(l);for(var c=0;c<l;c++)a[c]=arguments[c+2];n.children=a}return{$$typeof:F,type:e.type,key:r,ref:s,props:n,_owner:o}},h=function(e){return(e={$$typeof:H,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:U,_context:e},e.Consumer=e},u=oe,p=function(e){var t=oe.bind(null,e);return t.type=e,t},f=function(){return{current:null}},g=function(e){return{$$typeof:j,render:e}},m=ae,_=function(e){return{$$typeof:q,_payload:{_status:-1,_result:e},_init:ue}},v=function(e,t){return{$$typeof:G,type:e,compare:void 0===t?null:t}},b=function(e){var t=fe.transition;fe.transition={};try{e()}finally{fe.transition=t}},w=function(){throw Error("act(...) is not supported in production builds of React.")},y=function(e,t){return pe.current.useCallback(e,t)},x=function(e){return pe.current.useContext(e)},$=function(){},C=function(e){return pe.current.useDeferredValue(e)},S=function(e,t){return pe.current.useEffect(e,t)},E=function(){return pe.current.useId()},P=function(e,t,i){return pe.current.useImperativeHandle(e,t,i)},k=function(e,t){return pe.current.useInsertionEffect(e,t)},T=function(e,t){return pe.current.useLayoutEffect(e,t)},A=function(e,t){return pe.current.useMemo(e,t)},D=function(e,t,i){return pe.current.useReducer(e,t,i)},R=function(e){return pe.current.useRef(e)},I=function(e){return pe.current.useState(e)},M=function(e,t,i){return pe.current.useSyncExternalStore(e,t,i)},L=function(){return pe.current.useTransition()},B="18.0.0-fc46dba67-20220329"})),parcelRequire.register("Xw6Mv",(function(e,t){var i,n,r,s,o,a,l,c,d,h,u,p;$parcel$export(e.exports,"__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED",(()=>i),(e=>i=e)),$parcel$export(e.exports,"createPortal",(()=>n),(e=>n=e)),$parcel$export(e.exports,"createRoot",(()=>r),(e=>r=e)),$parcel$export(e.exports,"findDOMNode",(()=>s),(e=>s=e)),$parcel$export(e.exports,"flushSync",(()=>o),(e=>o=e)),$parcel$export(e.exports,"hydrate",(()=>a),(e=>a=e)),$parcel$export(e.exports,"hydrateRoot",(()=>l),(e=>l=e)),$parcel$export(e.exports,"render",(()=>c),(e=>c=e)),$parcel$export(e.exports,"unmountComponentAtNode",(()=>d),(e=>d=e)),$parcel$export(e.exports,"unstable_batchedUpdates",(()=>h),(e=>h=e)),$parcel$export(e.exports,"unstable_renderSubtreeIntoContainer",(()=>u),(e=>u=e)),$parcel$export(e.exports,"version",(()=>p),(e=>p=e));var f=parcelRequire("acw62"),g=parcelRequire("fO90s");function m(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,i=1;i<arguments.length;i++)t+="&args[]="+encodeURIComponent(arguments[i]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var _=new Set,v={};function b(e,t){w(e,t),w(e+"Capture",t)}function w(e,t){for(v[e]=t,e=0;e<t.length;e++)_.add(t[e])}var y=!("undefined"==typeof window||void 0===window.document||void 0===window.document.createElement),x=Object.prototype.hasOwnProperty,$=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,C={},S={};function E(e,t,i,n,r,s,o){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=n,this.attributeNamespace=r,this.mustUseProperty=i,this.propertyName=e,this.type=t,this.sanitizeURL=s,this.removeEmptyString=o}var P={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(e){P[e]=new E(e,0,!1,e,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(e){var t=e[0];P[t]=new E(t,1,!1,e[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(e){P[e]=new E(e,2,!1,e.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(e){P[e]=new E(e,2,!1,e,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(e){P[e]=new E(e,3,!1,e.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(e){P[e]=new E(e,3,!0,e,null,!1,!1)})),["capture","download"].forEach((function(e){P[e]=new E(e,4,!1,e,null,!1,!1)})),["cols","rows","size","span"].forEach((function(e){P[e]=new E(e,6,!1,e,null,!1,!1)})),["rowSpan","start"].forEach((function(e){P[e]=new E(e,5,!1,e.toLowerCase(),null,!1,!1)}));var k=/[\-:]([a-z])/g;function T(e){return e[1].toUpperCase()}function A(e,t,i,n){var r=P.hasOwnProperty(t)?P[t]:null;(null!==r?0!==r.type:n||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,i,n){if(null==t||function(e,t,i,n){if(null!==i&&0===i.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!n&&(null!==i?!i.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,i,n))return!0;if(n)return!1;if(null!==i)switch(i.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,i,r,n)&&(i=null),n||null===r?function(e){return!!x.call(S,e)||!x.call(C,e)&&($.test(e)?S[e]=!0:(C[e]=!0,!1))}(t)&&(null===i?e.removeAttribute(t):e.setAttribute(t,""+i)):r.mustUseProperty?e[r.propertyName]=null===i?3!==r.type&&"":i:(t=r.attributeName,n=r.attributeNamespace,null===i?e.removeAttribute(t):(i=3===(r=r.type)||4===r&&!0===i?"":""+i,n?e.setAttributeNS(n,t,i):e.setAttribute(t,i))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(e){var t=e.replace(k,T);P[t]=new E(t,1,!1,e,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(e){var t=e.replace(k,T);P[t]=new E(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(e){var t=e.replace(k,T);P[t]=new E(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(e){P[e]=new E(e,1,!1,e.toLowerCase(),null,!1,!1)})),P.xlinkHref=new E("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(e){P[e]=new E(e,1,!1,e.toLowerCase(),null,!0,!0)}));var D=f.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,R=Symbol.for("react.element"),I=Symbol.for("react.portal"),M=Symbol.for("react.fragment"),L=Symbol.for("react.strict_mode"),B=Symbol.for("react.profiler"),F=Symbol.for("react.provider"),O=Symbol.for("react.context"),z=Symbol.for("react.forward_ref"),N=Symbol.for("react.suspense"),V=Symbol.for("react.suspense_list"),U=Symbol.for("react.memo"),H=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var j=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var W=Symbol.iterator;function G(e){return null===e||"object"!=typeof e?null:"function"==typeof(e=W&&e[W]||e["@@iterator"])?e:null}var q,K=Object.assign;function X(e){if(void 0===q)try{throw Error()}catch(e){var t=e.stack.trim().match(/\n( *(at )?)/);q=t&&t[1]||""}return"\n"+q+e}var Y=!1;function Q(e,t){if(!e||Y)return"";Y=!0;var i=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"==typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(e){var n=e}Reflect.construct(e,[],t)}else{try{t.call()}catch(e){n=e}e.call(t.prototype)}else{try{throw Error()}catch(e){n=e}e()}}catch(t){if(t&&n&&"string"==typeof t.stack){for(var r=t.stack.split("\n"),s=n.stack.split("\n"),o=r.length-1,a=s.length-1;1<=o&&0<=a&&r[o]!==s[a];)a--;for(;1<=o&&0<=a;o--,a--)if(r[o]!==s[a]){if(1!==o||1!==a)do{if(o--,0>--a||r[o]!==s[a]){var l="\n"+r[o].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}}while(1<=o&&0<=a);break}}}finally{Y=!1,Error.prepareStackTrace=i}return(e=e?e.displayName||e.name:"")?X(e):""}function Z(e){switch(e.tag){case 5:return X(e.type);case 16:return X("Lazy");case 13:return X("Suspense");case 19:return X("SuspenseList");case 0:case 2:case 15:return e=Q(e.type,!1);case 11:return e=Q(e.type.render,!1);case 1:return e=Q(e.type,!0);default:return""}}function J(e){if(null==e)return null;if("function"==typeof e)return e.displayName||e.name||null;if("string"==typeof e)return e;switch(e){case M:return"Fragment";case I:return"Portal";case B:return"Profiler";case L:return"StrictMode";case N:return"Suspense";case V:return"SuspenseList"}if("object"==typeof e)switch(e.$$typeof){case O:return(e.displayName||"Context")+".Consumer";case F:return(e._context.displayName||"Context")+".Provider";case z:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case U:return null!==(t=e.displayName||null)?t:J(e.type)||"Memo";case H:t=e._payload,e=e._init;try{return J(e(t))}catch(e){}}return null}function ee(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return J(t);case 8:return t===L?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"==typeof t)return t.displayName||t.name||null;if("string"==typeof t)return t}return null}function te(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function ie(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function ne(e){e._valueTracker||(e._valueTracker=function(e){var t=ie(e)?"checked":"value",i=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&void 0!==i&&"function"==typeof i.get&&"function"==typeof i.set){var r=i.get,s=i.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return r.call(this)},set:function(e){n=""+e,s.call(this,e)}}),Object.defineProperty(e,t,{enumerable:i.enumerable}),{getValue:function(){return n},setValue:function(e){n=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function re(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var i=t.getValue(),n="";return e&&(n=ie(e)?e.checked?"true":"false":e.value),(e=n)!==i&&(t.setValue(e),!0)}function se(e){if(void 0===(e=e||("undefined"!=typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function oe(e,t){var i=t.checked;return K({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=i?i:e._wrapperState.initialChecked})}function ae(e,t){var i=null==t.defaultValue?"":t.defaultValue,n=null!=t.checked?t.checked:t.defaultChecked;i=te(null!=t.value?t.value:i),e._wrapperState={initialChecked:n,initialValue:i,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function le(e,t){null!=(t=t.checked)&&A(e,"checked",t,!1)}function ce(e,t){le(e,t);var i=te(t.value),n=t.type;if(null!=i)"number"===n?(0===i&&""===e.value||e.value!=i)&&(e.value=""+i):e.value!==""+i&&(e.value=""+i);else if("submit"===n||"reset"===n)return void e.removeAttribute("value");t.hasOwnProperty("value")?he(e,t.type,i):t.hasOwnProperty("defaultValue")&&he(e,t.type,te(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function de(e,t,i){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!("submit"!==n&&"reset"!==n||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,i||t===e.value||(e.value=t),e.defaultValue=t}""!==(i=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==i&&(e.name=i)}function he(e,t,i){"number"===t&&se(e.ownerDocument)===e||(null==i?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+i&&(e.defaultValue=""+i))}var ue=Array.isArray;function pe(e,t,i,n){if(e=e.options,t){t={};for(var r=0;r<i.length;r++)t["$"+i[r]]=!0;for(i=0;i<e.length;i++)r=t.hasOwnProperty("$"+e[i].value),e[i].selected!==r&&(e[i].selected=r),r&&n&&(e[i].defaultSelected=!0)}else{for(i=""+te(i),t=null,r=0;r<e.length;r++){if(e[r].value===i)return e[r].selected=!0,void(n&&(e[r].defaultSelected=!0));null!==t||e[r].disabled||(t=e[r])}null!==t&&(t.selected=!0)}}function fe(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(m(91));return K({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function ge(e,t){var i=t.value;if(null==i){if(i=t.children,t=t.defaultValue,null!=i){if(null!=t)throw Error(m(92));if(ue(i)){if(1<i.length)throw Error(m(93));i=i[0]}t=i}null==t&&(t=""),i=t}e._wrapperState={initialValue:te(i)}}function me(e,t){var i=te(t.value),n=te(t.defaultValue);null!=i&&((i=""+i)!==e.value&&(e.value=i),null==t.defaultValue&&e.defaultValue!==i&&(e.defaultValue=i)),null!=n&&(e.defaultValue=""+n)}function _e(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function ve(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function be(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?ve(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var we,ye,xe=(ye=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((we=we||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=we.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!=typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,i,n){MSApp.execUnsafeLocalFunction((function(){return ye(e,t)}))}:ye);function $e(e,t){if(t){var i=e.firstChild;if(i&&i===e.lastChild&&3===i.nodeType)return void(i.nodeValue=t)}e.textContent=t}var Ce={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Se=["Webkit","ms","Moz","O"];function Ee(e,t,i){return null==t||"boolean"==typeof t||""===t?"":i||"number"!=typeof t||0===t||Ce.hasOwnProperty(e)&&Ce[e]?(""+t).trim():t+"px"}function Pe(e,t){for(var i in e=e.style,t)if(t.hasOwnProperty(i)){var n=0===i.indexOf("--"),r=Ee(i,t[i],n);"float"===i&&(i="cssFloat"),n?e.setProperty(i,r):e[i]=r}}Object.keys(Ce).forEach((function(e){Se.forEach((function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Ce[t]=Ce[e]}))}));var ke=K({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Te(e,t){if(t){if(ke[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(m(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(m(60));if("object"!=typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(m(61))}if(null!=t.style&&"object"!=typeof t.style)throw Error(m(62))}}function Ae(e,t){if(-1===e.indexOf("-"))return"string"==typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var De=null;function Re(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var Ie=null,Me=null,Le=null;function Be(e){if(e=Cr(e)){if("function"!=typeof Ie)throw Error(m(280));var t=e.stateNode;t&&(t=Er(t),Ie(e.stateNode,e.type,t))}}function Fe(e){Me?Le?Le.push(e):Le=[e]:Me=e}function Oe(){if(Me){var e=Me,t=Le;if(Le=Me=null,Be(e),t)for(e=0;e<t.length;e++)Be(t[e])}}function ze(e,t){return e(t)}function Ne(){}var Ve=!1;function Ue(e,t,i){if(Ve)return e(t,i);Ve=!0;try{return ze(e,t,i)}finally{Ve=!1,(null!==Me||null!==Le)&&(Ne(),Oe())}}function He(e,t){var i=e.stateNode;if(null===i)return null;var n=Er(i);if(null===n)return null;i=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(n=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!n;break e;default:e=!1}if(e)return null;if(i&&"function"!=typeof i)throw Error(m(231,t,typeof i));return i}var je=!1;if(y)try{var We={};Object.defineProperty(We,"passive",{get:function(){je=!0}}),window.addEventListener("test",We,We),window.removeEventListener("test",We,We)}catch(ye){je=!1}function Ge(e,t,i,n,r,s,o,a,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(i,c)}catch(e){this.onError(e)}}var qe=!1,Ke=null,Xe=!1,Ye=null,Qe={onError:function(e){qe=!0,Ke=e}};function Ze(e,t,i,n,r,s,o,a,l){qe=!1,Ke=null,Ge.apply(Qe,arguments)}function Je(e){var t=e,i=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!=(4098&(t=e).flags)&&(i=t.return),e=t.return}while(e)}return 3===t.tag?i:null}function et(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function tt(e){if(Je(e)!==e)throw Error(m(188))}function it(e){return e=function(e){var t=e.alternate;if(!t){if(null===(t=Je(e)))throw Error(m(188));return t!==e?null:e}for(var i=e,n=t;;){var r=i.return;if(null===r)break;var s=r.alternate;if(null===s){if(null!==(n=r.return)){i=n;continue}break}if(r.child===s.child){for(s=r.child;s;){if(s===i)return tt(r),e;if(s===n)return tt(r),t;s=s.sibling}throw Error(m(188))}if(i.return!==n.return)i=r,n=s;else{for(var o=!1,a=r.child;a;){if(a===i){o=!0,i=r,n=s;break}if(a===n){o=!0,n=r,i=s;break}a=a.sibling}if(!o){for(a=s.child;a;){if(a===i){o=!0,i=s,n=r;break}if(a===n){o=!0,n=s,i=r;break}a=a.sibling}if(!o)throw Error(m(189))}}if(i.alternate!==n)throw Error(m(190))}if(3!==i.tag)throw Error(m(188));return i.stateNode.current===i?e:t}(e),null!==e?nt(e):null}function nt(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=nt(e);if(null!==t)return t;e=e.sibling}return null}var rt=g.unstable_scheduleCallback,st=g.unstable_cancelCallback,ot=g.unstable_shouldYield,at=g.unstable_requestPaint,lt=g.unstable_now,ct=g.unstable_getCurrentPriorityLevel,dt=g.unstable_ImmediatePriority,ht=g.unstable_UserBlockingPriority,ut=g.unstable_NormalPriority,pt=g.unstable_LowPriority,ft=g.unstable_IdlePriority,gt=null,mt=null;var _t=Math.clz32?Math.clz32:function(e){return 0===(e>>>=0)?32:31-(vt(e)/bt|0)|0},vt=Math.log,bt=Math.LN2;var wt=64,yt=4194304;function xt(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function $t(e,t){var i=e.pendingLanes;if(0===i)return 0;var n=0,r=e.suspendedLanes,s=e.pingedLanes,o=268435455&i;if(0!==o){var a=o&~r;0!==a?n=xt(a):0!==(s&=o)&&(n=xt(s))}else 0!==(o=i&~r)?n=xt(o):0!==s&&(n=xt(s));if(0===n)return 0;if(0!==t&&t!==n&&0==(t&r)&&((r=n&-n)>=(s=t&-t)||16===r&&0!=(4194240&s)))return t;if(0!=(4&n)&&(n|=16&i),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=n;0<t;)r=1<<(i=31-_t(t)),n|=e[i],t&=~r;return n}function Ct(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function St(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function Et(e){for(var t=[],i=0;31>i;i++)t.push(e);return t}function Pt(e,t,i){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-_t(t)]=i}function kt(e,t){var i=e.entangledLanes|=t;for(e=e.entanglements;i;){var n=31-_t(i),r=1<<n;r&t|e[n]&t&&(e[n]|=t),i&=~r}}var Tt=0;function At(e){return 1<(e&=-e)?4<e?0!=(268435455&e)?16:536870912:4:1}var Dt,Rt,It,Mt,Lt,Bt=!1,Ft=[],Ot=null,zt=null,Nt=null,Vt=new Map,Ut=new Map,Ht=[],jt="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Wt(e,t){switch(e){case"focusin":case"focusout":Ot=null;break;case"dragenter":case"dragleave":zt=null;break;case"mouseover":case"mouseout":Nt=null;break;case"pointerover":case"pointerout":Vt.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ut.delete(t.pointerId)}}function Gt(e,t,i,n,r,s){return null===e||e.nativeEvent!==s?(e={blockedOn:t,domEventName:i,eventSystemFlags:n,nativeEvent:s,targetContainers:[r]},null!==t&&(null!==(t=Cr(t))&&Rt(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,null!==r&&-1===t.indexOf(r)&&t.push(r),e)}function qt(e){var t=$r(e.target);if(null!==t){var i=Je(t);if(null!==i)if(13===(t=i.tag)){if(null!==(t=et(i)))return e.blockedOn=t,void Lt(e.priority,(function(){It(i)}))}else if(3===t&&i.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===i.tag?i.stateNode.containerInfo:null)}e.blockedOn=null}function Kt(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var i=ri(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==i)return null!==(t=Cr(i))&&Rt(t),e.blockedOn=i,!1;var n=new(i=e.nativeEvent).constructor(i.type,i);De=n,i.target.dispatchEvent(n),De=null,t.shift()}return!0}function Xt(e,t,i){Kt(e)&&i.delete(t)}function Yt(){Bt=!1,null!==Ot&&Kt(Ot)&&(Ot=null),null!==zt&&Kt(zt)&&(zt=null),null!==Nt&&Kt(Nt)&&(Nt=null),Vt.forEach(Xt),Ut.forEach(Xt)}function Qt(e,t){e.blockedOn===t&&(e.blockedOn=null,Bt||(Bt=!0,g.unstable_scheduleCallback(g.unstable_NormalPriority,Yt)))}function Zt(e){function t(t){return Qt(t,e)}if(0<Ft.length){Qt(Ft[0],e);for(var i=1;i<Ft.length;i++){var n=Ft[i];n.blockedOn===e&&(n.blockedOn=null)}}for(null!==Ot&&Qt(Ot,e),null!==zt&&Qt(zt,e),null!==Nt&&Qt(Nt,e),Vt.forEach(t),Ut.forEach(t),i=0;i<Ht.length;i++)(n=Ht[i]).blockedOn===e&&(n.blockedOn=null);for(;0<Ht.length&&null===(i=Ht[0]).blockedOn;)qt(i),null===i.blockedOn&&Ht.shift()}var Jt=D.ReactCurrentBatchConfig;function ei(e,t,i,n){var r=Tt,s=Jt.transition;Jt.transition=null;try{Tt=1,ii(e,t,i,n)}finally{Tt=r,Jt.transition=s}}function ti(e,t,i,n){var r=Tt,s=Jt.transition;Jt.transition=null;try{Tt=4,ii(e,t,i,n)}finally{Tt=r,Jt.transition=s}}function ii(e,t,i,n){var r=ri(e,t,i,n);if(null===r)Yn(e,t,n,ni,i),Wt(e,n);else if(function(e,t,i,n,r){switch(t){case"focusin":return Ot=Gt(Ot,e,t,i,n,r),!0;case"dragenter":return zt=Gt(zt,e,t,i,n,r),!0;case"mouseover":return Nt=Gt(Nt,e,t,i,n,r),!0;case"pointerover":var s=r.pointerId;return Vt.set(s,Gt(Vt.get(s)||null,e,t,i,n,r)),!0;case"gotpointercapture":return s=r.pointerId,Ut.set(s,Gt(Ut.get(s)||null,e,t,i,n,r)),!0}return!1}(r,e,t,i,n))n.stopPropagation();else if(Wt(e,n),4&t&&-1<jt.indexOf(e)){for(;null!==r;){var s=Cr(r);if(null!==s&&Dt(s),null===(s=ri(e,t,i,n))&&Yn(e,t,n,ni,i),s===r)break;r=s}null!==r&&n.stopPropagation()}else Yn(e,t,n,null,i)}var ni=null;function ri(e,t,i,n){if(ni=null,null!==(e=$r(e=Re(n))))if(null===(t=Je(e)))e=null;else if(13===(i=t.tag)){if(null!==(e=et(t)))return e;e=null}else if(3===i){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return ni=e,null}function si(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(ct()){case dt:return 1;case ht:return 4;case ut:case pt:return 16;case ft:return 536870912;default:return 16}default:return 16}}var oi=null,ai=null,li=null;function ci(){if(li)return li;var e,t,i=ai,n=i.length,r="value"in oi?oi.value:oi.textContent,s=r.length;for(e=0;e<n&&i[e]===r[e];e++);var o=n-e;for(t=1;t<=o&&i[n-t]===r[s-t];t++);return li=r.slice(e,1<t?1-t:void 0)}function di(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function hi(){return!0}function ui(){return!1}function pi(e){function t(t,i,n,r,s){for(var o in this._reactName=t,this._targetInst=n,this.type=i,this.nativeEvent=r,this.target=s,this.currentTarget=null,e)e.hasOwnProperty(o)&&(t=e[o],this[o]=t?t(r):r[o]);return this.isDefaultPrevented=(null!=r.defaultPrevented?r.defaultPrevented:!1===r.returnValue)?hi:ui,this.isPropagationStopped=ui,this}return K(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!=typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=hi)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!=typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=hi)},persist:function(){},isPersistent:hi}),t}var fi,gi,mi,_i={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},vi=pi(_i),bi=K({},_i,{view:0,detail:0}),wi=pi(bi),yi=K({},bi,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ri,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==mi&&(mi&&"mousemove"===e.type?(fi=e.screenX-mi.screenX,gi=e.screenY-mi.screenY):gi=fi=0,mi=e),fi)},movementY:function(e){return"movementY"in e?e.movementY:gi}}),xi=pi(yi),$i=pi(K({},yi,{dataTransfer:0})),Ci=pi(K({},bi,{relatedTarget:0})),Si=pi(K({},_i,{animationName:0,elapsedTime:0,pseudoElement:0})),Ei=pi(K({},_i,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}})),Pi=pi(K({},_i,{data:0})),ki={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Ti={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Ai={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Di(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=Ai[e])&&!!t[e]}function Ri(){return Di}var Ii=pi(K({},bi,{key:function(e){if(e.key){var t=ki[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=di(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?Ti[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ri,charCode:function(e){return"keypress"===e.type?di(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?di(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}})),Mi=pi(K({},yi,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),Li=pi(K({},bi,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ri})),Bi=pi(K({},_i,{propertyName:0,elapsedTime:0,pseudoElement:0})),Fi=pi(K({},yi,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0})),Oi=[9,13,27,32],zi=y&&"CompositionEvent"in window,Ni=null;y&&"documentMode"in document&&(Ni=document.documentMode);var Vi=y&&"TextEvent"in window&&!Ni,Ui=y&&(!zi||Ni&&8<Ni&&11>=Ni),Hi=String.fromCharCode(32),ji=!1;function Wi(e,t){switch(e){case"keyup":return-1!==Oi.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Gi(e){return"object"==typeof(e=e.detail)&&"data"in e?e.data:null}var qi=!1;var Ki={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Xi(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Ki[e.type]:"textarea"===t}function Yi(e,t,i,n){Fe(n),0<(t=Zn(t,"onChange")).length&&(i=new vi("onChange","change",null,i,n),e.push({event:i,listeners:t}))}var Qi=null,Zi=null;function Ji(e){jn(e,0)}function en(e){if(re(Sr(e)))return e}function tn(e,t){if("change"===e)return t}var nn=!1;if(y){var rn;if(y){var sn="oninput"in document;if(!sn){var on=document.createElement("div");on.setAttribute("oninput","return;"),sn="function"==typeof on.oninput}rn=sn}else rn=!1;nn=rn&&(!document.documentMode||9<document.documentMode)}function an(){Qi&&(Qi.detachEvent("onpropertychange",ln),Zi=Qi=null)}function ln(e){if("value"===e.propertyName&&en(Zi)){var t=[];Yi(t,Zi,e,Re(e)),Ue(Ji,t)}}function cn(e,t,i){"focusin"===e?(an(),Zi=i,(Qi=t).attachEvent("onpropertychange",ln)):"focusout"===e&&an()}function dn(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return en(Zi)}function hn(e,t){if("click"===e)return en(t)}function un(e,t){if("input"===e||"change"===e)return en(t)}var pn="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t};function fn(e,t){if(pn(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;var i=Object.keys(e),n=Object.keys(t);if(i.length!==n.length)return!1;for(n=0;n<i.length;n++){var r=i[n];if(!x.call(t,r)||!pn(e[r],t[r]))return!1}return!0}function gn(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function mn(e,t){var i,n=gn(e);for(e=0;n;){if(3===n.nodeType){if(i=e+n.textContent.length,e<=t&&i>=t)return{node:n,offset:t-e};e=i}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=gn(n)}}function _n(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?_n(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function vn(){for(var e=window,t=se();t instanceof e.HTMLIFrameElement;){try{var i="string"==typeof t.contentWindow.location.href}catch(e){i=!1}if(!i)break;t=se((e=t.contentWindow).document)}return t}function bn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function wn(e){var t=vn(),i=e.focusedElem,n=e.selectionRange;if(t!==i&&i&&i.ownerDocument&&_n(i.ownerDocument.documentElement,i)){if(null!==n&&bn(i))if(t=n.start,void 0===(e=n.end)&&(e=t),"selectionStart"in i)i.selectionStart=t,i.selectionEnd=Math.min(e,i.value.length);else if((e=(t=i.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var r=i.textContent.length,s=Math.min(n.start,r);n=void 0===n.end?s:Math.min(n.end,r),!e.extend&&s>n&&(r=n,n=s,s=r),r=mn(i,s);var o=mn(i,n);r&&o&&(1!==e.rangeCount||e.anchorNode!==r.node||e.anchorOffset!==r.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&((t=t.createRange()).setStart(r.node,r.offset),e.removeAllRanges(),s>n?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}for(t=[],e=i;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"==typeof i.focus&&i.focus(),i=0;i<t.length;i++)(e=t[i]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var yn=y&&"documentMode"in document&&11>=document.documentMode,xn=null,$n=null,Cn=null,Sn=!1;function En(e,t,i){var n=i.window===i?i.document:9===i.nodeType?i:i.ownerDocument;Sn||null==xn||xn!==se(n)||("selectionStart"in(n=xn)&&bn(n)?n={start:n.selectionStart,end:n.selectionEnd}:n={anchorNode:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset},Cn&&fn(Cn,n)||(Cn=n,0<(n=Zn($n,"onSelect")).length&&(t=new vi("onSelect","select",null,t,i),e.push({event:t,listeners:n}),t.target=xn)))}function Pn(e,t){var i={};return i[e.toLowerCase()]=t.toLowerCase(),i["Webkit"+e]="webkit"+t,i["Moz"+e]="moz"+t,i}var kn={animationend:Pn("Animation","AnimationEnd"),animationiteration:Pn("Animation","AnimationIteration"),animationstart:Pn("Animation","AnimationStart"),transitionend:Pn("Transition","TransitionEnd")},Tn={},An={};function Dn(e){if(Tn[e])return Tn[e];if(!kn[e])return e;var t,i=kn[e];for(t in i)if(i.hasOwnProperty(t)&&t in An)return Tn[e]=i[t];return e}y&&(An=document.createElement("div").style,"AnimationEvent"in window||(delete kn.animationend.animation,delete kn.animationiteration.animation,delete kn.animationstart.animation),"TransitionEvent"in window||delete kn.transitionend.transition);var Rn=Dn("animationend"),In=Dn("animationiteration"),Mn=Dn("animationstart"),Ln=Dn("transitionend"),Bn=new Map,Fn="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function On(e,t){Bn.set(e,t),b(t,[e])}for(var zn=0;zn<Fn.length;zn++){var Nn=Fn[zn];On(Nn.toLowerCase(),"on"+(Nn[0].toUpperCase()+Nn.slice(1)))}On(Rn,"onAnimationEnd"),On(In,"onAnimationIteration"),On(Mn,"onAnimationStart"),On("dblclick","onDoubleClick"),On("focusin","onFocus"),On("focusout","onBlur"),On(Ln,"onTransitionEnd"),w("onMouseEnter",["mouseout","mouseover"]),w("onMouseLeave",["mouseout","mouseover"]),w("onPointerEnter",["pointerout","pointerover"]),w("onPointerLeave",["pointerout","pointerover"]),b("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),b("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),b("onBeforeInput",["compositionend","keypress","textInput","paste"]),b("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),b("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),b("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Vn="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Un=new Set("cancel close invalid load scroll toggle".split(" ").concat(Vn));function Hn(e,t,i){var n=e.type||"unknown-event";e.currentTarget=i,function(e,t,i,n,r,s,o,a,l){if(Ze.apply(this,arguments),qe){if(!qe)throw Error(m(198));var c=Ke;qe=!1,Ke=null,Xe||(Xe=!0,Ye=c)}}(n,t,void 0,e),e.currentTarget=null}function jn(e,t){t=0!=(4&t);for(var i=0;i<e.length;i++){var n=e[i],r=n.event;n=n.listeners;e:{var s=void 0;if(t)for(var o=n.length-1;0<=o;o--){var a=n[o],l=a.instance,c=a.currentTarget;if(a=a.listener,l!==s&&r.isPropagationStopped())break e;Hn(r,a,c),s=l}else for(o=0;o<n.length;o++){if(l=(a=n[o]).instance,c=a.currentTarget,a=a.listener,l!==s&&r.isPropagationStopped())break e;Hn(r,a,c),s=l}}}if(Xe)throw e=Ye,Xe=!1,Ye=null,e}function Wn(e,t){var i=t[wr];void 0===i&&(i=t[wr]=new Set);var n=e+"__bubble";i.has(n)||(Xn(t,e,2,!1),i.add(n))}function Gn(e,t,i){var n=0;t&&(n|=4),Xn(i,e,n,t)}var qn="_reactListening"+Math.random().toString(36).slice(2);function Kn(e){if(!e[qn]){e[qn]=!0,_.forEach((function(t){"selectionchange"!==t&&(Un.has(t)||Gn(t,!1,e),Gn(t,!0,e))}));var t=9===e.nodeType?e:e.ownerDocument;null===t||t[qn]||(t[qn]=!0,Gn("selectionchange",!1,t))}}function Xn(e,t,i,n){switch(si(t)){case 1:var r=ei;break;case 4:r=ti;break;default:r=ii}i=r.bind(null,t,i,e),r=void 0,!je||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(r=!0),n?void 0!==r?e.addEventListener(t,i,{capture:!0,passive:r}):e.addEventListener(t,i,!0):void 0!==r?e.addEventListener(t,i,{passive:r}):e.addEventListener(t,i,!1)}function Yn(e,t,i,n,r){var s=n;if(0==(1&t)&&0==(2&t)&&null!==n)e:for(;;){if(null===n)return;var o=n.tag;if(3===o||4===o){var a=n.stateNode.containerInfo;if(a===r||8===a.nodeType&&a.parentNode===r)break;if(4===o)for(o=n.return;null!==o;){var l=o.tag;if((3===l||4===l)&&((l=o.stateNode.containerInfo)===r||8===l.nodeType&&l.parentNode===r))return;o=o.return}for(;null!==a;){if(null===(o=$r(a)))return;if(5===(l=o.tag)||6===l){n=s=o;continue e}a=a.parentNode}}n=n.return}Ue((function(){var n=s,r=Re(i),o=[];e:{var a=Bn.get(e);if(void 0!==a){var l=vi,c=e;switch(e){case"keypress":if(0===di(i))break e;case"keydown":case"keyup":l=Ii;break;case"focusin":c="focus",l=Ci;break;case"focusout":c="blur",l=Ci;break;case"beforeblur":case"afterblur":l=Ci;break;case"click":if(2===i.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=xi;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=$i;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=Li;break;case Rn:case In:case Mn:l=Si;break;case Ln:l=Bi;break;case"scroll":l=wi;break;case"wheel":l=Fi;break;case"copy":case"cut":case"paste":l=Ei;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=Mi}var d=0!=(4&t),h=!d&&"scroll"===e,u=d?null!==a?a+"Capture":null:a;d=[];for(var p,f=n;null!==f;){var g=(p=f).stateNode;if(5===p.tag&&null!==g&&(p=g,null!==u&&(null!=(g=He(f,u))&&d.push(Qn(f,g,p)))),h)break;f=f.return}0<d.length&&(a=new l(a,c,null,i,r),o.push({event:a,listeners:d}))}}if(0==(7&t)){if(l="mouseout"===e||"pointerout"===e,(!(a="mouseover"===e||"pointerover"===e)||i===De||!(c=i.relatedTarget||i.fromElement)||!$r(c)&&!c[br])&&(l||a)&&(a=r.window===r?r:(a=r.ownerDocument)?a.defaultView||a.parentWindow:window,l?(l=n,null!==(c=(c=i.relatedTarget||i.toElement)?$r(c):null)&&(c!==(h=Je(c))||5!==c.tag&&6!==c.tag)&&(c=null)):(l=null,c=n),l!==c)){if(d=xi,g="onMouseLeave",u="onMouseEnter",f="mouse","pointerout"!==e&&"pointerover"!==e||(d=Mi,g="onPointerLeave",u="onPointerEnter",f="pointer"),h=null==l?a:Sr(l),p=null==c?a:Sr(c),(a=new d(g,f+"leave",l,i,r)).target=h,a.relatedTarget=p,g=null,$r(r)===n&&((d=new d(u,f+"enter",c,i,r)).target=p,d.relatedTarget=h,g=d),h=g,l&&c)e:{for(u=c,f=0,p=d=l;p;p=Jn(p))f++;for(p=0,g=u;g;g=Jn(g))p++;for(;0<f-p;)d=Jn(d),f--;for(;0<p-f;)u=Jn(u),p--;for(;f--;){if(d===u||null!==u&&d===u.alternate)break e;d=Jn(d),u=Jn(u)}d=null}else d=null;null!==l&&er(o,a,l,d,!1),null!==c&&null!==h&&er(o,h,c,d,!0)}if("select"===(l=(a=n?Sr(n):window).nodeName&&a.nodeName.toLowerCase())||"input"===l&&"file"===a.type)var m=tn;else if(Xi(a))if(nn)m=un;else{m=dn;var _=cn}else(l=a.nodeName)&&"input"===l.toLowerCase()&&("checkbox"===a.type||"radio"===a.type)&&(m=hn);switch(m&&(m=m(e,n))?Yi(o,m,i,r):(_&&_(e,a,n),"focusout"===e&&(_=a._wrapperState)&&_.controlled&&"number"===a.type&&he(a,"number",a.value)),_=n?Sr(n):window,e){case"focusin":(Xi(_)||"true"===_.contentEditable)&&(xn=_,$n=n,Cn=null);break;case"focusout":Cn=$n=xn=null;break;case"mousedown":Sn=!0;break;case"contextmenu":case"mouseup":case"dragend":Sn=!1,En(o,i,r);break;case"selectionchange":if(yn)break;case"keydown":case"keyup":En(o,i,r)}var v;if(zi)e:{switch(e){case"compositionstart":var b="onCompositionStart";break e;case"compositionend":b="onCompositionEnd";break e;case"compositionupdate":b="onCompositionUpdate";break e}b=void 0}else qi?Wi(e,i)&&(b="onCompositionEnd"):"keydown"===e&&229===i.keyCode&&(b="onCompositionStart");b&&(Ui&&"ko"!==i.locale&&(qi||"onCompositionStart"!==b?"onCompositionEnd"===b&&qi&&(v=ci()):(ai="value"in(oi=r)?oi.value:oi.textContent,qi=!0)),0<(_=Zn(n,b)).length&&(b=new Pi(b,e,null,i,r),o.push({event:b,listeners:_}),v?b.data=v:null!==(v=Gi(i))&&(b.data=v))),(v=Vi?function(e,t){switch(e){case"compositionend":return Gi(t);case"keypress":return 32!==t.which?null:(ji=!0,Hi);case"textInput":return(e=t.data)===Hi&&ji?null:e;default:return null}}(e,i):function(e,t){if(qi)return"compositionend"===e||!zi&&Wi(e,t)?(e=ci(),li=ai=oi=null,qi=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Ui&&"ko"!==t.locale?null:t.data}}(e,i))&&(0<(n=Zn(n,"onBeforeInput")).length&&(r=new Pi("onBeforeInput","beforeinput",null,i,r),o.push({event:r,listeners:n}),r.data=v))}jn(o,t)}))}function Qn(e,t,i){return{instance:e,listener:t,currentTarget:i}}function Zn(e,t){for(var i=t+"Capture",n=[];null!==e;){var r=e,s=r.stateNode;5===r.tag&&null!==s&&(r=s,null!=(s=He(e,i))&&n.unshift(Qn(e,s,r)),null!=(s=He(e,t))&&n.push(Qn(e,s,r))),e=e.return}return n}function Jn(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function er(e,t,i,n,r){for(var s=t._reactName,o=[];null!==i&&i!==n;){var a=i,l=a.alternate,c=a.stateNode;if(null!==l&&l===n)break;5===a.tag&&null!==c&&(a=c,r?null!=(l=He(i,s))&&o.unshift(Qn(i,l,a)):r||null!=(l=He(i,s))&&o.push(Qn(i,l,a))),i=i.return}0!==o.length&&e.push({event:t,listeners:o})}var tr=/\r\n?/g,ir=/\u0000|\uFFFD/g;function nr(e){return("string"==typeof e?e:""+e).replace(tr,"\n").replace(ir,"")}function rr(e,t,i){if(t=nr(t),nr(e)!==t&&i)throw Error(m(425))}function sr(){}var or=null;function ar(e,t){return"textarea"===e||"noscript"===e||"string"==typeof t.children||"number"==typeof t.children||"object"==typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var lr="function"==typeof setTimeout?setTimeout:void 0,cr="function"==typeof clearTimeout?clearTimeout:void 0,dr="function"==typeof Promise?Promise:void 0,hr="function"==typeof queueMicrotask?queueMicrotask:void 0!==dr?function(e){return dr.resolve(null).then(e).catch(ur)}:lr;function ur(e){setTimeout((function(){throw e}))}function pr(e,t){var i=t,n=0;do{var r=i.nextSibling;if(e.removeChild(i),r&&8===r.nodeType)if("/$"===(i=r.data)){if(0===n)return e.removeChild(r),void Zt(t);n--}else"$"!==i&&"$?"!==i&&"$!"!==i||n++;i=r}while(i);Zt(t)}function fr(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function gr(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var i=e.data;if("$"===i||"$!"===i||"$?"===i){if(0===t)return e;t--}else"/$"===i&&t++}e=e.previousSibling}return null}var mr=Math.random().toString(36).slice(2),_r="__reactFiber$"+mr,vr="__reactProps$"+mr,br="__reactContainer$"+mr,wr="__reactEvents$"+mr,yr="__reactListeners$"+mr,xr="__reactHandles$"+mr;function $r(e){var t=e[_r];if(t)return t;for(var i=e.parentNode;i;){if(t=i[br]||i[_r]){if(i=t.alternate,null!==t.child||null!==i&&null!==i.child)for(e=gr(e);null!==e;){if(i=e[_r])return i;e=gr(e)}return t}i=(e=i).parentNode}return null}function Cr(e){return!(e=e[_r]||e[br])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function Sr(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(m(33))}function Er(e){return e[vr]||null}var Pr=[],kr=-1;function Tr(e){return{current:e}}function Ar(e){0>kr||(e.current=Pr[kr],Pr[kr]=null,kr--)}function Dr(e,t){kr++,Pr[kr]=e.current,e.current=t}var Rr={},Ir=Tr(Rr),Mr=Tr(!1),Lr=Rr;function Br(e,t){var i=e.type.contextTypes;if(!i)return Rr;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var r,s={};for(r in i)s[r]=t[r];return n&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=s),s}function Fr(e){return null!=(e=e.childContextTypes)}function Or(){Ar(Mr),Ar(Ir)}function zr(e,t,i){if(Ir.current!==Rr)throw Error(m(168));Dr(Ir,t),Dr(Mr,i)}function Nr(e,t,i){var n=e.stateNode;if(t=t.childContextTypes,"function"!=typeof n.getChildContext)return i;for(var r in n=n.getChildContext())if(!(r in t))throw Error(m(108,ee(e)||"Unknown",r));return K({},i,n)}function Vr(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Rr,Lr=Ir.current,Dr(Ir,e),Dr(Mr,Mr.current),!0}function Ur(e,t,i){var n=e.stateNode;if(!n)throw Error(m(169));i?(e=Nr(e,t,Lr),n.__reactInternalMemoizedMergedChildContext=e,Ar(Mr),Ar(Ir),Dr(Ir,e)):Ar(Mr),Dr(Mr,i)}var Hr=null,jr=!1,Wr=!1;function Gr(e){null===Hr?Hr=[e]:Hr.push(e)}function qr(){if(!Wr&&null!==Hr){Wr=!0;var e=0,t=Tt;try{var i=Hr;for(Tt=1;e<i.length;e++){var n=i[e];do{n=n(!0)}while(null!==n)}Hr=null,jr=!1}catch(t){throw null!==Hr&&(Hr=Hr.slice(e+1)),rt(dt,qr),t}finally{Tt=t,Wr=!1}}return null}var Kr=D.ReactCurrentBatchConfig;function Xr(e,t){if(e&&e.defaultProps){for(var i in t=K({},t),e=e.defaultProps)void 0===t[i]&&(t[i]=e[i]);return t}return t}var Yr=Tr(null),Qr=null,Zr=null,Jr=null;function es(){Jr=Zr=Qr=null}function ts(e){var t=Yr.current;Ar(Yr),e._currentValue=t}function is(e,t,i){for(;null!==e;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==n&&(n.childLanes|=t)):null!==n&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===i)break;e=e.return}}function ns(e,t){Qr=e,Jr=Zr=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!=(e.lanes&t)&&(Sa=!0),e.firstContext=null)}function rs(e){var t=e._currentValue;if(Jr!==e)if(e={context:e,memoizedValue:t,next:null},null===Zr){if(null===Qr)throw Error(m(308));Zr=e,Qr.dependencies={lanes:0,firstContext:e}}else Zr=Zr.next=e;return t}var ss=null,os=!1;function as(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function ls(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function cs(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function ds(e,t){var i=e.updateQueue;null!==i&&(i=i.shared,null!==El&&0!=(1&e.mode)&&0==(2&Sl)?(null===(e=i.interleaved)?(t.next=t,null===ss?ss=[i]:ss.push(i)):(t.next=e.next,e.next=t),i.interleaved=t):(null===(e=i.pending)?t.next=t:(t.next=e.next,e.next=t),i.pending=t))}function hs(e,t,i){if(null!==(t=t.updateQueue)&&(t=t.shared,0!=(4194240&i))){var n=t.lanes;i|=n&=e.pendingLanes,t.lanes=i,kt(e,i)}}function us(e,t){var i=e.updateQueue,n=e.alternate;if(null!==n&&i===(n=n.updateQueue)){var r=null,s=null;if(null!==(i=i.firstBaseUpdate)){do{var o={eventTime:i.eventTime,lane:i.lane,tag:i.tag,payload:i.payload,callback:i.callback,next:null};null===s?r=s=o:s=s.next=o,i=i.next}while(null!==i);null===s?r=s=t:s=s.next=t}else r=s=t;return i={baseState:n.baseState,firstBaseUpdate:r,lastBaseUpdate:s,shared:n.shared,effects:n.effects},void(e.updateQueue=i)}null===(e=i.lastBaseUpdate)?i.firstBaseUpdate=t:e.next=t,i.lastBaseUpdate=t}function ps(e,t,i,n){var r=e.updateQueue;os=!1;var s=r.firstBaseUpdate,o=r.lastBaseUpdate,a=r.shared.pending;if(null!==a){r.shared.pending=null;var l=a,c=l.next;l.next=null,null===o?s=c:o.next=c,o=l;var d=e.alternate;null!==d&&((a=(d=d.updateQueue).lastBaseUpdate)!==o&&(null===a?d.firstBaseUpdate=c:a.next=c,d.lastBaseUpdate=l))}if(null!==s){var h=r.baseState;for(o=0,d=c=l=null,a=s;;){var u=a.lane,p=a.eventTime;if((n&u)===u){null!==d&&(d=d.next={eventTime:p,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var f=e,g=a;switch(u=t,p=i,g.tag){case 1:if("function"==typeof(f=g.payload)){h=f.call(p,h,u);break e}h=f;break e;case 3:f.flags=-65537&f.flags|128;case 0:if(null==(u="function"==typeof(f=g.payload)?f.call(p,h,u):f))break e;h=K({},h,u);break e;case 2:os=!0}}null!==a.callback&&0!==a.lane&&(e.flags|=64,null===(u=r.effects)?r.effects=[a]:u.push(a))}else p={eventTime:p,lane:u,tag:a.tag,payload:a.payload,callback:a.callback,next:null},null===d?(c=d=p,l=h):d=d.next=p,o|=u;if(null===(a=a.next)){if(null===(a=r.shared.pending))break;a=(u=a).next,u.next=null,r.lastBaseUpdate=u,r.shared.pending=null}}if(null===d&&(l=h),r.baseState=l,r.firstBaseUpdate=c,r.lastBaseUpdate=d,null!==(t=r.shared.interleaved)){r=t;do{o|=r.lane,r=r.next}while(r!==t)}else null===s&&(r.shared.lanes=0);Il|=o,e.lanes=o,e.memoizedState=h}}function fs(e,t,i){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var n=e[t],r=n.callback;if(null!==r){if(n.callback=null,n=i,"function"!=typeof r)throw Error(m(191,r));r.call(n)}}}var gs=(new f.Component).refs;function ms(e,t,i,n){i=null==(i=i(n,t=e.memoizedState))?t:K({},t,i),e.memoizedState=i,0===e.lanes&&(e.updateQueue.baseState=i)}var _s={isMounted:function(e){return!!(e=e._reactInternals)&&Je(e)===e},enqueueSetState:function(e,t,i){e=e._reactInternals;var n=Yl(),r=Ql(e),s=cs(n,r);s.payload=t,null!=i&&(s.callback=i),ds(e,s),null!==(t=Zl(e,r,n))&&hs(t,e,r)},enqueueReplaceState:function(e,t,i){e=e._reactInternals;var n=Yl(),r=Ql(e),s=cs(n,r);s.tag=1,s.payload=t,null!=i&&(s.callback=i),ds(e,s),null!==(t=Zl(e,r,n))&&hs(t,e,r)},enqueueForceUpdate:function(e,t){e=e._reactInternals;var i=Yl(),n=Ql(e),r=cs(i,n);r.tag=2,null!=t&&(r.callback=t),ds(e,r),null!==(t=Zl(e,n,i))&&hs(t,e,n)}};function vs(e,t,i,n,r,s,o){return"function"==typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(n,s,o):!t.prototype||!t.prototype.isPureReactComponent||(!fn(i,n)||!fn(r,s))}function bs(e,t,i){var n=!1,r=Rr,s=t.contextType;return"object"==typeof s&&null!==s?s=rs(s):(r=Fr(t)?Lr:Ir.current,s=(n=null!=(n=t.contextTypes))?Br(e,r):Rr),t=new t(i,s),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=_s,e.stateNode=t,t._reactInternals=e,n&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=r,e.__reactInternalMemoizedMaskedChildContext=s),t}function ws(e,t,i,n){e=t.state,"function"==typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(i,n),"function"==typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(i,n),t.state!==e&&_s.enqueueReplaceState(t,t.state,null)}function ys(e,t,i,n){var r=e.stateNode;r.props=i,r.state=e.memoizedState,r.refs=gs,as(e);var s=t.contextType;"object"==typeof s&&null!==s?r.context=rs(s):(s=Fr(t)?Lr:Ir.current,r.context=Br(e,s)),r.state=e.memoizedState,"function"==typeof(s=t.getDerivedStateFromProps)&&(ms(e,t,s,i),r.state=e.memoizedState),"function"==typeof t.getDerivedStateFromProps||"function"==typeof r.getSnapshotBeforeUpdate||"function"!=typeof r.UNSAFE_componentWillMount&&"function"!=typeof r.componentWillMount||(t=r.state,"function"==typeof r.componentWillMount&&r.componentWillMount(),"function"==typeof r.UNSAFE_componentWillMount&&r.UNSAFE_componentWillMount(),t!==r.state&&_s.enqueueReplaceState(r,r.state,null),ps(e,i,r,n),r.state=e.memoizedState),"function"==typeof r.componentDidMount&&(e.flags|=4194308)}var xs=[],$s=0,Cs=null,Ss=0,Es=[],Ps=0,ks=null,Ts=1,As="";function Ds(e,t){xs[$s++]=Ss,xs[$s++]=Cs,Cs=e,Ss=t}function Rs(e,t,i){Es[Ps++]=Ts,Es[Ps++]=As,Es[Ps++]=ks,ks=e;var n=Ts;e=As;var r=32-_t(n)-1;n&=~(1<<r),i+=1;var s=32-_t(t)+r;if(30<s){var o=r-r%5;s=(n&(1<<o)-1).toString(32),n>>=o,r-=o,Ts=1<<32-_t(t)+r|i<<r|n,As=s+e}else Ts=1<<s|i<<r|n,As=e}function Is(e){null!==e.return&&(Ds(e,1),Rs(e,1,0))}function Ms(e){for(;e===Cs;)Cs=xs[--$s],xs[$s]=null,Ss=xs[--$s],xs[$s]=null;for(;e===ks;)ks=Es[--Ps],Es[Ps]=null,As=Es[--Ps],Es[Ps]=null,Ts=Es[--Ps],Es[Ps]=null}var Ls=null,Bs=null,Fs=!1,Os=null;function zs(e,t){var i=kc(5,null,null,0);i.elementType="DELETED",i.stateNode=t,i.return=e,null===(t=e.deletions)?(e.deletions=[i],e.flags|=16):t.push(i)}function Ns(e,t){switch(e.tag){case 5:var i=e.type;return null!==(t=1!==t.nodeType||i.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,Ls=e,Bs=fr(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,Ls=e,Bs=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(i=null!==ks?{id:Ts,overflow:As}:null,e.memoizedState={dehydrated:t,treeContext:i,retryLane:1073741824},(i=kc(18,null,null,0)).stateNode=t,i.return=e,e.child=i,Ls=e,Bs=null,!0);default:return!1}}function Vs(e){return 0!=(1&e.mode)&&0==(128&e.flags)}function Us(e){if(Fs){var t=Bs;if(t){var i=t;if(!Ns(e,t)){if(Vs(e))throw Error(m(418));t=fr(i.nextSibling);var n=Ls;t&&Ns(e,t)?zs(n,i):(e.flags=-4097&e.flags|2,Fs=!1,Ls=e)}}else{if(Vs(e))throw Error(m(418));e.flags=-4097&e.flags|2,Fs=!1,Ls=e}}}function Hs(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;Ls=e}function js(e){if(e!==Ls)return!1;if(!Fs)return Hs(e),Fs=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!ar(e.type,e.memoizedProps)),t&&(t=Bs)){if(Vs(e)){for(e=Bs;e;)e=fr(e.nextSibling);throw Error(m(418))}for(;t;)zs(e,t),t=fr(t.nextSibling)}if(Hs(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(m(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var i=e.data;if("/$"===i){if(0===t){Bs=fr(e.nextSibling);break e}t--}else"$"!==i&&"$!"!==i&&"$?"!==i||t++}e=e.nextSibling}Bs=null}}else Bs=Ls?fr(e.stateNode.nextSibling):null;return!0}function Ws(){Bs=Ls=null,Fs=!1}function Gs(e){null===Os?Os=[e]:Os.push(e)}function qs(e,t,i){if(null!==(e=i.ref)&&"function"!=typeof e&&"object"!=typeof e){if(i._owner){if(i=i._owner){if(1!==i.tag)throw Error(m(309));var n=i.stateNode}if(!n)throw Error(m(147,e));var r=n,s=""+e;return null!==t&&null!==t.ref&&"function"==typeof t.ref&&t.ref._stringRef===s?t.ref:((t=function(e){var t=r.refs;t===gs&&(t=r.refs={}),null===e?delete t[s]:t[s]=e})._stringRef=s,t)}if("string"!=typeof e)throw Error(m(284));if(!i._owner)throw Error(m(290,e))}return e}function Ks(e,t){throw e=Object.prototype.toString.call(t),Error(m(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Xs(e){return(0,e._init)(e._payload)}function Ys(e){function t(t,i){if(e){var n=t.deletions;null===n?(t.deletions=[i],t.flags|=16):n.push(i)}}function i(i,n){if(!e)return null;for(;null!==n;)t(i,n),n=n.sibling;return null}function n(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function r(e,t){return(e=Ac(e,t)).index=0,e.sibling=null,e}function s(t,i,n){return t.index=n,e?null!==(n=t.alternate)?(n=n.index)<i?(t.flags|=2,i):n:(t.flags|=2,i):(t.flags|=1048576,i)}function o(t){return e&&null===t.alternate&&(t.flags|=2),t}function a(e,t,i,n){return null===t||6!==t.tag?((t=Mc(i,e.mode,n)).return=e,t):((t=r(t,i)).return=e,t)}function l(e,t,i,n){var s=i.type;return s===M?d(e,t,i.props.children,n,i.key):null!==t&&(t.elementType===s||"object"==typeof s&&null!==s&&s.$$typeof===H&&Xs(s)===t.type)?((n=r(t,i.props)).ref=qs(e,t,i),n.return=e,n):((n=Dc(i.type,i.key,i.props,null,e.mode,n)).ref=qs(e,t,i),n.return=e,n)}function c(e,t,i,n){return null===t||4!==t.tag||t.stateNode.containerInfo!==i.containerInfo||t.stateNode.implementation!==i.implementation?((t=Lc(i,e.mode,n)).return=e,t):((t=r(t,i.children||[])).return=e,t)}function d(e,t,i,n,s){return null===t||7!==t.tag?((t=Rc(i,e.mode,n,s)).return=e,t):((t=r(t,i)).return=e,t)}function h(e,t,i){if("string"==typeof t&&""!==t||"number"==typeof t)return(t=Mc(""+t,e.mode,i)).return=e,t;if("object"==typeof t&&null!==t){switch(t.$$typeof){case R:return(i=Dc(t.type,t.key,t.props,null,e.mode,i)).ref=qs(e,null,t),i.return=e,i;case I:return(t=Lc(t,e.mode,i)).return=e,t;case H:return h(e,(0,t._init)(t._payload),i)}if(ue(t)||G(t))return(t=Rc(t,e.mode,i,null)).return=e,t;Ks(e,t)}return null}function u(e,t,i,n){var r=null!==t?t.key:null;if("string"==typeof i&&""!==i||"number"==typeof i)return null!==r?null:a(e,t,""+i,n);if("object"==typeof i&&null!==i){switch(i.$$typeof){case R:return i.key===r?l(e,t,i,n):null;case I:return i.key===r?c(e,t,i,n):null;case H:return u(e,t,(r=i._init)(i._payload),n)}if(ue(i)||G(i))return null!==r?null:d(e,t,i,n,null);Ks(e,i)}return null}function p(e,t,i,n,r){if("string"==typeof n&&""!==n||"number"==typeof n)return a(t,e=e.get(i)||null,""+n,r);if("object"==typeof n&&null!==n){switch(n.$$typeof){case R:return l(t,e=e.get(null===n.key?i:n.key)||null,n,r);case I:return c(t,e=e.get(null===n.key?i:n.key)||null,n,r);case H:return p(e,t,i,(0,n._init)(n._payload),r)}if(ue(n)||G(n))return d(t,e=e.get(i)||null,n,r,null);Ks(t,n)}return null}return function a(l,c,d,f){if("object"==typeof d&&null!==d&&d.type===M&&null===d.key&&(d=d.props.children),"object"==typeof d&&null!==d){switch(d.$$typeof){case R:e:{for(var g=d.key,_=c;null!==_;){if(_.key===g){if((g=d.type)===M){if(7===_.tag){i(l,_.sibling),(c=r(_,d.props.children)).return=l,l=c;break e}}else if(_.elementType===g||"object"==typeof g&&null!==g&&g.$$typeof===H&&Xs(g)===_.type){i(l,_.sibling),(c=r(_,d.props)).ref=qs(l,_,d),c.return=l,l=c;break e}i(l,_);break}t(l,_),_=_.sibling}d.type===M?((c=Rc(d.props.children,l.mode,f,d.key)).return=l,l=c):((f=Dc(d.type,d.key,d.props,null,l.mode,f)).ref=qs(l,c,d),f.return=l,l=f)}return o(l);case I:e:{for(_=d.key;null!==c;){if(c.key===_){if(4===c.tag&&c.stateNode.containerInfo===d.containerInfo&&c.stateNode.implementation===d.implementation){i(l,c.sibling),(c=r(c,d.children||[])).return=l,l=c;break e}i(l,c);break}t(l,c),c=c.sibling}(c=Lc(d,l.mode,f)).return=l,l=c}return o(l);case H:return a(l,c,(_=d._init)(d._payload),f)}if(ue(d))return function(r,o,a,l){for(var c=null,d=null,f=o,g=o=0,m=null;null!==f&&g<a.length;g++){f.index>g?(m=f,f=null):m=f.sibling;var _=u(r,f,a[g],l);if(null===_){null===f&&(f=m);break}e&&f&&null===_.alternate&&t(r,f),o=s(_,o,g),null===d?c=_:d.sibling=_,d=_,f=m}if(g===a.length)return i(r,f),Fs&&Ds(r,g),c;if(null===f){for(;g<a.length;g++)null!==(f=h(r,a[g],l))&&(o=s(f,o,g),null===d?c=f:d.sibling=f,d=f);return Fs&&Ds(r,g),c}for(f=n(r,f);g<a.length;g++)null!==(m=p(f,r,g,a[g],l))&&(e&&null!==m.alternate&&f.delete(null===m.key?g:m.key),o=s(m,o,g),null===d?c=m:d.sibling=m,d=m);return e&&f.forEach((function(e){return t(r,e)})),Fs&&Ds(r,g),c}(l,c,d,f);if(G(d))return function(r,o,a,l){var c=G(a);if("function"!=typeof c)throw Error(m(150));if(null==(a=c.call(a)))throw Error(m(151));for(var d=c=null,f=o,g=o=0,_=null,v=a.next();null!==f&&!v.done;g++,v=a.next()){f.index>g?(_=f,f=null):_=f.sibling;var b=u(r,f,v.value,l);if(null===b){null===f&&(f=_);break}e&&f&&null===b.alternate&&t(r,f),o=s(b,o,g),null===d?c=b:d.sibling=b,d=b,f=_}if(v.done)return i(r,f),Fs&&Ds(r,g),c;if(null===f){for(;!v.done;g++,v=a.next())null!==(v=h(r,v.value,l))&&(o=s(v,o,g),null===d?c=v:d.sibling=v,d=v);return Fs&&Ds(r,g),c}for(f=n(r,f);!v.done;g++,v=a.next())null!==(v=p(f,r,g,v.value,l))&&(e&&null!==v.alternate&&f.delete(null===v.key?g:v.key),o=s(v,o,g),null===d?c=v:d.sibling=v,d=v);return e&&f.forEach((function(e){return t(r,e)})),Fs&&Ds(r,g),c}(l,c,d,f);Ks(l,d)}return"string"==typeof d&&""!==d||"number"==typeof d?(d=""+d,null!==c&&6===c.tag?(i(l,c.sibling),(c=r(c,d)).return=l,l=c):(i(l,c),(c=Mc(d,l.mode,f)).return=l,l=c),o(l)):i(l,c)}}var Qs=Ys(!0),Zs=Ys(!1),Js={},eo=Tr(Js),to=Tr(Js),io=Tr(Js);function no(e){if(e===Js)throw Error(m(174));return e}function ro(e,t){switch(Dr(io,t),Dr(to,e),Dr(eo,Js),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:be(null,"");break;default:t=be(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}Ar(eo),Dr(eo,t)}function so(){Ar(eo),Ar(to),Ar(io)}function oo(e){no(io.current);var t=no(eo.current),i=be(t,e.type);t!==i&&(Dr(to,e),Dr(eo,i))}function ao(e){to.current===e&&(Ar(eo),Ar(to))}var lo=Tr(0);function co(e){for(var t=e;null!==t;){if(13===t.tag){var i=t.memoizedState;if(null!==i&&(null===(i=i.dehydrated)||"$?"===i.data||"$!"===i.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!=(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var ho=[];function uo(){for(var e=0;e<ho.length;e++)ho[e]._workInProgressVersionPrimary=null;ho.length=0}var po=D.ReactCurrentDispatcher,fo=D.ReactCurrentBatchConfig,go=0,mo=null,_o=null,vo=null,bo=!1,wo=!1,yo=0,xo=0;function $o(){throw Error(m(321))}function Co(e,t){if(null===t)return!1;for(var i=0;i<t.length&&i<e.length;i++)if(!pn(e[i],t[i]))return!1;return!0}function So(e,t,i,n,r,s){if(go=s,mo=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,po.current=null===e||null===e.memoizedState?aa:la,e=i(n,r),wo){s=0;do{if(wo=!1,yo=0,25<=s)throw Error(m(301));s+=1,vo=_o=null,t.updateQueue=null,po.current=ca,e=i(n,r)}while(wo)}if(po.current=oa,t=null!==_o&&null!==_o.next,go=0,vo=_o=mo=null,bo=!1,t)throw Error(m(300));return e}function Eo(){var e=0!==yo;return yo=0,e}function Po(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===vo?mo.memoizedState=vo=e:vo=vo.next=e,vo}function ko(){if(null===_o){var e=mo.alternate;e=null!==e?e.memoizedState:null}else e=_o.next;var t=null===vo?mo.memoizedState:vo.next;if(null!==t)vo=t,_o=e;else{if(null===e)throw Error(m(310));e={memoizedState:(_o=e).memoizedState,baseState:_o.baseState,baseQueue:_o.baseQueue,queue:_o.queue,next:null},null===vo?mo.memoizedState=vo=e:vo=vo.next=e}return vo}function To(e,t){return"function"==typeof t?t(e):t}function Ao(e){var t=ko(),i=t.queue;if(null===i)throw Error(m(311));i.lastRenderedReducer=e;var n=_o,r=n.baseQueue,s=i.pending;if(null!==s){if(null!==r){var o=r.next;r.next=s.next,s.next=o}n.baseQueue=r=s,i.pending=null}if(null!==r){s=r.next,n=n.baseState;var a=o=null,l=null,c=s;do{var d=c.lane;if((go&d)===d)null!==l&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),n=c.hasEagerState?c.eagerState:e(n,c.action);else{var h={lane:d,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};null===l?(a=l=h,o=n):l=l.next=h,mo.lanes|=d,Il|=d}c=c.next}while(null!==c&&c!==s);null===l?o=n:l.next=a,pn(n,t.memoizedState)||(Sa=!0),t.memoizedState=n,t.baseState=o,t.baseQueue=l,i.lastRenderedState=n}if(null!==(e=i.interleaved)){r=e;do{s=r.lane,mo.lanes|=s,Il|=s,r=r.next}while(r!==e)}else null===r&&(i.lanes=0);return[t.memoizedState,i.dispatch]}function Do(e){var t=ko(),i=t.queue;if(null===i)throw Error(m(311));i.lastRenderedReducer=e;var n=i.dispatch,r=i.pending,s=t.memoizedState;if(null!==r){i.pending=null;var o=r=r.next;do{s=e(s,o.action),o=o.next}while(o!==r);pn(s,t.memoizedState)||(Sa=!0),t.memoizedState=s,null===t.baseQueue&&(t.baseState=s),i.lastRenderedState=s}return[s,n]}function Ro(){}function Io(e,t){var i=mo,n=ko(),r=t(),s=!pn(n.memoizedState,r);if(s&&(n.memoizedState=r,Sa=!0),n=n.queue,jo(Bo.bind(null,i,n,e),[e]),n.getSnapshot!==t||s||null!==vo&&1&vo.memoizedState.tag){if(i.flags|=2048,zo(9,Lo.bind(null,i,n,r,t),void 0,null),null===El)throw Error(m(349));0!=(30&go)||Mo(i,t,r)}return r}function Mo(e,t,i){e.flags|=16384,e={getSnapshot:t,value:i},null===(t=mo.updateQueue)?(t={lastEffect:null,stores:null},mo.updateQueue=t,t.stores=[e]):null===(i=t.stores)?t.stores=[e]:i.push(e)}function Lo(e,t,i,n){t.value=i,t.getSnapshot=n,Fo(t)&&Zl(e,1,-1)}function Bo(e,t,i){return i((function(){Fo(t)&&Zl(e,1,-1)}))}function Fo(e){var t=e.getSnapshot;e=e.value;try{var i=t();return!pn(e,i)}catch(e){return!0}}function Oo(e){var t=Po();return"function"==typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:To,lastRenderedState:e},t.queue=e,e=e.dispatch=ta.bind(null,mo,e),[t.memoizedState,e]}function zo(e,t,i,n){return e={tag:e,create:t,destroy:i,deps:n,next:null},null===(t=mo.updateQueue)?(t={lastEffect:null,stores:null},mo.updateQueue=t,t.lastEffect=e.next=e):null===(i=t.lastEffect)?t.lastEffect=e.next=e:(n=i.next,i.next=e,e.next=n,t.lastEffect=e),e}function No(){return ko().memoizedState}function Vo(e,t,i,n){var r=Po();mo.flags|=e,r.memoizedState=zo(1|t,i,void 0,void 0===n?null:n)}function Uo(e,t,i,n){var r=ko();n=void 0===n?null:n;var s=void 0;if(null!==_o){var o=_o.memoizedState;if(s=o.destroy,null!==n&&Co(n,o.deps))return void(r.memoizedState=zo(t,i,s,n))}mo.flags|=e,r.memoizedState=zo(1|t,i,s,n)}function Ho(e,t){return Vo(8390656,8,e,t)}function jo(e,t){return Uo(2048,8,e,t)}function Wo(e,t){return Uo(4,2,e,t)}function Go(e,t){return Uo(4,4,e,t)}function qo(e,t){return"function"==typeof t?(e=e(),t(e),function(){t(null)}):null!=t?(e=e(),t.current=e,function(){t.current=null}):void 0}function Ko(e,t,i){return i=null!=i?i.concat([e]):null,Uo(4,4,qo.bind(null,t,e),i)}function Xo(){}function Yo(e,t){var i=ko();t=void 0===t?null:t;var n=i.memoizedState;return null!==n&&null!==t&&Co(t,n[1])?n[0]:(i.memoizedState=[e,t],e)}function Qo(e,t){var i=ko();t=void 0===t?null:t;var n=i.memoizedState;return null!==n&&null!==t&&Co(t,n[1])?n[0]:(e=e(),i.memoizedState=[e,t],e)}function Zo(e,t){var i=Tt;Tt=0!==i&&4>i?i:4,e(!0);var n=fo.transition;fo.transition={};try{e(!1),t()}finally{Tt=i,fo.transition=n}}function Jo(){return ko().memoizedState}function ea(e,t,i){var n=Ql(e);i={lane:n,action:i,hasEagerState:!1,eagerState:null,next:null},ia(e)?na(t,i):(ra(e,t,i),null!==(e=Zl(e,n,i=Yl()))&&sa(e,t,n))}function ta(e,t,i){var n=Ql(e),r={lane:n,action:i,hasEagerState:!1,eagerState:null,next:null};if(ia(e))na(t,r);else{ra(e,t,r);var s=e.alternate;if(0===e.lanes&&(null===s||0===s.lanes)&&null!==(s=t.lastRenderedReducer))try{var o=t.lastRenderedState,a=s(o,i);if(r.hasEagerState=!0,r.eagerState=a,pn(a,o))return}catch(e){}null!==(e=Zl(e,n,i=Yl()))&&sa(e,t,n)}}function ia(e){var t=e.alternate;return e===mo||null!==t&&t===mo}function na(e,t){wo=bo=!0;var i=e.pending;null===i?t.next=t:(t.next=i.next,i.next=t),e.pending=t}function ra(e,t,i){null!==El&&0!=(1&e.mode)&&0==(2&Sl)?(null===(e=t.interleaved)?(i.next=i,null===ss?ss=[t]:ss.push(t)):(i.next=e.next,e.next=i),t.interleaved=i):(null===(e=t.pending)?i.next=i:(i.next=e.next,e.next=i),t.pending=i)}function sa(e,t,i){if(0!=(4194240&i)){var n=t.lanes;i|=n&=e.pendingLanes,t.lanes=i,kt(e,i)}}var oa={readContext:rs,useCallback:$o,useContext:$o,useEffect:$o,useImperativeHandle:$o,useInsertionEffect:$o,useLayoutEffect:$o,useMemo:$o,useReducer:$o,useRef:$o,useState:$o,useDebugValue:$o,useDeferredValue:$o,useTransition:$o,useMutableSource:$o,useSyncExternalStore:$o,useId:$o,unstable_isNewReconciler:!1},aa={readContext:rs,useCallback:function(e,t){return Po().memoizedState=[e,void 0===t?null:t],e},useContext:rs,useEffect:Ho,useImperativeHandle:function(e,t,i){return i=null!=i?i.concat([e]):null,Vo(4194308,4,qo.bind(null,t,e),i)},useLayoutEffect:function(e,t){return Vo(4194308,4,e,t)},useInsertionEffect:function(e,t){return Vo(4,2,e,t)},useMemo:function(e,t){var i=Po();return t=void 0===t?null:t,e=e(),i.memoizedState=[e,t],e},useReducer:function(e,t,i){var n=Po();return t=void 0!==i?i(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=ea.bind(null,mo,e),[n.memoizedState,e]},useRef:function(e){return e={current:e},Po().memoizedState=e},useState:Oo,useDebugValue:Xo,useDeferredValue:function(e){var t=Oo(e),i=t[0],n=t[1];return Ho((function(){var t=fo.transition;fo.transition={};try{n(e)}finally{fo.transition=t}}),[e]),i},useTransition:function(){var e=Oo(!1),t=e[0];return e=Zo.bind(null,e[1]),Po().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,i){var n=mo,r=Po();if(Fs){if(void 0===i)throw Error(m(407));i=i()}else{if(i=t(),null===El)throw Error(m(349));0!=(30&go)||Mo(n,t,i)}r.memoizedState=i;var s={value:i,getSnapshot:t};return r.queue=s,Ho(Bo.bind(null,n,s,e),[e]),n.flags|=2048,zo(9,Lo.bind(null,n,s,i,t),void 0,null),i},useId:function(){var e=Po(),t=El.identifierPrefix;if(Fs){var i=As;t=":"+t+"R"+(i=(Ts&~(1<<32-_t(Ts)-1)).toString(32)+i),0<(i=yo++)&&(t+="H"+i.toString(32)),t+=":"}else t=":"+t+"r"+(i=xo++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},la={readContext:rs,useCallback:Yo,useContext:rs,useEffect:jo,useImperativeHandle:Ko,useInsertionEffect:Wo,useLayoutEffect:Go,useMemo:Qo,useReducer:Ao,useRef:No,useState:function(){return Ao(To)},useDebugValue:Xo,useDeferredValue:function(e){var t=Ao(To),i=t[0],n=t[1];return jo((function(){var t=fo.transition;fo.transition={};try{n(e)}finally{fo.transition=t}}),[e]),i},useTransition:function(){return[Ao(To)[0],ko().memoizedState]},useMutableSource:Ro,useSyncExternalStore:Io,useId:Jo,unstable_isNewReconciler:!1},ca={readContext:rs,useCallback:Yo,useContext:rs,useEffect:jo,useImperativeHandle:Ko,useInsertionEffect:Wo,useLayoutEffect:Go,useMemo:Qo,useReducer:Do,useRef:No,useState:function(){return Do(To)},useDebugValue:Xo,useDeferredValue:function(e){var t=Do(To),i=t[0],n=t[1];return jo((function(){var t=fo.transition;fo.transition={};try{n(e)}finally{fo.transition=t}}),[e]),i},useTransition:function(){return[Do(To)[0],ko().memoizedState]},useMutableSource:Ro,useSyncExternalStore:Io,useId:Jo,unstable_isNewReconciler:!1};function da(e,t){try{var i="",n=t;do{i+=Z(n),n=n.return}while(n);var r=i}catch(e){r="\nError generating stack: "+e.message+"\n"+e.stack}return{value:e,source:t,stack:r}}function ha(e,t){try{console.error(t.value)}catch(e){setTimeout((function(){throw e}))}}var ua,pa,fa,ga="function"==typeof WeakMap?WeakMap:Map;function ma(e,t,i){(i=cs(-1,i)).tag=3,i.payload={element:null};var n=t.value;return i.callback=function(){Nl||(Nl=!0,Vl=n),ha(0,t)},i}function _a(e,t,i){(i=cs(-1,i)).tag=3;var n=e.type.getDerivedStateFromError;if("function"==typeof n){var r=t.value;i.payload=function(){return n(r)},i.callback=function(){ha(0,t)}}var s=e.stateNode;return null!==s&&"function"==typeof s.componentDidCatch&&(i.callback=function(){ha(0,t),"function"!=typeof n&&(null===Ul?Ul=new Set([this]):Ul.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),i}function va(e,t,i){var n=e.pingCache;if(null===n){n=e.pingCache=new ga;var r=new Set;n.set(t,r)}else void 0===(r=n.get(t))&&(r=new Set,n.set(t,r));r.has(i)||(r.add(i),e=xc.bind(null,e,t,i),t.then(e,e))}function ba(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function wa(e,t,i,n,r){return 0==(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,i.flags|=131072,i.flags&=-52805,1===i.tag&&(null===i.alternate?i.tag=17:((t=cs(-1,1)).tag=2,ds(i,t))),i.lanes|=1),e):(e.flags|=65536,e.lanes=r,e)}function ya(e,t){if(!Fs)switch(e.tailMode){case"hidden":t=e.tail;for(var i=null;null!==t;)null!==t.alternate&&(i=t),t=t.sibling;null===i?e.tail=null:i.sibling=null;break;case"collapsed":i=e.tail;for(var n=null;null!==i;)null!==i.alternate&&(n=i),i=i.sibling;null===n?t||null===e.tail?e.tail=null:e.tail.sibling=null:n.sibling=null}}function xa(e){var t=null!==e.alternate&&e.alternate.child===e.child,i=0,n=0;if(t)for(var r=e.child;null!==r;)i|=r.lanes|r.childLanes,n|=14680064&r.subtreeFlags,n|=14680064&r.flags,r.return=e,r=r.sibling;else for(r=e.child;null!==r;)i|=r.lanes|r.childLanes,n|=r.subtreeFlags,n|=r.flags,r.return=e,r=r.sibling;return e.subtreeFlags|=n,e.childLanes=i,t}function $a(e,t,i){var n=t.pendingProps;switch(Ms(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return xa(t),null;case 1:case 17:return Fr(t.type)&&Or(),xa(t),null;case 3:return n=t.stateNode,so(),Ar(Mr),Ar(Ir),uo(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),null!==e&&null!==e.child||(js(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0==(256&t.flags)||(t.flags|=1024,null!==Os&&(nc(Os),Os=null))),xa(t),null;case 5:ao(t);var r=no(io.current);if(i=t.type,null!==e&&null!=t.stateNode)pa(e,t,i,n),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(null===t.stateNode)throw Error(m(166));return xa(t),null}if(e=no(eo.current),js(t)){n=t.stateNode,i=t.type;var s=t.memoizedProps;switch(n[_r]=t,n[vr]=s,e=0!=(1&t.mode),i){case"dialog":Wn("cancel",n),Wn("close",n);break;case"iframe":case"object":case"embed":Wn("load",n);break;case"video":case"audio":for(r=0;r<Vn.length;r++)Wn(Vn[r],n);break;case"source":Wn("error",n);break;case"img":case"image":case"link":Wn("error",n),Wn("load",n);break;case"details":Wn("toggle",n);break;case"input":ae(n,s),Wn("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!s.multiple},Wn("invalid",n);break;case"textarea":ge(n,s),Wn("invalid",n)}for(var o in Te(i,s),r=null,s)if(s.hasOwnProperty(o)){var a=s[o];"children"===o?"string"==typeof a?n.textContent!==a&&(rr(n.textContent,a,e),r=["children",a]):"number"==typeof a&&n.textContent!==""+a&&(rr(n.textContent,a,e),r=["children",""+a]):v.hasOwnProperty(o)&&null!=a&&"onScroll"===o&&Wn("scroll",n)}switch(i){case"input":ne(n),de(n,s,!0);break;case"textarea":ne(n),_e(n);break;case"select":case"option":break;default:"function"==typeof s.onClick&&(n.onclick=sr)}n=r,t.updateQueue=n,null!==n&&(t.flags|=4)}else{o=9===r.nodeType?r:r.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=ve(i)),"http://www.w3.org/1999/xhtml"===e?"script"===i?((e=o.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"==typeof n.is?e=o.createElement(i,{is:n.is}):(e=o.createElement(i),"select"===i&&(o=e,n.multiple?o.multiple=!0:n.size&&(o.size=n.size))):e=o.createElementNS(e,i),e[_r]=t,e[vr]=n,ua(e,t),t.stateNode=e;e:{switch(o=Ae(i,n),i){case"dialog":Wn("cancel",e),Wn("close",e),r=n;break;case"iframe":case"object":case"embed":Wn("load",e),r=n;break;case"video":case"audio":for(r=0;r<Vn.length;r++)Wn(Vn[r],e);r=n;break;case"source":Wn("error",e),r=n;break;case"img":case"image":case"link":Wn("error",e),Wn("load",e),r=n;break;case"details":Wn("toggle",e),r=n;break;case"input":ae(e,n),r=oe(e,n),Wn("invalid",e);break;case"option":default:r=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},r=K({},n,{value:void 0}),Wn("invalid",e);break;case"textarea":ge(e,n),r=fe(e,n),Wn("invalid",e)}for(s in Te(i,r),a=r)if(a.hasOwnProperty(s)){var l=a[s];"style"===s?Pe(e,l):"dangerouslySetInnerHTML"===s?null!=(l=l?l.__html:void 0)&&xe(e,l):"children"===s?"string"==typeof l?("textarea"!==i||""!==l)&&$e(e,l):"number"==typeof l&&$e(e,""+l):"suppressContentEditableWarning"!==s&&"suppressHydrationWarning"!==s&&"autoFocus"!==s&&(v.hasOwnProperty(s)?null!=l&&"onScroll"===s&&Wn("scroll",e):null!=l&&A(e,s,l,o))}switch(i){case"input":ne(e),de(e,n,!1);break;case"textarea":ne(e),_e(e);break;case"option":null!=n.value&&e.setAttribute("value",""+te(n.value));break;case"select":e.multiple=!!n.multiple,null!=(s=n.value)?pe(e,!!n.multiple,s,!1):null!=n.defaultValue&&pe(e,!!n.multiple,n.defaultValue,!0);break;default:"function"==typeof r.onClick&&(e.onclick=sr)}switch(i){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return xa(t),null;case 6:if(e&&null!=t.stateNode)fa(0,t,e.memoizedProps,n);else{if("string"!=typeof n&&null===t.stateNode)throw Error(m(166));if(i=no(io.current),no(eo.current),js(t)){if(n=t.stateNode,i=t.memoizedProps,n[_r]=t,(s=n.nodeValue!==i)&&null!==(e=Ls))switch(o=0!=(1&e.mode),e.tag){case 3:rr(n.nodeValue,i,o);break;case 5:!0!==e.memoizedProps[void 0]&&rr(n.nodeValue,i,o)}s&&(t.flags|=4)}else(n=(9===i.nodeType?i:i.ownerDocument).createTextNode(n))[_r]=t,t.stateNode=n}return xa(t),null;case 13:if(Ar(lo),n=t.memoizedState,Fs&&null!==Bs&&0!=(1&t.mode)&&0==(128&t.flags)){for(n=Bs;n;)n=fr(n.nextSibling);return Ws(),t.flags|=98560,t}if(null!==n&&null!==n.dehydrated){if(n=js(t),null===e){if(!n)throw Error(m(318));if(!(n=null!==(n=t.memoizedState)?n.dehydrated:null))throw Error(m(317));n[_r]=t}else Ws(),0==(128&t.flags)&&(t.memoizedState=null),t.flags|=4;return xa(t),null}return null!==Os&&(nc(Os),Os=null),0!=(128&t.flags)?(t.lanes=i,t):(n=null!==n,i=!1,null===e?js(t):i=null!==e.memoizedState,n&&!i&&(t.child.flags|=8192,0!=(1&t.mode)&&(null===e||0!=(1&lo.current)?0===Dl&&(Dl=3):uc())),null!==t.updateQueue&&(t.flags|=4),xa(t),null);case 4:return so(),null===e&&Kn(t.stateNode.containerInfo),xa(t),null;case 10:return ts(t.type._context),xa(t),null;case 19:if(Ar(lo),null===(s=t.memoizedState))return xa(t),null;if(n=0!=(128&t.flags),null===(o=s.rendering))if(n)ya(s,!1);else{if(0!==Dl||null!==e&&0!=(128&e.flags))for(e=t.child;null!==e;){if(null!==(o=co(e))){for(t.flags|=128,ya(s,!1),null!==(n=o.updateQueue)&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=i,i=t.child;null!==i;)e=n,(s=i).flags&=14680066,null===(o=s.alternate)?(s.childLanes=0,s.lanes=e,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,e=o.dependencies,s.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),i=i.sibling;return Dr(lo,1&lo.current|2),t.child}e=e.sibling}null!==s.tail&&lt()>zl&&(t.flags|=128,n=!0,ya(s,!1),t.lanes=4194304)}else{if(!n)if(null!==(e=co(o))){if(t.flags|=128,n=!0,null!==(i=e.updateQueue)&&(t.updateQueue=i,t.flags|=4),ya(s,!0),null===s.tail&&"hidden"===s.tailMode&&!o.alternate&&!Fs)return xa(t),null}else 2*lt()-s.renderingStartTime>zl&&1073741824!==i&&(t.flags|=128,n=!0,ya(s,!1),t.lanes=4194304);s.isBackwards?(o.sibling=t.child,t.child=o):(null!==(i=s.last)?i.sibling=o:t.child=o,s.last=o)}return null!==s.tail?(t=s.tail,s.rendering=t,s.tail=t.sibling,s.renderingStartTime=lt(),t.sibling=null,i=lo.current,Dr(lo,n?1&i|2:1&i),t):(xa(t),null);case 22:case 23:return lc(),n=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==n&&(t.flags|=8192),n&&0!=(1&t.mode)?0!=(1073741824&Tl)&&(xa(t),6&t.subtreeFlags&&(t.flags|=8192)):xa(t),null;case 24:case 25:return null}throw Error(m(156,t.tag))}ua=function(e,t){for(var i=t.child;null!==i;){if(5===i.tag||6===i.tag)e.appendChild(i.stateNode);else if(4!==i.tag&&null!==i.child){i.child.return=i,i=i.child;continue}if(i===t)break;for(;null===i.sibling;){if(null===i.return||i.return===t)return;i=i.return}i.sibling.return=i.return,i=i.sibling}},pa=function(e,t,i,n){var r=e.memoizedProps;if(r!==n){e=t.stateNode,no(eo.current);var s,o=null;switch(i){case"input":r=oe(e,r),n=oe(e,n),o=[];break;case"select":r=K({},r,{value:void 0}),n=K({},n,{value:void 0}),o=[];break;case"textarea":r=fe(e,r),n=fe(e,n),o=[];break;default:"function"!=typeof r.onClick&&"function"==typeof n.onClick&&(e.onclick=sr)}for(c in Te(i,n),i=null,r)if(!n.hasOwnProperty(c)&&r.hasOwnProperty(c)&&null!=r[c])if("style"===c){var a=r[c];for(s in a)a.hasOwnProperty(s)&&(i||(i={}),i[s]="")}else"dangerouslySetInnerHTML"!==c&&"children"!==c&&"suppressContentEditableWarning"!==c&&"suppressHydrationWarning"!==c&&"autoFocus"!==c&&(v.hasOwnProperty(c)?o||(o=[]):(o=o||[]).push(c,null));for(c in n){var l=n[c];if(a=null!=r?r[c]:void 0,n.hasOwnProperty(c)&&l!==a&&(null!=l||null!=a))if("style"===c)if(a){for(s in a)!a.hasOwnProperty(s)||l&&l.hasOwnProperty(s)||(i||(i={}),i[s]="");for(s in l)l.hasOwnProperty(s)&&a[s]!==l[s]&&(i||(i={}),i[s]=l[s])}else i||(o||(o=[]),o.push(c,i)),i=l;else"dangerouslySetInnerHTML"===c?(l=l?l.__html:void 0,a=a?a.__html:void 0,null!=l&&a!==l&&(o=o||[]).push(c,l)):"children"===c?"string"!=typeof l&&"number"!=typeof l||(o=o||[]).push(c,""+l):"suppressContentEditableWarning"!==c&&"suppressHydrationWarning"!==c&&(v.hasOwnProperty(c)?(null!=l&&"onScroll"===c&&Wn("scroll",e),o||a===l||(o=[])):(o=o||[]).push(c,l))}i&&(o=o||[]).push("style",i);var c=o;(t.updateQueue=c)&&(t.flags|=4)}},fa=function(e,t,i,n){i!==n&&(t.flags|=4)};var Ca=D.ReactCurrentOwner,Sa=!1;function Ea(e,t,i,n){t.child=null===e?Zs(t,null,i,n):Qs(t,e.child,i,n)}function Pa(e,t,i,n,r){i=i.render;var s=t.ref;return ns(t,r),n=So(e,t,i,n,s,r),i=Eo(),null===e||Sa?(Fs&&i&&Is(t),t.flags|=1,Ea(e,t,n,r),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~r,qa(e,t,r))}function ka(e,t,i,n,r){if(null===e){var s=i.type;return"function"!=typeof s||Tc(s)||void 0!==s.defaultProps||null!==i.compare||void 0!==i.defaultProps?((e=Dc(i.type,null,n,t,t.mode,r)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=s,Ta(e,t,s,n,r))}if(s=e.child,0==(e.lanes&r)){var o=s.memoizedProps;if((i=null!==(i=i.compare)?i:fn)(o,n)&&e.ref===t.ref)return qa(e,t,r)}return t.flags|=1,(e=Ac(s,n)).ref=t.ref,e.return=t,t.child=e}function Ta(e,t,i,n,r){if(null!==e&&fn(e.memoizedProps,n)&&e.ref===t.ref){if(Sa=!1,0==(e.lanes&r))return t.lanes=e.lanes,qa(e,t,r);0!=(131072&e.flags)&&(Sa=!0)}return Ra(e,t,i,n,r)}function Aa(e,t,i){var n=t.pendingProps,r=n.children,s=null!==e?e.memoizedState:null;if("hidden"===n.mode)if(0==(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null},Dr(Al,Tl),Tl|=i;else{if(0==(1073741824&i))return e=null!==s?s.baseLanes|i:i,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null},t.updateQueue=null,Dr(Al,Tl),Tl|=e,null;t.memoizedState={baseLanes:0,cachePool:null},n=null!==s?s.baseLanes:i,Dr(Al,Tl),Tl|=n}else null!==s?(n=s.baseLanes|i,t.memoizedState=null):n=i,Dr(Al,Tl),Tl|=n;return Ea(e,t,r,i),t.child}function Da(e,t){var i=t.ref;(null===e&&null!==i||null!==e&&e.ref!==i)&&(t.flags|=512,t.flags|=2097152)}function Ra(e,t,i,n,r){var s=Fr(i)?Lr:Ir.current;return s=Br(t,s),ns(t,r),i=So(e,t,i,n,s,r),n=Eo(),null===e||Sa?(Fs&&n&&Is(t),t.flags|=1,Ea(e,t,i,r),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~r,qa(e,t,r))}function Ia(e,t,i,n,r){if(Fr(i)){var s=!0;Vr(t)}else s=!1;if(ns(t,r),null===t.stateNode)null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),bs(t,i,n),ys(t,i,n,r),n=!0;else if(null===e){var o=t.stateNode,a=t.memoizedProps;o.props=a;var l=o.context,c=i.contextType;"object"==typeof c&&null!==c?c=rs(c):c=Br(t,c=Fr(i)?Lr:Ir.current);var d=i.getDerivedStateFromProps,h="function"==typeof d||"function"==typeof o.getSnapshotBeforeUpdate;h||"function"!=typeof o.UNSAFE_componentWillReceiveProps&&"function"!=typeof o.componentWillReceiveProps||(a!==n||l!==c)&&ws(t,o,n,c),os=!1;var u=t.memoizedState;o.state=u,ps(t,n,o,r),l=t.memoizedState,a!==n||u!==l||Mr.current||os?("function"==typeof d&&(ms(t,i,d,n),l=t.memoizedState),(a=os||vs(t,i,a,n,u,l,c))?(h||"function"!=typeof o.UNSAFE_componentWillMount&&"function"!=typeof o.componentWillMount||("function"==typeof o.componentWillMount&&o.componentWillMount(),"function"==typeof o.UNSAFE_componentWillMount&&o.UNSAFE_componentWillMount()),"function"==typeof o.componentDidMount&&(t.flags|=4194308)):("function"==typeof o.componentDidMount&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=l),o.props=n,o.state=l,o.context=c,n=a):("function"==typeof o.componentDidMount&&(t.flags|=4194308),n=!1)}else{o=t.stateNode,ls(e,t),a=t.memoizedProps,c=t.type===t.elementType?a:Xr(t.type,a),o.props=c,h=t.pendingProps,u=o.context,"object"==typeof(l=i.contextType)&&null!==l?l=rs(l):l=Br(t,l=Fr(i)?Lr:Ir.current);var p=i.getDerivedStateFromProps;(d="function"==typeof p||"function"==typeof o.getSnapshotBeforeUpdate)||"function"!=typeof o.UNSAFE_componentWillReceiveProps&&"function"!=typeof o.componentWillReceiveProps||(a!==h||u!==l)&&ws(t,o,n,l),os=!1,u=t.memoizedState,o.state=u,ps(t,n,o,r);var f=t.memoizedState;a!==h||u!==f||Mr.current||os?("function"==typeof p&&(ms(t,i,p,n),f=t.memoizedState),(c=os||vs(t,i,c,n,u,f,l)||!1)?(d||"function"!=typeof o.UNSAFE_componentWillUpdate&&"function"!=typeof o.componentWillUpdate||("function"==typeof o.componentWillUpdate&&o.componentWillUpdate(n,f,l),"function"==typeof o.UNSAFE_componentWillUpdate&&o.UNSAFE_componentWillUpdate(n,f,l)),"function"==typeof o.componentDidUpdate&&(t.flags|=4),"function"==typeof o.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!=typeof o.componentDidUpdate||a===e.memoizedProps&&u===e.memoizedState||(t.flags|=4),"function"!=typeof o.getSnapshotBeforeUpdate||a===e.memoizedProps&&u===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=f),o.props=n,o.state=f,o.context=l,n=c):("function"!=typeof o.componentDidUpdate||a===e.memoizedProps&&u===e.memoizedState||(t.flags|=4),"function"!=typeof o.getSnapshotBeforeUpdate||a===e.memoizedProps&&u===e.memoizedState||(t.flags|=1024),n=!1)}return Ma(e,t,i,n,s,r)}function Ma(e,t,i,n,r,s){Da(e,t);var o=0!=(128&t.flags);if(!n&&!o)return r&&Ur(t,i,!1),qa(e,t,s);n=t.stateNode,Ca.current=t;var a=o&&"function"!=typeof i.getDerivedStateFromError?null:n.render();return t.flags|=1,null!==e&&o?(t.child=Qs(t,e.child,null,s),t.child=Qs(t,null,a,s)):Ea(e,t,a,s),t.memoizedState=n.state,r&&Ur(t,i,!0),t.child}function La(e){var t=e.stateNode;t.pendingContext?zr(0,t.pendingContext,t.pendingContext!==t.context):t.context&&zr(0,t.context,!1),ro(e,t.containerInfo)}function Ba(e,t,i,n,r){return Ws(),Gs(r),t.flags|=256,Ea(e,t,i,n),t.child}var Fa={dehydrated:null,treeContext:null,retryLane:0};function Oa(e){return{baseLanes:e,cachePool:null}}function za(e,t,i){var n,r=t.pendingProps,s=lo.current,o=!1,a=0!=(128&t.flags);if((n=a)||(n=(null===e||null!==e.memoizedState)&&0!=(2&s)),n?(o=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(s|=1),Dr(lo,1&s),null===e)return Us(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0==(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(s=r.children,e=r.fallback,o?(r=t.mode,o=t.child,s={mode:"hidden",children:s},0==(1&r)&&null!==o?(o.childLanes=0,o.pendingProps=s):o=Ic(s,r,0,null),e=Rc(e,r,i,null),o.return=t,e.return=t,o.sibling=e,t.child=o,t.child.memoizedState=Oa(i),t.memoizedState=Fa,e):Na(t,s));if(null!==(s=e.memoizedState)){if(null!==(n=s.dehydrated)){if(a)return 256&t.flags?(t.flags&=-257,Ha(e,t,i,Error(m(422)))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(o=r.fallback,s=t.mode,r=Ic({mode:"visible",children:r.children},s,0,null),(o=Rc(o,s,i,null)).flags|=2,r.return=t,o.return=t,r.sibling=o,t.child=r,0!=(1&t.mode)&&Qs(t,e.child,null,i),t.child.memoizedState=Oa(i),t.memoizedState=Fa,o);if(0==(1&t.mode))t=Ha(e,t,i,null);else if("$!"===n.data)t=Ha(e,t,i,Error(m(419)));else if(r=0!=(i&e.childLanes),Sa||r){if(null!==(r=El)){switch(i&-i){case 4:o=2;break;case 16:o=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:o=32;break;case 536870912:o=268435456;break;default:o=0}0!==(r=0!=(o&(r.suspendedLanes|i))?0:o)&&r!==s.retryLane&&(s.retryLane=r,Zl(e,r,-1))}uc(),t=Ha(e,t,i,Error(m(421)))}else"$?"===n.data?(t.flags|=128,t.child=e.child,t=Cc.bind(null,e),n._reactRetry=t,t=null):(i=s.treeContext,Bs=fr(n.nextSibling),Ls=t,Fs=!0,Os=null,null!==i&&(Es[Ps++]=Ts,Es[Ps++]=As,Es[Ps++]=ks,Ts=i.id,As=i.overflow,ks=t),(t=Na(t,t.pendingProps.children)).flags|=4096);return t}return o?(r=Ua(e,t,r.children,r.fallback,i),o=t.child,s=e.child.memoizedState,o.memoizedState=null===s?Oa(i):{baseLanes:s.baseLanes|i,cachePool:null},o.childLanes=e.childLanes&~i,t.memoizedState=Fa,r):(i=Va(e,t,r.children,i),t.memoizedState=null,i)}return o?(r=Ua(e,t,r.children,r.fallback,i),o=t.child,s=e.child.memoizedState,o.memoizedState=null===s?Oa(i):{baseLanes:s.baseLanes|i,cachePool:null},o.childLanes=e.childLanes&~i,t.memoizedState=Fa,r):(i=Va(e,t,r.children,i),t.memoizedState=null,i)}function Na(e,t){return(t=Ic({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function Va(e,t,i,n){var r=e.child;return e=r.sibling,i=Ac(r,{mode:"visible",children:i}),0==(1&t.mode)&&(i.lanes=n),i.return=t,i.sibling=null,null!==e&&(null===(n=t.deletions)?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=i}function Ua(e,t,i,n,r){var s=t.mode,o=(e=e.child).sibling,a={mode:"hidden",children:i};return 0==(1&s)&&t.child!==e?((i=t.child).childLanes=0,i.pendingProps=a,t.deletions=null):(i=Ac(e,a)).subtreeFlags=14680064&e.subtreeFlags,null!==o?n=Ac(o,n):(n=Rc(n,s,r,null)).flags|=2,n.return=t,i.return=t,i.sibling=n,t.child=i,n}function Ha(e,t,i,n){return null!==n&&Gs(n),Qs(t,e.child,null,i),(e=Na(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function ja(e,t,i){e.lanes|=t;var n=e.alternate;null!==n&&(n.lanes|=t),is(e.return,t,i)}function Wa(e,t,i,n,r){var s=e.memoizedState;null===s?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:i,tailMode:r}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=n,s.tail=i,s.tailMode=r)}function Ga(e,t,i){var n=t.pendingProps,r=n.revealOrder,s=n.tail;if(Ea(e,t,n.children,i),0!=(2&(n=lo.current)))n=1&n|2,t.flags|=128;else{if(null!==e&&0!=(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&ja(e,i,t);else if(19===e.tag)ja(e,i,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(Dr(lo,n),0==(1&t.mode))t.memoizedState=null;else switch(r){case"forwards":for(i=t.child,r=null;null!==i;)null!==(e=i.alternate)&&null===co(e)&&(r=i),i=i.sibling;null===(i=r)?(r=t.child,t.child=null):(r=i.sibling,i.sibling=null),Wa(t,!1,r,i,s);break;case"backwards":for(i=null,r=t.child,t.child=null;null!==r;){if(null!==(e=r.alternate)&&null===co(e)){t.child=r;break}e=r.sibling,r.sibling=i,i=r,r=e}Wa(t,!0,i,null,s);break;case"together":Wa(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function qa(e,t,i){if(null!==e&&(t.dependencies=e.dependencies),Il|=t.lanes,0==(i&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(m(153));if(null!==t.child){for(i=Ac(e=t.child,e.pendingProps),t.child=i,i.return=t;null!==e.sibling;)e=e.sibling,(i=i.sibling=Ac(e,e.pendingProps)).return=t;i.sibling=null}return t.child}function Ka(e,t){switch(Ms(t),t.tag){case 1:return Fr(t.type)&&Or(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return so(),Ar(Mr),Ar(Ir),uo(),0!=(65536&(e=t.flags))&&0==(128&e)?(t.flags=-65537&e|128,t):null;case 5:return ao(t),null;case 13:if(Ar(lo),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(m(340));Ws()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return Ar(lo),null;case 4:return so(),null;case 10:return ts(t.type._context),null;case 22:case 23:return lc(),null;default:return null}}var Xa=!1,Ya=!1,Qa="function"==typeof WeakSet?WeakSet:Set,Za=null;function Ja(e,t){var i=e.ref;if(null!==i)if("function"==typeof i)try{i(null)}catch(i){yc(e,t,i)}else i.current=null}function el(e,t,i){try{i()}catch(i){yc(e,t,i)}}var tl=!1;function il(e,t,i){var n=t.updateQueue;if(null!==(n=null!==n?n.lastEffect:null)){var r=n=n.next;do{if((r.tag&e)===e){var s=r.destroy;r.destroy=void 0,void 0!==s&&el(t,i,s)}r=r.next}while(r!==n)}}function nl(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var i=t=t.next;do{if((i.tag&e)===e){var n=i.create;i.destroy=n()}i=i.next}while(i!==t)}}function rl(e){var t=e.ref;if(null!==t){var i=e.stateNode;e.tag,e=i,"function"==typeof t?t(e):t.current=e}}function sl(e,t,i){if(mt&&"function"==typeof mt.onCommitFiberUnmount)try{mt.onCommitFiberUnmount(gt,t)}catch(e){}switch(t.tag){case 0:case 11:case 14:case 15:if(null!==(e=t.updateQueue)&&null!==(e=e.lastEffect)){var n=e=e.next;do{var r=n,s=r.destroy;r=r.tag,void 0!==s&&(0!=(2&r)||0!=(4&r))&&el(t,i,s),n=n.next}while(n!==e)}break;case 1:if(Ja(t,i),"function"==typeof(e=t.stateNode).componentWillUnmount)try{e.props=t.memoizedProps,e.state=t.memoizedState,e.componentWillUnmount()}catch(e){yc(t,i,e)}break;case 5:Ja(t,i);break;case 4:ul(e,t,i)}}function ol(e){var t=e.alternate;null!==t&&(e.alternate=null,ol(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[_r],delete t[vr],delete t[wr],delete t[yr],delete t[xr])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function al(e){return 5===e.tag||3===e.tag||4===e.tag}function ll(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||al(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function cl(e){e:{for(var t=e.return;null!==t;){if(al(t))break e;t=t.return}throw Error(m(160))}var i=t;switch(i.tag){case 5:t=i.stateNode,32&i.flags&&($e(t,""),i.flags&=-33),hl(e,i=ll(e),t);break;case 3:case 4:t=i.stateNode.containerInfo,dl(e,i=ll(e),t);break;default:throw Error(m(161))}}function dl(e,t,i){var n=e.tag;if(5===n||6===n)e=e.stateNode,t?8===i.nodeType?i.parentNode.insertBefore(e,t):i.insertBefore(e,t):(8===i.nodeType?(t=i.parentNode).insertBefore(e,i):(t=i).appendChild(e),null!=(i=i._reactRootContainer)||null!==t.onclick||(t.onclick=sr));else if(4!==n&&null!==(e=e.child))for(dl(e,t,i),e=e.sibling;null!==e;)dl(e,t,i),e=e.sibling}function hl(e,t,i){var n=e.tag;if(5===n||6===n)e=e.stateNode,t?i.insertBefore(e,t):i.appendChild(e);else if(4!==n&&null!==(e=e.child))for(hl(e,t,i),e=e.sibling;null!==e;)hl(e,t,i),e=e.sibling}function ul(e,t,i){for(var n,r,s=t,o=!1;;){if(!o){o=s.return;e:for(;;){if(null===o)throw Error(m(160));switch(n=o.stateNode,o.tag){case 5:r=!1;break e;case 3:case 4:n=n.containerInfo,r=!0;break e}o=o.return}o=!0}if(5===s.tag||6===s.tag){e:for(var a=e,l=s,c=i,d=l;;)if(sl(a,d,c),null!==d.child&&4!==d.tag)d.child.return=d,d=d.child;else{if(d===l)break e;for(;null===d.sibling;){if(null===d.return||d.return===l)break e;d=d.return}d.sibling.return=d.return,d=d.sibling}r?(a=n,l=s.stateNode,8===a.nodeType?a.parentNode.removeChild(l):a.removeChild(l)):n.removeChild(s.stateNode)}else if(18===s.tag)r?(a=n,l=s.stateNode,8===a.nodeType?pr(a.parentNode,l):1===a.nodeType&&pr(a,l),Zt(a)):pr(n,s.stateNode);else if(4===s.tag){if(null!==s.child){n=s.stateNode.containerInfo,r=!0,s.child.return=s,s=s.child;continue}}else if(sl(e,s,i),null!==s.child){s.child.return=s,s=s.child;continue}if(s===t)break;for(;null===s.sibling;){if(null===s.return||s.return===t)return;4===(s=s.return).tag&&(o=!1)}s.sibling.return=s.return,s=s.sibling}}function pl(e,t){switch(t.tag){case 0:case 11:case 14:case 15:return il(3,t,t.return),nl(3,t),void il(5,t,t.return);case 1:case 12:case 17:return;case 5:var i=t.stateNode;if(null!=i){var n=t.memoizedProps,r=null!==e?e.memoizedProps:n;e=t.type;var s=t.updateQueue;if(t.updateQueue=null,null!==s){for("input"===e&&"radio"===n.type&&null!=n.name&&le(i,n),Ae(e,r),t=Ae(e,n),r=0;r<s.length;r+=2){var o=s[r],a=s[r+1];"style"===o?Pe(i,a):"dangerouslySetInnerHTML"===o?xe(i,a):"children"===o?$e(i,a):A(i,o,a,t)}switch(e){case"input":ce(i,n);break;case"textarea":me(i,n);break;case"select":e=i._wrapperState.wasMultiple,i._wrapperState.wasMultiple=!!n.multiple,null!=(s=n.value)?pe(i,!!n.multiple,s,!1):e!==!!n.multiple&&(null!=n.defaultValue?pe(i,!!n.multiple,n.defaultValue,!0):pe(i,!!n.multiple,n.multiple?[]:"",!1))}i[vr]=n}}return;case 6:if(null===t.stateNode)throw Error(m(162));return void(t.stateNode.nodeValue=t.memoizedProps);case 3:return void(null!==e&&e.memoizedState.isDehydrated&&Zt(t.stateNode.containerInfo));case 13:case 19:return void fl(t)}throw Error(m(163))}function fl(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var i=e.stateNode;null===i&&(i=e.stateNode=new Qa),t.forEach((function(t){var n=Sc.bind(null,e,t);i.has(t)||(i.add(t),t.then(n,n))}))}}function gl(e,t,i){Za=e,ml(e,t,i)}function ml(e,t,i){for(var n=0!=(1&e.mode);null!==Za;){var r=Za,s=r.child;if(22===r.tag&&n){var o=null!==r.memoizedState||Xa;if(!o){var a=r.alternate,l=null!==a&&null!==a.memoizedState||Ya;a=Xa;var c=Ya;if(Xa=o,(Ya=l)&&!c)for(Za=r;null!==Za;)l=(o=Za).child,22===o.tag&&null!==o.memoizedState?bl(r):null!==l?(l.return=o,Za=l):bl(r);for(;null!==s;)Za=s,ml(s,t,i),s=s.sibling;Za=r,Xa=a,Ya=c}_l(e)}else 0!=(8772&r.subtreeFlags)&&null!==s?(s.return=r,Za=s):_l(e)}}function _l(e){for(;null!==Za;){var t=Za;if(0!=(8772&t.flags)){var i=t.alternate;try{if(0!=(8772&t.flags))switch(t.tag){case 0:case 11:case 15:Ya||nl(5,t);break;case 1:var n=t.stateNode;if(4&t.flags&&!Ya)if(null===i)n.componentDidMount();else{var r=t.elementType===t.type?i.memoizedProps:Xr(t.type,i.memoizedProps);n.componentDidUpdate(r,i.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var s=t.updateQueue;null!==s&&fs(t,s,n);break;case 3:var o=t.updateQueue;if(null!==o){if(i=null,null!==t.child)switch(t.child.tag){case 5:case 1:i=t.child.stateNode}fs(t,o,i)}break;case 5:var a=t.stateNode;if(null===i&&4&t.flags){i=a;var l=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&i.focus();break;case"img":l.src&&(i.src=l.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:break;case 13:if(null===t.memoizedState){var c=t.alternate;if(null!==c){var d=c.memoizedState;if(null!==d){var h=d.dehydrated;null!==h&&Zt(h)}}}break;default:throw Error(m(163))}Ya||512&t.flags&&rl(t)}catch(e){yc(t,t.return,e)}}if(t===e){Za=null;break}if(null!==(i=t.sibling)){i.return=t.return,Za=i;break}Za=t.return}}function vl(e){for(;null!==Za;){var t=Za;if(t===e){Za=null;break}var i=t.sibling;if(null!==i){i.return=t.return,Za=i;break}Za=t.return}}function bl(e){for(;null!==Za;){var t=Za;try{switch(t.tag){case 0:case 11:case 15:var i=t.return;try{nl(4,t)}catch(e){yc(t,i,e)}break;case 1:var n=t.stateNode;if("function"==typeof n.componentDidMount){var r=t.return;try{n.componentDidMount()}catch(e){yc(t,r,e)}}var s=t.return;try{rl(t)}catch(e){yc(t,s,e)}break;case 5:var o=t.return;try{rl(t)}catch(e){yc(t,o,e)}}}catch(e){yc(t,t.return,e)}if(t===e){Za=null;break}var a=t.sibling;if(null!==a){a.return=t.return,Za=a;break}Za=t.return}}var wl,yl=Math.ceil,xl=D.ReactCurrentDispatcher,$l=D.ReactCurrentOwner,Cl=D.ReactCurrentBatchConfig,Sl=0,El=null,Pl=null,kl=0,Tl=0,Al=Tr(0),Dl=0,Rl=null,Il=0,Ml=0,Ll=0,Bl=null,Fl=null,Ol=0,zl=1/0,Nl=!1,Vl=null,Ul=null,Hl=!1,jl=null,Wl=0,Gl=0,ql=null,Kl=-1,Xl=0;function Yl(){return 0!=(6&Sl)?lt():-1!==Kl?Kl:Kl=lt()}function Ql(e){return 0==(1&e.mode)?1:0!=(2&Sl)&&0!==kl?kl&-kl:null!==Kr.transition?(0===Xl&&(e=wt,0==(4194240&(wt<<=1))&&(wt=64),Xl=e),Xl):0!==(e=Tt)?e:e=void 0===(e=window.event)?16:si(e.type)}function Zl(e,t,i){if(50<Gl)throw Gl=0,ql=null,Error(m(185));var n=Jl(e,t);return null===n?null:(Pt(n,t,i),0!=(2&Sl)&&n===El||(n===El&&(0==(2&Sl)&&(Ml|=t),4===Dl&&rc(n,kl)),ec(n,i),1===t&&0===Sl&&0==(1&e.mode)&&(zl=lt()+500,jr&&qr())),n)}function Jl(e,t){e.lanes|=t;var i=e.alternate;for(null!==i&&(i.lanes|=t),i=e,e=e.return;null!==e;)e.childLanes|=t,null!==(i=e.alternate)&&(i.childLanes|=t),i=e,e=e.return;return 3===i.tag?i.stateNode:null}function ec(e,t){var i=e.callbackNode;!function(e,t){for(var i=e.suspendedLanes,n=e.pingedLanes,r=e.expirationTimes,s=e.pendingLanes;0<s;){var o=31-_t(s),a=1<<o,l=r[o];-1===l?0!=(a&i)&&0==(a&n)||(r[o]=Ct(a,t)):l<=t&&(e.expiredLanes|=a),s&=~a}}(e,t);var n,r=$t(e,e===El?kl:0);if(0===r)null!==i&&st(i),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(null!=i&&st(i),1===t)0===e.tag?(n=sc.bind(null,e),jr=!0,Gr(n)):Gr(sc.bind(null,e)),hr((function(){0===Sl&&qr()})),i=null;else{switch(At(r)){case 1:i=dt;break;case 4:i=ht;break;case 16:default:i=ut;break;case 536870912:i=ft}i=Ec(i,tc.bind(null,e))}e.callbackPriority=t,e.callbackNode=i}}function tc(e,t){if(Kl=-1,Xl=0,0!=(6&Sl))throw Error(m(327));var i=e.callbackNode;if(bc()&&e.callbackNode!==i)return null;var n=$t(e,e===El?kl:0);if(0===n)return null;if(0!=(30&n)||0!=(n&e.expiredLanes)||t)t=pc(e,n);else{t=n;var r=Sl;Sl|=2;var s=hc();for(El===e&&kl===t||(zl=lt()+500,cc(e,t));;)try{gc();break}catch(t){dc(e,t)}es(),xl.current=s,Sl=r,null!==Pl?t=0:(El=null,kl=0,t=Dl)}if(0!==t){if(2===t&&(0!==(r=St(e))&&(n=r,t=ic(e,r))),1===t)throw i=Rl,cc(e,0),rc(e,n),ec(e,lt()),i;if(6===t)rc(e,n);else{if(r=e.current.alternate,0==(30&n)&&!function(e){for(var t=e;;){if(16384&t.flags){var i=t.updateQueue;if(null!==i&&null!==(i=i.stores))for(var n=0;n<i.length;n++){var r=i[n],s=r.getSnapshot;r=r.value;try{if(!pn(s(),r))return!1}catch(e){return!1}}}if(i=t.child,16384&t.subtreeFlags&&null!==i)i.return=t,t=i;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(r)&&(2===(t=pc(e,n))&&(0!==(s=St(e))&&(n=s,t=ic(e,s))),1===t))throw i=Rl,cc(e,0),rc(e,n),ec(e,lt()),i;switch(e.finishedWork=r,e.finishedLanes=n,t){case 0:case 1:throw Error(m(345));case 2:case 5:vc(e,Fl);break;case 3:if(rc(e,n),(130023424&n)===n&&10<(t=Ol+500-lt())){if(0!==$t(e,0))break;if(((r=e.suspendedLanes)&n)!==n){Yl(),e.pingedLanes|=e.suspendedLanes&r;break}e.timeoutHandle=lr(vc.bind(null,e,Fl),t);break}vc(e,Fl);break;case 4:if(rc(e,n),(4194240&n)===n)break;for(t=e.eventTimes,r=-1;0<n;){var o=31-_t(n);s=1<<o,(o=t[o])>r&&(r=o),n&=~s}if(n=r,10<(n=(120>(n=lt()-n)?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*yl(n/1960))-n)){e.timeoutHandle=lr(vc.bind(null,e,Fl),n);break}vc(e,Fl);break;default:throw Error(m(329))}}}return ec(e,lt()),e.callbackNode===i?tc.bind(null,e):null}function ic(e,t){var i=Bl;return e.current.memoizedState.isDehydrated&&(cc(e,t).flags|=256),2!==(e=pc(e,t))&&(t=Fl,Fl=i,null!==t&&nc(t)),e}function nc(e){null===Fl?Fl=e:Fl.push.apply(Fl,e)}function rc(e,t){for(t&=~Ll,t&=~Ml,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var i=31-_t(t),n=1<<i;e[i]=-1,t&=~n}}function sc(e){if(0!=(6&Sl))throw Error(m(327));bc();var t=$t(e,0);if(0==(1&t))return ec(e,lt()),null;var i=pc(e,t);if(0!==e.tag&&2===i){var n=St(e);0!==n&&(t=n,i=ic(e,n))}if(1===i)throw i=Rl,cc(e,0),rc(e,t),ec(e,lt()),i;if(6===i)throw Error(m(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,vc(e,Fl),ec(e,lt()),null}function oc(e,t){var i=Sl;Sl|=1;try{return e(t)}finally{0===(Sl=i)&&(zl=lt()+500,jr&&qr())}}function ac(e){null!==jl&&0===jl.tag&&0==(6&Sl)&&bc();var t=Sl;Sl|=1;var i=Cl.transition,n=Tt;try{if(Cl.transition=null,Tt=1,e)return e()}finally{Tt=n,Cl.transition=i,0==(6&(Sl=t))&&qr()}}function lc(){Tl=Al.current,Ar(Al)}function cc(e,t){e.finishedWork=null,e.finishedLanes=0;var i=e.timeoutHandle;if(-1!==i&&(e.timeoutHandle=-1,cr(i)),null!==Pl)for(i=Pl.return;null!==i;){var n=i;switch(Ms(n),n.tag){case 1:null!=(n=n.type.childContextTypes)&&Or();break;case 3:so(),Ar(Mr),Ar(Ir),uo();break;case 5:ao(n);break;case 4:so();break;case 13:case 19:Ar(lo);break;case 10:ts(n.type._context);break;case 22:case 23:lc()}i=i.return}if(El=e,Pl=e=Ac(e.current,null),kl=Tl=t,Dl=0,Rl=null,Ll=Ml=Il=0,Fl=Bl=null,null!==ss){for(t=0;t<ss.length;t++)if(null!==(n=(i=ss[t]).interleaved)){i.interleaved=null;var r=n.next,s=i.pending;if(null!==s){var o=s.next;s.next=r,n.next=o}i.pending=n}ss=null}return e}function dc(e,t){for(;;){var i=Pl;try{if(es(),po.current=oa,bo){for(var n=mo.memoizedState;null!==n;){var r=n.queue;null!==r&&(r.pending=null),n=n.next}bo=!1}if(go=0,vo=_o=mo=null,wo=!1,yo=0,$l.current=null,null===i||null===i.return){Dl=1,Rl=t,Pl=null;break}e:{var s=e,o=i.return,a=i,l=t;if(t=kl,a.flags|=32768,null!==l&&"object"==typeof l&&"function"==typeof l.then){var c=l,d=a,h=d.tag;if(0==(1&d.mode)&&(0===h||11===h||15===h)){var u=d.alternate;u?(d.updateQueue=u.updateQueue,d.memoizedState=u.memoizedState,d.lanes=u.lanes):(d.updateQueue=null,d.memoizedState=null)}var p=ba(o);if(null!==p){p.flags&=-257,wa(p,o,a,0,t),1&p.mode&&va(s,c,t),l=c;var f=(t=p).updateQueue;if(null===f){var g=new Set;g.add(l),t.updateQueue=g}else f.add(l);break e}if(0==(1&t)){va(s,c,t),uc();break e}l=Error(m(426))}else if(Fs&&1&a.mode){var _=ba(o);if(null!==_){0==(65536&_.flags)&&(_.flags|=256),wa(_,o,a,0,t),Gs(l);break e}}s=l,4!==Dl&&(Dl=2),null===Bl?Bl=[s]:Bl.push(s),l=da(l,a),a=o;do{switch(a.tag){case 3:a.flags|=65536,t&=-t,a.lanes|=t,us(a,ma(0,l,t));break e;case 1:s=l;var v=a.type,b=a.stateNode;if(0==(128&a.flags)&&("function"==typeof v.getDerivedStateFromError||null!==b&&"function"==typeof b.componentDidCatch&&(null===Ul||!Ul.has(b)))){a.flags|=65536,t&=-t,a.lanes|=t,us(a,_a(a,s,t));break e}}a=a.return}while(null!==a)}_c(i)}catch(e){t=e,Pl===i&&null!==i&&(Pl=i=i.return);continue}break}}function hc(){var e=xl.current;return xl.current=oa,null===e?oa:e}function uc(){0!==Dl&&3!==Dl&&2!==Dl||(Dl=4),null===El||0==(268435455&Il)&&0==(268435455&Ml)||rc(El,kl)}function pc(e,t){var i=Sl;Sl|=2;var n=hc();for(El===e&&kl===t||cc(e,t);;)try{fc();break}catch(t){dc(e,t)}if(es(),Sl=i,xl.current=n,null!==Pl)throw Error(m(261));return El=null,kl=0,Dl}function fc(){for(;null!==Pl;)mc(Pl)}function gc(){for(;null!==Pl&&!ot();)mc(Pl)}function mc(e){var t=wl(e.alternate,e,Tl);e.memoizedProps=e.pendingProps,null===t?_c(e):Pl=t,$l.current=null}function _c(e){var t=e;do{var i=t.alternate;if(e=t.return,0==(32768&t.flags)){if(null!==(i=$a(i,t,Tl)))return void(Pl=i)}else{if(null!==(i=Ka(i,t)))return i.flags&=32767,void(Pl=i);if(null===e)return Dl=6,void(Pl=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(Pl=t);Pl=t=e}while(null!==t);0===Dl&&(Dl=5)}function vc(e,t){var i=Tt,n=Cl.transition;try{Cl.transition=null,Tt=1,function(e,t,i){do{bc()}while(null!==jl);if(0!=(6&Sl))throw Error(m(327));var n=e.finishedWork,r=e.finishedLanes;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(m(177));e.callbackNode=null,e.callbackPriority=0;var s=n.lanes|n.childLanes;if(function(e,t){var i=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<i;){var r=31-_t(i),s=1<<r;t[r]=0,n[r]=-1,e[r]=-1,i&=~s}}(e,s),e===El&&(Pl=El=null,kl=0),0==(2064&n.subtreeFlags)&&0==(2064&n.flags)||Hl||(Hl=!0,Ec(ut,(function(){return bc(),null}))),s=0!=(15990&n.flags),0!=(15990&n.subtreeFlags)||s){s=Cl.transition,Cl.transition=null;var o=Tt;Tt=1;var a=Sl;Sl|=4,$l.current=null,function(e,t){if(bn(e=vn())){if("selectionStart"in e)var i={start:e.selectionStart,end:e.selectionEnd};else e:{var n=(i=(i=e.ownerDocument)&&i.defaultView||window).getSelection&&i.getSelection();if(n&&0!==n.rangeCount){i=n.anchorNode;var r=n.anchorOffset,s=n.focusNode;n=n.focusOffset;try{i.nodeType,s.nodeType}catch(e){i=null;break e}var o=0,a=-1,l=-1,c=0,d=0,h=e,u=null;t:for(;;){for(var p;h!==i||0!==r&&3!==h.nodeType||(a=o+r),h!==s||0!==n&&3!==h.nodeType||(l=o+n),3===h.nodeType&&(o+=h.nodeValue.length),null!==(p=h.firstChild);)u=h,h=p;for(;;){if(h===e)break t;if(u===i&&++c===r&&(a=o),u===s&&++d===n&&(l=o),null!==(p=h.nextSibling))break;u=(h=u).parentNode}h=p}i=-1===a||-1===l?null:{start:a,end:l}}else i=null}i=i||{start:0,end:0}}else i=null;for(or={focusedElem:e,selectionRange:i},Za=t;null!==Za;)if(e=(t=Za).child,0!=(1028&t.subtreeFlags)&&null!==e)e.return=t,Za=e;else for(;null!==Za;){t=Za;try{var f=t.alternate;if(0!=(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==f){var g=f.memoizedProps,_=f.memoizedState,v=t.stateNode,b=v.getSnapshotBeforeUpdate(t.elementType===t.type?g:Xr(t.type,g),_);v.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var w=t.stateNode.containerInfo;if(1===w.nodeType)w.textContent="";else if(9===w.nodeType){var y=w.body;null!=y&&(y.textContent="")}break;default:throw Error(m(163))}}catch(e){yc(t,t.return,e)}if(null!==(e=t.sibling)){e.return=t.return,Za=e;break}Za=t.return}f=tl,tl=!1}(e,n),function(e,t){for(Za=t;null!==Za;){var i=(t=Za).deletions;if(null!==i)for(var n=0;n<i.length;n++){var r=i[n];try{ul(e,r,t);var s=r.alternate;null!==s&&(s.return=null),r.return=null}catch(e){yc(r,t,e)}}if(i=t.child,0!=(12854&t.subtreeFlags)&&null!==i)i.return=t,Za=i;else for(;null!==Za;){t=Za;try{var o=t.flags;if(32&o&&$e(t.stateNode,""),512&o){var a=t.alternate;if(null!==a){var l=a.ref;null!==l&&("function"==typeof l?l(null):l.current=null)}}if(8192&o)switch(t.tag){case 13:if(null!==t.memoizedState){var c=t.alternate;null!==c&&null!==c.memoizedState||(Ol=lt())}break;case 22:var d=null!==t.memoizedState,h=t.alternate,u=null!==h&&null!==h.memoizedState;e:{r=d;for(var p=null,f=n=i=t;;){if(5===f.tag){if(null===p){p=f;var g=f.stateNode;if(r){var m=g.style;"function"==typeof m.setProperty?m.setProperty("display","none","important"):m.display="none"}else{var _=f.stateNode,v=f.memoizedProps.style,b=null!=v&&v.hasOwnProperty("display")?v.display:null;_.style.display=Ee("display",b)}}}else if(6===f.tag)null===p&&(f.stateNode.nodeValue=r?"":f.memoizedProps);else if((22!==f.tag&&23!==f.tag||null===f.memoizedState||f===n)&&null!==f.child){f.child.return=f,f=f.child;continue}if(f===n)break;for(;null===f.sibling;){if(null===f.return||f.return===n)break e;p===f&&(p=null),f=f.return}p===f&&(p=null),f.sibling.return=f.return,f=f.sibling}}if(d&&!u&&0!=(1&i.mode)){Za=i;for(var w=i.child;null!==w;){for(i=Za=w;null!==Za;){var y=(n=Za).child;switch(n.tag){case 0:case 11:case 14:case 15:il(4,n,n.return);break;case 1:Ja(n,n.return);var x=n.stateNode;if("function"==typeof x.componentWillUnmount){var $=n.return;try{x.props=n.memoizedProps,x.state=n.memoizedState,x.componentWillUnmount()}catch(e){yc(n,$,e)}}break;case 5:Ja(n,n.return);break;case 22:if(null!==n.memoizedState){vl(i);continue}}null!==y?(y.return=n,Za=y):vl(i)}w=w.sibling}}}switch(4102&o){case 2:cl(t),t.flags&=-3;break;case 6:cl(t),t.flags&=-3,pl(t.alternate,t);break;case 4096:t.flags&=-4097;break;case 4100:t.flags&=-4097,pl(t.alternate,t);break;case 4:pl(t.alternate,t)}}catch(e){yc(t,t.return,e)}if(null!==(i=t.sibling)){i.return=t.return,Za=i;break}Za=t.return}}}(e,n),wn(or),or=null,e.current=n,gl(n,e,r),at(),Sl=a,Tt=o,Cl.transition=s}else e.current=n;if(Hl&&(Hl=!1,jl=e,Wl=r),0===(s=e.pendingLanes)&&(Ul=null),function(e){if(mt&&"function"==typeof mt.onCommitFiberRoot)try{mt.onCommitFiberRoot(gt,e,void 0,128==(128&e.current.flags))}catch(e){}}(n.stateNode),ec(e,lt()),null!==t)for(i=e.onRecoverableError,n=0;n<t.length;n++)i(t[n]);if(Nl)throw Nl=!1,e=Vl,Vl=null,e;0!=(1&Wl)&&0!==e.tag&&bc(),0!=(1&(s=e.pendingLanes))?e===ql?Gl++:(Gl=0,ql=e):Gl=0,qr()}(e,t,i)}finally{Cl.transition=n,Tt=i}return null}function bc(){if(null!==jl){var e=At(Wl),t=Cl.transition,i=Tt;try{if(Cl.transition=null,Tt=16>e?16:e,null===jl)var n=!1;else{if(e=jl,jl=null,Wl=0,0!=(6&Sl))throw Error(m(331));var r=Sl;for(Sl|=4,Za=e.current;null!==Za;){var s=Za,o=s.child;if(0!=(16&Za.flags)){var a=s.deletions;if(null!==a){for(var l=0;l<a.length;l++){var c=a[l];for(Za=c;null!==Za;){var d=Za;switch(d.tag){case 0:case 11:case 15:il(8,d,s)}var h=d.child;if(null!==h)h.return=d,Za=h;else for(;null!==Za;){var u=(d=Za).sibling,p=d.return;if(ol(d),d===c){Za=null;break}if(null!==u){u.return=p,Za=u;break}Za=p}}}var f=s.alternate;if(null!==f){var g=f.child;if(null!==g){f.child=null;do{var _=g.sibling;g.sibling=null,g=_}while(null!==g)}}Za=s}}if(0!=(2064&s.subtreeFlags)&&null!==o)o.return=s,Za=o;else e:for(;null!==Za;){if(0!=(2048&(s=Za).flags))switch(s.tag){case 0:case 11:case 15:il(9,s,s.return)}var v=s.sibling;if(null!==v){v.return=s.return,Za=v;break e}Za=s.return}}var b=e.current;for(Za=b;null!==Za;){var w=(o=Za).child;if(0!=(2064&o.subtreeFlags)&&null!==w)w.return=o,Za=w;else e:for(o=b;null!==Za;){if(0!=(2048&(a=Za).flags))try{switch(a.tag){case 0:case 11:case 15:nl(9,a)}}catch(e){yc(a,a.return,e)}if(a===o){Za=null;break e}var y=a.sibling;if(null!==y){y.return=a.return,Za=y;break e}Za=a.return}}if(Sl=r,qr(),mt&&"function"==typeof mt.onPostCommitFiberRoot)try{mt.onPostCommitFiberRoot(gt,e)}catch(e){}n=!0}return n}finally{Tt=i,Cl.transition=t}}return!1}function wc(e,t,i){ds(e,t=ma(0,t=da(i,t),1)),t=Yl(),null!==(e=Jl(e,1))&&(Pt(e,1,t),ec(e,t))}function yc(e,t,i){if(3===e.tag)wc(e,e,i);else for(;null!==t;){if(3===t.tag){wc(t,e,i);break}if(1===t.tag){var n=t.stateNode;if("function"==typeof t.type.getDerivedStateFromError||"function"==typeof n.componentDidCatch&&(null===Ul||!Ul.has(n))){ds(t,e=_a(t,e=da(i,e),1)),e=Yl(),null!==(t=Jl(t,1))&&(Pt(t,1,e),ec(t,e));break}}t=t.return}}function xc(e,t,i){var n=e.pingCache;null!==n&&n.delete(t),t=Yl(),e.pingedLanes|=e.suspendedLanes&i,El===e&&(kl&i)===i&&(4===Dl||3===Dl&&(130023424&kl)===kl&&500>lt()-Ol?cc(e,0):Ll|=i),ec(e,t)}function $c(e,t){0===t&&(0==(1&e.mode)?t=1:(t=yt,0==(130023424&(yt<<=1))&&(yt=4194304)));var i=Yl();null!==(e=Jl(e,t))&&(Pt(e,t,i),ec(e,i))}function Cc(e){var t=e.memoizedState,i=0;null!==t&&(i=t.retryLane),$c(e,i)}function Sc(e,t){var i=0;switch(e.tag){case 13:var n=e.stateNode,r=e.memoizedState;null!==r&&(i=r.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(m(314))}null!==n&&n.delete(t),$c(e,i)}function Ec(e,t){return rt(e,t)}function Pc(e,t,i,n){this.tag=e,this.key=i,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function kc(e,t,i,n){return new Pc(e,t,i,n)}function Tc(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Ac(e,t){var i=e.alternate;return null===i?((i=kc(e.tag,t,e.key,e.mode)).elementType=e.elementType,i.type=e.type,i.stateNode=e.stateNode,i.alternate=e,e.alternate=i):(i.pendingProps=t,i.type=e.type,i.flags=0,i.subtreeFlags=0,i.deletions=null),i.flags=14680064&e.flags,i.childLanes=e.childLanes,i.lanes=e.lanes,i.child=e.child,i.memoizedProps=e.memoizedProps,i.memoizedState=e.memoizedState,i.updateQueue=e.updateQueue,t=e.dependencies,i.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},i.sibling=e.sibling,i.index=e.index,i.ref=e.ref,i}function Dc(e,t,i,n,r,s){var o=2;if(n=e,"function"==typeof e)Tc(e)&&(o=1);else if("string"==typeof e)o=5;else e:switch(e){case M:return Rc(i.children,r,s,t);case L:o=8,r|=8;break;case B:return(e=kc(12,i,t,2|r)).elementType=B,e.lanes=s,e;case N:return(e=kc(13,i,t,r)).elementType=N,e.lanes=s,e;case V:return(e=kc(19,i,t,r)).elementType=V,e.lanes=s,e;case j:return Ic(i,r,s,t);default:if("object"==typeof e&&null!==e)switch(e.$$typeof){case F:o=10;break e;case O:o=9;break e;case z:o=11;break e;case U:o=14;break e;case H:o=16,n=null;break e}throw Error(m(130,null==e?e:typeof e,""))}return(t=kc(o,i,t,r)).elementType=e,t.type=n,t.lanes=s,t}function Rc(e,t,i,n){return(e=kc(7,e,n,t)).lanes=i,e}function Ic(e,t,i,n){return(e=kc(22,e,n,t)).elementType=j,e.lanes=i,e.stateNode={},e}function Mc(e,t,i){return(e=kc(6,e,null,t)).lanes=i,e}function Lc(e,t,i){return(t=kc(4,null!==e.children?e.children:[],e.key,t)).lanes=i,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Bc(e,t,i,n,r){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Et(0),this.expirationTimes=Et(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Et(0),this.identifierPrefix=n,this.onRecoverableError=r,this.mutableSourceEagerHydrationData=null}function Fc(e,t,i,n,r,s,o,a,l){return e=new Bc(e,t,i,a,l),1===t?(t=1,!0===s&&(t|=8)):t=0,s=kc(3,null,null,t),e.current=s,s.stateNode=e,s.memoizedState={element:n,isDehydrated:i,cache:null,transitions:null},as(s),e}function Oc(e,t,i){var n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:I,key:null==n?null:""+n,children:e,containerInfo:t,implementation:i}}function zc(e){if(!e)return Rr;e:{if(Je(e=e._reactInternals)!==e||1!==e.tag)throw Error(m(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Fr(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(m(171))}if(1===e.tag){var i=e.type;if(Fr(i))return Nr(e,i,t)}return t}function Nc(e,t,i,n,r,s,o,a,l){return(e=Fc(i,n,!0,e,0,s,0,a,l)).context=zc(null),i=e.current,(s=cs(n=Yl(),r=Ql(i))).callback=null!=t?t:null,ds(i,s),e.current.lanes=r,Pt(e,r,n),ec(e,n),e}function Vc(e,t,i,n){var r=t.current,s=Yl(),o=Ql(r);return i=zc(i),null===t.context?t.context=i:t.pendingContext=i,(t=cs(s,o)).payload={element:e},null!==(n=void 0===n?null:n)&&(t.callback=n),ds(r,t),null!==(e=Zl(r,o,s))&&hs(e,r,o),o}function Uc(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function Hc(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var i=e.retryLane;e.retryLane=0!==i&&i<t?i:t}}function jc(e,t){Hc(e,t),(e=e.alternate)&&Hc(e,t)}wl=function(e,t,i){if(null!==e)if(e.memoizedProps!==t.pendingProps||Mr.current)Sa=!0;else{if(0==(e.lanes&i)&&0==(128&t.flags))return Sa=!1,function(e,t,i){switch(t.tag){case 3:La(t),Ws();break;case 5:oo(t);break;case 1:Fr(t.type)&&Vr(t);break;case 4:ro(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,r=t.memoizedProps.value;Dr(Yr,n._currentValue),n._currentValue=r;break;case 13:if(null!==(n=t.memoizedState))return null!==n.dehydrated?(Dr(lo,1&lo.current),t.flags|=128,null):0!=(i&t.child.childLanes)?za(e,t,i):(Dr(lo,1&lo.current),null!==(e=qa(e,t,i))?e.sibling:null);Dr(lo,1&lo.current);break;case 19:if(n=0!=(i&t.childLanes),0!=(128&e.flags)){if(n)return Ga(e,t,i);t.flags|=128}if(null!==(r=t.memoizedState)&&(r.rendering=null,r.tail=null,r.lastEffect=null),Dr(lo,lo.current),n)break;return null;case 22:case 23:return t.lanes=0,Aa(e,t,i)}return qa(e,t,i)}(e,t,i);Sa=0!=(131072&e.flags)}else Sa=!1,Fs&&0!=(1048576&t.flags)&&Rs(t,Ss,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),e=t.pendingProps;var r=Br(t,Ir.current);ns(t,i),r=So(null,t,n,e,r,i);var s=Eo();return t.flags|=1,"object"==typeof r&&null!==r&&"function"==typeof r.render&&void 0===r.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Fr(n)?(s=!0,Vr(t)):s=!1,t.memoizedState=null!==r.state&&void 0!==r.state?r.state:null,as(t),r.updater=_s,t.stateNode=r,r._reactInternals=t,ys(t,n,e,i),t=Ma(null,t,n,!0,s,i)):(t.tag=0,Fs&&s&&Is(t),Ea(null,t,r,i),t=t.child),t;case 16:n=t.elementType;e:{switch(null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),e=t.pendingProps,n=(r=n._init)(n._payload),t.type=n,r=t.tag=function(e){if("function"==typeof e)return Tc(e)?1:0;if(null!=e){if((e=e.$$typeof)===z)return 11;if(e===U)return 14}return 2}(n),e=Xr(n,e),r){case 0:t=Ra(null,t,n,e,i);break e;case 1:t=Ia(null,t,n,e,i);break e;case 11:t=Pa(null,t,n,e,i);break e;case 14:t=ka(null,t,n,Xr(n.type,e),i);break e}throw Error(m(306,n,""))}return t;case 0:return n=t.type,r=t.pendingProps,Ra(e,t,n,r=t.elementType===n?r:Xr(n,r),i);case 1:return n=t.type,r=t.pendingProps,Ia(e,t,n,r=t.elementType===n?r:Xr(n,r),i);case 3:e:{if(La(t),null===e)throw Error(m(387));n=t.pendingProps,r=(s=t.memoizedState).element,ls(e,t),ps(t,n,null,i);var o=t.memoizedState;if(n=o.element,s.isDehydrated){if(s={element:n,isDehydrated:!1,cache:o.cache,transitions:o.transitions},t.updateQueue.baseState=s,t.memoizedState=s,256&t.flags){t=Ba(e,t,n,i,r=Error(m(423)));break e}if(n!==r){t=Ba(e,t,n,i,r=Error(m(424)));break e}for(Bs=fr(t.stateNode.containerInfo.firstChild),Ls=t,Fs=!0,Os=null,i=Zs(t,null,n,i),t.child=i;i;)i.flags=-3&i.flags|4096,i=i.sibling}else{if(Ws(),n===r){t=qa(e,t,i);break e}Ea(e,t,n,i)}t=t.child}return t;case 5:return oo(t),null===e&&Us(t),n=t.type,r=t.pendingProps,s=null!==e?e.memoizedProps:null,o=r.children,ar(n,r)?o=null:null!==s&&ar(n,s)&&(t.flags|=32),Da(e,t),Ea(e,t,o,i),t.child;case 6:return null===e&&Us(t),null;case 13:return za(e,t,i);case 4:return ro(t,t.stateNode.containerInfo),n=t.pendingProps,null===e?t.child=Qs(t,null,n,i):Ea(e,t,n,i),t.child;case 11:return n=t.type,r=t.pendingProps,Pa(e,t,n,r=t.elementType===n?r:Xr(n,r),i);case 7:return Ea(e,t,t.pendingProps,i),t.child;case 8:case 12:return Ea(e,t,t.pendingProps.children,i),t.child;case 10:e:{if(n=t.type._context,r=t.pendingProps,s=t.memoizedProps,o=r.value,Dr(Yr,n._currentValue),n._currentValue=o,null!==s)if(pn(s.value,o)){if(s.children===r.children&&!Mr.current){t=qa(e,t,i);break e}}else for(null!==(s=t.child)&&(s.return=t);null!==s;){var a=s.dependencies;if(null!==a){o=s.child;for(var l=a.firstContext;null!==l;){if(l.context===n){if(1===s.tag){(l=cs(-1,i&-i)).tag=2;var c=s.updateQueue;if(null!==c){var d=(c=c.shared).pending;null===d?l.next=l:(l.next=d.next,d.next=l),c.pending=l}}s.lanes|=i,null!==(l=s.alternate)&&(l.lanes|=i),is(s.return,i,t),a.lanes|=i;break}l=l.next}}else if(10===s.tag)o=s.type===t.type?null:s.child;else if(18===s.tag){if(null===(o=s.return))throw Error(m(341));o.lanes|=i,null!==(a=o.alternate)&&(a.lanes|=i),is(o,i,t),o=s.sibling}else o=s.child;if(null!==o)o.return=s;else for(o=s;null!==o;){if(o===t){o=null;break}if(null!==(s=o.sibling)){s.return=o.return,o=s;break}o=o.return}s=o}Ea(e,t,r.children,i),t=t.child}return t;case 9:return r=t.type,n=t.pendingProps.children,ns(t,i),n=n(r=rs(r)),t.flags|=1,Ea(e,t,n,i),t.child;case 14:return r=Xr(n=t.type,t.pendingProps),ka(e,t,n,r=Xr(n.type,r),i);case 15:return Ta(e,t,t.type,t.pendingProps,i);case 17:return n=t.type,r=t.pendingProps,r=t.elementType===n?r:Xr(n,r),null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),t.tag=1,Fr(n)?(e=!0,Vr(t)):e=!1,ns(t,i),bs(t,n,r),ys(t,n,r,i),Ma(null,t,n,!0,e,i);case 19:return Ga(e,t,i);case 22:return Aa(e,t,i)}throw Error(m(156,t.tag))};var Wc="function"==typeof reportError?reportError:function(e){console.error(e)};function Gc(e){this._internalRoot=e}function qc(e){this._internalRoot=e}function Kc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function Xc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function Yc(){}function Qc(e,t,i,n,r){var s=i._reactRootContainer;if(s){var o=s;if("function"==typeof r){var a=r;r=function(){var e=Uc(o);a.call(e)}}Vc(t,o,e,r)}else o=function(e,t,i,n,r){if(r){if("function"==typeof n){var s=n;n=function(){var e=Uc(o);s.call(e)}}var o=Nc(t,n,e,0,null,!1,0,"",Yc);return e._reactRootContainer=o,e[br]=o.current,Kn(8===e.nodeType?e.parentNode:e),ac(),o}for(;r=e.lastChild;)e.removeChild(r);if("function"==typeof n){var a=n;n=function(){var e=Uc(l);a.call(e)}}var l=Fc(e,0,!1,null,0,!1,0,"",Yc);return e._reactRootContainer=l,e[br]=l.current,Kn(8===e.nodeType?e.parentNode:e),ac((function(){Vc(t,l,i,n)})),l}(i,t,e,r,n);return Uc(o)}qc.prototype.render=Gc.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(m(409));Vc(e,t,null,null)},qc.prototype.unmount=Gc.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;ac((function(){Vc(null,e,null,null)})),t[br]=null}},qc.prototype.unstable_scheduleHydration=function(e){if(e){var t=Mt();e={blockedOn:null,target:e,priority:t};for(var i=0;i<Ht.length&&0!==t&&t<Ht[i].priority;i++);Ht.splice(i,0,e),0===i&&qt(e)}},Dt=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var i=xt(t.pendingLanes);0!==i&&(kt(t,1|i),ec(t,lt()),0==(6&Sl)&&(zl=lt()+500,qr()))}break;case 13:var n=Yl();ac((function(){return Zl(e,1,n)})),jc(e,1)}},Rt=function(e){13===e.tag&&(Zl(e,134217728,Yl()),jc(e,134217728))},It=function(e){if(13===e.tag){var t=Yl(),i=Ql(e);Zl(e,i,t),jc(e,i)}},Mt=function(){return Tt},Lt=function(e,t){var i=Tt;try{return Tt=e,t()}finally{Tt=i}},Ie=function(e,t,i){switch(t){case"input":if(ce(e,i),t=i.name,"radio"===i.type&&null!=t){for(i=e;i.parentNode;)i=i.parentNode;for(i=i.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<i.length;t++){var n=i[t];if(n!==e&&n.form===e.form){var r=Er(n);if(!r)throw Error(m(90));re(n),ce(n,r)}}}break;case"textarea":me(e,i);break;case"select":null!=(t=i.value)&&pe(e,!!i.multiple,t,!1)}},ze=oc,Ne=ac;var Zc={usingClientEntryPoint:!1,Events:[Cr,Sr,Er,Fe,Oe,oc]},Jc={findFiberByHostInstance:$r,bundleType:0,version:"18.0.0-fc46dba67-20220329",rendererPackageName:"react-dom"},ed={bundleType:Jc.bundleType,version:Jc.version,rendererPackageName:Jc.rendererPackageName,rendererConfig:Jc.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:D.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=it(e))?null:e.stateNode},findFiberByHostInstance:Jc.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.0.0-fc46dba67-20220329"};if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var td=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!td.isDisabled&&td.supportsFiber)try{gt=td.inject(ed),mt=td}catch(ye){}}i=Zc,n=function(e,t){var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Kc(t))throw Error(m(200));return Oc(e,t,null,i)},r=function(e,t){if(!Kc(e))throw Error(m(299));var i=!1,n="",r=Wc;return null!=t&&(!0===t.unstable_strictMode&&(i=!0),void 0!==t.identifierPrefix&&(n=t.identifierPrefix),void 0!==t.onRecoverableError&&(r=t.onRecoverableError)),t=Fc(e,1,!1,null,0,i,0,n,r),e[br]=t.current,Kn(8===e.nodeType?e.parentNode:e),new Gc(t)},s=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"==typeof e.render)throw Error(m(188));throw e=Object.keys(e).join(","),Error(m(268,e))}return e=null===(e=it(t))?null:e.stateNode},o=function(e){return ac(e)},a=function(e,t,i){if(!Xc(t))throw Error(m(200));return Qc(null,e,t,!0,i)},l=function(e,t,i){if(!Kc(e))throw Error(m(405));var n=null!=i&&i.hydratedSources||null,r=!1,s="",o=Wc;if(null!=i&&(!0===i.unstable_strictMode&&(r=!0),void 0!==i.identifierPrefix&&(s=i.identifierPrefix),void 0!==i.onRecoverableError&&(o=i.onRecoverableError)),t=Nc(t,null,e,1,null!=i?i:null,r,0,s,o),e[br]=t.current,Kn(e),n)for(e=0;e<n.length;e++)r=(r=(i=n[e])._getVersion)(i._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[i,r]:t.mutableSourceEagerHydrationData.push(i,r);return new qc(t)},c=function(e,t,i){if(!Xc(t))throw Error(m(200));return Qc(null,e,t,!1,i)},d=function(e){if(!Xc(e))throw Error(m(40));return!!e._reactRootContainer&&(ac((function(){Qc(null,null,e,!1,(function(){e._reactRootContainer=null,e[br]=null}))})),!0)},h=oc,u=function(e,t,i,n){if(!Xc(i))throw Error(m(200));if(null==e||void 0===e._reactInternals)throw Error(m(38));return Qc(e,t,i,!1,n)},p="18.0.0-fc46dba67-20220329"})),parcelRequire.register("fO90s",(function(e,t){e.exports=parcelRequire("gcnCG")})),parcelRequire.register("gcnCG",(function(e,t){var i,n,r,s,o,a,l,c,d,h,u,p,f,g,m,_,v,b,w;function y(e,t){var i=e.length;e.push(t);e:for(;0<i;){var n=i-1>>>1,r=e[n];if(!(0<C(r,t)))break e;e[n]=t,e[i]=r,i=n}}function x(e){return 0===e.length?null:e[0]}function $(e){if(0===e.length)return null;var t=e[0],i=e.pop();if(i!==t){e[0]=i;e:for(var n=0,r=e.length,s=r>>>1;n<s;){var o=2*(n+1)-1,a=e[o],l=o+1,c=e[l];if(0>C(a,i))l<r&&0>C(c,a)?(e[n]=c,e[l]=i,n=l):(e[n]=a,e[o]=i,n=o);else{if(!(l<r&&0>C(c,i)))break e;e[n]=c,e[l]=i,n=l}}}return t}function C(e,t){var i=e.sortIndex-t.sortIndex;return 0!==i?i:e.id-t.id}if($parcel$export(e.exports,"unstable_now",(()=>i),(e=>i=e)),$parcel$export(e.exports,"unstable_IdlePriority",(()=>n),(e=>n=e)),$parcel$export(e.exports,"unstable_ImmediatePriority",(()=>r),(e=>r=e)),$parcel$export(e.exports,"unstable_LowPriority",(()=>s),(e=>s=e)),$parcel$export(e.exports,"unstable_NormalPriority",(()=>o),(e=>o=e)),$parcel$export(e.exports,"unstable_Profiling",(()=>a),(e=>a=e)),$parcel$export(e.exports,"unstable_UserBlockingPriority",(()=>l),(e=>l=e)),$parcel$export(e.exports,"unstable_cancelCallback",(()=>c),(e=>c=e)),$parcel$export(e.exports,"unstable_continueExecution",(()=>d),(e=>d=e)),$parcel$export(e.exports,"unstable_forceFrameRate",(()=>h),(e=>h=e)),$parcel$export(e.exports,"unstable_getCurrentPriorityLevel",(()=>u),(e=>u=e)),$parcel$export(e.exports,"unstable_getFirstCallbackNode",(()=>p),(e=>p=e)),$parcel$export(e.exports,"unstable_next",(()=>f),(e=>f=e)),$parcel$export(e.exports,"unstable_pauseExecution",(()=>g),(e=>g=e)),$parcel$export(e.exports,"unstable_requestPaint",(()=>m),(e=>m=e)),$parcel$export(e.exports,"unstable_runWithPriority",(()=>_),(e=>_=e)),$parcel$export(e.exports,"unstable_scheduleCallback",(()=>v),(e=>v=e)),$parcel$export(e.exports,"unstable_shouldYield",(()=>b),(e=>b=e)),$parcel$export(e.exports,"unstable_wrapCallback",(()=>w),(e=>w=e)),"object"==typeof performance&&"function"==typeof performance.now){var S=performance;i=function(){return S.now()}}else{var E=Date,P=E.now();i=function(){return E.now()-P}}var k=[],T=[],A=1,D=null,R=3,I=!1,M=!1,L=!1,B="function"==typeof setTimeout?setTimeout:null,F="function"==typeof clearTimeout?clearTimeout:null,O="undefined"!=typeof setImmediate?setImmediate:null;function z(e){for(var t=x(T);null!==t;){if(null===t.callback)$(T);else{if(!(t.startTime<=e))break;$(T),t.sortIndex=t.expirationTime,y(k,t)}t=x(T)}}function N(e){if(L=!1,z(e),!M)if(null!==x(k))M=!0,Z(V);else{var t=x(T);null!==t&&J(N,t.startTime-e)}}function V(e,t){M=!1,L&&(L=!1,F(W),W=-1),I=!0;var n=R;try{for(z(t),D=x(k);null!==D&&(!(D.expirationTime>t)||e&&!K());){var r=D.callback;if("function"==typeof r){D.callback=null,R=D.priorityLevel;var s=r(D.expirationTime<=t);t=i(),"function"==typeof s?D.callback=s:D===x(k)&&$(k),z(t)}else $(k);D=x(k)}if(null!==D)var o=!0;else{var a=x(T);null!==a&&J(N,a.startTime-t),o=!1}return o}finally{D=null,R=n,I=!1}}"undefined"!=typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var U,H=!1,j=null,W=-1,G=5,q=-1;function K(){return!(i()-q<G)}function X(){if(null!==j){var e=i();q=e;var t=!0;try{t=j(!0,e)}finally{t?U():(H=!1,j=null)}}else H=!1}if("function"==typeof O)U=function(){O(X)};else if("undefined"!=typeof MessageChannel){var Y=new MessageChannel,Q=Y.port2;Y.port1.onmessage=X,U=function(){Q.postMessage(null)}}else U=function(){B(X,0)};function Z(e){j=e,H||(H=!0,U())}function J(e,t){W=B((function(){e(i())}),t)}n=5,r=1,s=4,o=3,a=null,l=2,c=function(e){e.callback=null},d=function(){M||I||(M=!0,Z(V))},h=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):G=0<e?Math.floor(1e3/e):5},u=function(){return R},p=function(){return x(k)},f=function(e){switch(R){case 1:case 2:case 3:var t=3;break;default:t=R}var i=R;R=t;try{return e()}finally{R=i}},g=function(){},m=function(){},_=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var i=R;R=e;try{return t()}finally{R=i}},v=function(e,t,n){var r=i();switch("object"==typeof n&&null!==n?n="number"==typeof(n=n.delay)&&0<n?r+n:r:n=r,e){case 1:var s=-1;break;case 2:s=250;break;case 5:s=1073741823;break;case 4:s=1e4;break;default:s=5e3}return e={id:A++,callback:t,priorityLevel:e,startTime:n,expirationTime:s=n+s,sortIndex:-1},n>r?(e.sortIndex=n,y(T,e),null===x(k)&&e===x(T)&&(L?(F(W),W=-1):L=!0,J(N,n-r))):(e.sortIndex=s,y(k,e),M||I||(M=!0,Z(V))),e},b=K,w=function(e){var t=R;return function(){var i=R;R=t;try{return e.apply(this,arguments)}finally{R=i}}}})),parcelRequire.register("jgD1p",(function(e,t){
/*!
 * excalibur - 0.26.0-alpha.128+483dc65 - 2022-4-4
 * https://github.com/excaliburjs/Excalibur
 * Copyright (c) 2022 Excalibur.js <https://github.com/excaliburjs/Excalibur/graphs/contributors>
 * Licensed BSD-2-Clause
 * @preserve
 */
var i;self,i=function(){return(()=>{var e={4662:(e,t,i)=>{i(3430);var n=i(8791);e.exports=n("Array","sort")},8343:(e,t,i)=>{i(4769);var n=i(9276);e.exports=n.Object.keys},7111:(e,t,i)=>{var n=i(9859),r=i(6733),s=i(9821),o=n.TypeError;e.exports=function(e){if(r(e))return e;throw o(s(e)+" is not a function")}},1176:(e,t,i)=>{var n=i(9859),r=i(5052),s=n.String,o=n.TypeError;e.exports=function(e){if(r(e))return e;throw o(s(e)+" is not an object")}},9540:(e,t,i)=>{var n=i(905),r=i(3231),s=i(9646),o=function(e){return function(t,i,o){var a,l=n(t),c=s(l),d=r(o,c);if(e&&i!=i){for(;c>d;)if((a=l[d++])!=a)return!0}else for(;c>d;d++)if((e||d in l)&&l[d]===i)return e||d||0;return!e&&-1}};e.exports={includes:o(!0),indexOf:o(!1)}},6038:(e,t,i)=>{var n=i(4229);e.exports=function(e,t){var i=[][e];return!!i&&n((function(){i.call(null,t||function(){throw 1},1)}))}},9794:(e,t,i)=>{var n=i(9859),r=i(3231),s=i(9646),o=i(2324),a=n.Array,l=Math.max;e.exports=function(e,t,i){for(var n=s(e),c=r(t,n),d=r(void 0===i?n:i,n),h=a(l(d-c,0)),u=0;c<d;c++,u++)o(h,u,e[c]);return h.length=u,h}},3867:(e,t,i)=>{var n=i(9794),r=Math.floor,s=function(e,t){var i=e.length,l=r(i/2);return i<8?o(e,t):a(e,s(n(e,0,l),t),s(n(e,l),t),t)},o=function(e,t){for(var i,n,r=e.length,s=1;s<r;){for(n=s,i=e[s];n&&t(e[n-1],i)>0;)e[n]=e[--n];n!==s++&&(e[n]=i)}return e},a=function(e,t,i,n){for(var r=t.length,s=i.length,o=0,a=0;o<r||a<s;)e[o+a]=o<r&&a<s?n(t[o],i[a])<=0?t[o++]:i[a++]:o<r?t[o++]:i[a++];return e};e.exports=s},7079:(e,t,i)=>{var n=i(5968),r=n({}.toString),s=n("".slice);e.exports=function(e){return s(r(e),8,-1)}},1589:(e,t,i)=>{var n=i(9859),r=i(1601),s=i(6733),o=i(7079),a=i(95)("toStringTag"),l=n.Object,c="Arguments"==o(function(){return arguments}());e.exports=r?o:function(e){var t,i,n;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(i=function(e,t){try{return e[t]}catch(e){}}(t=l(e),a))?i:c?o(t):"Object"==(n=o(t))&&s(t.callee)?"Arguments":n}},7081:(e,t,i)=>{var n=i(8270),r=i(4826),s=i(7933),o=i(1787);e.exports=function(e,t,i){for(var a=r(t),l=o.f,c=s.f,d=0;d<a.length;d++){var h=a[d];n(e,h)||i&&n(i,h)||l(e,h,c(t,h))}}},5762:(e,t,i)=>{var n=i(7400),r=i(1787),s=i(5358);e.exports=n?function(e,t,i){return r.f(e,t,s(1,i))}:function(e,t,i){return e[t]=i,e}},5358:e=>{e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},2324:(e,t,i)=>{var n=i(9310),r=i(1787),s=i(5358);e.exports=function(e,t,i){var o=n(t);o in e?r.f(e,o,s(0,i)):e[o]=i}},7400:(e,t,i)=>{var n=i(4229);e.exports=!n((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]}))},2635:(e,t,i)=>{var n=i(9859),r=i(5052),s=n.document,o=r(s)&&r(s.createElement);e.exports=function(e){return o?s.createElement(e):{}}},2671:(e,t,i)=>{var n=i(598).match(/firefox\/(\d+)/i);e.exports=!!n&&+n[1]},8506:(e,t,i)=>{var n=i(598);e.exports=/MSIE|Trident/.test(n)},598:(e,t,i)=>{var n=i(1333);e.exports=n("navigator","userAgent")||""},6358:(e,t,i)=>{var n,r,s=i(9859),o=i(598),a=s.process,l=s.Deno,c=a&&a.versions||l&&l.version,d=c&&c.v8;d&&(r=(n=d.split("."))[0]>0&&n[0]<4?1:+(n[0]+n[1])),!r&&o&&(!(n=o.match(/Edge\/(\d+)/))||n[1]>=74)&&(n=o.match(/Chrome\/(\d+)/))&&(r=+n[1]),e.exports=r},9811:(e,t,i)=>{var n=i(598).match(/AppleWebKit\/(\d+)\./);e.exports=!!n&&+n[1]},8791:(e,t,i)=>{var n=i(9859),r=i(5968);e.exports=function(e,t){return r(n[e].prototype[t])}},3837:e=>{e.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},3103:(e,t,i)=>{var n=i(9859),r=i(7933).f,s=i(5762),o=i(7487),a=i(2079),l=i(7081),c=i(6541);e.exports=function(e,t){var i,d,h,u,p,f=e.target,g=e.global,m=e.stat;if(i=g?n:m?n[f]||a(f,{}):(n[f]||{}).prototype)for(d in t){if(u=t[d],h=e.noTargetGet?(p=r(i,d))&&p.value:i[d],!c(g?d:f+(m?".":"#")+d,e.forced)&&void 0!==h){if(typeof u==typeof h)continue;l(u,h)}(e.sham||h&&h.sham)&&s(u,"sham",!0),o(i,d,u,e)}}},4229:e=>{e.exports=function(e){try{return!!e()}catch(e){return!0}}},7188:(e,t,i)=>{var n=i(4229);e.exports=!n((function(){var e=function(){}.bind();return"function"!=typeof e||e.hasOwnProperty("prototype")}))},266:(e,t,i)=>{var n=i(7188),r=Function.prototype.call;e.exports=n?r.bind(r):function(){return r.apply(r,arguments)}},1805:(e,t,i)=>{var n=i(7400),r=i(8270),s=Function.prototype,o=n&&Object.getOwnPropertyDescriptor,a=r(s,"name"),l=a&&"something"===function(){}.name,c=a&&(!n||n&&o(s,"name").configurable);e.exports={EXISTS:a,PROPER:l,CONFIGURABLE:c}},5968:(e,t,i)=>{var n=i(7188),r=Function.prototype,s=r.bind,o=r.call,a=n&&s.bind(o,o);e.exports=n?function(e){return e&&a(e)}:function(e){return e&&function(){return o.apply(e,arguments)}}},1333:(e,t,i)=>{var n=i(9859),r=i(6733),s=function(e){return r(e)?e:void 0};e.exports=function(e,t){return arguments.length<2?s(n[e]):n[e]&&n[e][t]}},5300:(e,t,i)=>{var n=i(7111);e.exports=function(e,t){var i=e[t];return null==i?void 0:n(i)}},9859:(e,t,i)=>{var n=function(e){return e&&e.Math==Math&&e};e.exports=n("object"==typeof globalThis&&globalThis)||n("object"==typeof window&&window)||n("object"==typeof self&&self)||n("object"==typeof i.g&&i.g)||function(){return this}()||Function("return this")()},8270:(e,t,i)=>{var n=i(5968),r=i(2991),s=n({}.hasOwnProperty);e.exports=Object.hasOwn||function(e,t){return s(r(e),t)}},5977:e=>{e.exports={}},4394:(e,t,i)=>{var n=i(7400),r=i(4229),s=i(2635);e.exports=!n&&!r((function(){return 7!=Object.defineProperty(s("div"),"a",{get:function(){return 7}}).a}))},9337:(e,t,i)=>{var n=i(9859),r=i(5968),s=i(4229),o=i(7079),a=n.Object,l=r("".split);e.exports=s((function(){return!a("z").propertyIsEnumerable(0)}))?function(e){return"String"==o(e)?l(e,""):a(e)}:a},8511:(e,t,i)=>{var n=i(5968),r=i(6733),s=i(5353),o=n(Function.toString);r(s.inspectSource)||(s.inspectSource=function(e){return o(e)}),e.exports=s.inspectSource},6407:(e,t,i)=>{var n,r,s,o=i(8694),a=i(9859),l=i(5968),c=i(5052),d=i(5762),h=i(8270),u=i(5353),p=i(4399),f=i(5977),g="Object already initialized",m=a.TypeError,_=a.WeakMap;if(o||u.state){var v=u.state||(u.state=new _),b=l(v.get),w=l(v.has),y=l(v.set);n=function(e,t){if(w(v,e))throw new m(g);return t.facade=e,y(v,e,t),t},r=function(e){return b(v,e)||{}},s=function(e){return w(v,e)}}else{var x=p("state");f[x]=!0,n=function(e,t){if(h(e,x))throw new m(g);return t.facade=e,d(e,x,t),t},r=function(e){return h(e,x)?e[x]:{}},s=function(e){return h(e,x)}}e.exports={set:n,get:r,has:s,enforce:function(e){return s(e)?r(e):n(e,{})},getterFor:function(e){return function(t){var i;if(!c(t)||(i=r(t)).type!==e)throw m("Incompatible receiver, "+e+" required");return i}}}},6733:e=>{e.exports=function(e){return"function"==typeof e}},6541:(e,t,i)=>{var n=i(4229),r=i(6733),s=/#|\.prototype\./,o=function(e,t){var i=l[a(e)];return i==d||i!=c&&(r(t)?n(t):!!t)},a=o.normalize=function(e){return String(e).replace(s,".").toLowerCase()},l=o.data={},c=o.NATIVE="N",d=o.POLYFILL="P";e.exports=o},5052:(e,t,i)=>{var n=i(6733);e.exports=function(e){return"object"==typeof e?null!==e:n(e)}},4231:e=>{e.exports=!1},9395:(e,t,i)=>{var n=i(9859),r=i(1333),s=i(6733),o=i(1321),a=i(6969),l=n.Object;e.exports=a?function(e){return"symbol"==typeof e}:function(e){var t=r("Symbol");return s(t)&&o(t.prototype,l(e))}},9646:(e,t,i)=>{var n=i(4237);e.exports=function(e){return n(e.length)}},3839:(e,t,i)=>{var n=i(6358),r=i(4229);e.exports=!!Object.getOwnPropertySymbols&&!r((function(){var e=Symbol();return!String(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&n&&n<41}))},8694:(e,t,i)=>{var n=i(9859),r=i(6733),s=i(8511),o=n.WeakMap;e.exports=r(o)&&/native code/.test(s(o))},1787:(e,t,i)=>{var n=i(9859),r=i(7400),s=i(4394),o=i(7137),a=i(1176),l=i(9310),c=n.TypeError,d=Object.defineProperty,h=Object.getOwnPropertyDescriptor,u="enumerable",p="configurable",f="writable";t.f=r?o?function(e,t,i){if(a(e),t=l(t),a(i),"function"==typeof e&&"prototype"===t&&"value"in i&&f in i&&!i.writable){var n=h(e,t);n&&n.writable&&(e[t]=i.value,i={configurable:p in i?i.configurable:n.configurable,enumerable:u in i?i.enumerable:n.enumerable,writable:!1})}return d(e,t,i)}:d:function(e,t,i){if(a(e),t=l(t),a(i),s)try{return d(e,t,i)}catch(e){}if("get"in i||"set"in i)throw c("Accessors not supported");return"value"in i&&(e[t]=i.value),e}},7933:(e,t,i)=>{var n=i(7400),r=i(266),s=i(9195),o=i(5358),a=i(905),l=i(9310),c=i(8270),d=i(4394),h=Object.getOwnPropertyDescriptor;t.f=n?h:function(e,t){if(e=a(e),t=l(t),d)try{return h(e,t)}catch(e){}if(c(e,t))return o(!r(s.f,e,t),e[t])}},8151:(e,t,i)=>{var n=i(140),r=i(3837).concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return n(e,r)}},894:(e,t)=>{t.f=Object.getOwnPropertySymbols},1321:(e,t,i)=>{var n=i(5968);e.exports=n({}.isPrototypeOf)},140:(e,t,i)=>{var n=i(5968),r=i(8270),s=i(905),o=i(9540).indexOf,a=i(5977),l=n([].push);e.exports=function(e,t){var i,n=s(e),c=0,d=[];for(i in n)!r(a,i)&&r(n,i)&&l(d,i);for(;t.length>c;)r(n,i=t[c++])&&(~o(d,i)||l(d,i));return d}},5632:(e,t,i)=>{var n=i(140),r=i(3837);e.exports=Object.keys||function(e){return n(e,r)}},9195:(e,t)=>{var i={}.propertyIsEnumerable,n=Object.getOwnPropertyDescriptor,r=n&&!i.call({1:2},1);t.f=r?function(e){var t=n(this,e);return!!t&&t.enumerable}:i},2914:(e,t,i)=>{var n=i(9859),r=i(266),s=i(6733),o=i(5052),a=n.TypeError;e.exports=function(e,t){var i,n;if("string"===t&&s(i=e.toString)&&!o(n=r(i,e)))return n;if(s(i=e.valueOf)&&!o(n=r(i,e)))return n;if("string"!==t&&s(i=e.toString)&&!o(n=r(i,e)))return n;throw a("Can't convert object to primitive value")}},4826:(e,t,i)=>{var n=i(1333),r=i(5968),s=i(8151),o=i(894),a=i(1176),l=r([].concat);e.exports=n("Reflect","ownKeys")||function(e){var t=s.f(a(e)),i=o.f;return i?l(t,i(e)):t}},9276:(e,t,i)=>{var n=i(9859);e.exports=n},7487:(e,t,i)=>{var n=i(9859),r=i(6733),s=i(8270),o=i(5762),a=i(2079),l=i(8511),c=i(6407),d=i(1805).CONFIGURABLE,h=c.get,u=c.enforce,p=String(String).split("String");(e.exports=function(e,t,i,l){var c,h=!!l&&!!l.unsafe,f=!!l&&!!l.enumerable,g=!!l&&!!l.noTargetGet,m=l&&void 0!==l.name?l.name:t;r(i)&&("Symbol("===String(m).slice(0,7)&&(m="["+String(m).replace(/^Symbol\(([^)]*)\)/,"$1")+"]"),(!s(i,"name")||d&&i.name!==m)&&o(i,"name",m),(c=u(i)).source||(c.source=p.join("string"==typeof m?m:""))),e!==n?(h?!g&&e[t]&&(f=!0):delete e[t],f?e[t]=i:o(e,t,i)):f?e[t]=i:a(t,i)})(Function.prototype,"toString",(function(){return r(this)&&h(this).source||l(this)}))},8885:(e,t,i)=>{var n=i(9859).TypeError;e.exports=function(e){if(null==e)throw n("Can't call method on "+e);return e}},2079:(e,t,i)=>{var n=i(9859),r=Object.defineProperty;e.exports=function(e,t){try{r(n,e,{value:t,configurable:!0,writable:!0})}catch(i){n[e]=t}return t}},4399:(e,t,i)=>{var n=i(3036),r=i(1441),s=n("keys");e.exports=function(e){return s[e]||(s[e]=r(e))}},5353:(e,t,i)=>{var n=i(9859),r=i(2079),s="__core-js_shared__",o=n[s]||r(s,{});e.exports=o},3036:(e,t,i)=>{var n=i(4231),r=i(5353);(e.exports=function(e,t){return r[e]||(r[e]=void 0!==t?t:{})})("versions",[]).push({version:"3.21.0",mode:n?"pure":"global",copyright:" 2014-2022 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.21.0/LICENSE",source:"https://github.com/zloirock/core-js"})},3231:(e,t,i)=>{var n=i(3329),r=Math.max,s=Math.min;e.exports=function(e,t){var i=n(e);return i<0?r(i+t,0):s(i,t)}},905:(e,t,i)=>{var n=i(9337),r=i(8885);e.exports=function(e){return n(r(e))}},3329:e=>{var t=Math.ceil,i=Math.floor;e.exports=function(e){var n=+e;return n!=n||0===n?0:(n>0?i:t)(n)}},4237:(e,t,i)=>{var n=i(3329),r=Math.min;e.exports=function(e){return e>0?r(n(e),9007199254740991):0}},2991:(e,t,i)=>{var n=i(9859),r=i(8885),s=n.Object;e.exports=function(e){return s(r(e))}},2066:(e,t,i)=>{var n=i(9859),r=i(266),s=i(5052),o=i(9395),a=i(5300),l=i(2914),c=i(95),d=n.TypeError,h=c("toPrimitive");e.exports=function(e,t){if(!s(e)||o(e))return e;var i,n=a(e,h);if(n){if(void 0===t&&(t="default"),i=r(n,e,t),!s(i)||o(i))return i;throw d("Can't convert object to primitive value")}return void 0===t&&(t="number"),l(e,t)}},9310:(e,t,i)=>{var n=i(2066),r=i(9395);e.exports=function(e){var t=n(e,"string");return r(t)?t:t+""}},1601:(e,t,i)=>{var n={};n[i(95)("toStringTag")]="z",e.exports="[object z]"===String(n)},3326:(e,t,i)=>{var n=i(9859),r=i(1589),s=n.String;e.exports=function(e){if("Symbol"===r(e))throw TypeError("Cannot convert a Symbol value to a string");return s(e)}},9821:(e,t,i)=>{var n=i(9859).String;e.exports=function(e){try{return n(e)}catch(e){return"Object"}}},1441:(e,t,i)=>{var n=i(5968),r=0,s=Math.random(),o=n(1..toString);e.exports=function(e){return"Symbol("+(void 0===e?"":e)+")_"+o(++r+s,36)}},6969:(e,t,i)=>{var n=i(3839);e.exports=n&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},7137:(e,t,i)=>{var n=i(7400),r=i(4229);e.exports=n&&r((function(){return 42!=Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype}))},95:(e,t,i)=>{var n=i(9859),r=i(3036),s=i(8270),o=i(1441),a=i(3839),l=i(6969),c=r("wks"),d=n.Symbol,h=d&&d.for,u=l?d:d&&d.withoutSetter||o;e.exports=function(e){if(!s(c,e)||!a&&"string"!=typeof c[e]){var t="Symbol."+e;a&&s(d,e)?c[e]=d[e]:c[e]=l&&h?h(t):u(t)}return c[e]}},3430:(e,t,i)=>{var n=i(3103),r=i(5968),s=i(7111),o=i(2991),a=i(9646),l=i(3326),c=i(4229),d=i(3867),h=i(6038),u=i(2671),p=i(8506),f=i(6358),g=i(9811),m=[],_=r(m.sort),v=r(m.push),b=c((function(){m.sort(void 0)})),w=c((function(){m.sort(null)})),y=h("sort"),x=!c((function(){if(f)return f<70;if(!(u&&u>3)){if(p)return!0;if(g)return g<603;var e,t,i,n,r="";for(e=65;e<76;e++){switch(t=String.fromCharCode(e),e){case 66:case 69:case 70:case 72:i=3;break;case 68:case 71:i=4;break;default:i=2}for(n=0;n<47;n++)m.push({k:t+n,v:i})}for(m.sort((function(e,t){return t.v-e.v})),n=0;n<m.length;n++)t=m[n].k.charAt(0),r.charAt(r.length-1)!==t&&(r+=t);return"DGBEFHACIJK"!==r}}));n({target:"Array",proto:!0,forced:b||!w||!y||!x},{sort:function(e){void 0!==e&&s(e);var t=o(this);if(x)return void 0===e?_(t):_(t,e);var i,n,r=[],c=a(t);for(n=0;n<c;n++)n in t&&v(r,t[n]);for(d(r,function(e){return function(t,i){return void 0===i?-1:void 0===t?1:void 0!==e?+e(t,i)||0:l(t)>l(i)?1:-1}}(e)),i=r.length,n=0;n<i;)t[n]=r[n++];for(;n<c;)delete t[n++];return t}})},4769:(e,t,i)=>{var n=i(3103),r=i(2991),s=i(5632);n({target:"Object",stat:!0,forced:i(4229)((function(){s(1)}))},{keys:function(e){return s(r(e))}})},1388:(e,t,i)=>{i.d(t,{Z:()=>a});var n=i(272),r=i.n(n),s=i(2609),o=i.n(s)()(r());o.push([e.id,"/* Buttons styles start */\n\nbutton#excalibur-play {\n  display: inline-block;\n  position: relative;\n  z-index: 999;\n  border-radius: 6px;\n  border: none;\n  /*border: 3px solid;\n    border-color: white;\n    box-shadow: 0 0 10px #ccc;*/\n  padding: 1rem 1.5rem 1rem 4rem;\n  margin: 0;\n  text-decoration: none;\n  background: #00b233;\n  color: #ffffff;\n  font-family: sans-serif;\n  font-size: 2rem;\n  white-space: nowrap;\n  line-height: 1;\n  cursor: pointer;\n  text-align: center;\n  transition: background 250ms ease-in-out, transform 150ms ease;\n  -webkit-appearance: none;\n  -moz-appearance: none;\n\n  -webkit-animation: excalibur-button-fadein 200ms; /* Safari, Chrome and Opera > 12.1 */\n  -moz-animation: excalibur-button-fadein 200ms; /* Firefox < 16 */\n  -ms-animation: excalibur-button-fadein 200ms; /* Internet Explorer */\n  -o-animation: excalibur-button-fadein 200ms; /* Opera < 12.1 */\n  animation: excalibur-button-fadein 200ms;\n}\n\n/*\nbutton#excalibur-play {\n  display: none;\n}*/\n\nbutton#excalibur-play:after {\n  position: absolute;\n  content: '';\n  border: 8px solid;\n  border-color: transparent transparent transparent white;\n  left: 35px;\n  top: 24px;\n  width: 0;\n  height: 0;\n}\n\nbutton#excalibur-play:before {\n  position: absolute;\n  content: '';\n  border: 3px solid;\n  left: 19px;\n  top: 14px;\n  border-radius: 20px;\n  width: 30px;\n  height: 30px;\n}\n\nbutton#excalibur-play:hover,\nbutton#excalibur-play:focus {\n  background: #00982c;\n}\n\nbutton#excalibur-play:focus {\n  outline: 1px solid #fff;\n  outline-offset: -4px;\n}\n\nbutton#excalibur-play:active {\n  transform: scale(0.99);\n}\n\n@keyframes excalibur-button-fadein {\n  from {\n    opacity: 0;\n  }\n  to {\n    opacity: 1;\n  }\n}\n\n/* Firefox < 16 */\n@-moz-keyframes excalibur-button-fadein {\n  from {\n    opacity: 0;\n  }\n  to {\n    opacity: 1;\n  }\n}\n\n/* Safari, Chrome and Opera > 12.1 */\n@-webkit-keyframes excalibur-button-fadein {\n  from {\n    opacity: 0;\n  }\n  to {\n    opacity: 1;\n  }\n}\n\n/* Internet Explorer */\n@-ms-keyframes excalibur-button-fadein {\n  from {\n    opacity: 0;\n  }\n  to {\n    opacity: 1;\n  }\n}\n\n/* Opera < 12.1 */\n@-o-keyframes excalibur-button-fadein {\n  from {\n    opacity: 0;\n  }\n  to {\n    opacity: 1;\n  }\n}\n","",{version:3,sources:["webpack://./Loader.css"],names:[],mappings:"AAAA,yBAAyB;;AAEzB;EACE,qBAAqB;EACrB,kBAAkB;EAClB,YAAY;EACZ,kBAAkB;EAClB,YAAY;EACZ;;+BAE6B;EAC7B,8BAA8B;EAC9B,SAAS;EACT,qBAAqB;EACrB,mBAAmB;EACnB,cAAc;EACd,uBAAuB;EACvB,eAAe;EACf,mBAAmB;EACnB,cAAc;EACd,eAAe;EACf,kBAAkB;EAClB,8DAA8D;EAC9D,wBAAwB;EACxB,qBAAqB;;EAErB,gDAAgD,EAAE,oCAAoC;EACtF,6CAA6C,EAAE,iBAAiB;EAChE,4CAA4C,EAAE,sBAAsB;EACpE,2CAA2C,EAAE,iBAAiB;EAC9D,wCAAwC;AAC1C;;AAEA;;;EAGE;;AAEF;EACE,kBAAkB;EAClB,WAAW;EACX,iBAAiB;EACjB,uDAAuD;EACvD,UAAU;EACV,SAAS;EACT,QAAQ;EACR,SAAS;AACX;;AAEA;EACE,kBAAkB;EAClB,WAAW;EACX,iBAAiB;EACjB,UAAU;EACV,SAAS;EACT,mBAAmB;EACnB,WAAW;EACX,YAAY;AACd;;AAEA;;EAEE,mBAAmB;AACrB;;AAEA;EACE,uBAAuB;EACvB,oBAAoB;AACtB;;AAEA;EACE,sBAAsB;AACxB;;AAEA;EACE;IACE,UAAU;EACZ;EACA;IACE,UAAU;EACZ;AACF;;AAEA,iBAAiB;AACjB;EACE;IACE,UAAU;EACZ;EACA;IACE,UAAU;EACZ;AACF;;AAEA,oCAAoC;AACpC;EACE;IACE,UAAU;EACZ;EACA;IACE,UAAU;EACZ;AACF;;AAEA,sBAAsB;AACtB;EACE;IACE,UAAU;EACZ;EACA;IACE,UAAU;EACZ;AACF;;AAEA,iBAAiB;AACjB;EACE;IACE,UAAU;EACZ;EACA;IACE,UAAU;EACZ;AACF",sourcesContent:["/* Buttons styles start */\n\nbutton#excalibur-play {\n  display: inline-block;\n  position: relative;\n  z-index: 999;\n  border-radius: 6px;\n  border: none;\n  /*border: 3px solid;\n    border-color: white;\n    box-shadow: 0 0 10px #ccc;*/\n  padding: 1rem 1.5rem 1rem 4rem;\n  margin: 0;\n  text-decoration: none;\n  background: #00b233;\n  color: #ffffff;\n  font-family: sans-serif;\n  font-size: 2rem;\n  white-space: nowrap;\n  line-height: 1;\n  cursor: pointer;\n  text-align: center;\n  transition: background 250ms ease-in-out, transform 150ms ease;\n  -webkit-appearance: none;\n  -moz-appearance: none;\n\n  -webkit-animation: excalibur-button-fadein 200ms; /* Safari, Chrome and Opera > 12.1 */\n  -moz-animation: excalibur-button-fadein 200ms; /* Firefox < 16 */\n  -ms-animation: excalibur-button-fadein 200ms; /* Internet Explorer */\n  -o-animation: excalibur-button-fadein 200ms; /* Opera < 12.1 */\n  animation: excalibur-button-fadein 200ms;\n}\n\n/*\nbutton#excalibur-play {\n  display: none;\n}*/\n\nbutton#excalibur-play:after {\n  position: absolute;\n  content: '';\n  border: 8px solid;\n  border-color: transparent transparent transparent white;\n  left: 35px;\n  top: 24px;\n  width: 0;\n  height: 0;\n}\n\nbutton#excalibur-play:before {\n  position: absolute;\n  content: '';\n  border: 3px solid;\n  left: 19px;\n  top: 14px;\n  border-radius: 20px;\n  width: 30px;\n  height: 30px;\n}\n\nbutton#excalibur-play:hover,\nbutton#excalibur-play:focus {\n  background: #00982c;\n}\n\nbutton#excalibur-play:focus {\n  outline: 1px solid #fff;\n  outline-offset: -4px;\n}\n\nbutton#excalibur-play:active {\n  transform: scale(0.99);\n}\n\n@keyframes excalibur-button-fadein {\n  from {\n    opacity: 0;\n  }\n  to {\n    opacity: 1;\n  }\n}\n\n/* Firefox < 16 */\n@-moz-keyframes excalibur-button-fadein {\n  from {\n    opacity: 0;\n  }\n  to {\n    opacity: 1;\n  }\n}\n\n/* Safari, Chrome and Opera > 12.1 */\n@-webkit-keyframes excalibur-button-fadein {\n  from {\n    opacity: 0;\n  }\n  to {\n    opacity: 1;\n  }\n}\n\n/* Internet Explorer */\n@-ms-keyframes excalibur-button-fadein {\n  from {\n    opacity: 0;\n  }\n  to {\n    opacity: 1;\n  }\n}\n\n/* Opera < 12.1 */\n@-o-keyframes excalibur-button-fadein {\n  from {\n    opacity: 0;\n  }\n  to {\n    opacity: 1;\n  }\n}\n"],sourceRoot:""}]);const a=o},2609:e=>{e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var i="",n=void 0!==t[5];return t[4]&&(i+="@supports (".concat(t[4],") {")),t[2]&&(i+="@media ".concat(t[2]," {")),n&&(i+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),i+=e(t),n&&(i+="}"),t[2]&&(i+="}"),t[4]&&(i+="}"),i})).join("")},t.i=function(e,i,n,r,s){"string"==typeof e&&(e=[[null,e,void 0]]);var o={};if(n)for(var a=0;a<this.length;a++){var l=this[a][0];null!=l&&(o[l]=!0)}for(var c=0;c<e.length;c++){var d=[].concat(e[c]);n&&o[d[0]]||(void 0!==s&&(void 0===d[5]||(d[1]="@layer".concat(d[5].length>0?" ".concat(d[5]):""," {").concat(d[1],"}")),d[5]=s),i&&(d[2]?(d[1]="@media ".concat(d[2]," {").concat(d[1],"}"),d[2]=i):d[2]=i),r&&(d[4]?(d[1]="@supports (".concat(d[4],") {").concat(d[1],"}"),d[4]=r):d[4]="".concat(r)),t.push(d))}},t}},272:e=>{e.exports=function(e){var t=e[1],i=e[3];if(!i)return t;if("function"==typeof btoa){var n=btoa(unescape(encodeURIComponent(JSON.stringify(i)))),r="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(n),s="/*# ".concat(r," */"),o=i.sources.map((function(e){return"/*# sourceURL=".concat(i.sourceRoot||"").concat(e," */")}));return[t].concat(o).concat([s]).join("\n")}return[t].join("\n")}}},t={};function i(n){var r=t[n];if(void 0!==r)return r.exports;var s=t[n]={id:n,exports:{}};return e[n](s,s.exports,i),s.exports}i.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return i.d(t,{a:t}),t},i.d=(e,t)=>{for(var n in t)i.o(t,n)&&!i.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},i.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var n={};return(()=>{i.r(n),i.d(n,{ActionContext:()=>Kn,ActionQueue:()=>Dn,ActionsComponent:()=>Xn,ActionsSystem:()=>Jr,ActivateEvent:()=>at,Actor:()=>Jn,AddedComponent:()=>_n,AddedEntity:()=>yr,Animation:()=>jr,AnimationDirection:()=>Or,AnimationStrategy:()=>Nr,ArcadeSolver:()=>Mr,AudioContextFactory:()=>fi,Axis:()=>nr,BaseAlign:()=>Ft,BinaryTreeNode:()=>Po,Blink:()=>Un,BodyComponent:()=>fn,BoundingBox:()=>I,BroadphaseStrategy:()=>Ai,BrowserComponent:()=>Is,BrowserEvents:()=>Ms,Camera:()=>fr,Canvas:()=>Te,Circle:()=>kn,CircleCollider:()=>tn,Class:()=>mi,Clock:()=>Hs,ClosestLine:()=>Ji,ClosestLineJumpTable:()=>en,Collider:()=>Yi,ColliderComponent:()=>cn,CollisionContact:()=>nn,CollisionEndEvent:()=>st,CollisionGroup:()=>Hi,CollisionGroupManager:()=>ro,CollisionJumpTable:()=>sn,CollisionPostSolveEvent:()=>nt,CollisionPreSolveEvent:()=>it,CollisionResolutionStrategy:()=>ki,CollisionSolver:()=>Ir,CollisionStartEvent:()=>rt,CollisionSystem:()=>Fr,CollisionType:()=>Ei,Color:()=>D,ColorBlindFlags:()=>Ss,ColorBlindnessMode:()=>ns,ColorBlindnessPostProcessor:()=>Cs,Component:()=>Oi,CompositeCollider:()=>Qi,Configurable:()=>Et,ConsoleAppender:()=>b,ContactConstraintPoint:()=>Lr,ContactEndEvent:()=>tt,ContactStartEvent:()=>et,CoordPlane:()=>Mi,CullingBox:()=>gn,DeactivateEvent:()=>lt,Debug:()=>Es,DebugGraphicsComponent:()=>ir,DebugSystem:()=>Qr,DebugText:()=>qt,DegreeOfFreedom:()=>dn,Detector:()=>Si,Die:()=>Wn,Direction:()=>Vt,DisplayMode:()=>di,DynamicTree:()=>qi,DynamicTreeCollisionProcessor:()=>Xi,EX_VERSION:()=>Mo,EaseTo:()=>Vn,EasingFunctions:()=>An,EdgeCollider:()=>on,ElasticToActorStrategy:()=>hr,EmitterType:()=>Ur,Engine:()=>Xs,EnterTriggerEvent:()=>ht,EnterViewPortEvent:()=>dt,Entity:()=>yn,EntityManager:()=>Sr,EventDispatcher:()=>pt,EventTypes:()=>pe,Events:()=>t,ExResponse:()=>oo,ExcaliburGraphicsContext2DCanvas:()=>Bs,ExcaliburGraphicsContextWebGL:()=>ci,ExcaliburWebGLContextAccessor:()=>Yt,ExitTriggerEvent:()=>ut,ExitViewPortEvent:()=>ct,Experiments:()=>c,Fade:()=>Hn,Flags:()=>m,Follow:()=>Gn,Font:()=>Yn,FontStyle:()=>zt,FontUnit:()=>It,FpsSampler:()=>Us,FrameStats:()=>Ps,GameEvent:()=>Ae,GameStartEvent:()=>Me,GameStopEvent:()=>Le,GamepadAxisEvent:()=>qe,GamepadButtonEvent:()=>Ge,GamepadConnectEvent:()=>je,GamepadDisconnectEvent:()=>We,Gif:()=>bo,GlobalCoordinates:()=>Fs,Graphic:()=>we,GraphicsComponent:()=>En,GraphicsGroup:()=>Wr,GraphicsLayer:()=>Cn,GraphicsLayers:()=>Sn,GraphicsSystem:()=>Xr,HiddenEvent:()=>Qe,ImageFiltering:()=>he,ImageSource:()=>At,InitializeEvent:()=>ot,Input:()=>a,Integrator:()=>Ri,IsometricEntityComponent:()=>es,IsometricEntitySystem:()=>ts,IsometricMap:()=>no,IsometricTile:()=>io,KillEvent:()=>De,Label:()=>to,Legacy:()=>d,LegacyDrawing:()=>o,LimitCameraBoundsStrategy:()=>pr,Line:()=>Zi,Loader:()=>$i,LockCameraToActorAxisStrategy:()=>dr,LockCameraToActorStrategy:()=>cr,LogLevel:()=>u,Logger:()=>v,Matrix:()=>ge,MatrixLocations:()=>ce,MediaEvent:()=>Qs,Meet:()=>qn,MockedElement:()=>ko,MotionComponent:()=>Ui,MotionSystem:()=>Rr,MoveBy:()=>Mn,MoveTo:()=>Ln,NativeSoundEvent:()=>Zs,NativeSoundProcessedEvent:()=>Js,Observable:()=>Ni,OffscreenSystem:()=>is,Pair:()=>ji,ParseGif:()=>$o,Particle:()=>qr,ParticleEmitter:()=>Kr,Physics:()=>Bi,PhysicsStats:()=>ks,PointerComponent:()=>Tn,PointerSystem:()=>Zr,Polygon:()=>Co,PolygonCollider:()=>an,Pool:()=>To,PostCollisionEvent:()=>Je,PostDebugDrawEvent:()=>ze,PostDrawEvent:()=>Fe,PostFrameEvent:()=>He,PostKillEvent:()=>Ie,PostUpdateEvent:()=>Ve,PreCollisionEvent:()=>Ze,PreDebugDrawEvent:()=>Oe,PreDrawEvent:()=>Be,PreFrameEvent:()=>Ue,PreKillEvent:()=>Re,PreUpdateEvent:()=>Ne,Projection:()=>Wi,Promise:()=>Io,PromiseState:()=>Do,QuadIndexBuffer:()=>ri,Query:()=>Pr,QueryManager:()=>kr,RadiusAroundActorStrategy:()=>ur,Random:()=>L,Raster:()=>ke,Ray:()=>Ki,RealisticSolver:()=>Br,Rectangle:()=>Pn,RemovedComponent:()=>bn,RemovedEntity:()=>$r,Repeat:()=>Rn,RepeatForever:()=>In,Resolution:()=>ui,Resource:()=>ft,RotateBy:()=>Fn,RotateTo:()=>Bn,RotationType:()=>un,ScaleBy:()=>zn,ScaleTo:()=>On,Scene:()=>xs,Screen:()=>pi,ScreenAppender:()=>w,ScreenElement:()=>er,ScreenShader:()=>$s,ScrollPreventionMode:()=>Gs,Shader:()=>Qt,Shape:()=>ln,Side:()=>k,SortedList:()=>Eo,Sound:()=>vo,Sprite:()=>Tt,SpriteFont:()=>Gt,SpriteSheet:()=>Wt,StandardClock:()=>js,StrategyContainer:()=>lr,Stream:()=>xo,SubscribeEvent:()=>Ke,System:()=>wr,SystemManager:()=>Tr,SystemType:()=>vr,TagComponent:()=>zi,TestClock:()=>Ws,Text:()=>Qn,TextAlign:()=>Lt,TextureLoader:()=>Pe,Tile:()=>ar,TileMap:()=>or,Timer:()=>tr,Traits:()=>l,TransformComponent:()=>Vi,TreeNode:()=>Gi,Trigger:()=>_r,TwoPI:()=>B,UnsubscribeEvent:()=>Xe,Util:()=>f,Vector:()=>E,VectorView:()=>Fi,VertexBuffer:()=>Zt,VertexLayout:()=>Jt,VisibleEvent:()=>Ye,WebAudio:()=>gi,WebAudioInstance:()=>mo,World:()=>Ar,canonicalizeAngle:()=>N,clamp:()=>z,createId:()=>_,frac:()=>F,hasGraphicsTick:()=>$n,hasOnInitialize:()=>lo,hasOnPostUpdate:()=>po,hasOnPreUpdate:()=>ho,hasPostDraw:()=>go,hasPreDraw:()=>fo,has_initialize:()=>ao,has_postupdate:()=>uo,has_preupdate:()=>co,isAddedComponent:()=>vn,isAddedSystemEntity:()=>xr,isRemoveSystemEntity:()=>Cr,isRemovedComponent:()=>wn,maxMessages:()=>y,obsolete:()=>S,randomInRange:()=>j,randomIntInRange:()=>W,range:()=>H,resetObsoleteCounter:()=>$,sign:()=>O,toDegrees:()=>V,toRadians:()=>U,vec:()=>P,webgl:()=>e});var e={};i.r(e),i.d(e,{ensurePowerOfTwo:()=>$e,getAttributeComponentSize:()=>Se,getAttributePointerType:()=>Ee,getGlTypeSizeBytes:()=>Ce,isPowerOfTwo:()=>ye,nextHighestPowerOfTwo:()=>xe});var t={};i.r(t),i.d(t,{ActivateEvent:()=>at,CollisionEndEvent:()=>st,CollisionPostSolveEvent:()=>nt,CollisionPreSolveEvent:()=>it,CollisionStartEvent:()=>rt,ContactEndEvent:()=>tt,ContactStartEvent:()=>et,DeactivateEvent:()=>lt,EnterTriggerEvent:()=>ht,EnterViewPortEvent:()=>dt,EventTypes:()=>pe,ExitTriggerEvent:()=>ut,ExitViewPortEvent:()=>ct,GameEvent:()=>Ae,GameStartEvent:()=>Me,GameStopEvent:()=>Le,GamepadAxisEvent:()=>qe,GamepadButtonEvent:()=>Ge,GamepadConnectEvent:()=>je,GamepadDisconnectEvent:()=>We,HiddenEvent:()=>Qe,InitializeEvent:()=>ot,KillEvent:()=>De,PostCollisionEvent:()=>Je,PostDebugDrawEvent:()=>ze,PostDrawEvent:()=>Fe,PostFrameEvent:()=>He,PostKillEvent:()=>Ie,PostUpdateEvent:()=>Ve,PreCollisionEvent:()=>Ze,PreDebugDrawEvent:()=>Oe,PreDrawEvent:()=>Be,PreFrameEvent:()=>Ue,PreKillEvent:()=>Re,PreUpdateEvent:()=>Ne,SubscribeEvent:()=>Ke,UnsubscribeEvent:()=>Xe,VisibleEvent:()=>Ye});var r={};i.r(r),i.d(r,{Colorize:()=>bt,Darken:()=>yt,Desaturate:()=>$t,Fill:()=>Ct,Grayscale:()=>mt,Invert:()=>_t,Lighten:()=>wt,Opacity:()=>vt,Saturate:()=>xt});var s={};i.r(s),i.d(s,{circle:()=>yi,line:()=>_i,point:()=>vi,roundRect:()=>wi,vector:()=>bi});var o={};i.r(o),i.d(o,{Animation:()=>Rt,CanvasDrawComponent:()=>xn,CanvasDrawingSystem:()=>Yr,Effects:()=>r,Polygon:()=>so,Sprite:()=>kt,SpriteFont:()=>jt,SpriteSheet:()=>Ht,Texture:()=>St});var a={};i.r(a),i.d(a,{Axes:()=>hs,Buttons:()=>cs,Gamepad:()=>Rs,Gamepads:()=>Ds,KeyEvent:()=>Ts,Keyboard:()=>As,Keys:()=>as,NativePointerButton:()=>gs,PointerButton:()=>_s,PointerComponent:()=>Tn,PointerEvent:()=>Os,PointerEventReceiver:()=>Vs,PointerScope:()=>ss,PointerSystem:()=>Zr,PointerType:()=>bs,WheelDeltaMode:()=>ps,WheelEvent:()=>zs});var l={};i.r(l),i.d(l,{OffscreenCulling:()=>mn});var c,d,h,u,p,f={};function g(){if("undefined"==typeof window&&(window={audioContext:function(){}}),"undefined"==typeof window||window.requestAnimationFrame||(window.requestAnimationFrame=window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(e){window.setInterval(e,1e3/60)}),"undefined"==typeof window||window.cancelAnimationFrame||(window.cancelAnimationFrame=window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||function(){}),"undefined"!=typeof window&&!window.AudioContext){if(window.webkitAudioContext){const e=window.webkitAudioContext.prototype.decodeAudioData;window.webkitAudioContext.prototype.decodeAudioData=function(t){return new Promise(((i,n)=>{e.call(this,t,i,n)}))}}window.AudioContext=window.AudioContext||window.webkitAudioContext||window.mozAudioContext||window.msAudioContext||window.oAudioContext}"undefined"==typeof window||window.devicePixelRatio||(window.devicePixelRatio=window.devicePixelRatio||1)}i.r(f),i.d(f,{Collection:()=>oe,ConsoleAppender:()=>b,DrawUtil:()=>s,EasingFunctions:()=>An,LogLevel:()=>u,Logger:()=>v,Observable:()=>Ni,ScreenAppender:()=>w,TwoPI:()=>G,addItemToArray:()=>te,canonicalizeAngle:()=>Y,clamp:()=>q,contains:()=>ne,delay:()=>le,fail:()=>ae,getOppositeSide:()=>re,getPosition:()=>ee,getSideFromDirection:()=>se,randomInRange:()=>K,randomIntInRange:()=>X,range:()=>J,removeItemFromArray:()=>ie,toDegrees:()=>Q,toRadians:()=>Z}),i(4662),i(8343),(c||(c={})).WebGL="use-webgl",(h=d||(d={})).Canvas="use-canvas-context",h.LegacyDrawing="use-legacy-drawing";class m{static freeze(){m._FROZEN=!0}static _reset(){m._FROZEN=!1,m._FLAGS={}}static useWebGL(){m.enable(c.WebGL)}static useCanvasGraphicsContext(){m.enable(d.Canvas)}static useLegacyDrawing(){m.enable(d.LegacyDrawing)}static enable(e){if(this._FROZEN)throw Error("Feature flags can only be enabled before Engine constructor time");m._FLAGS[e]=!0}static disable(e){if(this._FROZEN)throw Error("Feature flags can only be disabled before Engine constructor time");m._FLAGS[e]=!1}static isEnabled(e){return!!m._FLAGS[e]}static show(){return Object.keys(m._FLAGS)}}function _(e,t){return{type:e,value:t}}m._FROZEN=!1,m._FLAGS={},(p=u||(u={}))[p.Debug=0]="Debug",p[p.Info=1]="Info",p[p.Warn=2]="Warn",p[p.Error=3]="Error",p[p.Fatal=4]="Fatal";class v{constructor(){if(this._appenders=[],this.defaultLevel=u.Info,v._INSTANCE)throw new Error("Logger is a singleton");return v._INSTANCE=this,v._INSTANCE.addAppender(new b),v._INSTANCE}static getInstance(){return null==v._INSTANCE&&(v._INSTANCE=new v),v._INSTANCE}addAppender(e){this._appenders.push(e)}clearAppenders(){this._appenders.length=0}_log(e,t){null==e&&(e=this.defaultLevel);const i=this._appenders.length;for(let n=0;n<i;n++)e>=this.defaultLevel&&this._appenders[n].log(e,t)}debug(...e){this._log(u.Debug,e)}info(...e){this._log(u.Info,e)}warn(...e){this._log(u.Warn,e)}error(...e){this._log(u.Error,e)}fatal(...e){this._log(u.Fatal,e)}}v._INSTANCE=null;class b{log(e,t){if(!console&&!console.log&&console.warn&&console.error)return;const i=[];i.unshift.apply(i,t),i.unshift("["+u[e]+"] : "),e<u.Warn?console.log.apply?console.log.apply(console,i):console.log(i.join(" ")):e<u.Error?console.warn.apply?console.warn.apply(console,i):console.warn(i.join(" ")):console.error.apply?console.error.apply(console,i):console.error(i.join(" "))}}class w{constructor(e,t){this._messages=[],this._canvas=document.createElement("canvas"),this._canvas.width=e||window.innerWidth,this._canvas.height=t||window.innerHeight,this._canvas.style.position="absolute",this._ctx=this._canvas.getContext("2d"),document.body.appendChild(this._canvas)}log(e,t){const i=t.join(",");this._ctx.clearRect(0,0,this._canvas.width,this._canvas.height),this._messages.unshift("["+u[e]+"] : "+i);let n=10,r=1;for(let e=0;e<this._messages.length;e++)this._ctx.fillStyle="rgba(255,255,255,"+r.toFixed(2)+")",this._ctx.fillText(this._messages[e],200,n),n+=10,r=r>0?r-.05:0}}const y=5,x={},$=()=>{for(const e in x)x[e]=0},C=(e,t)=>{const i=m.isEnabled("suppress-obsolete-message");x[e]<y&&!i&&(v.getInstance().warn(e),console.trace&&t.showStackTrace&&console.trace()),x[e]++};function S(e){return e={message:"This feature will be removed in future versions of Excalibur.",alternateMethod:null,showStackTrace:!1,...e},function(t,i,n){if(n&&"function"!=typeof n.value&&"function"!=typeof n.get&&"function"!=typeof n.set)throw new SyntaxError("Only classes/functions/getters/setters can be marked as obsolete");const r=`${t.name||""}${t.name&&i?".":""}${i||""} is marked obsolete: ${e.message}`+(e.alternateMethod?` Use ${e.alternateMethod} instead`:"");x[r]||(x[r]=0);const s=n?{...n}:t;if(!n){class t extends s{constructor(...t){C(r,e),super(...t)}}return t}return n&&n.value?(s.value=function(){return C(r,e),n.value.apply(this,arguments)},s):(n&&n.get&&(s.get=function(){return C(r,e),n.get.apply(this,arguments)}),n&&n.set&&(s.set=function(){return C(r,e),n.set.apply(this,arguments)}),s)}}class E{constructor(e,t){this._x=0,this._y=0,this._x=e,this._y=t}static get Zero(){return new E(0,0)}static get One(){return new E(1,1)}static get Half(){return new E(.5,.5)}static get Up(){return new E(0,-1)}static get Down(){return new E(0,1)}static get Left(){return new E(-1,0)}static get Right(){return new E(1,0)}static fromAngle(e){return new E(Math.cos(e),Math.sin(e))}static isValid(e){return null!=e&&!isNaN(e.x)&&!isNaN(e.y)&&e.x!==1/0&&e.y!==1/0&&e.x!==-1/0&&e.y!==-1/0}static distance(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}static min(e,t){return new E(Math.min(e.x,t.x),Math.min(e.y,t.y))}static max(e,t){return new E(Math.max(e.x,t.x),Math.max(e.y,t.y))}get x(){return this._x}set x(e){this._x=e}get y(){return this._y}set y(e){this._y=e}setTo(e,t){this.x=e,this.y=t}equals(e,t=.001){return Math.abs(this.x-e.x)<=t&&Math.abs(this.y-e.y)<=t}distance(e){return e||(e=E.Zero),Math.sqrt(Math.pow(this.x-e.x,2)+Math.pow(this.y-e.y,2))}squareDistance(e){return e||(e=E.Zero),Math.pow(this.x-e.x,2)+Math.pow(this.y-e.y,2)}magnitude(){return this.distance()}get size(){return this.distance()}set size(e){const t=this.normalize().scale(e);this.setTo(t.x,t.y)}normalize(){const e=this.distance();return e>0?new E(this.x/e,this.y/e):new E(0,1)}average(e){return this.add(e).scale(.5)}scale(e){return e instanceof E?new E(this.x*e.x,this.y*e.y):new E(this.x*e,this.y*e)}add(e){return new E(this.x+e.x,this.y+e.y)}sub(e){return new E(this.x-e.x,this.y-e.y)}addEqual(e){return this.setTo(this.x+e.x,this.y+e.y),this}subEqual(e){return this.setTo(this.x-e.x,this.y-e.y),this}scaleEqual(e){return this.setTo(this.x*e,this.y*e),this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return e instanceof E?this.x*e.y-this.y*e.x:"number"==typeof e?new E(e*this.y,-e*this.x):void 0}static cross(e,t){return new E(-e*t.y,e*t.x)}perpendicular(){return new E(this.y,-this.x)}normal(){return this.perpendicular().normalize()}negate(){return this.scale(-1)}toAngle(){return Math.atan2(this.y,this.x)}rotate(e,t){t||(t=new E(0,0));const i=Math.sin(e),n=Math.cos(e),r=n*(this.x-t.x)-i*(this.y-t.y)+t.x,s=i*(this.x-t.x)+n*(this.y-t.y)+t.y;return new E(r,s)}clone(){return new E(this.x,this.y)}toString(e){return e?`(${this.x.toFixed(e)}, ${this.y.toFixed(e)})`:`(${this.x}, ${this.y})`}}function P(e,t){return new E(e,t)}!function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);s>3&&o&&Object.defineProperty(t,i,o)}([S({message:"will be removed in favour of `.size` in version 0.25.0"})],E.prototype,"magnitude",null);var k,T,A=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};class D{constructor(e,t,i,n){this.r=e,this.g=t,this.b=i,this.a=null!=n?n:1}static fromRGB(e,t,i,n){return new D(e,t,i,n)}static fromRGBString(e){let t=null;if(t=e.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d+(?:\.\d+)?))?\)/i)){const e=parseInt(t[1],10),i=parseInt(t[2],10),n=parseInt(t[3],10);let r=1;return t[4]&&(r=parseFloat(t[4])),new D(e,i,n,r)}throw new Error("Invalid rgb/a string: "+e)}static fromHex(e){let t=null;if(t=e.match(/^#?([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})?$/i)){const e=parseInt(t[1],16),i=parseInt(t[2],16),n=parseInt(t[3],16);let r=1;return t[4]&&(r=parseInt(t[4],16)/255),new D(e,i,n,r)}throw new Error("Invalid hex string: "+e)}static fromHSL(e,t,i,n=1){return new R(e,t,i,n).toRGBA()}lighten(e=.1){const t=R.fromRGBA(this.r,this.g,this.b,this.a);return t.l+=(1-t.l)*e,t.toRGBA()}darken(e=.1){const t=R.fromRGBA(this.r,this.g,this.b,this.a);return t.l-=t.l*e,t.toRGBA()}saturate(e=.1){const t=R.fromRGBA(this.r,this.g,this.b,this.a);return t.s+=t.s*e,t.toRGBA()}desaturate(e=.1){const t=R.fromRGBA(this.r,this.g,this.b,this.a);return t.s-=t.s*e,t.toRGBA()}multiply(e){const t=e.r/255*this.r/255*255,i=e.g/255*this.g/255*255,n=e.b/255*this.b/255*255,r=e.a*this.a;return new D(t,i,n,r)}mulitiply(e){return this.multiply(e)}screen(e){const t=e.invert(),i=e.invert();return t.multiply(i).invert()}invert(){return new D(255-this.r,255-this.g,255-this.b,1-this.a)}average(e){const t=(e.r+this.r)/2,i=(e.g+this.g)/2,n=(e.b+this.b)/2,r=(e.a+this.a)/2;return new D(t,i,n,r)}equal(e){return this.toString()===e.toString()}toString(e="rgb"){switch(e){case"rgb":return this.toRGBA();case"hsl":return this.toHSLA();case"hex":return this.toHex();default:throw new Error("Invalid Color format")}}_componentToHex(e){const t=e.toString(16);return 1===t.length?"0"+t:t}toHex(){return"#"+this._componentToHex(this.r)+this._componentToHex(this.g)+this._componentToHex(this.b)}toRGBA(){const e=String(this.r.toFixed(0))+", "+String(this.g.toFixed(0))+", "+String(this.b.toFixed(0));return void 0!==this.a||null!==this.a?"rgba("+e+", "+String(this.a)+")":"rgb("+e+")"}toHSLA(){return R.fromRGBA(this.r,this.g,this.b,this.a).toString()}fillStyle(){return this.toString()}clone(){return new D(this.r,this.g,this.b,this.a)}static get Black(){return D.fromHex("#000000")}static get White(){return D.fromHex("#FFFFFF")}static get Gray(){return D.fromHex("#808080")}static get LightGray(){return D.fromHex("#D3D3D3")}static get DarkGray(){return D.fromHex("#A9A9A9")}static get Yellow(){return D.fromHex("#FFFF00")}static get Orange(){return D.fromHex("#FFA500")}static get Red(){return D.fromHex("#FF0000")}static get Vermilion(){return D.fromHex("#FF5B31")}static get Vermillion(){return D.Vermilion}static get Rose(){return D.fromHex("#FF007F")}static get Magenta(){return D.fromHex("#FF00FF")}static get Violet(){return D.fromHex("#7F00FF")}static get Blue(){return D.fromHex("#0000FF")}static get Azure(){return D.fromHex("#007FFF")}static get Cyan(){return D.fromHex("#00FFFF")}static get Viridian(){return D.fromHex("#59978F")}static get Green(){return D.fromHex("#00FF00")}static get Chartreuse(){return D.fromHex("#7FFF00")}static get Transparent(){return D.fromHex("#FFFFFF00")}static get ExcaliburBlue(){return D.fromHex("#176BAA")}}A([S({message:"Alias for incorrect spelling used in older versions, use multiply instead, will be removed in v0.25.0"})],D.prototype,"mulitiply",null),A([S({message:"Alias for incorrect spelling used in older versions",alternateMethod:"Vermilion"})],D,"Vermillion",null);class R{constructor(e,t,i,n){this.h=e,this.s=t,this.l=i,this.a=n}static hue2rgb(e,t,i){return i<0&&(i+=1),i>1&&(i-=1),i<1/6?e+6*(t-e)*i:i<.5?t:i<2/3?e+(t-e)*(2/3-i)*6:e}static fromRGBA(e,t,i,n){e/=255,t/=255,i/=255;const r=Math.max(e,t,i),s=Math.min(e,t,i);let o,a;const l=(r+s)/2;if(r===s)o=a=0;else{const n=r-s;switch(a=l>.5?n/(2-r-s):n/(r+s),r){case e:o=(t-i)/n+(t<i?6:0);break;case t:o=(i-e)/n+2;break;case i:o=(e-t)/n+4}o/=6}return new R(o,a,l,n)}toRGBA(){let e,t,i;if(0===this.s)e=t=i=this.l;else{const n=this.l<.5?this.l*(1+this.s):this.l+this.s-this.l*this.s,r=2*this.l-n;e=R.hue2rgb(r,n,this.h+1/3),t=R.hue2rgb(r,n,this.h),i=R.hue2rgb(r,n,this.h-1/3)}return new D(255*e,255*t,255*i,this.a)}toString(){return`hsla(${this.h.toFixed(0)}, ${this.s.toFixed(0)}, ${this.l.toFixed(0)}, ${this.a.toFixed(0)})`}}(T=k||(k={})).None="None",T.Top="Top",T.Bottom="Bottom",T.Left="Left",T.Right="Right",function(e){e.getOpposite=function(t){return t===e.Top?e.Bottom:t===e.Bottom?e.Top:t===e.Left?e.Right:t===e.Right?e.Left:e.None},e.fromDirection=function(t){const i=[E.Left,E.Right,E.Up,E.Down],n=[e.Left,e.Right,e.Top,e.Bottom];let r=-Number.MAX_VALUE,s=-1;for(let e=0;e<i.length;e++)i[e].dot(t)>r&&(r=i[e].dot(t),s=e);return n[s]}}(k||(k={}));class I{constructor(e=0,t=0,i=0,n=0){"object"==typeof e?(this.left=e.left,this.top=e.top,this.right=e.right,this.bottom=e.bottom):"number"==typeof e&&(this.left=e,this.top=t,this.right=i,this.bottom=n)}clone(){return new I(this.left,this.top,this.right,this.bottom)}static getSideFromIntersection(e){return e&&e?Math.abs(e.x)>Math.abs(e.y)?e.x<0?k.Right:k.Left:e.y<0?k.Bottom:k.Top:k.None}static fromPoints(e){let t=1/0,i=1/0,n=-1/0,r=-1/0;for(let s=0;s<e.length;s++)e[s].x<t&&(t=e[s].x),e[s].x>n&&(n=e[s].x),e[s].y<i&&(i=e[s].y),e[s].y>r&&(r=e[s].y);return new I(t,i,n,r)}static fromDimension(e,t,i=E.Half,n=E.Zero){return new I(-e*i.x+n.x,-t*i.y+n.y,e-e*i.x+n.x,t-t*i.y+n.y)}get width(){return this.right-this.left}get height(){return this.bottom-this.top}hasZeroDimensions(){return 0===this.width||0===this.height}get center(){return new E((this.left+this.right)/2,(this.top+this.bottom)/2)}translate(e){return new I(this.left+e.x,this.top+e.y,this.right+e.x,this.bottom+e.y)}rotate(e,t=E.Zero){const i=this.getPoints().map((i=>i.rotate(e,t)));return I.fromPoints(i)}scale(e,t=E.Zero){const i=this.translate(t);return new I(i.left*e.x,i.top*e.y,i.right*e.x,i.bottom*e.y)}transform(e){const t=P(e.data[0],e.data[1]),i=t.scale(this.left),n=t.scale(this.right),r=P(e.data[4],e.data[5]),s=r.scale(this.top),o=r.scale(this.bottom),a=e.getPosition(),l=E.min(i,n).add(E.min(s,o)).add(a),c=E.max(i,n).add(E.max(s,o)).add(a);return new I({left:l.x,top:l.y,right:c.x,bottom:c.y})}getPerimeter(){return 2*(this.width+this.height)}getPoints(){const e=[];return e.push(new E(this.left,this.top)),e.push(new E(this.right,this.top)),e.push(new E(this.right,this.bottom)),e.push(new E(this.left,this.bottom)),e}rayCast(e,t=1/0){let i=-1/0,n=1/0;const r=0===e.dir.x?Number.MAX_VALUE:1/e.dir.x,s=0===e.dir.y?Number.MAX_VALUE:1/e.dir.y,o=(this.left-e.pos.x)*r,a=(this.right-e.pos.x)*r;i=Math.min(o,a),n=Math.max(o,a);const l=(this.top-e.pos.y)*s,c=(this.bottom-e.pos.y)*s;return i=Math.max(i,Math.min(l,c)),n=Math.min(n,Math.max(l,c)),n>=Math.max(0,i)&&i<t}rayCastTime(e,t=1/0){let i=-1/0,n=1/0;const r=0===e.dir.x?Number.MAX_VALUE:1/e.dir.x,s=0===e.dir.y?Number.MAX_VALUE:1/e.dir.y,o=(this.left-e.pos.x)*r,a=(this.right-e.pos.x)*r;i=Math.min(o,a),n=Math.max(o,a);const l=(this.top-e.pos.y)*s,c=(this.bottom-e.pos.y)*s;return i=Math.max(i,Math.min(l,c)),n=Math.min(n,Math.max(l,c)),n>=Math.max(0,i)&&i<t?i:-1}contains(e){return e instanceof E?this.left<=e.x&&this.top<=e.y&&this.bottom>=e.y&&this.right>=e.x:e instanceof I&&this.left<e.left&&this.top<e.top&&e.bottom<this.bottom&&e.right<this.right}combine(e){return new I(Math.min(this.left,e.left),Math.min(this.top,e.top),Math.max(this.right,e.right),Math.max(this.bottom,e.bottom))}get dimensions(){return new E(this.width,this.height)}overlaps(e){const t=this.combine(e);return t.width<e.width+this.width&&t.height<e.height+this.height}intersect(e){const t=this.combine(e);if(t.width<e.width+this.width&&t.height<e.height+this.height&&!t.dimensions.equals(e.dimensions)&&!t.dimensions.equals(this.dimensions)){let t=0;t=this.right>=e.left&&this.right<=e.right?e.left-this.right:e.right-this.left;let i=0;return i=this.top<=e.bottom&&this.top>=e.top?e.bottom-this.top:e.top-this.bottom,Math.abs(t)<Math.abs(i)?new E(t,0):new E(0,i)}if(t.dimensions.equals(e.dimensions)||t.dimensions.equals(this.dimensions)){let t=0;t=this.width-e.width>=0?this.right-e.right<=e.left-this.left?e.left-this.right:e.right-this.left:e.right-this.right<=this.left-e.left?this.left-e.right:this.right-e.left;let i=0;return i=this.height-e.height>=0?this.bottom-e.bottom<=e.top-this.top?e.top-this.bottom:e.bottom-this.top:e.bottom-this.bottom<=this.top-e.top?this.top-e.bottom:this.bottom-e.top,Math.abs(t)<Math.abs(i)?new E(t,0):new E(0,i)}return null}intersectWithSide(e){const t=this.intersect(e);return I.getSideFromIntersection(t)}debugDraw(e,t=D.Yellow){e.strokeStyle=t.toString(),e.strokeRect(this.left,this.top,this.width,this.height)}draw(e,t=D.Yellow){e.debug.drawRect(this.left,this.top,this.width,this.height,{color:t})}}const M=4294967295;class L{constructor(e){this.seed=e,this._lowerMask=2147483647,this._upperMask=2147483648,this._w=32,this._n=624,this._m=397,this._a=2567483615,this._u=11,this._s=7,this._b=2636928640,this._t=15,this._c=4022730752,this._l=18,this._f=1812433253,this._mt=new Array(this._n),this._mt[0]=(e||Date.now())>>>0;for(let e=1;e<this._n;e++){const t=this._mt[e-1]^this._mt[e-1]>>>this._w-2;this._mt[e]=(this._f*((4294901760&t)>>>16)<<16)+this._f*(65535&t)+e>>>0}this._index=this._n}_twist(){const e=[0,this._a];let t=0,i=0;for(;i<this._n-this._m;i++)t=this._mt[i]&this._upperMask|this._mt[i+1]&this._lowerMask,this._mt[i]=this._mt[i+this._m]^t>>>1^e[1&t]&M;for(;i<this._n-1;i++)t=this._mt[i]&this._upperMask|this._mt[i+1]&this._lowerMask,this._mt[i]=this._mt[i+(this._m-this._n)]^t>>>1^e[1&t]&M;t=this._mt[this._n-1]&this._upperMask|this._mt[0]&this._lowerMask,this._mt[this._n-1]=this._mt[this._m-1]^t>>>1^e[1&t]&M,this._index=0}nextInt(){this._index>=this._n&&this._twist();let e=this._mt[this._index++];return e^=e>>>this._u,e^=e<<this._s&this._b,e^=e<<this._t&this._c,e^=e>>>this._l,e>>>0}next(){return this.nextInt()*(1/4294967296)}floating(e,t){return(t-e)*this.next()+e}integer(e,t){return Math.floor((t-e+1)*this.next()+e)}bool(e=.5){return this.next()<=e}pickOne(e){return e[this.integer(0,e.length-1)]}pickSet(e,t,i=!1){return i?this._pickSetWithDuplicates(e,t):this._pickSetWithoutDuplicates(e,t)}_pickSetWithoutDuplicates(e,t){if(t>e.length||t<0)throw new Error("Invalid number of elements to pick, must pick a value 0 < n <= length");if(t===e.length)return e;const i=new Array(t);let n=0;const r=e.slice(0);for(;n<t;){const e=this.integer(0,r.length-1);i[n++]=r[e],r.splice(e,1)}return i}_pickSetWithDuplicates(e,t){if(t<0)throw new Error("Invalid number of elements to pick, must pick a value 0 <= n < MAX_INT");const i=new Array(t);for(let n=0;n<t;n++)i[n]=this.pickOne(e);return i}shuffle(e){const t=e.slice(0);let i=null;for(let e=0;e<t.length-2;e++){const n=this.integer(e,t.length-1);i=t[e],t[e]=t[n],t[n]=i}return t}range(e,t,i){const n=new Array(e);for(let r=0;r<e;r++)n[r]=this.integer(t,i);return n}d4(){return this.integer(1,4)}d6(){return this.integer(1,6)}d8(){return this.integer(1,8)}d10(){return this.integer(1,10)}d12(){return this.integer(1,12)}d20(){return this.integer(1,20)}}const B=2*Math.PI;function F(e){return e>=0?e-Math.floor(e):e-Math.ceil(e)}function O(e){return 0===e?0:e<0?-1:1}function z(e,t,i){return Math.min(Math.max(t,e),i)}function N(e){let t=e;if(e>B)for(;t>B;)t-=B;if(e<0)for(;t<0;)t+=B;return t}function V(e){return 180/Math.PI*e}function U(e){return e/180*Math.PI}const H=(e,t)=>Array.from(new Array(t-e+1),((t,i)=>i+e));function j(e,t,i=new L){return i?i.floating(e,t):e+Math.random()*(t-e)}function W(e,t,i=new L){return i?i.integer(e,t):Math.round(j(e,t))}const G=B,q=z,K=j,X=W,Y=N,Q=V,Z=U,J=H;function ee(e){let t=0,i=0;const n=e=>{t+=e.offsetLeft,e.offsetParent&&n(e.offsetParent)},r=e=>{i+=e.offsetTop,e.offsetParent&&r(e.offsetParent)};return n(e),r(e),new E(t,i)}function te(e,t){return-1===t.indexOf(e)&&(t.push(e),!0)}function ie(e,t){let i=-1;return(i=t.indexOf(e))>-1&&(t.splice(i,1),!0)}function ne(e,t){for(let i=0;i<e.length;i++)if(e[i]===t)return!0;return!1}function re(e){return e===k.Top?k.Bottom:e===k.Bottom?k.Top:e===k.Left?k.Right:e===k.Right?k.Left:k.None}function se(e){const t=[E.Left,E.Right,E.Up,E.Down],i=[k.Left,k.Right,k.Top,k.Bottom];let n=-Number.MAX_VALUE,r=-1;for(let i=0;i<t.length;i++)t[i].dot(e)>n&&(n=t[i].dot(e),r=i);return i[r]}class oe{constructor(e=oe.DefaultSize){this._internalArray=null,this._endPointer=0,this._internalArray=new Array(e)}_resize(){const e=2*this._internalArray.length,t=new Array(e),i=this.count();for(let e=0;e<i;e++)t[e]=this._internalArray[e];delete this._internalArray,this._internalArray=t}push(e){return this._endPointer===this._internalArray.length&&this._resize(),this._internalArray[this._endPointer++]=e}pop(){return this._endPointer=this._endPointer-1<0?0:this._endPointer-1,this._internalArray[this._endPointer]}count(){return this._endPointer}clear(){this._endPointer=0}internalSize(){return this._internalArray.length}elementAt(e){if(e>=this.count())throw new Error("Invalid index "+e);return this._internalArray[e]}insert(e,t){return e>=this.count()&&this._resize(),this._internalArray[e]=t}remove(e){const t=this.count();if(0===t)throw new Error("Invalid parameter "+e);const i=this._internalArray[e];for(let i=e;i<t;i++)this._internalArray[i]=this._internalArray[i+1];return this._endPointer--,i}removeElement(e){const t=this._internalArray.indexOf(e);this.remove(t)}toArray(){return this._internalArray.slice(0,this._endPointer)}forEach(e){let t=0;const i=this.count();for(;t<i;t++)e.call(this,this._internalArray[t],t)}map(e){const t=this.count();for(let i=0;i<t;i++)this._internalArray[i]=e.call(this,this._internalArray[i],i)}}function ae(e){throw new Error(e)}function le(e,t){var i;const n=null!==(i=null==t?void 0:t.schedule.bind(t))&&void 0!==i?i:setTimeout;return new Promise((t=>{n((()=>{t()}),e)}))}var ce,de,he,ue,pe,fe;oe.DefaultSize=200,(de=ce||(ce={}))[de.X=12]="X",de[de.Y=13]="Y";class ge{constructor(){this.data=new Float32Array(16),this._scaleSignX=1,this._scaleSignY=1}static ortho(e,t,i,n,r,s){const o=new ge;return o.data[0]=2/(t-e),o.data[1]=0,o.data[2]=0,o.data[3]=0,o.data[4]=0,o.data[5]=2/(n-i),o.data[6]=0,o.data[7]=0,o.data[8]=0,o.data[9]=0,o.data[10]=-2/(s-r),o.data[11]=0,o.data[12]=-(t+e)/(t-e),o.data[13]=-(n+i)/(n-i),o.data[14]=-(s+r)/(s-r),o.data[15]=1,o}clone(){const e=new ge;return e.data[0]=this.data[0],e.data[1]=this.data[1],e.data[2]=this.data[2],e.data[3]=this.data[3],e.data[4]=this.data[4],e.data[5]=this.data[5],e.data[6]=this.data[6],e.data[7]=this.data[7],e.data[8]=this.data[8],e.data[9]=this.data[9],e.data[10]=this.data[10],e.data[11]=this.data[11],e.data[12]=this.data[12],e.data[13]=this.data[13],e.data[14]=this.data[14],e.data[15]=this.data[15],e}toDOMMatrix(){return new DOMMatrix([...this.data])}static identity(){const e=new ge;return e.data[0]=1,e.data[1]=0,e.data[2]=0,e.data[3]=0,e.data[4]=0,e.data[5]=1,e.data[6]=0,e.data[7]=0,e.data[8]=0,e.data[9]=0,e.data[10]=1,e.data[11]=0,e.data[12]=0,e.data[13]=0,e.data[14]=0,e.data[15]=1,e}reset(){const e=this;return e.data[0]=1,e.data[1]=0,e.data[2]=0,e.data[3]=0,e.data[4]=0,e.data[5]=1,e.data[6]=0,e.data[7]=0,e.data[8]=0,e.data[9]=0,e.data[10]=1,e.data[11]=0,e.data[12]=0,e.data[13]=0,e.data[14]=0,e.data[15]=1,e}static translation(e,t){const i=ge.identity();return i.data[12]=e,i.data[13]=t,i}static scale(e,t){const i=ge.identity();return i.data[0]=e,i.data[5]=t,i.data[10]=1,i.data[15]=1,i}static rotation(e){const t=ge.identity();return t.data[0]=Math.cos(e),t.data[4]=-Math.sin(e),t.data[1]=Math.sin(e),t.data[5]=Math.cos(e),t}multiply(e,t){if(e instanceof E){const i=t||new E(0,0),n=e,r=n.x*this.data[0]+n.y*this.data[4]+this.data[12],s=n.x*this.data[1]+n.y*this.data[5]+this.data[13];return i.x=r,i.y=s,i}{const i=t||new ge,n=e,r=this.data[0],s=this.data[1],o=this.data[2],a=this.data[3],l=this.data[4],c=this.data[5],d=this.data[6],h=this.data[7],u=this.data[8],p=this.data[9],f=this.data[10],g=this.data[11],m=this.data[12],_=this.data[13],v=this.data[14],b=this.data[15],w=n.data[0],y=n.data[1],x=n.data[2],$=n.data[3],C=n.data[4],S=n.data[5],E=n.data[6],P=n.data[7],k=n.data[8],T=n.data[9],A=n.data[10],D=n.data[11],R=n.data[12],I=n.data[13],M=n.data[14],L=n.data[15];i.data[0]=r*w+l*y+u*x+m*$,i.data[1]=s*w+c*y+p*x+_*$,i.data[2]=o*w+d*y+f*x+v*$,i.data[3]=a*w+h*y+g*x+b*$,i.data[4]=r*C+l*S+u*E+m*P,i.data[5]=s*C+c*S+p*E+_*P,i.data[6]=o*C+d*S+f*E+v*P,i.data[7]=a*C+h*S+g*E+b*P,i.data[8]=r*k+l*T+u*A+m*D,i.data[9]=s*k+c*T+p*A+_*D,i.data[10]=o*k+d*T+f*A+v*D,i.data[11]=a*k+h*T+g*A+b*D,i.data[12]=r*R+l*I+u*M+m*L,i.data[13]=s*R+c*I+p*M+_*L,i.data[14]=o*R+d*I+f*M+v*L,i.data[15]=a*R+h*I+g*M+b*L;const B=this.getScale();return i._scaleSignX=O(B.x)*O(i._scaleSignX),i._scaleSignY=O(B.y)*O(i._scaleSignY),i}}translate(e,t){const i=this.data[0],n=this.data[1],r=this.data[2],s=this.data[3],o=this.data[4],a=this.data[5],l=this.data[6],c=this.data[7],d=this.data[8],h=this.data[9],u=this.data[10],p=this.data[11],f=this.data[12],g=this.data[13],m=this.data[14],_=this.data[15];return this.data[12]=i*e+o*t+0*d+1*f,this.data[13]=n*e+a*t+0*h+1*g,this.data[14]=r*e+l*t+0*u+1*m,this.data[15]=s*e+c*t+0*p+1*_,this}setPosition(e,t){this.data[12]=e,this.data[13]=t}getPosition(){return P(this.data[12],this.data[13])}rotate(e){const t=this.data[0],i=this.data[1],n=this.data[2],r=this.data[3],s=this.data[4],o=this.data[5],a=this.data[6],l=this.data[7],c=Math.sin(e),d=Math.cos(e);return this.data[0]=d*t+c*s,this.data[1]=d*i+c*o,this.data[2]=d*n+c*a,this.data[3]=d*r+c*l,this.data[4]=d*s-c*t,this.data[5]=d*o-c*i,this.data[6]=d*a-c*n,this.data[7]=d*l-c*r,this}scale(e,t){const i=this.data[0],n=this.data[1],r=this.data[2],s=this.data[3],o=this.data[4],a=this.data[5],l=this.data[6],c=this.data[7];return this.data[0]=i*e,this.data[1]=n*e,this.data[2]=r*e,this.data[3]=s*e,this.data[4]=o*t,this.data[5]=a*t,this.data[6]=l*t,this.data[7]=c*t,this}setRotation(e){const t=this.getScale(),i=Math.sin(e),n=Math.cos(e);this.data[0]=n*t.x,this.data[1]=i*t.y,this.data[4]=-i*t.x,this.data[5]=n*t.y}getRotation(){return N(Math.atan2(this.data[1]/this.getScaleY(),this.data[0]/this.getScaleX()))}getScaleX(){const e=P(this.data[0],this.data[4]).size;return this._scaleSignX*e}getScaleY(){const e=P(this.data[1],this.data[5]).size;return this._scaleSignY*e}getScale(){return P(this.getScaleX(),this.getScaleY())}setScaleX(e){this._scaleSignX=O(e);const t=P(this.data[0]*this._scaleSignX,this.data[4]*this._scaleSignX).normalize();this.data[0]=t.x*e,this.data[4]=t.y*e}setScaleY(e){this._scaleSignY=O(e);const t=P(this.data[1]*this._scaleSignY,this.data[5]*this._scaleSignY).normalize();this.data[1]=t.x*e,this.data[5]=t.y*e}setScale(e){this.setScaleX(e.x),this.setScaleY(e.y)}getBasisDeterminant(){return this.data[0]*this.data[5]-this.data[1]*this.data[4]}getAffineInverse(e){const t=1/this.getBasisDeterminant(),i=this.data[0],n=this.data[4],r=this.data[1],s=this.data[5],o=e||ge.identity();o.data[0]=s*t,o.data[1]=-r*t,o.data[4]=-n*t,o.data[5]=i*t;const a=this.data[12],l=this.data[13];return o.data[12]=-(a*o.data[0]+l*o.data[4]),o.data[13]=-(a*o.data[1]+l*o.data[5]),o}isIdentity(){return 1===this.data[0]&&0===this.data[1]&&0===this.data[2]&&0===this.data[3]&&0===this.data[4]&&1===this.data[5]&&0===this.data[6]&&0===this.data[7]&&0===this.data[8]&&0===this.data[9]&&1===this.data[10]&&0===this.data[11]&&0===this.data[12]&&0===this.data[13]&&0===this.data[14]&&1===this.data[15]}toString(){return`\n[${this.data[0]} ${this.data[4]} ${this.data[8]} ${this.data[12]}]\n[${this.data[1]} ${this.data[5]} ${this.data[9]} ${this.data[13]}]\n[${this.data[2]} ${this.data[6]} ${this.data[10]} ${this.data[14]}]\n[${this.data[3]} ${this.data[7]} ${this.data[11]} ${this.data[15]}]\n`}}class me{constructor(){this._transforms=[],this._currentTransform=ge.identity()}save(){this._transforms.push(this._currentTransform),this._currentTransform=this._currentTransform.clone()}restore(){this._currentTransform=this._transforms.pop()}translate(e,t){return this._currentTransform.translate(e,t)}rotate(e){return this._currentTransform.rotate(e)}scale(e,t){return this._currentTransform.scale(e,t)}set current(e){this._currentTransform=e}get current(){return this._currentTransform}}class _e{constructor(){this._states=[],this._currentState=this._getDefaultState()}_getDefaultState(){return{opacity:1}}_cloneState(){return{opacity:this._currentState.opacity}}save(){this._states.push(this._currentState),this._currentState=this._cloneState()}restore(){this._currentState=this._states.pop()}get current(){return this._currentState}}function ve(e,t){return e&&void 0===e.__isProxy?new Proxy(e,{set:(e,i,n)=>(e[i]!==n&&(e[i]=n,"string"==typeof i&&"_"!==i[0]&&t(e)),!0),get:(e,t)=>"__isProxy"===t||e[t]}):e}function be(e,t){return e&&void 0===e.__isProxy?new Proxy(e,{set:(e,i,n)=>(e[i]=n,"string"==typeof i&&"_"!==i[0]&&t(e),!0),get:(e,t)=>"__isProxy"===t||e[t]}):e}class we{constructor(e){var t,i,n,r,s,o;this.id=we._ID++,this.transform=ge.identity(),this._transformStale=!0,this.showDebug=!1,this._flipHorizontal=!1,this._flipVertical=!1,this._rotation=0,this.opacity=1,this._scale=E.One,this._origin=null,this._width=0,this._height=0,e&&(this.origin=null!==(t=e.origin)&&void 0!==t?t:this.origin,this.flipHorizontal=null!==(i=e.flipHorizontal)&&void 0!==i?i:this.flipHorizontal,this.flipVertical=null!==(n=e.flipVertical)&&void 0!==n?n:this.flipVertical,this.rotation=null!==(r=e.rotation)&&void 0!==r?r:this.rotation,this.opacity=null!==(s=e.opacity)&&void 0!==s?s:this.opacity,this.scale=null!==(o=e.scale)&&void 0!==o?o:this.scale)}isStale(){return this._transformStale}get flipHorizontal(){return this._flipHorizontal}set flipHorizontal(e){this._flipHorizontal=e,this._transformStale=!0}get flipVertical(){return this._flipVertical}set flipVertical(e){this._flipVertical=e,this._transformStale=!0}get rotation(){return this._rotation}set rotation(e){this._rotation=e,this._transformStale=!0}get scale(){return this._scale}set scale(e){this._scale=ve(e,(()=>{this._transformStale=!0})),this._transformStale=!0}get origin(){return this._origin}set origin(e){this._origin=ve(e,(()=>{this._transformStale=!0})),this._transformStale=!0}cloneGraphicOptions(){return{origin:this.origin?this.origin.clone():null,flipHorizontal:this.flipHorizontal,flipVertical:this.flipVertical,rotation:this.rotation,opacity:this.opacity,scale:this.scale?this.scale.clone():null}}get width(){return Math.abs(this._width*this.scale.x)}get height(){return Math.abs(this._height*this.scale.y)}set width(e){this._width=e,this._transformStale=!0}set height(e){this._height=e,this._transformStale=!0}get localBounds(){return I.fromDimension(this.width,this.height,E.Zero)}draw(e,t,i){this._preDraw(e,t,i),this._drawImage(e,0,0),this._postDraw(e)}_preDraw(e,t,i){e.save(),e.translate(t,i),this._transformStale&&(this.transform.reset(),this.transform.scale(Math.abs(this.scale.x),Math.abs(this.scale.y)),this._rotate(this.transform),this._flip(this.transform),this._transformStale=!1),e.multiply(this.transform),e.opacity=e.opacity*this.opacity}_rotate(e){var t;const i=this.scale.x>0?1:-1,n=this.scale.y>0?1:-1,r=null!==(t=this.origin)&&void 0!==t?t:P(this.width/2,this.height/2);e.translate(r.x,r.y),e.rotate(this.rotation),e.scale(i,n),e.translate(-r.x,-r.y)}_flip(e){this.flipHorizontal&&(e.translate(this.width/this.scale.x,0),e.scale(-1,1)),this.flipVertical&&(e.translate(0,this.height/this.scale.y),e.scale(1,-1))}_postDraw(e){this.showDebug&&e.debug.drawRect(0,0,this.width,this.height),e.restore()}}function ye(e){return 0==(e&e-1)}function xe(e){--e;for(let t=1;t<32;t<<=1)e|=e>>t;return e+1}function $e(e){return ye(e)?e:xe(e)}function Ce(e,t){switch(t){case e.FLOAT:return 4;case e.SHORT:case e.UNSIGNED_SHORT:return 2;case e.BYTE:case e.UNSIGNED_BYTE:default:return 1}}function Se(e,t){switch(t){case e.LOW_FLOAT:case e.HIGH_FLOAT:case e.FLOAT:return 1;case e.FLOAT_VEC2:return 2;case e.FLOAT_VEC3:return 3;case e.FLOAT_VEC4:return 4;case e.BYTE:case e.UNSIGNED_BYTE:case e.UNSIGNED_SHORT:case e.SHORT:default:return 1}}function Ee(e,t){switch(t){case e.LOW_FLOAT:case e.HIGH_FLOAT:case e.FLOAT:case e.FLOAT_VEC2:case e.FLOAT_VEC3:case e.FLOAT_VEC4:return e.FLOAT;case e.BYTE:return e.BYTE;case e.UNSIGNED_BYTE:return e.UNSIGNED_BYTE;case e.SHORT:return e.SHORT;case e.UNSIGNED_SHORT:return e.UNSIGNED_SHORT;default:return e.FLOAT}}we._ID=0,(ue=he||(he={})).Pixel="Pixel",ue.Blended="Blended";class Pe{static register(e){Pe._GL=e,Pe._MAX_TEXTURE_SIZE=e.getParameter(e.MAX_TEXTURE_SIZE)}static get(e){return Pe._TEXTURE_MAP.get(e)}static has(e){return Pe._TEXTURE_MAP.has(e)}static load(e,t,i=!1){const n=Pe._GL;if(!n)return null;let r=null;if(Pe.has(e)&&(r=Pe.get(e)),r){if(i){n.bindTexture(n.TEXTURE_2D,r);const t=Pe.toPowerOfTwoImage(e);n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,t)}return r}r=n.createTexture();const s=Pe.toPowerOfTwoImage(e);Pe.checkImageSizeSupportedAndLog(e),n.bindTexture(n.TEXTURE_2D,r),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE);const o=null!=t?t:Pe.filtering;return n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,o===he.Pixel?n.NEAREST:n.LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,o===he.Pixel?n.NEAREST:n.LINEAR),n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,s),Pe._TEXTURE_MAP.set(e,r),r}static toPowerOfTwoImage(e){const t=Pe._POT_CANVAS,i=Pe._POT_CTX;return ye(e.width)&&ye(e.height)||(t.width=$e(e.width),t.height=$e(e.height),i.imageSmoothingEnabled=!1,i.clearRect(0,0,t.width,t.height),i.drawImage(e,0,0,e.width,e.height),e=t),e}static checkImageSizeSupportedAndLog(e){var t;const i=null!==(t=e.dataset.originalSrc)&&void 0!==t?t:"internal canvas bitmap";return e.width>Pe._MAX_TEXTURE_SIZE||e.height>Pe._MAX_TEXTURE_SIZE?(Pe._LOGGER.error(`The image [${i}] provided to Excalibur is too large for the device's maximum texture size of (${Pe._MAX_TEXTURE_SIZE}x${Pe._MAX_TEXTURE_SIZE}) please resize to an image for excalibur to render properly.\n\nImages will likely render as black rectangles.\n\nRead more here: https://developer.mozilla.org/en-US/docs/Web/API/WebGL_API/WebGL_best_practices#understand_system_limits`),!1):((e.width>4096||e.height>4096)&&Pe._LOGGER.warn(`The image [${i}] provided to excalibur is too large may not work on all mobile devices, it is recommended you resize images to a maximum (4096x4096).\n\nImages will likely render as black rectangles on some mobile platforms.\n\nRead more here: https://developer.mozilla.org/en-US/docs/Web/API/WebGL_API/WebGL_best_practices#understand_system_limits`),!0)}}Pe._LOGGER=v.getInstance(),Pe.filtering=he.Blended,Pe._POT_CANVAS=document.createElement("canvas"),Pe._POT_CTX=Pe._POT_CANVAS.getContext("2d"),Pe._TEXTURE_MAP=new Map,Pe._MAX_TEXTURE_SIZE=0;class ke extends we{constructor(e){var t,i,n,r,s,o,a,l;super(e),this.filtering=null,this._dirty=!0,this._smoothing=!1,this._color=ve(D.Black,(()=>this.flagDirty())),this._lineWidth=1,this._lineDash=[],this._padding=0,e&&(this.color=null!==(t=e.color)&&void 0!==t?t:D.Black,this.strokeColor=null==e?void 0:e.strokeColor,this.smoothing=null!==(i=e.smoothing)&&void 0!==i?i:this.smoothing,this.lineWidth=null!==(n=e.lineWidth)&&void 0!==n?n:this.lineWidth,this.lineDash=null!==(r=e.lineDash)&&void 0!==r?r:this.lineDash,this.padding=null!==(s=e.padding)&&void 0!==s?s:this.padding,this.filtering=null!==(o=e.filtering)&&void 0!==o?o:this.filtering),this._bitmap=document.createElement("canvas");const c=null!==(a=null==e?void 0:e.width)&&void 0!==a?a:this._bitmap.width,d=null!==(l=null==e?void 0:e.height)&&void 0!==l?l:this._bitmap.height;this.width=$e(c),this.height=$e(d);const h=this._bitmap.getContext("2d");if(!h)throw new Error("Browser does not support 2d canvas drawing, cannot create Raster graphic");this._ctx=h}cloneRasterOptions(){return{color:this.color?this.color.clone():null,strokeColor:this.strokeColor?this.strokeColor.clone():null,smoothing:this.smoothing,lineWidth:this.lineWidth,lineDash:this.lineDash,padding:this.padding}}get dirty(){return this._dirty}flagDirty(){this._dirty=!0}get width(){return Math.abs(this._getTotalWidth()*this.scale.x)}set width(e){e/=Math.abs(this.scale.x),this._bitmap.width=e,this._originalWidth=e,this.flagDirty()}get height(){return Math.abs(this._getTotalHeight()*this.scale.y)}set height(e){e/=Math.abs(this.scale.y),this._bitmap.height=e,this._originalHeight=e,this.flagDirty()}_getTotalWidth(){var e;return(null!==(e=this._originalWidth)&&void 0!==e?e:this._bitmap.width)+2*this.padding}_getTotalHeight(){var e;return(null!==(e=this._originalHeight)&&void 0!==e?e:this._bitmap.height)+2*this.padding}get localBounds(){return I.fromDimension(this._getTotalWidth()*this.scale.x,this._getTotalHeight()*this.scale.y,E.Zero)}get smoothing(){return this._smoothing}set smoothing(e){this._smoothing=e,this.flagDirty()}get color(){return this._color}set color(e){this.flagDirty(),this._color=ve(e,(()=>this.flagDirty()))}get strokeColor(){return this._strokeColor}set strokeColor(e){this.flagDirty(),this._strokeColor=ve(e,(()=>this.flagDirty()))}get lineWidth(){return this._lineWidth}set lineWidth(e){this._lineWidth=e,this.flagDirty()}get lineDash(){return this._lineDash}set lineDash(e){this._lineDash=e,this.flagDirty()}get padding(){return this._padding}set padding(e){this._padding=e,this.flagDirty()}rasterize(){this._dirty=!1,this._ctx.clearRect(0,0,this._getTotalWidth(),this._getTotalHeight()),this._ctx.save(),this._applyRasterProperties(this._ctx),this.execute(this._ctx),this._ctx.restore(),Pe.load(this._bitmap,this.filtering,!0)}_applyRasterProperties(e){var t,i,n;this._bitmap.width=this._getTotalWidth(),this._bitmap.height=this._getTotalHeight(),e.translate(this.padding,this.padding),e.imageSmoothingEnabled=this.smoothing,e.lineWidth=this.lineWidth,e.setLineDash(null!==(t=this.lineDash)&&void 0!==t?t:e.getLineDash()),e.strokeStyle=null===(i=this.strokeColor)||void 0===i?void 0:i.toString(),e.fillStyle=null===(n=this.color)||void 0===n?void 0:n.toString()}_drawImage(e,t,i){this._dirty&&this.rasterize(),e.drawImage(this._bitmap,t,i)}}class Te extends ke{constructor(e){super(e),this._options=e}get ctx(){return this._ctx}clone(){return new Te({...this._options,...this.cloneGraphicOptions(),...this.cloneRasterOptions()})}execute(e){var t,i;(null===(t=this._options)||void 0===t?void 0:t.draw)&&(null===(i=this._options)||void 0===i||i.draw(e)),this._options.cache||this.flagDirty()}}(fe=pe||(pe={})).Kill="kill",fe.PreKill="prekill",fe.PostKill="postkill",fe.PreDraw="predraw",fe.PostDraw="postdraw",fe.PreDebugDraw="predebugdraw",fe.PostDebugDraw="postdebugdraw",fe.PreUpdate="preupdate",fe.PostUpdate="postupdate",fe.PreFrame="preframe",fe.PostFrame="postframe",fe.PreCollision="precollision",fe.CollisionStart="collisionstart",fe.CollisionEnd="collisionend",fe.PostCollision="postcollision",fe.Initialize="initialize",fe.Activate="activate",fe.Deactivate="deactivate",fe.ExitViewport="exitviewport",fe.EnterViewport="enterviewport",fe.ExitTrigger="exit",fe.EnterTrigger="enter",fe.Connect="connect",fe.Disconnect="disconnect",fe.Button="button",fe.Axis="axis",fe.Subscribe="subscribe",fe.Unsubscribe="unsubscribe",fe.Visible="visible",fe.Hidden="hidden",fe.Start="start",fe.Stop="stop",fe.PointerUp="pointerup",fe.PointerDown="pointerdown",fe.PointerMove="pointermove",fe.PointerEnter="pointerenter",fe.PointerLeave="pointerleave",fe.PointerCancel="pointercancel",fe.PointerWheel="pointerwheel",fe.Up="up",fe.Down="down",fe.Move="move",fe.Enter="enter",fe.Leave="leave",fe.Cancel="cancel",fe.Wheel="wheel",fe.Press="press",fe.Release="release",fe.Hold="hold",fe.PointerDragStart="pointerdragstart",fe.PointerDragEnd="pointerdragend",fe.PointerDragEnter="pointerdragenter",fe.PointerDragLeave="pointerdragleave",fe.PointerDragMove="pointerdragmove";class Ae{constructor(){this._bubbles=!0}get bubbles(){return this._bubbles}set bubbles(e){this._bubbles=e}stopPropagation(){this.bubbles=!1}}class De extends Ae{constructor(e){super(),this.target=e}}class Re extends Ae{constructor(e){super(),this.target=e}}class Ie extends Ae{constructor(e){super(),this.target=e}}class Me extends Ae{constructor(e){super(),this.target=e}}class Le extends Ae{constructor(e){super(),this.target=e}}class Be extends Ae{constructor(e,t,i){super(),this.ctx=e,this.delta=t,this.target=i}}class Fe extends Ae{constructor(e,t,i){super(),this.ctx=e,this.delta=t,this.target=i}}class Oe extends Ae{constructor(e,t){super(),this.ctx=e,this.target=t}}class ze extends Ae{constructor(e,t){super(),this.ctx=e,this.target=t}}class Ne extends Ae{constructor(e,t,i){super(),this.engine=e,this.delta=t,this.target=i}}class Ve extends Ae{constructor(e,t,i){super(),this.engine=e,this.delta=t,this.target=i}}class Ue extends Ae{constructor(e,t){super(),this.engine=e,this.prevStats=t,this.target=e}}class He extends Ae{constructor(e,t){super(),this.engine=e,this.stats=t,this.target=e}}class je extends Ae{constructor(e,t){super(),this.index=e,this.gamepad=t,this.target=t}}class We extends Ae{constructor(e,t){super(),this.index=e,this.gamepad=t,this.target=t}}class Ge extends Ae{constructor(e,t,i){super(),this.button=e,this.value=t,this.target=i}}class qe extends Ae{constructor(e,t,i){super(),this.axis=e,this.value=t,this.target=i}}class Ke extends Ae{constructor(e,t){super(),this.topic=e,this.handler=t}}class Xe extends Ae{constructor(e,t){super(),this.topic=e,this.handler=t}}class Ye extends Ae{constructor(e){super(),this.target=e}}class Qe extends Ae{constructor(e){super(),this.target=e}}class Ze extends Ae{constructor(e,t,i,n){super(),this.other=t,this.side=i,this.intersection=n,this.target=e}}class Je extends Ae{constructor(e,t,i,n){super(),this.other=t,this.side=i,this.intersection=n,this.target=e}get actor(){return this.target}set actor(e){this.target=e}}class et{constructor(e,t,i){this.target=e,this.other=t,this.contact=i}}class tt{constructor(e,t){this.target=e,this.other=t}}class it{constructor(e,t,i,n,r){this.target=e,this.other=t,this.side=i,this.intersection=n,this.contact=r}}class nt{constructor(e,t,i,n,r){this.target=e,this.other=t,this.side=i,this.intersection=n,this.contact=r}}class rt extends Ae{constructor(e,t,i){super(),this.other=t,this.contact=i,this.target=e}get actor(){return this.target}set actor(e){this.target=e}}class st extends Ae{constructor(e,t){super(),this.other=t,this.target=e}get actor(){return this.target}set actor(e){this.target=e}}class ot extends Ae{constructor(e,t){super(),this.engine=e,this.target=t}}class at extends Ae{constructor(e,t){super(),this.oldScene=e,this.target=t}}class lt extends Ae{constructor(e,t){super(),this.newScene=e,this.target=t}}class ct extends Ae{constructor(e){super(),this.target=e}}class dt extends Ae{constructor(e){super(),this.target=e}}class ht extends Ae{constructor(e,t){super(),this.target=e,this.actor=t}}class ut extends Ae{constructor(e,t){super(),this.target=e,this.actor=t}}class pt{constructor(){this._handlers={},this._wiredEventDispatchers=[]}clear(){this._handlers={},this._wiredEventDispatchers=[]}emit(e,t){if(!e)return;let i,n;if(e=e.toLowerCase(),t||(t=new Ae),this._handlers[e])for(i=0,n=this._handlers[e].length;i<n;i++)this._handlers[e][i](t);for(i=0,n=this._wiredEventDispatchers.length;i<n;i++)this._wiredEventDispatchers[i].emit(e,t)}on(e,t){e=e.toLowerCase(),this._handlers[e]||(this._handlers[e]=[]),this._handlers[e].push(t),"unsubscribe"!==e&&"subscribe"!==e&&this.emit("subscribe",new Ke(e,t))}off(e,t){e=e.toLowerCase();const i=this._handlers[e];if(i)if(t){const n=i.indexOf(t);this._handlers[e].splice(n,1)}else this._handlers[e].length=0;"unsubscribe"!==e&&"subscribe"!==e&&this.emit("unsubscribe",new Xe(e,t))}once(e,t){this.on(e,(i=>{const n=i||new Ae;this.off(e,t),t(n)}))}wire(e){e._wiredEventDispatchers.push(this)}unwire(e){const t=e._wiredEventDispatchers.indexOf(this);t>-1&&e._wiredEventDispatchers.splice(t,1)}}class ft{constructor(e,t,i=!0){this.path=e,this.responseType=t,this.bustCache=i,this.data=null,this.logger=v.getInstance(),this.events=new pt}isLoaded(){return null!==this.data}_cacheBust(e){return/\?\w*=\w*/.test(e)?e+="&__="+Date.now():e+="?__="+Date.now(),e}load(){return new Promise(((e,t)=>{if(null!==this.data)return this.logger.debug("Already have data for resource",this.path),this.events.emit("complete",this.data),void e(this.data);const i=new XMLHttpRequest;i.open("GET",this.bustCache?this._cacheBust(this.path):this.path,!0),i.responseType=this.responseType,i.addEventListener("loadstart",(e=>this.events.emit("loadstart",e))),i.addEventListener("progress",(e=>this.events.emit("progress",e))),i.addEventListener("error",(e=>this.events.emit("error",e))),i.addEventListener("load",(e=>this.events.emit("load",e))),i.addEventListener("load",(()=>{if(0!==i.status&&200!==i.status)return this.logger.error("Failed to load resource ",this.path," server responded with error code",i.status),this.events.emit("error",i.response),void t(new Error(i.statusText));this.data=i.response,this.events.emit("complete",this.data),this.logger.debug("Completed loading resource",this.path),e(this.data)})),i.send()}))}}var gt=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};let mt=class{updatePixel(e,t,i){const n=4*(e+t*i.width),r=i.data,s=(r[n+0]+r[n+1]+r[n+2])/3;r[n+0]=s,r[n+1]=s,r[n+2]=s}};mt=gt([S({message:"Grayscale will be removed in v0.26.0"})],mt);let _t=class{updatePixel(e,t,i){const n=4*(e+t*i.width),r=i.data;r[n+0]=255-r[n+0],r[n+1]=255-r[n+1],r[n+2]=255-r[n+2]}};_t=gt([S({message:"Invert will be removed in v0.26.0"})],_t);let vt=class{constructor(e){this.opacity=e}updatePixel(e,t,i){const n=4*(e+t*i.width),r=i.data;0!==r[n+3]&&(r[n+3]=Math.round(this.opacity*r[n+3]))}};vt=gt([S({message:"Opacity will be removed in v0.26.0"})],vt);let bt=class{constructor(e){this.color=e}updatePixel(e,t,i){const n=4*(e+t*i.width),r=i.data;0!==r[n+3]&&(r[n+0]=(r[n+0]+this.color.r)/2,r[n+1]=(r[n+1]+this.color.g)/2,r[n+2]=(r[n+2]+this.color.b)/2)}};bt=gt([S({message:"Colorize will be removed in v0.26.0"})],bt);let wt=class{constructor(e=.1){this.factor=e}updatePixel(e,t,i){const n=4*(e+t*i.width),r=i.data,s=D.fromRGB(r[n+0],r[n+1],r[n+2],r[n+3]).lighten(this.factor);r[n+0]=s.r,r[n+1]=s.g,r[n+2]=s.b,r[n+3]=s.a}};wt=gt([S({message:"Lighten will be removed in v0.26.0"})],wt);let yt=class{constructor(e=.1){this.factor=e}updatePixel(e,t,i){const n=4*(e+t*i.width),r=i.data,s=D.fromRGB(r[n+0],r[n+1],r[n+2],r[n+3]).darken(this.factor);r[n+0]=s.r,r[n+1]=s.g,r[n+2]=s.b,r[n+3]=s.a}};yt=gt([S({message:"Darken will be removed v0.26.0"})],yt);let xt=class{constructor(e=.1){this.factor=e}updatePixel(e,t,i){const n=4*(e+t*i.width),r=i.data,s=D.fromRGB(r[n+0],r[n+1],r[n+2],r[n+3]).saturate(this.factor);r[n+0]=s.r,r[n+1]=s.g,r[n+2]=s.b,r[n+3]=s.a}};xt=gt([S({message:"Saturate will be removed in v0.26.0"})],xt);let $t=class{constructor(e=.1){this.factor=e}updatePixel(e,t,i){const n=4*(e+t*i.width),r=i.data,s=D.fromRGB(r[n+0],r[n+1],r[n+2],r[n+3]).desaturate(this.factor);r[n+0]=s.r,r[n+1]=s.g,r[n+2]=s.b,r[n+3]=s.a}};$t=gt([S({message:"Desaturate will be removed in v0.26.0"})],$t);let Ct=class{constructor(e){this.color=e}updatePixel(e,t,i){const n=4*(e+t*i.width),r=i.data;0!==r[n+3]&&(r[n+0]=this.color.r,r[n+1]=this.color.g,r[n+2]=this.color.b)}};Ct=gt([S({message:"Fill will be removed in v0.26.0"})],Ct);class St{constructor(e,t=!0){this.path=e,this.bustCache=t,this._sprite=null,this.loaded=new Promise((e=>{this._loadedResolve=e})),this._resource=new ft(e,"blob",t),this._sprite=new kt(this,0,0,0,0)}get image(){return this.data}isLoaded(){return!!this.data}async load(){try{let e;if(this.path.includes("data:image/"))e=this.path;else{const t=await this._resource.load();e=URL.createObjectURL(t)}const t=new Image;t.src=e,await t.decode(),this.data=t,this.width=this._sprite.width=t.naturalWidth,this.height=this._sprite.height=t.naturalHeight,this._sprite=new kt(this,0,0,this.width,this.height)}catch(e){await Promise.reject("Error loading texture")}return this._loadedResolve(this.data),this.data}asSprite(){return this._sprite}}function Et(e){return class extends e{assign(e){for(const t in e)"function"!=typeof this[t]&&(this[t]=e[t])}constructor(...e){super(...e),1!==e.filter((function(e){return void 0!==e})).length||!e[0]||"object"!=typeof e[0]||e[0]instanceof Array||this.assign(e[0])}}}class Pt{constructor(e,t,i,n,r){this.x=0,this.y=0,this.rotation=0,this.anchor=E.Half,this.offset=E.Zero,this.scale=E.One,this.drawAroundAnchor=!1,this.logger=v.getInstance(),this.flipVertical=!1,this.flipHorizontal=!1,this.effects=[],this.width=0,this.height=0,this._spriteCanvas=null,this._spriteCtx=null,this._pixelData=null,this._pixelsLoaded=!1,this._dirtyEffect=!0,this._opacity=1;let s=e;if(e&&!(e instanceof St)&&(t=0|e.x,i=0|e.y,n=0|e.width,r=0|e.height,s=e.image,!s))throw new Error("An image texture is required to construct a sprite");this.x=t||0,this.y=i||0,this.texture=s,this._spriteCanvas=document.createElement("canvas"),this._spriteCanvas.width=n,this._spriteCanvas.height=r,this._spriteCtx=this._spriteCanvas.getContext("2d"),this._initPixelsFromTexture(),this.width=n,this.height=r}get drawWidth(){return Math.abs(this.width*this.scale.x)}get drawHeight(){return Math.abs(this.height*this.scale.y)}async _initPixelsFromTexture(){try{const e=await this.texture.loaded;this.width=this.width||e.naturalWidth,this.height=this.height||e.naturalHeight,this._spriteCanvas.width=this._spriteCanvas.width||e.naturalWidth,this._spriteCanvas.height=this._spriteCanvas.height||e.naturalHeight,this._loadPixels(),this._dirtyEffect=!0}catch(e){this.logger.error("Error loading texture ",this.texture.path,e)}}_loadPixels(){if(this.texture.isLoaded()&&!this._pixelsLoaded){const e=this.texture.image.naturalWidth||0,t=this.texture.image.naturalHeight||0;if(this.width>e&&this.logger.warn(`The sprite width ${this.width} exceeds the width \n                              ${e} of the backing texture ${this.texture.path}`),this.width<=0||e<=0)throw new Error(`The width of a sprite cannot be 0 or negative, sprite width: ${this.width}, original width: ${e}`);if(this.height>t&&this.logger.warn(`The sprite height ${this.height} exceeds the height \n                              ${t} of the backing texture ${this.texture.path}`),this.height<=0||t<=0)throw new Error(`The height of a sprite cannot be 0 or negative, sprite height: ${this.height}, original height: ${t}`);this._flushTexture(),this._pixelsLoaded=!0}}_flushTexture(){const e=this.texture.image.naturalWidth||0,t=this.texture.image.naturalHeight||0;this._spriteCtx.clearRect(0,0,this.width,this.height),this._spriteCtx.drawImage(this.texture.image,z(this.x,0,e),z(this.y,0,t),z(this.width,0,e),z(this.height,0,t),0,0,this.width,this.height)}opacity(e){this._opacity=e}grayscale(){this.addEffect(new mt)}invert(){this.addEffect(new _t)}fill(e){this.addEffect(new Ct(e))}colorize(e){this.addEffect(new bt(e))}lighten(e=.1){this.addEffect(new wt(e))}darken(e=.1){this.addEffect(new yt(e))}saturate(e=.1){this.addEffect(new xt(e))}desaturate(e=.1){this.addEffect(new $t(e))}addEffect(e){this.effects.push(e),this.texture.isLoaded()&&this._pixelsLoaded?this._applyEffects():this._dirtyEffect=!0}removeEffect(e){let t=-1;t="number"==typeof e?e:this.effects.indexOf(e),t<0||t>=this.effects.length||(this.effects.splice(t,1),this.texture.isLoaded()&&this._pixelsLoaded?this._applyEffects():this._dirtyEffect=!0)}_applyEffects(){if(this._flushTexture(),this.effects.length>0){this._pixelData=this._spriteCtx.getImageData(0,0,this.width,this.height);const e=this.effects.length;for(let t=0;t<e;t++)for(let e=0;e<this.height;e++)for(let i=0;i<this.width;i++)this.effects[t].updatePixel(i,e,this._pixelData);this._spriteCtx.clearRect(0,0,this.width,this.height),this._spriteCtx.putImageData(this._pixelData,0,0)}this._dirtyEffect=!1}clearEffects(){this.effects.length=0,this._applyEffects()}reset(){}debugDraw(e,t,i){e.save(),e.translate(t,i),e.rotate(this.rotation);const n=this.drawWidth*this.anchor.x,r=this.drawHeight*this.anchor.y;e.strokeStyle=D.Black.toString(),e.strokeRect(-n,-r,this.drawWidth,this.drawHeight),e.restore()}draw(e,t,i){e instanceof CanvasRenderingContext2D?this._drawWithOptions({ctx:e,x:t,y:i}):this._drawWithOptions(e)}_drawWithOptions(e){var t,i,n,r,s,o,a,l,c;const{ctx:d,x:h,y:u,rotation:p,drawWidth:f,drawHeight:g,anchor:m,offset:_,opacity:v,flipHorizontal:b,flipVertical:w}={...e,rotation:null!==(t=e.rotation)&&void 0!==t?t:this.rotation,drawWidth:null!==(i=e.drawWidth)&&void 0!==i?i:this.width,drawHeight:null!==(n=e.drawHeight)&&void 0!==n?n:this.height,flipHorizontal:null!==(r=e.flipHorizontal)&&void 0!==r?r:this.flipHorizontal,flipVertical:null!==(s=e.flipVertical)&&void 0!==s?s:this.flipVertical,anchor:null!==(o=e.anchor)&&void 0!==o?o:this.anchor,offset:null!==(a=e.offset)&&void 0!==a?a:this.offset,opacity:(null!==(l=e.opacity)&&void 0!==l?l:1)*(null!==(c=this._opacity)&&void 0!==c?c:1)};this._dirtyEffect&&this._applyEffects();const y=f*m.x+_.x,x=g*m.y+_.y,$=this.scale.x>0?1:-1,C=this.scale.y>0?1:-1;d.save(),d.translate(h,u),d.scale(Math.abs(this.scale.x),Math.abs(this.scale.y)),this.drawAroundAnchor&&d.translate(-y,-x),d.translate(y,x),d.rotate(p),d.scale($,C),d.translate(-y,-x),b&&(d.translate(f,0),d.scale(-1,1)),w&&(d.translate(0,g),d.scale(1,-1));const S=d.globalAlpha;d.globalAlpha=v,d.drawImage(this._spriteCanvas,0,0,this.width,this.height,0,0,this.width,this.height),d.globalAlpha=S,d.restore()}clone(){const e=new kt(this.texture,this.x,this.y,this.width,this.height);e.anchor=this.anchor.clone(),e.scale=this.scale.clone(),e.rotation=this.rotation,e.flipHorizontal=this.flipHorizontal,e.flipVertical=this.flipVertical;const t=this.effects.length;for(let i=0;i<t;i++)e.addEffect(this.effects[i]);return e}}let kt=class extends(Et(Pt)){constructor(e,t,i,n,r){super(e,t,i,n,r)}};kt=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o}([S({message:"Label.clearTextShadow will be removed in v0.26.0",alternateMethod:"Use Label.font.shadow"})],kt);class Tt extends we{constructor(e){var t,i;super(e),this._dirty=!0,this.image=e.image;const{width:n,height:r}=e;this.sourceView=null!==(t=e.sourceView)&&void 0!==t?t:{x:0,y:0,width:null!=n?n:0,height:null!=r?r:0},this.destSize=null!==(i=e.destSize)&&void 0!==i?i:{width:null!=n?n:0,height:null!=r?r:0},this._updateSpriteDimensions(),this.image.ready.then((()=>{this._updateSpriteDimensions()}))}static from(e){return new Tt({image:e})}get width(){return Math.abs(this.destSize.width*this.scale.x)}get height(){return Math.abs(this.destSize.height*this.scale.y)}set width(e){e/=Math.abs(this.scale.x),this.destSize.width=e,super.width=Math.ceil(this.destSize.width)}set height(e){e/=Math.abs(this.scale.y),this.destSize.height=e,super.height=Math.ceil(this.destSize.height)}_updateSpriteDimensions(){var e,t,i,n,r,s;const{width:o,height:a}=this.image;this.sourceView.width=(null===(e=this.sourceView)||void 0===e?void 0:e.width)||o,this.sourceView.height=(null===(t=this.sourceView)||void 0===t?void 0:t.height)||a,this.destSize.width=(null===(i=this.destSize)||void 0===i?void 0:i.width)||(null===(n=this.sourceView)||void 0===n?void 0:n.width)||o,this.destSize.height=(null===(r=this.destSize)||void 0===r?void 0:r.height)||(null===(s=this.sourceView)||void 0===s?void 0:s.height)||a,this.width=Math.ceil(this.destSize.width)*this.scale.x,this.height=Math.ceil(this.destSize.height)*this.scale.y}_preDraw(e,t,i){this.image.isLoaded()&&this._dirty&&(this._dirty=!1,this._updateSpriteDimensions()),super._preDraw(e,t,i)}_drawImage(e,t,i){this.image.isLoaded()&&e.drawImage(this.image.image,this.sourceView.x,this.sourceView.y,this.sourceView.width,this.sourceView.height,t,i,this.destSize.width,this.destSize.height)}static fromLegacySprite(e){const t=e.texture,i=At.fromLegacyTexture(t);return new Tt({image:i,sourceView:{x:e.x,y:e.y,width:e.width,height:e.height}})}static toLegacySprite(e){const t=e.image,i=new St(t.path);return i.data=t.image,new kt(i,e.sourceView.x,e.sourceView.y,e.sourceView.width,e.sourceView.height)}clone(){return new Tt({image:this.image,sourceView:{...this.sourceView},destSize:{...this.destSize},...this.cloneGraphicOptions()})}}class At{constructor(e,t=!1,i){this.path=e,this._logger=v.getInstance(),this.data=new Image,this._resource=new ft(e,"blob",t),this._filtering=i,(e.endsWith(".svg")||e.endsWith(".gif"))&&this._logger.warn(`Image type is not fully supported, you may have mixed results ${e}. Fully supported: jpg, bmp, and png`),this.ready=new Promise((e=>{this._loadedResolve=e}))}get width(){return this.image.naturalWidth}get height(){return this.image.naturalHeight}isLoaded(){return this._src||(this._src=this.data.src),!!this._src}get image(){return this.data}async load(){if(this.isLoaded())return this.data;try{let e;if(this.path.includes("data:image/"))e=this.path;else{const t=await this._resource.load();e=URL.createObjectURL(t)}const t=new Image;t.src=e,t.setAttribute("data-original-src",this.path),await t.decode(),this.data=t}catch(e){throw`Error loading ImageSource from path '${this.path}' with error [${e.message}]`}return Pe.load(this.data,this._filtering),this._loadedResolve(this.data),this.data}toSprite(){return Tt.from(this)}static fromLegacyTexture(e){const t=new At(e.path);return e.isLoaded()?t.data=e.data:e.loaded.then((()=>{t.data=e.data})),t}unload(){this.data=new Image}}class Dt{constructor(e,t,i,n){this.sprites=[],this.currentFrame=0,this._timeLeftInFrame=0,this._idempotencyToken=-1,this.anchor=E.Zero,this.rotation=0,this.scale=E.One,this.loop=!0,this.freezeFrame=-1,this.flipVertical=!1,this.flipHorizontal=!1,this.drawWidth=0,this.drawHeight=0,this.width=0,this.height=0,this._opacity=1;let r=e;if(e&&!(e instanceof Xs)){const s=e;r=s.engine,t=s.sprites,i=s.speed,n=s.loop}this.sprites=t,this.speed=i,this._engine=r,this._timeLeftInFrame=this.speed,null!=n&&(this.loop=n),t&&t[0]&&(this.drawHeight=t[0]?t[0].drawHeight:0,this.drawWidth=t[0]?t[0].drawWidth:0,this.width=t[0]?t[0].width:0,this.height=t[0]?t[0].height:0,this.freezeFrame=t.length-1)}opacity(e){this._opacity=e}grayscale(){this.addEffect(new mt)}invert(){this.addEffect(new _t)}fill(e){this.addEffect(new Ct(e))}colorize(e){this.addEffect(new bt(e))}lighten(e=.1){this.addEffect(new wt(e))}darken(e=.1){this.addEffect(new yt(e))}saturate(e=.1){this.addEffect(new xt(e))}desaturate(e=.1){this.addEffect(new $t(e))}addEffect(e){for(const t in this.sprites)this.sprites[t].addEffect(e)}removeEffect(e){for(const t in this.sprites)this.sprites[t].removeEffect(e)}clearEffects(){for(const e in this.sprites)this.sprites[e].clearEffects()}_setAnchor(e){for(const t in this.sprites)this.sprites[t].anchor.setTo(e.x,e.y)}_setRotation(e){for(const t in this.sprites)this.sprites[t].rotation=e}_setScale(e){for(const t in this.sprites)this.sprites[t].scale=e}reset(){this.currentFrame=0}isDone(){return!this.loop&&this.currentFrame>=this.sprites.length}tick(e,t){if(this._idempotencyToken===t)return;this._idempotencyToken=t,this._timeLeftInFrame-=e,this._timeLeftInFrame<=0&&(this.currentFrame=this.loop?(this.currentFrame+1)%this.sprites.length:this.currentFrame+1,this._timeLeftInFrame=this.speed),this._updateValues();const i=this.sprites[this.currentFrame];i&&(this.width=i.width,this.height=i.height,this.drawWidth=i.drawWidth,this.drawHeight=i.drawHeight)}_updateValues(){this._setAnchor(this.anchor),this._setRotation(this.rotation),this._setScale(this.scale)}skip(e){this.currentFrame=(this.currentFrame+e)%this.sprites.length}draw(e,t,i){e instanceof CanvasRenderingContext2D?this._drawWithOptions({ctx:e,x:t,y:i}):this._drawWithOptions(e)}_drawWithOptions(e){var t,i,n,r,s,o,a,l;const c={...e,rotation:null!==(t=e.rotation)&&void 0!==t?t:this.rotation,drawWidth:null!==(i=e.drawWidth)&&void 0!==i?i:this.drawWidth,drawHeight:null!==(n=e.drawHeight)&&void 0!==n?n:this.drawHeight,flipHorizontal:null!==(r=e.flipHorizontal)&&void 0!==r?r:this.flipHorizontal,flipVertical:null!==(s=e.flipVertical)&&void 0!==s?s:this.flipVertical,anchor:null!==(o=e.anchor)&&void 0!==o?o:this.anchor,opacity:(null!==(a=e.opacity)&&void 0!==a?a:1)*(null!==(l=this._opacity)&&void 0!==l?l:1)};let d;this._updateValues(),this.currentFrame<this.sprites.length&&(d=this.sprites[this.currentFrame],d.draw(c)),-1!==this.freezeFrame&&this.currentFrame>=this.sprites.length&&(d=this.sprites[z(this.freezeFrame,0,this.sprites.length-1)],d.draw(c)),d&&(this.drawWidth=d.drawWidth,this.drawHeight=d.drawHeight)}play(e,t){this.reset(),this._engine.playAnimation(this,e,t)}}let Rt=class extends(Et(Dt)){constructor(e,t,i,n){super(e,t,i,n)}};var It,Mt,Lt,Bt,Ft,Ot,zt,Nt,Vt,Ut;Rt=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o}([S({message:"Animation will be removed in v0.26.0",alternateMethod:"Use Graphics.Animation"})],Rt),(Mt=It||(It={})).Em="em",Mt.Rem="rem",Mt.Px="px",Mt.Pt="pt",Mt.Percent="%",(Bt=Lt||(Lt={})).Left="left",Bt.Right="right",Bt.Center="center",Bt.Start="start",Bt.End="end",(Ot=Ft||(Ft={})).Top="top",Ot.Hanging="hanging",Ot.Middle="middle",Ot.Alphabetic="alphabetic",Ot.Ideographic="ideographic",Ot.Bottom="bottom",(Nt=zt||(zt={})).Normal="normal",Nt.Italic="italic",Nt.Oblique="oblique",(Ut=Vt||(Vt={})).LeftToRight="ltr",Ut.RightToLeft="rtl";class Ht{constructor(e,t,i,n,r,s){this._sprites=[],this._image=null,this._columns=0,this._rows=0,this._spWidth=0,this._spHeight=0,this._spacing=0;let o=!1;if(e instanceof Array?this._sprites=e:(!e||e instanceof St?(this._image=e,this._columns=t,this._rows=i,this._spWidth=n,this._spHeight=r,this._spacing=s||0):(this._columns=e.columns,this._rows=e.rows,this._spWidth=e.spWidth,this._spHeight=e.spHeight,this._image=e.image,this._spacing=e.spacing||0),this._sprites=new Array(this._columns*this._rows),o=!0),this.image instanceof St){let e=!1,t=!1;if(this.image.isLoaded()){if(e=this.spWidth*this.columns>this.image.image.naturalWidth,t=this.spHeight*this.rows>this.image.image.naturalHeight,e)throw new RangeError(`SpriteSheet specified is wider, ${this.columns} cols x ${this.spWidth} pixels > ${this.image.image.naturalWidth} pixels than image width`);if(t)throw new RangeError(`SpriteSheet specified is taller, ${this.rows} rows x ${this.spHeight} pixels > ${this.image.image.naturalHeight} pixels than image height`)}}if(o){const e=this.getSpacingDimensions();for(let t=0;t<this.rows;t++)for(let i=0;i<this.columns;i++)this._sprites[i+t*this.columns]=new kt(this.image,i*this.spWidth+e.margin*i+e.left,t*this.spHeight+e.margin*t+e.top,this.spWidth,this.spHeight)}}get spacing(){return this._spacing}get sprites(){return[...this._sprites]}get image(){return this._image}get columns(){return this._columns}get rows(){return this._rows}get spWidth(){return this._spWidth}get spHeight(){return this._spHeight}getSpacingDimensions(){var e,t,i;return"number"==typeof this.spacing?{left:this.spacing,top:this.spacing,margin:this.spacing}:{left:null!==(e=this.spacing.left)&&void 0!==e?e:0,top:null!==(t=this.spacing.top)&&void 0!==t?t:0,margin:null!==(i=this.spacing.margin)&&void 0!==i?i:0}}getAnimationByIndices(e,t,i){let n=t.map((e=>this.sprites[e]));return n=n.map((function(e){return e.clone()})),new Rt(e,n,i)}getAnimationBetween(e,t,i,n){let r=this.sprites.slice(t,i);return r=r.map((function(e){return e.clone()})),new Rt(e,r,n)}getAnimationForAll(e,t){const i=this.sprites.map((function(e){return e.clone()}));return new Rt(e,i,t)}getSprite(e){if(e>=0&&e<this.sprites.length)return this.sprites[e];throw new Error("Invalid index: "+e)}getAnimationByCoords(e,t,i){let n=0,r=0;const s=new Array(t.length);for(let e=0;e<t.length;e++){const i=t[e];i.image=i.image||this.image,n=Math.max(n,i.drawWidth),r=Math.max(r,i.drawHeight),s[e]=new kt(i)}const o=new Rt(e,s,i);return o.drawWidth=n,o.drawHeight=r,o}}let jt=class extends Ht{constructor(e,t,i,n,r,s,o,a){super(e instanceof St?{image:e,spWidth:s,spHeight:o,rows:r,columns:n,spacing:a||0}:e),this._currentColor=D.Black,this._currentOpacity=1,this._spriteRecord={},this._textShadowOn=!1,this._textShadowDirty=!0,this._textShadowColor=D.Black,this._textShadowSprites={},this._shadowOffsetX=5,this._shadowOffsetY=5,!e||e instanceof St||(t=e.alphabet,i=e.caseInsensitive),this.alphabet=t,this.caseInsensitive=i,this._spriteRecord=this.getTextSprites()}getTextSprites(){const e={};for(let t=0;t<this.alphabet.length;t++){let i=this.alphabet[t];this.caseInsensitive&&(i=i.toLowerCase()),e[i]=this.sprites[t].clone()}return e}setTextShadow(e,t,i){this._textShadowOn=!0,this._shadowOffsetX=e,this._shadowOffsetY=t,this._textShadowColor=i.clone(),this._textShadowDirty=!0;for(const e in this._spriteRecord)this._textShadowSprites[e]=this._spriteRecord[e].clone()}useTextShadow(e){this._textShadowOn=e,e&&this.setTextShadow(5,5,this._textShadowColor)}draw(e,t,i,n,r){if(r=this._parseOptions(r),this._currentColor.toString()!==r.color.toString()||this._currentOpacity!==r.opacity){this._currentOpacity=r.opacity,this._currentColor=r.color;for(const e in this._spriteRecord)this._spriteRecord[e].clearEffects(),this._spriteRecord[e].fill(r.color),this._spriteRecord[e].opacity(r.opacity)}if(this._textShadowOn&&this._textShadowDirty&&this._textShadowColor){for(const e in this._textShadowSprites)this._textShadowSprites[e].clearEffects(),this._textShadowSprites[e].addEffect(new Ct(this._textShadowColor.clone()));this._textShadowDirty=!1}const s=this.sprites[0],o=s.height,a=r.fontSize/o,l=t.length*s.width*a+t.length*r.letterSpacing;let c=i;r.textAlign===Lt.Left||r.textAlign===Lt.Start?c=i:r.textAlign===Lt.Right||r.textAlign===Lt.End?c=i-l:r.textAlign===Lt.Center&&(c=i-l/2);let d=n-o*a;r.baseAlign===Ft.Top||r.baseAlign===Ft.Hanging?d=n:r.baseAlign===Ft.Ideographic||r.baseAlign===Ft.Bottom||r.baseAlign===Ft.Alphabetic?d=n-o*a:r.baseAlign===Ft.Middle&&(d=n-o*a/2);for(let i=0;i<t.length;i++){let n=t[i];this.caseInsensitive&&(n=n.toLowerCase());try{this._textShadowOn&&(this._textShadowSprites[n].drawAroundAnchor=!1,this._textShadowSprites[n].scale=P(a,a),this._textShadowSprites[n].draw(e,c+this._shadowOffsetX,d+this._shadowOffsetY));const t=this._spriteRecord[n];t.drawAroundAnchor=!1,t.scale=P(a,a),t.draw(e,c,d),c+=t.drawWidth+r.letterSpacing}catch(e){v.getInstance().error(`SpriteFont Error drawing char ${n}`)}}}_parseOptions(e){return{fontSize:e.fontSize||10,letterSpacing:e.letterSpacing||0,color:e.color||D.Black,textAlign:(e.textAlign,e.textAlign),baseAlign:(e.baseAlign,e.baseAlign),maxWidth:e.maxWidth||-1,opacity:e.opacity||0}}};jt=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o}([S({message:"SpriteSheet will be removed in v0.26.0",alternateMethod:"Use Graphics.SpriteSheet"})],jt);class Wt{constructor(e){this._logger=v.getInstance(),this.sprites=[];const{sprites:t,rows:i,columns:n}=e;this.sprites=t,this.rows=null!=i?i:1,this.columns=null!=n?n:this.sprites.length}getSprite(e,t){if(e>=this.columns||e<0)return this._logger.warn(`No sprite exists in the SpriteSheet at (${e}, ${t}), x: ${e} should be between 0 and ${this.columns-1}`),null;if(t>=this.rows||t<0)return this._logger.warn(`No sprite exists in the SpriteSheet at (${e}, ${t}), y: ${t} should be between 0 and ${this.rows-1}`),null;const i=e+t*this.columns;return this.sprites[i]}static fromLegacySpriteSheet(e){const t=e.sprites.map((e=>Tt.fromLegacySprite(e)));return new Wt({sprites:t})}static toLegacySpriteSheet(e){const t=e.sprites.map((e=>Tt.toLegacySprite(e)));return new Ht(t)}static fromImageSource(e){var t;const i=[];e.spacing=null!==(t=e.spacing)&&void 0!==t?t:{};const{image:n,grid:{rows:r,columns:s,spriteWidth:o,spriteHeight:a},spacing:{originOffset:l,margin:c}}=e,d={x:0,y:0,...l},h={x:0,y:0,...c};for(let e=0;e<s;e++)for(let t=0;t<r;t++)i[e+t*s]=new Tt({image:n,sourceView:{x:e*o+h.x*e+d.x,y:t*a+h.y*t+d.y,width:o,height:a},destSize:{height:a,width:o}});return new Wt({sprites:i,rows:r,columns:s})}}class Gt extends we{constructor(e){super(e),this._text="",this.alphabet="",this.shadow=null,this.caseInsensitive=!1,this.spacing=0,this._logger=v.getInstance(),this._alreadyWarnedAlphabet=!1,this._alreadyWarnedSpriteSheet=!1;const{alphabet:t,spriteSheet:i,caseInsensitive:n,spacing:r,shadow:s}=e;this.alphabet=t,this.spriteSheet=i,this.caseInsensitive=null!=n?n:this.caseInsensitive,this.spacing=null!=r?r:this.spacing,this.shadow=null!=s?s:this.shadow}static fromLegacySpriteFont(e){const t=e.sprites.map(Tt.fromLegacySprite);return new Gt({alphabet:e.alphabet,spacing:0,caseInsensitive:e.caseInsensitive,spriteSheet:new Wt({sprites:t})})}_getCharacterSprites(e){const t=[],i=this.caseInsensitive?e.toLocaleLowerCase():e,n=this.caseInsensitive?this.alphabet.toLocaleLowerCase():this.alphabet;for(let e=0;e<i.length;e++){const r=i[e];let s=n.indexOf(r);-1===s&&(s=0,this._alreadyWarnedAlphabet||(this._logger.warn(`SpriteFont - Cannot find letter '${r}' in configured alphabet '${n}'.`),this._logger.warn("There maybe be more issues in the SpriteFont configuration. No additional warnings will be logged."),this._alreadyWarnedAlphabet=!0));const o=this.spriteSheet.sprites[s];o?t.push(o):this._alreadyWarnedSpriteSheet||(this._logger.warn(`SpriteFont - Cannot find sprite for '${r}' at index '${s}' in configured SpriteSheet`),this._logger.warn("There maybe be more issues in the SpriteFont configuration. No additional warnings will be logged."),this._alreadyWarnedSpriteSheet=!0)}return t}measureText(e){const t=e.split("\n"),i=t.reduce(((e,t)=>e.length>t.length?e:t)),n=this._getCharacterSprites(i);let r=0,s=0;for(const e of n)r+=e.width+this.spacing,s=Math.max(s,e.height);return I.fromDimension(r,s*t.length,E.Zero)}_drawImage(e,t,i){let n=0,r=0,s=0;const o=this._text.split("\n");for(const a of o){for(const o of this._getCharacterSprites(a))o.draw(e,t+n,i+r),n+=o.width+this.spacing,s=Math.max(s,o.height);n=0,r+=s}}render(e,t,i,n,r){this._text=t;const s=this.measureText(t);this.width=s.width,this.height=s.height,this.shadow&&(e.save(),e.translate(this.shadow.offset.x,this.shadow.offset.y),this.draw(e,n,r),e.restore()),this.draw(e,n,r)}clone(){return new Gt({alphabet:this.alphabet,spriteSheet:this.spriteSheet,spacing:this.spacing})}}class qt{constructor(){this.fontSheet="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAAAwCAYAAAD+f6R/AAAAAXNSR0IArs4c6QAABcJJREFUeJztnemu7CgMhGE07//KmT9NhrAFVzkQndQntXRP3/bCZkwCSQhCCCGEEEIIIYQQQog/TRz953Ecx/nDGIe/vdNhlc9tIz605Fk/ZmWfsO1hn9Gxuv1KHbvb3iL/VN+d1WORbyr7yR/5b9M4vjNeqko6jPJHq5wGHU151o9J2Udse9hndCxuv0rH7rY3yD/Wdyf13MrnQeDfkZIUSGKM4ff3cWN82pEZuTyQGX2IxeyR63va//8VNCYCq+1yEkLtWyagXv1P1r1H+110gP3PzT4gT8uW/mdQ8mUG8E9DqOz4MS9ICKGbXpS2BpnIrRzYeS96cll08INlCMl2/glzdcfazuuPqQO03lmqrBHsf272Q6NODXj6zzZIJd/LAHYTg3Mays5gBi7ZR27fOgs0yj8rm36DLMFiPgkAdXHKOwUQeMCQ/adSh/qBQrT/tPxbAwA9+DOZEILPAATSuHMgTv7+Auk/df2lHPCZLvMSLJe34LkEQ9PwXF1SRTllMYgvIaflqyVAjLGbsiCDcOK76jflxZ+sINPyROc5071yKWK5CJTV3dMp6+tBlyCtNlhAq/+XbWoBDcRNXYBMzD4VvQygSuPYC2jGGaSSOxXfy3dTUEsanIvNeepm38N/hssSALTPZnAXfwIYRJn2b7UBcw0FKX+nDdAMpm2j9WVnxrUa7TXaVAca/B+TgaAVh6R/rH0P/5m01dt/RLYViJn+w/bhVX2P7f/duqom5qb02pRLCLGIMgBU1wCEEN9BAUCID6MAIMSHUQAQ4sMoAAjxYRQAhPgwd1uB0fuZ7H3cnn2P+9mr/Pe4B8/eB/fwP4eRtci/0f6OfTCPt/9oHwC6G6y19RHZDumxmwzR4eE/s/2Tte/q/+XLdc9DeJ19diesQc/j7Z8fCe4tAS4CxZ7sp7eiJi7HiZmjmOTGJs+93CbS3nP0XIPH3vW8/qz6QPnX2QdsV/1uw/iZYvg8ACeHd28rpPzfNfhL+7vkw/4Ou9s+Onhbv91elpKZ48Dl6bzpwwibHigRArf+Ptk9+L3Y1Q5OB4LgCeSBw1iuB3GeJh1/HrX/zF0A9Mk+u45zMkc3r4rWPomma5+p/514LB+Zo93MErJ1JHxXPzByGa/licRYVKbpeQCoQ6Q8yxuCwJF9IPsoDkHAo/3Tx26cvA4EtJ/n04w8QOq/mrR7ddfLAC5BYFNlVI/0CnOVUflOpvJUQMx9AIMIW/nWDM67/qw0+95v9goBqD9j+72u/KD9U89IbnQbMIR2Zbneh5zUY7Hdk7XIP3UffVb+r+wDYAZLq+1n1+C7y3/ny2r7p5yeByDEh9HzAIQQJwoAQnwYBQAhPowCgBBjoNu3hNxSFACE6INuKvPajPZ4EFEAEKINcybGYzOd247WEd3TgA2jlmjEyrd+j9hvfVbD2PWQ3ZmGlu2HyO8og8eBuNUvNYWoDgMVpwHTJoLWdz1Y+ZYOy5uF7t6PPruZxANrud1lQXkP0jsGz/Yz+vGGMuygFyhSPcJnc1pMnQZElc+cRnoAlxdTvoDuK7puqF7uCQy+3fyFMiA02/vJQHh7DQDogMPTSGFNA56HTzbZ9yAfBOb1Zyo3qGM3MfMZ3f76huXf6xlmAHknMlLNXsBBBvbljIz9Uyz5Y5TzIBLR/qy/rNyrZ8+L/0BZ0m+tgXD0OK5XZxC/9P7I/g4hVFvzXf1/6i5A7+3AlijMPBLMZfCvuAp7A9rY56ApHitmLQc7c8bOv6ftAxlM9Xp35nkEK7nJetBsaMhtAAAuOLQGXwhh2dXQnn1rZ/a42BI3dL7L+jkFAbQddwdA9Ah35yMKhgEgVT46EFh5D4jz+OgavNKxeBCd1wDSJ/97oR8eoJkLi9t9/BDgDHTJ5NE7Dnzechh914OVv9M1K9PCqsfqb88XVg9qN9lm6nG176UPu+zn17GOxuO0vOWEEC/j+LFKTgghlvEfYJaLS+SA2O0AAAAASUVORK5CYII=",this.size=16,this.load()}load(){return this._imageSource=new At(this.fontSheet),this._imageSource.load().then((()=>{this._spriteSheet=Wt.fromImageSource({image:this._imageSource,grid:{rows:3,columns:16,spriteWidth:16,spriteHeight:16}}),this._spriteFont=new Gt({alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ,!'&.\"?-()+ ",caseInsensitive:!0,spriteSheet:this._spriteSheet,spacing:-6})}))}write(e,t,i){this._imageSource.isLoaded()&&this._spriteFont.render(e,t,null,i.x,i.y)}}class Kt{constructor(e,t){this._gl=e,this._texture=t}use(){const e=this._gl;e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_2D,this._texture)}disable(){const e=this._gl;e.bindTexture(e.TEXTURE_2D,null)}}class Xt{constructor(e){this.width=e.width,this.height=e.height,this._gl=e.gl,this._setupFramebuffer()}setResolution(e,t){const i=this._gl;this.width=e,this.height=t,i.bindTexture(i.TEXTURE_2D,this._frameTexture),i.texImage2D(i.TEXTURE_2D,0,i.RGBA,this.width,this.height,0,i.RGBA,i.UNSIGNED_BYTE,null)}get frameBuffer(){return this._frameBuffer}get frameTexture(){return this._frameTexture}_setupFramebuffer(){const e=this._gl;this._frameTexture=e.createTexture(),e.bindTexture(e.TEXTURE_2D,this._frameTexture),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,this.width,this.height,0,e.RGBA,e.UNSIGNED_BYTE,null),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE);const t=e.COLOR_ATTACHMENT0;this._frameBuffer=e.createFramebuffer(),e.bindFramebuffer(e.FRAMEBUFFER,this._frameBuffer),e.framebufferTexture2D(e.FRAMEBUFFER,t,e.TEXTURE_2D,this._frameTexture,0),this.disable()}toRenderSource(){return new Kt(this._gl,this._frameTexture)}use(){const e=this._gl;e.bindFramebuffer(e.FRAMEBUFFER,this._frameBuffer),e.viewport(0,0,this.width,this.height)}disable(){const e=this._gl;e.bindFramebuffer(e.FRAMEBUFFER,null),e.bindTexture(e.TEXTURE_2D,null)}}class Yt{static clear(){Yt._GL=null}static register(e){Yt._GL=e}static get gl(){if(!Yt._GL)throw Error("Attempted gl access before init");return Yt._GL}}class Qt{constructor(e){this._gl=Yt.gl,this.uniforms={},this.attributes={},this._compiled=!1;const{vertexSource:t,fragmentSource:i}=e;this.vertexSource=t,this.fragmentSource=i}get compiled(){return this._compiled}use(){this._gl.useProgram(this.program),Qt._ACTIVE_SHADER_INSTANCE=this}isCurrentlyBound(){return Qt._ACTIVE_SHADER_INSTANCE===this}compile(){const e=this._gl,t=this._compileShader(e,this.vertexSource,e.VERTEX_SHADER),i=this._compileShader(e,this.fragmentSource,e.FRAGMENT_SHADER);this.program=this._createProgram(e,t,i);const n=this.getAttributes();for(const e of n)this.attributes[e.name]=e;const r=this.getUniforms();for(const e of r)this.uniforms[e.name]=e;return this._compiled=!0,this.program}getUniforms(){const e=this._gl,t=e.getProgramParameter(this.program,e.ACTIVE_UNIFORMS),i=[];for(let n=0;n<t;n++){const t=e.getActiveUniform(this.program,n),r=e.getUniformLocation(this.program,t.name);i.push({name:t.name,glType:t.type,location:r})}return i}getAttributes(){const e=this._gl,t=e.getProgramParameter(this.program,e.ACTIVE_ATTRIBUTES),i=[];for(let n=0;n<t;n++){const t=e.getActiveAttrib(this.program,n),r=e.getAttribLocation(this.program,t.name);i.push({name:t.name,glType:Ee(e,t.type),size:Se(e,t.type),location:r,normalized:!1})}return i}setTexture(e,t){const i=this._gl;i.activeTexture(i.TEXTURE0+e),i.bindTexture(i.TEXTURE_2D,t)}setUniformInt(e,t){this.setUniform("uniform1i",e,~~t)}setUniformIntArray(e,t){this.setUniform("uniform1iv",e,t)}setUniformBoolean(e,t){this.setUniform("uniform1i",e,t?1:0)}setUniformFloat(e,t){this.setUniform("uniform1f",e,t)}setUniformFloatArray(e,t){this.setUniform("uniform1fv",e,t)}setUniformFloatVector(e,t){this.setUniform("uniform2f",e,t.x,t.y)}setUniformMatrix(e,t){this.setUniform("uniformMatrix4fv",e,!1,t.data)}setUniform(e,t,...i){if(!this._compiled)throw Error(`Must compile shader before setting a uniform ${e}:${t}`);if(!this.isCurrentlyBound())throw Error("Currently accessed shader instance is not the current active shader in WebGL, must call `shader.use()` before setting uniforms");const n=this._gl.getUniformLocation(this.program,t);if(!n)throw Error(`Uniform ${e}:${t} doesn't exist or is not used in the shader source code, unused uniforms are optimized away by most browsers`);{const t=[n,...i];this._gl[e].apply(this._gl,t)}}_createProgram(e,t,i){const n=e.createProgram();if(null===n)throw Error("Could not create graphics shader program");if(e.attachShader(n,t),e.attachShader(n,i),e.linkProgram(n),!e.getProgramParameter(n,e.LINK_STATUS))throw Error(`Could not link the program: [${e.getProgramInfoLog(n)}]`);return n}_compileShader(e,t,i){const n=e.VERTEX_SHADER===i?"vertex":"fragment",r=e.createShader(i);if(null===r)throw Error(`Could not build shader: [${t}]`);if(e.shaderSource(r,t),e.compileShader(r),!e.getShaderParameter(r,e.COMPILE_STATUS)){const i=e.getShaderInfoLog(r);throw Error(`Could not compile ${n} shader:\n\n${i}${this._processSourceForError(t,i)}`)}return r}_processSourceForError(e,t){const i=e.split("\n"),n=t.search(/\d:\d/),r=t.indexOf(" ",n),[s,o]=t.slice(n,r).split(":").map((e=>Number(e)));for(let e=0;e<i.length;e++)i[e]=`${e+1}: ${i[e]}${o===e+1?" <----- ERROR!":""}`;return"\n\nSource:\n"+i.join("\n")}}Qt._ACTIVE_SHADER_INSTANCE=null;class Zt{constructor(e){this._gl=Yt.gl,this.type="dynamic";const{size:t,type:i,data:n}=e;if(this.buffer=this._gl.createBuffer(),!n&&!t)throw Error("Must either provide data or a size to the VertexBuffer");this.bufferData=n||new Float32Array(t),this.type=null!=i?i:this.type}bind(){const e=this._gl;e.bindBuffer(e.ARRAY_BUFFER,this.buffer)}upload(){const e=this._gl;e.bindBuffer(e.ARRAY_BUFFER,this.buffer),e.bufferData(e.ARRAY_BUFFER,this.bufferData,"static"===this.type?e.STATIC_DRAW:e.DYNAMIC_DRAW)}}class Jt{constructor(e){this._gl=Yt.gl,this._logger=v.getInstance(),this._layout=[],this._attributes=[],this._vertexTotalSizeBytes=0;const{shader:t,vertexBuffer:i,attributes:n}=e;this._vertexBuffer=i,this._attributes=n,this._shader=t,this.initialize()}get vertexBuffer(){return this._vertexBuffer}get attributes(){return this._attributes}get totalVertexSizeBytes(){return this._vertexTotalSizeBytes}initialize(){if(!this._shader.compiled)throw Error("Shader not compiled, shader must be compiled before defining a vertex layout");this._layout.length=0;const e=this._shader.attributes;for(const t of this._attributes){const i=e[t[0]];if(!i)throw Error(`The attribute named: ${t[0]} size ${t[1]} not found in the shader source code:\n ${this._shader.vertexSource}`);if(i.size!==t[1])throw Error(`VertexLayout size definition for attribute: [${t[0]}, ${t[1]}], doesnt match shader source size ${i.size}:\n ${this._shader.vertexSource}`);this._layout.push(i)}let t=0;for(const e of this._layout){const i=Ce(this._gl,e.glType);this._vertexTotalSizeBytes+=i*e.size,t+=e.size}this._vertexBuffer.bufferData.length%t!=0&&this._logger.warn(`The vertex component size (${t})  does divide evenly into the specified vertex buffer (${this._vertexBuffer.bufferData.length})`)}use(e=!1){const t=this._gl;if(!this._shader.isCurrentlyBound())throw Error("Shader associated with this vertex layout is not active! Call shader.use() before layout.use()");this._vertexBuffer.bind(),e&&this._vertexBuffer.upload();let i=0;for(const e of this._layout)t.vertexAttribPointer(e.location,e.size,e.glType,e.normalized,this.totalVertexSizeBytes,i),t.enableVertexAttribArray(e.location),i+=Ce(t,e.glType)*e.size}}class ei{static clear(){ei.DrawCallCount=0,ei.DrawnImagesCount=0}}ei.DrawCallCount=0,ei.DrawnImagesCount=0;class ti{constructor(){this.type="ex.line",this.priority=0,this._maxLines=10922,this._vertexIndex=0,this._lineCount=0}initialize(e,t){this._gl=e,this._context=t,this._shader=new Qt({vertexSource:"attribute vec2 a_position;\nattribute vec4 a_color;\n\nvarying lowp vec4 v_color;\n\nuniform mat4 u_matrix;\n\n\nvoid main() {\n   // Set the vertex position using the ortho transform matrix\n   gl_Position = u_matrix * vec4(a_position, 0.0, 1.0);\n\n   // Passthrough the color\n   v_color = a_color;\n}",fragmentSource:"precision mediump float;\n\n// Color\nvarying lowp vec4 v_color;\n\n\nvoid main() {\n  gl_FragColor = v_color;\n}"}),this._shader.compile(),this._shader.use(),this._shader.setUniformMatrix("u_matrix",this._context.ortho),this._vertexBuffer=new Zt({size:12*this._maxLines,type:"dynamic"}),this._layout=new Jt({vertexBuffer:this._vertexBuffer,shader:this._shader,attributes:[["a_position",2],["a_color",4]]})}draw(e,t,i){this._isFull()&&this.flush(),this._lineCount++;const n=this._context.getTransform(),r=n.multiply(e),s=n.multiply(t),o=this._vertexBuffer.bufferData;o[this._vertexIndex++]=r.x,o[this._vertexIndex++]=r.y,o[this._vertexIndex++]=i.r/255,o[this._vertexIndex++]=i.g/255,o[this._vertexIndex++]=i.b/255,o[this._vertexIndex++]=i.a,o[this._vertexIndex++]=s.x,o[this._vertexIndex++]=s.y,o[this._vertexIndex++]=i.r/255,o[this._vertexIndex++]=i.g/255,o[this._vertexIndex++]=i.b/255,o[this._vertexIndex++]=i.a}_isFull(){return this._lineCount>=this._maxLines}hasPendingDraws(){return 0!==this._lineCount}flush(){if(0===this._lineCount)return;const e=this._gl;this._shader.use(),this._layout.use(!0),this._shader.setUniformMatrix("u_matrix",this._context.ortho),e.drawArrays(e.LINES,0,2*this._lineCount),ei.DrawnImagesCount+=this._lineCount,ei.DrawCallCount++,this._vertexIndex=0,this._lineCount=0}}class ii{constructor(){this.type="ex.point",this.priority=0,this._maxPoints=10922,this._pointCount=0,this._vertexIndex=0}initialize(e,t){this._gl=e,this._context=t,this._shader=new Qt({vertexSource:"attribute vec2 a_position;\nattribute vec4 a_color;\nattribute float a_size;\nvarying lowp vec4 v_color;\nuniform mat4 u_matrix;\n\nvoid main() {\n  gl_Position = u_matrix * vec4(a_position, 0.0, 1.0);\n  gl_PointSize = a_size * 2.0;\n  v_color = a_color;\n}",fragmentSource:'#ifdef GL_OES_standard_derivatives\n#extension GL_OES_standard_derivatives : enable\n#endif\n\nprecision mediump float;\nvarying lowp vec4 v_color;\n\nvoid main() {\n  float r = 0.0, delta = 0.0, alpha = 1.0;\n  vec2 cxy = 2.0 * gl_PointCoord - 1.0;\n  r = dot(cxy, cxy);\n\n#ifdef GL_OES_standard_derivatives\n  delta = fwidth(r);\n  alpha = 1.0 - smoothstep(1.0 - delta, 1.0 + delta, r);\n#else\n  if (r > 1.0) {\n    discard;\n  }\n#endif\n  // "premultiply" the color by alpha\n  vec4 color = v_color;\n  color.a = color.a * alpha;\n  color.rgb = color.rgb * color.a;\n  gl_FragColor = color;\n}'}),this._shader.compile(),this._shader.use(),this._shader.setUniformMatrix("u_matrix",this._context.ortho),this._buffer=new Zt({size:7*this._maxPoints,type:"dynamic"}),this._layout=new Jt({shader:this._shader,vertexBuffer:this._buffer,attributes:[["a_position",2],["a_color",4],["a_size",1]]})}draw(e,t,i){this._isFull()&&this.flush(),this._pointCount++;const n=this._context.getTransform(),r=this._context.opacity,s=n.multiply(e),o=this._buffer.bufferData;o[this._vertexIndex++]=s.x,o[this._vertexIndex++]=s.y,o[this._vertexIndex++]=t.r/255,o[this._vertexIndex++]=t.g/255,o[this._vertexIndex++]=t.b/255,o[this._vertexIndex++]=t.a*r,o[this._vertexIndex++]=i*Math.max(n.getScaleX(),n.getScaleY())}_isFull(){return this._pointCount>=this._maxPoints}hasPendingDraws(){return 0!==this._pointCount}flush(){if(0===this._pointCount)return;const e=this._gl;this._shader.use(),this._layout.use(!0),this._shader.setUniformMatrix("u_matrix",this._context.ortho),e.drawArrays(e.POINTS,0,this._pointCount),ei.DrawnImagesCount+=this._pointCount,ei.DrawCallCount++,this._pointCount=0,this._vertexIndex=0}}class ni{constructor(e){this._gl=e,this._shader=new Qt({vertexSource:"attribute vec2 a_position;\n\nattribute vec2 a_texcoord;\nvarying vec2 v_texcoord;\n\nvoid main() {\n  gl_Position = vec4(a_position, 0.0, 1.0);\n\n  // Pass the texcoord to the fragment shader.\n  v_texcoord = a_texcoord;\n}",fragmentSource:"precision mediump float;\n\n// Passed in from the vertex shader.\nvarying vec2 v_texcoord;\n\n// The texture.\nuniform sampler2D u_texture;\n\nvoid main() {\n   gl_FragColor = texture2D(u_texture, v_texcoord);\n}"}),this._shader.compile(),this._buffer=new Zt({type:"static",data:new Float32Array([-1,-1,0,0,-1,1,0,1,1,-1,1,0,1,-1,1,0,-1,1,0,1,1,1,1,1])}),this._layout=new Jt({shader:this._shader,vertexBuffer:this._buffer,attributes:[["a_position",2],["a_texcoord",2]]}),this._buffer.upload()}renderWithPostProcessor(e){const t=this._gl;e.getShader().use(),e.getLayout().use(),t.drawArrays(t.TRIANGLES,0,6)}renderToScreen(){const e=this._gl;this._shader.use(),this._layout.use(),e.drawArrays(e.TRIANGLES,0,6)}}class ri{constructor(e,t){this._gl=Yt.gl,this._logger=v.getInstance();const i=this._gl;this.buffer=i.createBuffer(),i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,this.buffer);const n=6*e;if(i.getExtension("OES_element_index_uint")&&!t)this.bufferData=new Uint32Array(n);else{const t=65535,r=Math.floor((t-1)/4);this.bufferGlType=i.UNSIGNED_SHORT,this.bufferData=new Uint16Array(n),e>r&&this._logger.warn(`Total quads exceeds hardware index buffer limit (uint16), max(${r}) requested quads(${e})`)}let r=0;for(let e=0;e<n;e+=6)this.bufferData[e+0]=r+0,this.bufferData[e+1]=r+1,this.bufferData[e+2]=r+2,this.bufferData[e+3]=r+2,this.bufferData[e+4]=r+1,this.bufferData[e+5]=r+3,r+=4;i.bufferData(i.ELEMENT_ARRAY_BUFFER,this.bufferData,i.STATIC_DRAW)}get size(){return this.bufferData.length}upload(){const e=this._gl;e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.buffer),e.bufferData(e.ELEMENT_ARRAY_BUFFER,this.bufferData,e.STATIC_DRAW)}bind(){const e=this._gl;e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.buffer)}}class si{constructor(){this.type="ex.image",this.priority=0,this._maxImages=10922,this._maxTextures=0,this._imageCount=0,this._textures=[],this._vertexIndex=0}initialize(e,t){this._gl=e,this._context=t,this._maxTextures=Math.min(e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS),125);const i=this._transformFragmentSource("precision mediump float;\n\n// UV coord\nvarying vec2 v_texcoord;\n\n// Texture index\nvarying lowp float v_textureIndex;\n\n// Textures in the current draw\nuniform sampler2D u_textures[%%count%%];\n\n// Opacity\nvarying float v_opacity;\n\nvoid main() {\n   // In order to support the most efficient sprite batching, we have multiple\n   // textures loaded into the gpu (usually 8) this picker logic skips over textures\n   // that do not apply to a particular sprite.\n\n   vec4 color = vec4(1.0, 0, 0, 1.0);\n\n   // GLSL is templated out to pick the right texture and set the vec4 color\n   %%texture_picker%%\n\n   color.rgb = color.rgb * v_opacity;\n   color.a = color.a * v_opacity;\n   gl_FragColor = color;\n}",this._maxTextures);this._shader=new Qt({fragmentSource:i,vertexSource:"attribute vec2 a_position;\n\n// Opacity \nattribute float a_opacity;\nvarying float v_opacity;\n\n// UV coordinate\nattribute vec2 a_texcoord;\nvarying vec2 v_texcoord;\n\n// Texture number\nattribute lowp float a_textureIndex;\nvarying lowp float v_textureIndex;\n\nuniform mat4 u_matrix;\n\n\nvoid main() {\n   // Set the vertex position using the ortho transform matrix\n   gl_Position = u_matrix * vec4(a_position, 0.0, 1.0);\n\n   // Pass through the Opacity to the fragment shader\n   v_opacity = a_opacity;\n   // Pass through the UV coord to the fragment shader\n   v_texcoord = a_texcoord;\n   // Pass through the texture number to the fragment shader\n   v_textureIndex = a_textureIndex;\n}"}),this._shader.compile(),this._shader.use(),this._shader.setUniformMatrix("u_matrix",t.ortho),this._shader.setUniformIntArray("u_textures",[...Array(this._maxTextures)].map(((e,t)=>t))),this._buffer=new Zt({size:24*this._maxImages,type:"dynamic"}),this._layout=new Jt({shader:this._shader,vertexBuffer:this._buffer,attributes:[["a_position",2],["a_opacity",1],["a_texcoord",2],["a_textureIndex",1]]}),this._quads=new ri(this._maxImages,!0)}_transformFragmentSource(e,t){let i=e.replace("%%count%%",t.toString()),n="";for(let e=0;e<t;e++)n+=0===e?`if (v_textureIndex <= ${e}.5) {\n`:`   else if (v_textureIndex <= ${e}.5) {\n`,n+=`      color = texture2D(u_textures[${e}], v_texcoord);\n`,n+="   }\n";return i=i.replace("%%texture_picker%%",n),i}_addImageAsTexture(e){const t=Pe.load(e);-1===this._textures.indexOf(t)&&this._textures.push(t)}_bindTextures(e){for(let t=0;t<this._maxTextures;t++)e.activeTexture(e.TEXTURE0+t),e.bindTexture(e.TEXTURE_2D,this._textures[t]||this._textures[0])}_getTextureIdForImage(e){return e?this._textures.indexOf(Pe.get(e)):-1}_isFull(){return this._imageCount>=this._maxImages||this._textures.length>=this._maxTextures}draw(e,t,i,n,r,s,o,a,l){var c,d,h,u;this._isFull()&&this.flush(),this._imageCount++,this._addImageAsTexture(e);let p=(null==e?void 0:e.width)||n||0,f=(null==e?void 0:e.height)||r||0,g=[0,0,null!==(c=null!=n?n:null==e?void 0:e.width)&&void 0!==c?c:0,null!==(d=null!=r?r:null==e?void 0:e.height)&&void 0!==d?d:0],m=[null!=t?t:1,null!=i?i:1];void 0!==s&&void 0!==o&&void 0!==a&&void 0!==l&&(g=[null!=t?t:1,null!=i?i:1,null!==(h=null!=n?n:null==e?void 0:e.width)&&void 0!==h?h:0,null!==(u=null!=r?r:null==e?void 0:e.height)&&void 0!==u?u:0],m=[s,o],p=a,f=l),t=g[0],i=g[1];const _=g[2],v=g[3],b=this._context.getTransform(),w=this._context.opacity,y=this._context.snapToPixel;let x=P(m[0],m[1]),$=P(m[0]+p,m[1]),C=P(m[0],m[1]+f),S=P(m[0]+p,m[1]+f);x=b.multiply(x),$=b.multiply($),C=b.multiply(C),S=b.multiply(S),y&&(x.x=~~x.x,x.y=~~x.y,$.x=~~$.x,$.y=~~$.y,C.x=~~C.x,C.y=~~C.y,S.x=~~S.x,S.y=~~S.y);const E=this._getTextureIdForImage(e),k=$e(e.width||p),T=$e(e.height||f),A=t/k,D=i/T,R=(t+_-.01)/k,I=(i+v-.01)/T,M=this._layout.vertexBuffer.bufferData;M[this._vertexIndex++]=x.x,M[this._vertexIndex++]=x.y,M[this._vertexIndex++]=w,M[this._vertexIndex++]=A,M[this._vertexIndex++]=D,M[this._vertexIndex++]=E,M[this._vertexIndex++]=C.x,M[this._vertexIndex++]=C.y,M[this._vertexIndex++]=w,M[this._vertexIndex++]=A,M[this._vertexIndex++]=I,M[this._vertexIndex++]=E,M[this._vertexIndex++]=$.x,M[this._vertexIndex++]=$.y,M[this._vertexIndex++]=w,M[this._vertexIndex++]=R,M[this._vertexIndex++]=D,M[this._vertexIndex++]=E,M[this._vertexIndex++]=S.x,M[this._vertexIndex++]=S.y,M[this._vertexIndex++]=w,M[this._vertexIndex++]=R,M[this._vertexIndex++]=I,M[this._vertexIndex++]=E}hasPendingDraws(){return 0!==this._imageCount}flush(){if(0===this._imageCount)return;const e=this._gl;this._shader.use(),this._layout.use(!0),this._shader.setUniformMatrix("u_matrix",this._context.ortho),this._bindTextures(e),this._quads.bind(),e.drawElements(e.TRIANGLES,6*this._imageCount,this._quads.bufferGlType,0),ei.DrawnImagesCount+=this._imageCount,ei.DrawCallCount++,this._imageCount=0,this._vertexIndex=0,this._textures.length=0}}class oi{constructor(){this.type="ex.rectangle",this.priority=0,this._maxRectangles=10922,this._rectangleCount=0,this._vertexIndex=0}initialize(e,t){this._gl=e,this._context=t,e.getExtension("OES_standard_derivatives"),this._shader=new Qt({fragmentSource:"#ifdef GL_OES_standard_derivatives\n#extension GL_OES_standard_derivatives : enable\n#endif\nprecision mediump float;\n\n// UV coord\nvarying vec2 v_uv;\n\nvarying vec2 v_size; // in pixels\n\n// Color coord to blend with image\nvarying lowp vec4 v_color;\n\n// Stroke color if used\nvarying lowp vec4 v_strokeColor;\n\n// Stroke thickness if used\nvarying lowp float v_strokeThickness; // in pixels\n\n// Opacity\nvarying float v_opacity;\n\nvoid main() {\n    // modified from https://stackoverflow.com/questions/59197671/glsl-rounded-rectangle-with-variable-border\n    vec2 uv = v_uv;\n    vec2 fragCoord = uv * v_size;\n    float maxX = v_size.x - v_strokeThickness;\n    float minX = v_strokeThickness;\n    float maxY = v_size.y - v_strokeThickness;\n    float minY = v_strokeThickness;\n\n    if (fragCoord.x < maxX && fragCoord.x > minX &&\n        fragCoord.y < maxY && fragCoord.y > minY) {\n      gl_FragColor = v_color;\n    } else {\n      gl_FragColor = v_strokeColor;\n    }\n    gl_FragColor.a *= v_opacity;\n    gl_FragColor.rgb *= gl_FragColor.a;\n\n    // vec2 v2CenteredPos     = abs(fragCoord - v_size.xy / 2.0);\n    // vec2 v2HalfShapeSizePx = v_size.xy/2.0 - v_strokeThickness/2.0;\n\n    // float fHalfBorderDist      = 0.0;\n    // float fHalfBorderThickness = 0.0;\n\n    // if (fragCoord.x > max(v_radius, v_strokeThickness) && \n    //     fragCoord.x < v_size.x - max(v_radius, v_strokeThickness))\n    // {\n    //     fHalfBorderDist      = v2CenteredPos.y - v2HalfShapeSizePx.y;\n    //     fHalfBorderThickness = v_strokeThickness / 2.0;\n    // }\n    // else if (fragCoord.y > max(v_radius, v_strokeThickness) && \n    //          fragCoord.y < v_size.y - max(v_radius, v_strokeThickness))\n    // {\n    //     fHalfBorderDist      = v2CenteredPos.x - v2HalfShapeSizePx.x;\n    //     fHalfBorderThickness = v_strokeThickness / 2.0;\n    // }\n    // else\n    // {\n    //     vec2 edgeVec = max(vec2(0.0), v_radius - vec2(\n    //         uv.x > 0.5 ? v_size.x - fragCoord.x : fragCoord.x,\n    //         uv.y > 0.5 ? v_size.y - fragCoord.y : fragCoord.y));\n        \n    //     float ellipse_ab    = v_radius-v_strokeThickness;\n    //     vec2 ellipse_isect = (v_strokeThickness > v_radius || v_strokeThickness > v_radius) ? vec2(0.0) :\n    //                             edgeVec.xy * ellipse_ab*ellipse_ab / length(ellipse_ab*edgeVec.yx); \n            \n    //     fHalfBorderThickness = (v_radius - length(ellipse_isect)) / 2.0;\n    //     fHalfBorderDist      = length(edgeVec) - (v_radius - fHalfBorderThickness);\n    // }\n\n    // vec4 v4FromColor = v_strokeColor;\n    // v4FromColor.rgb *= v4FromColor.a;\n    // vec4 v4ToColor   = vec4(0.0); // background color is transparent\n    // if (fHalfBorderDist < 0.0) {\n    //     v4ToColor = v_color;\n    //     v4ToColor.rgb *= v4ToColor.a;\n    // }\n\n    // float mixPct = abs(fHalfBorderDist) - fHalfBorderThickness;\n\n    // vec4 finalColor = mix(v4FromColor, v4ToColor, mixPct);\n    // gl_FragColor = finalColor;\n}",vertexSource:"attribute vec2 a_position;\n\n// UV coordinate\nattribute vec2 a_uv;\nvarying vec2 v_uv;\n\nattribute vec2 a_size;\nvarying vec2 v_size;\n\n// Opacity \nattribute float a_opacity;\nvarying float v_opacity;\n\nattribute vec4 a_color;\nvarying vec4 v_color;\n\nattribute vec4 a_strokeColor;\nvarying vec4 v_strokeColor;\n\nattribute float a_strokeThickness;\nvarying float v_strokeThickness;\n\nuniform mat4 u_matrix;\n\n\nvoid main() {\n   // Set the vertex position using the ortho transform matrix\n   gl_Position = u_matrix * vec4(a_position, 0.0, 1.0);\n\n   // Pass through UV coords\n   v_uv = a_uv;\n   // Pass through size\n   v_size = a_size;\n   // Pass through the Opacity to the fragment shader\n   v_opacity = a_opacity;\n   // Pass through the color to the fragment shader\n   v_color = a_color;\n   // Pass through the stroke color to the fragment shader\n   v_strokeColor = a_strokeColor;\n   // Pass through the stroke thickenss to the fragment shader\n   v_strokeThickness = a_strokeThickness;\n}"}),this._shader.compile(),this._shader.use(),this._shader.setUniformMatrix("u_matrix",t.ortho),this._buffer=new Zt({size:64*this._maxRectangles,type:"dynamic"}),this._layout=new Jt({shader:this._shader,vertexBuffer:this._buffer,attributes:[["a_position",2],["a_uv",2],["a_size",2],["a_opacity",1],["a_color",4],["a_strokeColor",4],["a_strokeThickness",1]]}),this._quads=new ri(this._maxRectangles,!0)}_isFull(){return this._rectangleCount>=this._maxRectangles}draw(...e){e[0]instanceof E&&e[1]instanceof E?this.drawLine.apply(this,e):this.drawRectangle.apply(this,e)}drawLine(e,t,i,n=1){this._isFull()&&this.flush(),this._rectangleCount++;const r=this._context.getTransform(),s=this._context.opacity,o=t.sub(e),a=o.size,l=o.normalize().perpendicular(),c=n/2,d=r.multiply(l.scale(c).add(e)),h=r.multiply(l.scale(-c).add(e)),u=r.multiply(l.scale(c).add(t)),p=r.multiply(l.scale(-c).add(t)),f=D.Transparent,g=this._layout.vertexBuffer.bufferData;g[this._vertexIndex++]=d.x,g[this._vertexIndex++]=d.y,g[this._vertexIndex++]=0,g[this._vertexIndex++]=0,g[this._vertexIndex++]=a,g[this._vertexIndex++]=n,g[this._vertexIndex++]=s,g[this._vertexIndex++]=i.r/255,g[this._vertexIndex++]=i.g/255,g[this._vertexIndex++]=i.b/255,g[this._vertexIndex++]=i.a,g[this._vertexIndex++]=f.r/255,g[this._vertexIndex++]=f.g/255,g[this._vertexIndex++]=f.b/255,g[this._vertexIndex++]=f.a,g[this._vertexIndex++]=0,g[this._vertexIndex++]=h.x,g[this._vertexIndex++]=h.y,g[this._vertexIndex++]=0,g[this._vertexIndex++]=1,g[this._vertexIndex++]=a,g[this._vertexIndex++]=n,g[this._vertexIndex++]=s,g[this._vertexIndex++]=i.r/255,g[this._vertexIndex++]=i.g/255,g[this._vertexIndex++]=i.b/255,g[this._vertexIndex++]=i.a,g[this._vertexIndex++]=f.r/255,g[this._vertexIndex++]=f.g/255,g[this._vertexIndex++]=f.b/255,g[this._vertexIndex++]=f.a,g[this._vertexIndex++]=0,g[this._vertexIndex++]=u.x,g[this._vertexIndex++]=u.y,g[this._vertexIndex++]=1,g[this._vertexIndex++]=0,g[this._vertexIndex++]=a,g[this._vertexIndex++]=n,g[this._vertexIndex++]=s,g[this._vertexIndex++]=i.r/255,g[this._vertexIndex++]=i.g/255,g[this._vertexIndex++]=i.b/255,g[this._vertexIndex++]=i.a,g[this._vertexIndex++]=f.r/255,g[this._vertexIndex++]=f.g/255,g[this._vertexIndex++]=f.b/255,g[this._vertexIndex++]=f.a,g[this._vertexIndex++]=0,g[this._vertexIndex++]=p.x,g[this._vertexIndex++]=p.y,g[this._vertexIndex++]=1,g[this._vertexIndex++]=1,g[this._vertexIndex++]=a,g[this._vertexIndex++]=n,g[this._vertexIndex++]=s,g[this._vertexIndex++]=i.r/255,g[this._vertexIndex++]=i.g/255,g[this._vertexIndex++]=i.b/255,g[this._vertexIndex++]=i.a,g[this._vertexIndex++]=f.r/255,g[this._vertexIndex++]=f.g/255,g[this._vertexIndex++]=f.b/255,g[this._vertexIndex++]=f.a,g[this._vertexIndex++]=0}drawRectangle(e,t,i,n,r=D.Transparent,s=0){this._isFull()&&this.flush(),this._rectangleCount++;const o=this._context.getTransform(),a=this._context.opacity,l=o.multiply(e.add(P(0,0))),c=o.multiply(e.add(P(t,0))),d=o.multiply(e.add(P(t,i))),h=o.multiply(e.add(P(0,i))),u=this._layout.vertexBuffer.bufferData;u[this._vertexIndex++]=l.x,u[this._vertexIndex++]=l.y,u[this._vertexIndex++]=0,u[this._vertexIndex++]=0,u[this._vertexIndex++]=t,u[this._vertexIndex++]=i,u[this._vertexIndex++]=a,u[this._vertexIndex++]=n.r/255,u[this._vertexIndex++]=n.g/255,u[this._vertexIndex++]=n.b/255,u[this._vertexIndex++]=n.a,u[this._vertexIndex++]=r.r/255,u[this._vertexIndex++]=r.g/255,u[this._vertexIndex++]=r.b/255,u[this._vertexIndex++]=r.a,u[this._vertexIndex++]=s,u[this._vertexIndex++]=h.x,u[this._vertexIndex++]=h.y,u[this._vertexIndex++]=0,u[this._vertexIndex++]=1,u[this._vertexIndex++]=t,u[this._vertexIndex++]=i,u[this._vertexIndex++]=a,u[this._vertexIndex++]=n.r/255,u[this._vertexIndex++]=n.g/255,u[this._vertexIndex++]=n.b/255,u[this._vertexIndex++]=n.a,u[this._vertexIndex++]=r.r/255,u[this._vertexIndex++]=r.g/255,u[this._vertexIndex++]=r.b/255,u[this._vertexIndex++]=r.a,u[this._vertexIndex++]=s,u[this._vertexIndex++]=c.x,u[this._vertexIndex++]=c.y,u[this._vertexIndex++]=1,u[this._vertexIndex++]=0,u[this._vertexIndex++]=t,u[this._vertexIndex++]=i,u[this._vertexIndex++]=a,u[this._vertexIndex++]=n.r/255,u[this._vertexIndex++]=n.g/255,u[this._vertexIndex++]=n.b/255,u[this._vertexIndex++]=n.a,u[this._vertexIndex++]=r.r/255,u[this._vertexIndex++]=r.g/255,u[this._vertexIndex++]=r.b/255,u[this._vertexIndex++]=r.a,u[this._vertexIndex++]=s,u[this._vertexIndex++]=d.x,u[this._vertexIndex++]=d.y,u[this._vertexIndex++]=1,u[this._vertexIndex++]=1,u[this._vertexIndex++]=t,u[this._vertexIndex++]=i,u[this._vertexIndex++]=a,u[this._vertexIndex++]=n.r/255,u[this._vertexIndex++]=n.g/255,u[this._vertexIndex++]=n.b/255,u[this._vertexIndex++]=n.a,u[this._vertexIndex++]=r.r/255,u[this._vertexIndex++]=r.g/255,u[this._vertexIndex++]=r.b/255,u[this._vertexIndex++]=r.a,u[this._vertexIndex++]=s}hasPendingDraws(){return 0!==this._rectangleCount}flush(){if(0===this._rectangleCount)return;const e=this._gl;this._shader.use(),this._layout.use(!0),this._shader.setUniformMatrix("u_matrix",this._context.ortho),this._quads.bind(),e.drawElements(e.TRIANGLES,6*this._rectangleCount,this._quads.bufferGlType,0),ei.DrawnImagesCount+=this._rectangleCount,ei.DrawCallCount++,this._rectangleCount=0,this._vertexIndex=0}}class ai{constructor(){this.type="ex.circle",this.priority=0,this._maxCircles=10922,this._circleCount=0,this._vertexIndex=0}initialize(e,t){this._gl=e,this._context=t,e.getExtension("OES_standard_derivatives"),this._shader=new Qt({fragmentSource:"#ifdef GL_OES_standard_derivatives\n#extension GL_OES_standard_derivatives : enable\n#endif\nprecision highp float;\n\n// UV coord\nvarying vec2 v_uv;\n\n// Color coord to blend with image\nvarying lowp vec4 v_color;\n\n// Stroke color if used\nvarying lowp vec4 v_strokeColor;\n\n// Stroke thickness if used\nvarying lowp float v_strokeThickness;\n\n// Opacity\nvarying float v_opacity;\n\nvoid main() {\n  // make (0, 0) the center the uv \n  vec2 uv = v_uv * 2.0 - 1.0;\n\n  vec4 color = v_color;\n  vec4 strokeColor = v_strokeColor;\n\n  // circle border is at radius 1.0 \n  // dist is > 0 when inside the circle \n  float d = length(uv);\n  float dist = 1.0 - length(uv);\n\n  // Fade based on fwidth\n  float fade = fwidth(dot(uv, uv));\n\n  // if dist is greater than 0 step to 1;\n  // when we cross this 0 threshold add a smooth fade\n  float fill = smoothstep(-fade/2.0, fade/2.0, dist);\n\n  // if dist is greater than the stroke thickness step to 1\n  float stroke = 1.0 - smoothstep(v_strokeThickness, v_strokeThickness + fade, dist);\n\n  strokeColor.a *= fill * stroke;\n  strokeColor.rgb *= strokeColor.a;\n\n  color.a *= fill * (1.0 - stroke);\n  color.rgb *= color.a;\n\n  vec4 finalColor = mix(vec4(0.0), (color + strokeColor), fill);\n  finalColor.rgb = finalColor.rgb * v_opacity;\n  finalColor.a = finalColor.a * v_opacity;\n  gl_FragColor = finalColor;\n}",vertexSource:"attribute vec2 a_position;\n\n// UV coordinate\nattribute vec2 a_uv;\nvarying vec2 v_uv;\n\n// Opacity \nattribute float a_opacity;\nvarying float v_opacity;\n\nattribute vec4 a_color;\nvarying vec4 v_color;\n\nattribute vec4 a_strokeColor;\nvarying vec4 v_strokeColor;\n\nattribute float a_strokeThickness;\nvarying float v_strokeThickness;\n\nuniform mat4 u_matrix;\n\n\nvoid main() {\n   // Set the vertex position using the ortho transform matrix\n   gl_Position = u_matrix * vec4(a_position, 0.0, 1.0);\n\n   // Pass through UV coords\n   v_uv = a_uv;\n   // Pass through the Opacity to the fragment shader\n   v_opacity = a_opacity;\n   // Pass through the color to the fragment shader\n   v_color = a_color;\n   // Pass through the stroke color to the fragment shader\n   v_strokeColor = a_strokeColor;\n   // Pass through the stroke thickenss to the fragment shader\n   v_strokeThickness = a_strokeThickness;\n}"}),this._shader.compile(),this._shader.use(),this._shader.setUniformMatrix("u_matrix",t.ortho),this._buffer=new Zt({size:56*this._maxCircles,type:"dynamic"}),this._layout=new Jt({shader:this._shader,vertexBuffer:this._buffer,attributes:[["a_position",2],["a_uv",2],["a_opacity",1],["a_color",4],["a_strokeColor",4],["a_strokeThickness",1]]}),this._quads=new ri(this._maxCircles,!0)}_isFull(){return this._circleCount>=this._maxCircles}draw(e,t,i,n=D.Transparent,r=0){this._isFull()&&this.flush(),this._circleCount++;const s=this._context.getTransform(),o=this._context.opacity,a=s.multiply(e.add(P(-t,-t))),l=s.multiply(e.add(P(t,-t))),c=s.multiply(e.add(P(t,t))),d=s.multiply(e.add(P(-t,t))),h=this._layout.vertexBuffer.bufferData;h[this._vertexIndex++]=a.x,h[this._vertexIndex++]=a.y,h[this._vertexIndex++]=0,h[this._vertexIndex++]=0,h[this._vertexIndex++]=o,h[this._vertexIndex++]=i.r/255,h[this._vertexIndex++]=i.g/255,h[this._vertexIndex++]=i.b/255,h[this._vertexIndex++]=i.a,h[this._vertexIndex++]=n.r/255,h[this._vertexIndex++]=n.g/255,h[this._vertexIndex++]=n.b/255,h[this._vertexIndex++]=n.a,h[this._vertexIndex++]=r/t,h[this._vertexIndex++]=d.x,h[this._vertexIndex++]=d.y,h[this._vertexIndex++]=0,h[this._vertexIndex++]=1,h[this._vertexIndex++]=o,h[this._vertexIndex++]=i.r/255,h[this._vertexIndex++]=i.g/255,h[this._vertexIndex++]=i.b/255,h[this._vertexIndex++]=i.a,h[this._vertexIndex++]=n.r/255,h[this._vertexIndex++]=n.g/255,h[this._vertexIndex++]=n.b/255,h[this._vertexIndex++]=n.a,h[this._vertexIndex++]=r/t,h[this._vertexIndex++]=l.x,h[this._vertexIndex++]=l.y,h[this._vertexIndex++]=1,h[this._vertexIndex++]=0,h[this._vertexIndex++]=o,h[this._vertexIndex++]=i.r/255,h[this._vertexIndex++]=i.g/255,h[this._vertexIndex++]=i.b/255,h[this._vertexIndex++]=i.a,h[this._vertexIndex++]=n.r/255,h[this._vertexIndex++]=n.g/255,h[this._vertexIndex++]=n.b/255,h[this._vertexIndex++]=n.a,h[this._vertexIndex++]=r/t,h[this._vertexIndex++]=c.x,h[this._vertexIndex++]=c.y,h[this._vertexIndex++]=1,h[this._vertexIndex++]=1,h[this._vertexIndex++]=o,h[this._vertexIndex++]=i.r/255,h[this._vertexIndex++]=i.g/255,h[this._vertexIndex++]=i.b/255,h[this._vertexIndex++]=i.a,h[this._vertexIndex++]=n.r/255,h[this._vertexIndex++]=n.g/255,h[this._vertexIndex++]=n.b/255,h[this._vertexIndex++]=n.a,h[this._vertexIndex++]=r/t}hasPendingDraws(){return 0!==this._circleCount}flush(){if(0===this._circleCount)return;const e=this._gl;this._shader.use(),this._layout.use(!0),this._shader.setUniformMatrix("u_matrix",this._context.ortho),this._quads.bind(),e.drawElements(e.TRIANGLES,6*this._circleCount,this._quads.bufferGlType,0),ei.DrawnImagesCount+=this._circleCount,ei.DrawCallCount++,this._circleCount=0,this._vertexIndex=0}}class li{constructor(e){this._webglCtx=e,this._debugText=new qt}drawRect(e,t,i,n,r={color:D.Black}){this.drawLine(P(e,t),P(e+i,t),{...r}),this.drawLine(P(e+i,t),P(e+i,t+n),{...r}),this.drawLine(P(e+i,t+n),P(e,t+n),{...r}),this.drawLine(P(e,t+n),P(e,t),{...r})}drawLine(e,t,i={color:D.Black}){this._webglCtx.draw("ex.line",e,t,i.color)}drawPoint(e,t={color:D.Black,size:5}){this._webglCtx.draw("ex.point",e,t.color,t.size)}drawText(e,t){this._debugText.write(this._webglCtx,e,t)}}class ci{constructor(e){this._logger=v.getInstance(),this._renderers=new Map,this._isDrawLifecycle=!1,this._postProcessTargets=[],this._postprocessors=[],this._transform=new me,this._state=new _e,this.snapToPixel=!0,this.smoothing=!1,this.backgroundColor=D.ExcaliburBlue,this._alreadyWarnedDrawLifecycle=!1,this.debug=new li(this);const{canvasElement:t,enableTransparency:i,smoothing:n,snapToPixel:r,backgroundColor:s}=e;this.__gl=t.getContext("webgl",{antialias:null!=n?n:this.smoothing,premultipliedAlpha:!1,alpha:null==i||i,depth:!0,powerPreference:"high-performance"}),Yt.register(this.__gl),Pe.register(this.__gl),this.snapToPixel=null!=r?r:this.snapToPixel,this.smoothing=null!=n?n:this.smoothing,this.backgroundColor=null!=s?s:this.backgroundColor,this._init()}get opacity(){return this._state.current.opacity}set opacity(e){this._state.current.opacity=e}get width(){return this.__gl.canvas.width}get height(){return this.__gl.canvas.height}get ortho(){return this._ortho}checkIfResolutionSupported(e){let t=!0;return(e.width>4096||e.height>4096)&&(t=!1),t}_init(){const e=this.__gl;this._ortho=ge.ortho(0,e.canvas.width,e.canvas.height,0,400,-400),e.viewport(0,0,e.canvas.width,e.canvas.height),e.clearColor(this.backgroundColor.r/255,this.backgroundColor.g/255,this.backgroundColor.b/255,this.backgroundColor.a),e.clear(e.COLOR_BUFFER_BIT),e.enable(e.BLEND),e.blendEquation(e.FUNC_ADD),e.blendFunc(e.ONE,e.ONE_MINUS_SRC_ALPHA),e.blendEquationSeparate(e.FUNC_ADD,e.FUNC_ADD),e.blendFuncSeparate(e.ONE,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA),this.register(new si),this.register(new oi),this.register(new ai),this.register(new ii),this.register(new ti),this._screenRenderer=new ni(e),this._renderTarget=new Xt({gl:e,width:e.canvas.width,height:e.canvas.height}),this._postProcessTargets=[new Xt({gl:e,width:e.canvas.width,height:e.canvas.height}),new Xt({gl:e,width:e.canvas.width,height:e.canvas.height})],this._canvas=new Te({width:e.canvas.width,height:e.canvas.height}),this.__ctx=this._canvas.ctx}register(e){this._renderers.set(e.type,e),e.initialize(this.__gl,this)}get(e){return this._renderers.get(e)}_isCurrentRenderer(e){return!this._currentRenderer||this._currentRenderer===e}beginDrawLifecycle(){this._isDrawLifecycle=!0}endDrawLifecycle(){this._isDrawLifecycle=!1}draw(e,...t){this._isDrawLifecycle||this._alreadyWarnedDrawLifecycle||(this._logger.warn("Attempting to draw outside the the drawing lifecycle (preDraw/postDraw) is not supported and is a source of bugs/errors.\nIf you want to do custom drawing, use Actor.graphics, or any onPreDraw or onPostDraw handler."),this._alreadyWarnedDrawLifecycle=!0);const i=this._renderers.get(e);if(!i)throw Error(`No renderer with name ${e} has been registered`);this._currentRenderer||(this._currentRenderer=i),this._isCurrentRenderer(i)||this._currentRenderer.flush(),i.draw(...t),this._currentRenderer=i}resetTransform(){this._transform.current=ge.identity()}updateViewport(e){const t=this.__gl;this._ortho=this._ortho=ge.ortho(0,e.width,e.height,0,400,-400),this._renderTarget.setResolution(t.canvas.width,t.canvas.height),this._postProcessTargets[0].setResolution(t.canvas.width,t.canvas.height),this._postProcessTargets[1].setResolution(t.canvas.width,t.canvas.height),this._canvas.width=t.canvas.width,this._canvas.height=t.canvas.height}drawImage(e,t,i,n,r,s,o,a,l){if(0!==n&&0!==r&&0!==a&&0!==l&&0!==e.width&&0!==e.height)return e?void this.draw("ex.image",e,t,i,n,r,s,o,a,l):(v.getInstance().warn("Cannot draw a null or undefined image"),void(console.trace&&console.trace()))}drawLine(e,t,i,n=1){this.draw("ex.rectangle",e,t,i,n)}drawRectangle(e,t,i,n,r,s){this.draw("ex.rectangle",e,t,i,n,r,s)}drawCircle(e,t,i,n,r){this.draw("ex.circle",e,t,i,n,r)}save(){this._transform.save(),this._state.save()}restore(){this._transform.restore(),this._state.restore()}translate(e,t){this._transform.translate(this.snapToPixel?~~e:e,this.snapToPixel?~~t:t)}rotate(e){this._transform.rotate(e)}scale(e,t){this._transform.scale(e,t)}transform(e){this._transform.current=e}getTransform(){return this._transform.current}multiply(e){this._transform.current=this._transform.current.multiply(e)}addPostProcessor(e){this._postprocessors.push(e),e.initialize(this.__gl)}removePostProcessor(e){const t=this._postprocessors.indexOf(e);-1!==t&&this._postprocessors.splice(t,1)}clearPostProcessors(){this._postprocessors.length=0}clear(){const e=this.__gl;this._renderTarget.use(),e.clearColor(this.backgroundColor.r/255,this.backgroundColor.g/255,this.backgroundColor.b/255,this.backgroundColor.a),e.clear(e.COLOR_BUFFER_BIT)}flush(){const e=this.__gl;this._renderTarget.use();for(const e of this._renderers.values())e.hasPendingDraws()&&e.flush();this._renderTarget.disable(),this._renderTarget.toRenderSource().use();for(let e=0;e<this._postprocessors.length;e++)this._postProcessTargets[e%2].use(),this._screenRenderer.renderWithPostProcessor(this._postprocessors[e]),this._postProcessTargets[e%2].toRenderSource().use();e.bindFramebuffer(e.FRAMEBUFFER,null),this._screenRenderer.renderToScreen()}}var di,hi;(hi=di||(di={})).Fixed="Fixed",hi.FitScreen="FitScreen",hi.FillScreen="FillScreen",hi.FitContainer="FitContainer",hi.FillContainer="FillContainer",hi.Position="Position";class ui{static get SVGA(){return{width:800,height:600}}static get Standard(){return{width:1920,height:1080}}static get Atari2600(){return{width:160,height:192}}static get GameBoy(){return{width:160,height:144}}static get GameBoyAdvance(){return{width:240,height:160}}static get NintendoDS(){return{width:256,height:192}}static get NES(){return{width:256,height:224}}static get SNES(){return{width:256,height:244}}}class pi{constructor(e){var t,i,n;this._antialiasing=!0,this._resolutionStack=[],this._viewportStack=[],this._pixelRatioOverride=null,this._isFullScreen=!1,this._isDisposed=!1,this._logger=v.getInstance(),this._fullscreenChangeHandler=()=>{this._isFullScreen=!this._isFullScreen,this._logger.debug("Fullscreen Change",this._isFullScreen)},this._pixelRatioChangeHandler=()=>{this._logger.debug("Pixel Ratio Change",window.devicePixelRatio),this._listenForPixelRatio(),this._devicePixelRatio=this._calculateDevicePixelRatio(),this.applyResolutionAndViewport()},this._resizeHandler=()=>{const e=this.parent;this._logger.debug("View port resized"),this._setResolutionAndViewportByDisplayMode(e),this.applyResolutionAndViewport()},this._devicePixelRatio=this._calculateDevicePixelRatio(),this._alreadyWarned=!1,this.viewport=e.viewport,this.resolution=null!==(t=e.resolution)&&void 0!==t?t:{...this.viewport},this._displayMode=null!==(i=e.displayMode)&&void 0!==i?i:di.Fixed,this._canvas=e.canvas,this.graphicsContext=e.context,this._antialiasing=null!==(n=e.antialiasing)&&void 0!==n?n:this._antialiasing,this._browser=e.browser,this._position=e.position,this._pixelRatioOverride=e.pixelRatio,this._applyDisplayMode(),this._listenForPixelRatio(),this._canvas.addEventListener("fullscreenchange",this._fullscreenChangeHandler),this.applyResolutionAndViewport()}_listenForPixelRatio(){this._mediaQueryList&&!this._mediaQueryList.addEventListener&&this._mediaQueryList.removeListener(this._pixelRatioChangeHandler),this._mediaQueryList=this._browser.window.nativeComponent.matchMedia(`(resolution: ${window.devicePixelRatio}dppx)`),this._mediaQueryList.addEventListener?this._mediaQueryList.addEventListener("change",this._pixelRatioChangeHandler,{once:!0}):this._mediaQueryList.addListener(this._pixelRatioChangeHandler)}dispose(){this._isDisposed||(this._isDisposed=!0,this._browser.window.off("resize",this._resizeHandler),this._resizeObserver&&this._resizeObserver.disconnect(),this.parent.removeEventListener("resize",this._resizeHandler),this._mediaQueryList.removeEventListener?this._mediaQueryList.removeEventListener("change",this._pixelRatioChangeHandler):this._mediaQueryList.removeListener(this._pixelRatioChangeHandler),this._canvas.removeEventListener("fullscreenchange",this._fullscreenChangeHandler))}_calculateDevicePixelRatio(){return window.devicePixelRatio<1?1:window.devicePixelRatio||1}get pixelRatio(){return this._pixelRatioOverride?this._pixelRatioOverride:this._devicePixelRatio}get isHiDpi(){return 1!==this.pixelRatio}get displayMode(){return this._displayMode}get canvas(){return this._canvas}get parent(){return this.displayMode===di.FillContainer||this.displayMode===di.FitContainer?this.canvas.parentElement||document.body:window}get resolution(){return this._resolution}set resolution(e){this._resolution=e}get viewport(){return this._viewport?this._viewport:this._resolution}set viewport(e){this._viewport=e}get aspectRatio(){return this._resolution.width/this._resolution.height}get scaledWidth(){return this._resolution.width*this.pixelRatio}get scaledHeight(){return this._resolution.height*this.pixelRatio}setCurrentCamera(e){this._camera=e}pushResolutionAndViewport(){this._resolutionStack.push(this.resolution),this._viewportStack.push(this.viewport),this.resolution={...this.resolution},this.viewport={...this.viewport}}peekViewport(){return this._viewportStack[this._viewportStack.length-1]}peekResolution(){return this._resolutionStack[this._resolutionStack.length-1]}popResolutionAndViewport(){this.resolution=this._resolutionStack.pop(),this.viewport=this._viewportStack.pop()}applyResolutionAndViewport(){this._canvas.width=this.scaledWidth,this._canvas.height=this.scaledHeight,this.graphicsContext instanceof ci&&(this.graphicsContext.checkIfResolutionSupported({width:this.scaledWidth,height:this.scaledHeight})||this._alreadyWarned||(this._alreadyWarned=!0,this._logger.warn(`The currently configured resolution (${this.resolution.width}x${this.resolution.height}) is too large for the platform WebGL implementation, this may work but cause WebGL rendering to behave oddly. Try reducing the resolution or disabling Hi DPI scaling to avoid this (read more here https://excaliburjs.com/docs/screens#understanding-viewport--resolution).`))),this._antialiasing?this._canvas.style.imageRendering="auto":(this._canvas.style.imageRendering="pixelated",""===this._canvas.style.imageRendering&&(this._canvas.style.imageRendering="crisp-edges")),this._canvas.style.width=this.viewport.width+"px",this._canvas.style.height=this.viewport.height+"px",this.graphicsContext.updateViewport(this.resolution),this.graphicsContext.resetTransform(),this.graphicsContext.smoothing=this._antialiasing}get antialiasing(){return this._antialiasing}set antialiasing(e){this._antialiasing=e,this.graphicsContext.smoothing=this._antialiasing}get isFullScreen(){return this._isFullScreen}goFullScreen(){return this._canvas.requestFullscreen()}exitFullScreen(){return document.exitFullscreen()}pageToScreenCoordinates(e){let t=e.x,i=e.y;if(this._isFullScreen||(t-=ee(this._canvas).x,i-=ee(this._canvas).y),this._isFullScreen)if(window.innerWidth/this.aspectRatio<window.innerHeight){const e=window.innerWidth/this.aspectRatio;i=(i-(window.innerHeight-e)/2)/e*this.viewport.height,t=t/window.innerWidth*this.viewport.width}else{const e=window.innerHeight*this.aspectRatio;t=(t-(window.innerWidth-e)/2)/e*this.viewport.width,i=i/window.innerHeight*this.viewport.height}return t=t/this.viewport.width*this.resolution.width,i=i/this.viewport.height*this.resolution.height,new E(t,i)}screenToPageCoordinates(e){let t=e.x,i=e.y;if(t=t/this.resolution.width*this.viewport.width,i=i/this.resolution.height*this.viewport.height,this._isFullScreen)if(window.innerWidth/this.aspectRatio<window.innerHeight){const e=window.innerWidth/this.aspectRatio,n=(window.innerHeight-e)/2;i=i/this.viewport.height*e+n,t=t/this.viewport.width*window.innerWidth}else{const e=window.innerHeight*this.aspectRatio,n=(window.innerWidth-e)/2;t=t/this.viewport.width*e+n,i=i/this.viewport.height*window.innerHeight}return this._isFullScreen||(t+=ee(this._canvas).x,i+=ee(this._canvas).y),new E(t,i)}screenToWorldCoordinates(e){return this._camera?this._camera.inverse.multiply(e):e.sub(P(this.resolution.width/2,this.resolution.height/2))}worldToScreenCoordinates(e){return this._camera?this._camera.transform.multiply(e):e.add(P(this.resolution.width/2,this.resolution.height/2))}pageToWorldCoordinates(e){const t=this.pageToScreenCoordinates(e);return this.screenToWorldCoordinates(t)}worldToPageCoordinates(e){const t=this.worldToScreenCoordinates(e);return this.screenToPageCoordinates(t)}getWorldBounds(){const e=this.screenToWorldCoordinates(E.Zero),t=e.x+this.drawWidth,i=e.y+this.drawHeight;return new I(e.x,e.y,t,i)}get canvasWidth(){return this.canvas.width}get halfCanvasWidth(){return this.canvas.width/2}get canvasHeight(){return this.canvas.height}get halfCanvasHeight(){return this.canvas.height/2}get drawWidth(){return this._camera?this.resolution.width/this._camera.zoom:this.resolution.width}get halfDrawWidth(){return this.drawWidth/2}get drawHeight(){return this._camera?this.resolution.height/this._camera.zoom:this.resolution.height}get halfDrawHeight(){return this.drawHeight/2}get center(){return P(this.halfDrawWidth,this.halfDrawHeight)}_computeFit(){document.body.style.margin="0px",document.body.style.overflow="hidden";const e=this.aspectRatio;let t=0,i=0;window.innerWidth/e<window.innerHeight?(t=window.innerWidth,i=window.innerWidth/e):(t=window.innerHeight*e,i=window.innerHeight),this.viewport={width:t,height:i}}_computeFitContainer(){const e=this.aspectRatio;let t=0,i=0;const n=this.canvas.parentElement;n.clientWidth/e<n.clientHeight?(t=n.clientWidth,i=n.clientWidth/e):(t=n.clientHeight*e,i=n.clientHeight),this.viewport={width:t,height:i}}_applyDisplayMode(){var e,t;this.displayMode===di.Position?this._initializeDisplayModePosition(this._position):(this._setResolutionAndViewportByDisplayMode(this.parent),this.parent instanceof Window?this._browser.window.on("resize",this._resizeHandler):(this._resizeObserver=new ResizeObserver((()=>{this._resizeHandler()})),this._resizeObserver.observe(this.parent)),this.parent.addEventListener("resize",this._resizeHandler),(null===(t=null===(e=null===window||void 0===window?void 0:window.screen)||void 0===e?void 0:e.orientation)||void 0===t?void 0:t.onchange)?window.screen.orientation.onchange=this._resizeHandler:this._browser.window.on("orientationchange",this._resizeHandler))}forceResize(){this._resizeHandler()}_setResolutionAndViewportByDisplayMode(e){this.displayMode===di.FillContainer&&(this.resolution={width:e.clientWidth,height:e.clientHeight},this.viewport=this.resolution),this.displayMode===di.FillScreen&&(document.body.style.margin="0px",document.body.style.overflow="hidden",this.resolution={width:e.innerWidth,height:e.innerHeight},this.viewport=this.resolution),this.displayMode===di.FitScreen&&this._computeFit(),this.displayMode===di.FitContainer&&this._computeFitContainer()}_initializeDisplayModePosition(e){if(!e)throw new Error("DisplayMode of Position was selected but no position option was given");if(this.canvas.style.display="block",this.canvas.style.position="absolute","string"==typeof e){const t=e.split(" ");switch(t[0]){case"top":this.canvas.style.top="0px";break;case"bottom":this.canvas.style.bottom="0px";break;case"middle":this.canvas.style.top="50%";const e=-this.halfDrawHeight;this.canvas.style.marginTop=e.toString();break;default:throw new Error("Invalid Position Given")}if(t[1])switch(t[1]){case"left":this.canvas.style.left="0px";break;case"right":this.canvas.style.right="0px";break;case"center":this.canvas.style.left="50%";const e=-this.halfDrawWidth;this.canvas.style.marginLeft=e.toString();break;default:throw new Error("Invalid Position Given")}}else e.top&&("number"==typeof e.top?this.canvas.style.top=e.top.toString()+"px":this.canvas.style.top=e.top),e.right&&("number"==typeof e.right?this.canvas.style.right=e.right.toString()+"px":this.canvas.style.right=e.right),e.bottom&&("number"==typeof e.bottom?this.canvas.style.bottom=e.bottom.toString()+"px":this.canvas.style.bottom=e.bottom),e.left&&("number"==typeof e.left?this.canvas.style.left=e.left.toString()+"px":this.canvas.style.left=e.left)}}class fi{static create(){return this._INSTANCE||(window.AudioContext||window.webkitAudioContext)&&(this._INSTANCE=new AudioContext),this._INSTANCE}}fi._INSTANCE=null;class gi{static unlock(){return new Promise(((e,t)=>{if(gi._UNLOCKED||!fi.create())return e(!0);const i=setTimeout((()=>{v.getInstance().warn("Excalibur was unable to unlock the audio context, audio probably will not play in this browser."),e(!1)}),200),n=fi.create();n.resume().then((()=>{const t=n.createBuffer(1,1,22050),r=n.createBufferSource();let s=!1;r.buffer=t,r.connect(n.destination),r.onended=()=>s=!0,r.start(0),setTimeout((()=>{!function(e){return!!e.playbackState}(r)?(n.currentTime>0||s)&&(gi._UNLOCKED=!0):r.playbackState!==r.PLAYING_STATE&&r.playbackState!==r.FINISHED_STATE||(gi._UNLOCKED=!0)}),0),clearTimeout(i),e(!0)}),(()=>{t()}))}))}static isUnlocked(){return this._UNLOCKED}}gi._UNLOCKED=!1;class mi{constructor(){this.eventDispatcher=new pt}on(e,t){this.eventDispatcher.on(e,t)}off(e,t){this.eventDispatcher.off(e,t)}emit(e,t){this.eventDispatcher.emit(e,t)}once(e,t){this.eventDispatcher.once(e,t)}}function _i(e,t=D.Red,i,n,r,s,o=1,a="butt"){e.save(),e.beginPath(),e.lineWidth=o,e.lineCap=a,e.strokeStyle=t.toString(),e.moveTo(i,n),e.lineTo(r,s),e.closePath(),e.stroke(),e.restore()}function vi(e,t=D.Red,i){e.beginPath(),e.strokeStyle=t.toString(),e.arc(i.x,i.y,5,0,2*Math.PI),e.closePath(),e.stroke()}function bi(e,t,i,n,r=1){const s=t?t.toString():"blue",o=n.scale(r);e.beginPath(),e.strokeStyle=s,e.moveTo(i.x,i.y),e.lineTo(i.x+o.x,i.y+o.y),e.closePath(),e.stroke()}function wi(e,t,i,n,r,s=5,o=D.White,a=null){let l;if("number"==typeof s)l={tl:s,tr:s,br:s,bl:s};else{const e={tl:0,tr:0,br:0,bl:0};for(const t in e)if(e.hasOwnProperty(t)){const i=t;l[i]=s[i]||e[i]}}e.beginPath(),e.moveTo(t+l.tl,i),e.lineTo(t+n-l.tr,i),e.quadraticCurveTo(t+n,i,t+n,i+l.tr),e.lineTo(t+n,i+r-l.br),e.quadraticCurveTo(t+n,i+r,t+n-l.br,i+r),e.lineTo(t+l.bl,i+r),e.quadraticCurveTo(t,i+r,t,i+r-l.bl),e.lineTo(t,i+l.tl),e.quadraticCurveTo(t,i,t+l.tl,i),e.closePath(),a&&(e.fillStyle=a.toString(),e.fill()),o&&(e.strokeStyle=o.toString(),e.stroke())}function yi(e,t,i,n,r=D.White,s=null){e.beginPath(),e.arc(t,i,n,0,2*Math.PI),e.closePath(),s&&(e.fillStyle=s.toString(),e.fill()),r&&(e.strokeStyle=r.toString(),e.stroke())}var xi=i(1388);class $i extends mi{constructor(e){super(),this.canvas=new Te({filtering:he.Blended,smoothing:!0,draw:this.draw.bind(this)}),this._resourceList=[],this._index=0,this._playButtonShown=!1,this._resourceCount=0,this._numLoaded=0,this._progressCounts={},this._totalCounts={},this.logo="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAdQAAAB2CAYAAABxhGI9AAAACXBIWXMAAAsSAAALEgHS3X78AAAKnUlEQVR42u3dP2wjSx0H8N8hJIonIRmJjsq0SBR+BQ1dcqKhe0lD77SvSwpKkJKGPulpktfRIMUdEqKIqV57rpAokM4dbSiyq7ONPTP7x39ifz7SFbnEnp3xer47O7uzH15fXwMA6OYHmgAABCoACFQAEKgAgEAFAIEKAAIVAAQqACBQAUCgAoBABQCBCgAIVAAQqAAgUAFAoAIAAhUABCoACFQAEKgAgECFLbmOiNeFf2PbAyz68Pr6qhUgbRwR92v+/zwiJrYHMEKFMmcN///UtgcQqFBk1PD/97U9Qx8VCFSgu4EmAIEKAAIVAAQqACBQ4Z25jojP8eX+0WtNAgIVaOY+Im5j+eKh24h41jQgUIEyZ7F5NaPU7wCBCiwYd/w9cOB+qAlgJ3KLLow0EV198803RWvJfvfddx+0lhEqHKu5JgAjVCBvlhmFzjQRXUekHz9+TP79y8uLRjNChXfvoePvAYEKxNtj1e42/O5JoIJABcrdRMRVLM+X3kTEpaaB988cKuzWg9EobTWdMx0Oly8uN4dqhAoARqgnaN3arHfqu7OyH8ItKLVB/P+CEfMTHyGPY3npx1m8zWGDEeoBfUk/xdti57dr/r1Wv2+6EPow3tZ5rRdS72s1neuF97xvWd+XTH0/V+UMttDWqbI/r2nrxfp+jv2uSjSO7S+OXy/A/3lN+9xX5T5HxEUPZZ0tfB71+w57eJ/HFu+z+jkv1u92YX9fbI/HhX3JA9rp5MPr66tWaG9UfUGbrHIzi7cLUyYFf/tpTady03EEeL8mUJ6i7MKYNvWNqr4Pe2jradXO60LrvPAz2PQ5RPX684ah8dxD+2zantnCgVipSVV+m/tgB9W2DDq2Sx/vM95wcHhZhWVJm8yrv58cSgfTdc70+++/X/r522+/tUKSEepBqo+om4ZLPerMjUwuNnQCtx1GWJtee1FwdD5uWd86xLs8UaVt2aNEO1/saZ/Z5rYMW4zq6v34rGV9Bg3q2eZ9SkeNm9qwyUh30OPIHYFKx5FG03C7znSOqYBq+qW/zpQ3anH037TNHluG6f0WPsPhHvab4QFty7ogOeuxDYcNy2/zu2214WNYWxmBurNO8bGn97pNBOO8xy/9uCorZZ4I2r4C7aJgO7ZV9iE49Dm6NvOWx+pWE9CUq3zbdTp9doz38TbXtzqH9RT5CyWe422OaZoZGeZCabrhPQY9HjwsjpTvCg4YtlE2+Ta/j2bzn8fqrDqgm+6yUHOmAvWUjAtGhbNYvsBknDnqH1Qhc7VmxHgeb/NbudA5j/UXlYwif2p6luhAc9teu1npiHKnDs8if6tCm7JLX3NKpgttXe9ruc9mHMd7a83iwdxF5vt8tutARaCeklRnNK9C8WnNF7geJQ4T4XG3JhSnVdilQrG+yOnrlVHfsEGYzhNBn7Lu6tS7+HJafJQ4EMiNlNqWXZ9WPvVgnVYHG5M1ByDXkT6leX2EgTqJtyt45yv7S2qO3sEZjZhDLXeR+YKdJ0Zdk8QocvH9N732KrNtq+FZ/zzIHABcJrYpd+Xv14lOd5ap76SgrduW/VTQ1qcQpqnbgu4ifZvUMNpd9XuoZmvCtPaQ2Y/BCHVLgbrJTeRPDdVf6pfMKDU2fOkHmVFFfXr3MsouLsnNvV5kRoe5+s431PeuoKPqWnaurY/ZPBEeqwceN4l96iwO6H7Mjq4y7VGPVNe10VaZMzVCPVWpI/Z6FZbcv5fMqGCU+dLfFGzj58jP8+bCdJCo7yzKTwdOF0bu9Ug7V4c+yz7FJfYeGoysUss0HssIdVZwYLDujMqlESoCdTtGsZtbHnJBeNdDSJSs0jTKdMJN1HNX54Wv7bvsU9NkVJVa13dX+/wuArV0X/l5RHyo/lnfF4G6p6DrS0kHdtXhy35TGErDPYZUn2WfWqDOo/lVqdMD2O/hKJhD7S/odukymq9s02QN4EEPR/zbaOumZc+r15zK1Zqznl9jsfiemTM1QmV3HUuTkedlg9HIQzRbUD93dfC+2tpj2fIHEH2+RqCCQH13gZq7hWXTNpVu19OB1fc9nQ0AKOKUb5lU0P1kDyOneoWk0lOZ9cIP0x7qu8+2BhCoR2wYu1+e7DmaXzBSsu5vaX1ne2zrpmUPTmxf7PM1Dm4y/vC7ny7Nif7+z/9ZmtM0Z3panPLtPmra9f16bcK0Dpbnwk43Vd/RHtu6zfNQTy1QBy3aqG2g9nVmxml+BOoJyT3NpWmn9xhfFnu4bvDa+44BXhqqfdf3uUF9+yz77AT31Yue2mjecYQ62NLfgkA9ghHqLNEhNem4H1c6vdyDxhf/bpz5m4coW/c39wi6VH2bPtHlcaV9cvXts+zxCe6rTeqc2ndL7uGd93QwM9bFcAzMoZZ7SgTBbWx+asui61h/iq1+RmjqdbnQXQ3T1DNQ63V/U9ucqm/pMzPb1rePsk/1iTOjgvatR4W3Lc8ULB78pELyrnAfeTcj1NU509/86mfJ33/8+Mf00a05UyPUEw7UVCeWG/WNEiExyHRMt5ltW30izUPk18ytt7lNfc8i//DvtvXto+ySA5BjljsLUF8lPkqMPEtW1JomDsiGBZ9Byb4NAvUITSN9GuwsIj6t6UTOqk7jJREkmzqli8xIs96udSO20sX0H1vW92IL9e1a9rgqVyf91gbPsTy9UD9n9lOkT8k+RfkFR5PMNqxOcdSf32PBvg3vilO+zdxE+okx9Wm0ph36XYsRZCpMF993GOk5qvqB3Dct6jvssb67KvuUNJ3frw92bhr8/STSF0JdRPMLpUCgnsgo9S76PZ246ZFk1wWvK5m3vVoYvW1Sz7nN91jfXbQ1ZQc7TW6HeaoOalypG/8/p/rP1aNAc6ZHzSnfdqPUPhdy2PQw6Nz9gSVhuhiqueUHR3uu7y7K3rdDX4u46ZrPbUa0IFBZ0seKQ3XQTRt2vm3W/a2DbNKys++rvm3ep6+y1x2UdP3bWU9lzra47U1GmlctX/sQ23t+aOlByLTh/4NAPaCRxtcdO5HLSJ/6vNtCwGx67VPmPbvWd1q9frKHtp4kAqRJ2HR9j762JfX3bZ//elPtj13PPDx1+D5tqk/Xi6NO8SHz7MmH19dXrdBNfVFP6T2PT1UHNit87/t4m5+aRH+nQBdvqyhZDKJLfZs8h7XPsqdV2ZOV+tanKB8aln0dyxdAXbV4j4gvt4oMOrbP6vbU73NW7TMlbdTnPrWpfqXfh9HKZ9vke7KuTeZRNtXRSe6+1FV//ce/ln5eXfsXgcqXzr6+9261M3moOoa7E6nvTZTfy7iNsmfb7kjfgXGsvxe0vihsEts9HTquPpt1q1vtahu2TqAiUAEEKj0zhwoARqgAu/OnX/442WH+9xc/Wvr58re/Tr7f41/+ZsRqhAoACFQAEKgAcHjMoQJskJsz/eqrr5Z+vvr7v5fmQFevAl5lztQIFQAQqAAgUAHgIJlDBdhgdQ41N2eKESoAIFABQKACwFEwhwoARqgAIFABQKACAAIVAAQqAAhUABCoAIBABQCBCgACFQAEKgAgUAFAoAKAQAUAgQoACFQAEKgAIFABQKACAAIVAAQqAAhUABCoAIBABQCBCgACFQAQqAAgUAFAoAKAQAUAlvwPcFDns1DsH4sAAAAASUVORK5CYII=",this.logoWidth=468,this.logoHeight=118,this.loadingBarColor=D.White,this.backgroundColor="#176BAA",this.suppressPlayButton=!1,this._playButtonStyles=xi.Z.toString(),this.playButtonText="Play game",this.startButtonFactory=()=>{let e=document.getElementById("excalibur-play");return e||(e=document.createElement("button")),e.id="excalibur-play",e.textContent=this.playButtonText,e.style.display="none",e},this._isLoadedPromise=new Promise((e=>{this._isLoadedResolve=e})),e&&this.addResources(e)}get _image(){return this._imageElement||(this._imageElement=new Image,this._imageElement.src=this.logo),this._imageElement}get playButtonRootElement(){return this._playButtonRootElement}get playButtonElement(){return this._playButtonElement}get _playButton(){const e=document.getElementById("excalibur-play-root");return e&&(this._playButtonRootElement=e),this._playButtonRootElement||(this._playButtonRootElement=document.createElement("div"),this._playButtonRootElement.id="excalibur-play-root",this._playButtonRootElement.style.position="absolute",document.body.appendChild(this._playButtonRootElement)),this._styleBlock||(this._styleBlock=document.createElement("style"),this._styleBlock.textContent=this._playButtonStyles,document.head.appendChild(this._styleBlock)),this._playButtonElement||(this._playButtonElement=this.startButtonFactory(),this._playButtonRootElement.appendChild(this._playButtonElement)),this._playButtonElement}wireEngine(e){this._engine=e,this.canvas.width=this._engine.canvas.width,this.canvas.height=this._engine.canvas.height}addResource(e){const t=this._index++;this._resourceList.push(e),this._progressCounts[t]=0,this._totalCounts[t]=1,this._resourceCount++}addResources(e){let t=0;const i=e.length;for(;t<i;t++)this.addResource(e[t])}isLoaded(){return this._numLoaded===this._resourceCount}async showPlayButton(){var e,t;if(!this.suppressPlayButton){const e=()=>{this._positionPlayButton()};(null===(t=this._engine)||void 0===t?void 0:t.browser)&&this._engine.browser.window.on("resize",e),this._playButtonShown=!0,this._playButton.style.display="block",document.body.addEventListener("keyup",(e=>{"Enter"===e.key&&this._playButton.click()})),this._positionPlayButton();const i=new Promise((t=>{const i=i=>{var n;i.stopPropagation(),this.hidePlayButton(),(null===(n=this._engine)||void 0===n?void 0:n.browser)&&this._engine.browser.window.off("resize",e),t()};this._playButton.addEventListener("click",i),this._playButton.addEventListener("touchend",i),this._playButton.addEventListener("pointerup",i)}));return await i}this.hidePlayButton(),await le(500,null===(e=this._engine)||void 0===e?void 0:e.clock)}hidePlayButton(){this._playButtonShown=!1,this._playButton.style.display="none"}dispose(){this._playButtonRootElement.parentElement&&(this._playButtonRootElement.removeChild(this._playButtonElement),document.body.removeChild(this._playButtonRootElement),document.head.removeChild(this._styleBlock),this._playButtonRootElement=null,this._playButtonElement=null,this._styleBlock=null)}update(e,t){}areResourcesLoaded(){return this._isLoadedPromise}async load(){var e,t;return await(null===(e=this._image)||void 0===e?void 0:e.decode()),await Promise.all(this._resourceList.map((e=>e.load().finally((()=>{this._numLoaded++}))))),this._isLoadedResolve(),await le(200,null===(t=this._engine)||void 0===t?void 0:t.clock),await this.showPlayButton(),await gi.unlock(),this.data=this._resourceList}markResourceComplete(){this._numLoaded++}get progress(){return this._resourceCount>0?z(this._numLoaded,0,this._resourceCount)/this._resourceCount:1}_positionPlayButton(){if(this._engine){const e=this._engine.screen.viewport.height,t=this._engine.screen.viewport.width;if(this._playButtonRootElement){const i=this._engine.canvas.offsetLeft,n=this._engine.canvas.offsetTop,r=this._playButton.clientWidth,s=this._playButton.clientHeight;this.playButtonPosition?(this._playButtonRootElement.style.left=`${this.playButtonPosition.x}px`,this._playButtonRootElement.style.top=`${this.playButtonPosition.y}px`):(this._playButtonRootElement.style.left=i+t/2-r/2+"px",this._playButtonRootElement.style.top=n+e/2-s/2+100+"px")}}}draw(e){const t=this._engine.canvasHeight/this._engine.pixelRatio,i=this._engine.canvasWidth/this._engine.pixelRatio;this._positionPlayButton(),e.fillStyle=this.backgroundColor,e.fillRect(0,0,i,t);let n=t/2;const r=Math.min(this.logoWidth,.75*i);let s=i/2-r/2;this.logoPosition&&(s=this.logoPosition.x,n=this.logoPosition.y);const o=Math.floor(r*(this.logoHeight/this.logoWidth)),a=this._engine.getAntialiasing();if(this._engine.setAntialiasing(!0),this.logoPosition?e.drawImage(this._image,0,0,this.logoWidth,this.logoHeight,s,n,r,o):e.drawImage(this._image,0,0,this.logoWidth,this.logoHeight,s,n-o-20,r,o),!this.suppressPlayButton&&this._playButtonShown)return void this._engine.setAntialiasing(a);let l=s,c=n;this.loadingBarPosition&&(l=this.loadingBarPosition.x,c=this.loadingBarPosition.y),e.lineWidth=2,wi(e,l,c,r,20,10,this.loadingBarColor);const d=r*this.progress-10;wi(e,l+5,c+5,d>10?d:10,10,5,null,this.loadingBarColor),this._engine.setAntialiasing(a)}}const Ci={webgl:"WebGL",webaudio:"WebAudio",gamepadapi:"Gamepad API"};class Si{constructor(){this._features=null,this.failedTests=[],this._criticalTests={canvasSupport:function(){const e=document.createElement("canvas");return!(!e.getContext||!e.getContext("2d"))},arrayBufferSupport:function(){const e=new XMLHttpRequest;e.open("GET","/");try{e.responseType="arraybuffer"}catch(e){return!1}return"arraybuffer"===e.responseType},dataUrlSupport:function(){return 0===document.createElement("canvas").toDataURL("image/png").indexOf("data:image/png")},objectUrlSupport:function(){return"URL"in window&&"revokeObjectURL"in URL&&"createObjectURL"in URL},rgbaSupport:function(){const e=document.createElement("a").style;return e.cssText="background-color:rgba(150,255,150,.5)",(""+e.backgroundColor).indexOf("rgba")>-1}},this._warningTest={webAudioSupport:function(){return!!(window.AudioContext||window.webkitAudioContext||window.mozAudioContext||window.msAudioContext||window.oAudioContext)},webglSupport:function(){const e=document.createElement("canvas");return!(!e.getContext||!e.getContext("webgl"))}},this._features=this._loadBrowserFeatures()}getBrowserFeatures(){return null===this._features&&(this._features=this._loadBrowserFeatures()),this._features}logBrowserFeatures(){let e="%cSUPPORTED BROWSER FEATURES\n==========================%c\n";const t=["font-weight: bold; color: navy","font-weight: normal; color: inherit"],i=this.getBrowserFeatures();for(const n of Object.keys(Ci))i[n]?(e+="(%c%c)",t.push("font-weight: bold; color: green"),t.push("font-weight: normal; color: inherit")):(e+="(%c%c)",t.push("font-weight: bold; color: red"),t.push("font-weight: normal; color: inherit")),e+=" "+Ci[n]+"\n";t.unshift(e),console.log.apply(console,t)}_loadBrowserFeatures(){return{canvas:(()=>this._criticalTests.canvasSupport())(),arraybuffer:(()=>this._criticalTests.arrayBufferSupport())(),dataurl:(()=>this._criticalTests.dataUrlSupport())(),objecturl:(()=>this._criticalTests.objectUrlSupport())(),rgba:(()=>this._criticalTests.rgbaSupport())(),webaudio:(()=>this._warningTest.webAudioSupport())(),webgl:(()=>this._warningTest.webglSupport())(),gamepadapi:!!navigator.getGamepads}}test(){let e=!1;for(const t in this._criticalTests)this._criticalTests[t].call(this)||(this.failedTests.push(t),v.getInstance().error("Critical browser feature missing, Excalibur requires:",t),e=!0);if(e)return!1;for(const e in this._warningTest)this._warningTest[e]()||v.getInstance().warn("Warning browser feature missing, Excalibur will have reduced performance:",e);return!0}}var Ei,Pi,ki,Ti,Ai,Di,Ri,Ii,Mi,Li;(Pi=Ei||(Ei={})).PreventCollision="PreventCollision",Pi.Passive="Passive",Pi.Active="Active",Pi.Fixed="Fixed",(Ti=ki||(ki={})).Arcade="arcade",Ti.Realistic="realistic",(Di=Ai||(Ai={}))[Di.DynamicAABBTree=0]="DynamicAABBTree",(Ii=Ri||(Ri={}))[Ii.Euler=0]="Euler";class Bi{static get gravity(){return Bi.acc}static set gravity(e){Bi.acc=e}static useArcadePhysics(){Bi.collisionResolutionStrategy=ki.Arcade}static useRealisticPhysics(){Bi.collisionResolutionStrategy=ki.Realistic}static get dynamicTreeVelocityMultiplyer(){return Bi.dynamicTreeVelocityMultiplier}static set dynamicTreeVelocityMultiplyer(e){Bi.dynamicTreeVelocityMultiplier=e}}Bi.acc=new E(0,0),Bi.enabled=!0,Bi.broadphaseStrategy=Ai.DynamicAABBTree,Bi.collisionResolutionStrategy=ki.Arcade,Bi.defaultMass=10,Bi.integrator=Ri.Euler,Bi.dynamicTreeVelocityMultiplier=2,Bi.boundsPadding=5,Bi.positionIterations=3,Bi.velocityIterations=8,Bi.slop=1,Bi.steeringFactor=.2,Bi.warmStart=!0,Bi.bodiesCanSleepByDefault=!1,Bi.surfaceEpsilon=.1,Bi.sleepEpsilon=.07,Bi.wakeThreshold=3*Bi.sleepEpsilon,Bi.sleepBias=.9,Bi.checkForFastBodies=!0,Bi.disableMinimumSpeedForFastBody=!1,function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);s>3&&o&&Object.defineProperty(t,i,o)}([S({message:"Alias for incorrect spelling used in older versions, will be removed in v0.25.0",alternateMethod:"dynamicTreeVelocityMultiplier"})],Bi,"dynamicTreeVelocityMultiplyer",null);class Fi extends E{constructor(e){super(0,0),this._getX=e.getX,this._getY=e.getY,this._setX=e.setX,this._setY=e.setY}get x(){return this._x=this._getX()}set x(e){this._setX(e),this._x=e}get y(){return this._y=this._getY()}set y(e){this._setY(e),this._y=e}}class Oi{constructor(){this.owner=null}clone(){const e=new this.constructor;for(const i in this)if(this.hasOwnProperty(i)){const n=this[i];(null==(t=n)?void 0:t.clone)&&"owner"!==i&&"clone"!==i?e[i]=n.clone():e[i]=n}var t;return e}}class zi extends Oi{constructor(e,t){super(),this.type=e,this.value=t}}class Ni{constructor(){this.observers=[],this.subscriptions=[]}register(e){this.observers.push(e)}subscribe(e){this.subscriptions.push(e)}unregister(e){const t=this.observers.indexOf(e);-1!==t&&this.observers.splice(t,1)}unsubscribe(e){const t=this.subscriptions.indexOf(e);-1!==t&&this.subscriptions.splice(t,1)}notifyAll(e){this.observers.forEach((t=>t.notify(e))),this.subscriptions.forEach((t=>t(e)))}clear(){this.observers.length=0,this.subscriptions.length=0}}(Li=Mi||(Mi={})).World="world",Li.Screen="screen";class Vi extends Oi{constructor(){super(...arguments),this.type="ex.transform",this._dirty=!1,this.matrix=ge.identity().translate(0,0).rotate(0).scale(1,1),this._position=ve((e=>{const t=e;return new Fi({setX:e=>{t.data[ce.X]=e},setY:e=>{t.data[ce.Y]=e},getX:()=>t.data[ce.X],getY:()=>t.data[ce.Y]})})(this.matrix),(e=>{this.posChanged$.notifyAll(e)})),this._rotation=0,this._scale=(e=>{const t=e;return new Fi({setX:e=>{t.setScaleX(e)},setY:e=>{t.setScaleY(e)},getX:()=>t.getScaleX(),getY:()=>t.getScaleY()})})(this.matrix),this.coordPlane=Mi.World,this.posChanged$=new Ni,this.zIndexChanged$=new Ni,this._z=0}_recalculate(){this._rotation=this.matrix.getRotation(),this._dirty=!1}getGlobalMatrix(){return this.parent?this.parent.getGlobalMatrix().multiply(this.matrix):this.matrix}getGlobalTransform(){return{pos:this.globalPos,scale:this.globalScale,rotation:this.globalRotation,z:this.z,coordPlane:this.coordPlane}}get parent(){var e,t;return null===(t=null===(e=null==this?void 0:this.owner)||void 0===e?void 0:e.parent)||void 0===t?void 0:t.get(Vi)}get pos(){return this._dirty&&this._recalculate(),this._position}set pos(e){const t=this.matrix.getPosition();this.matrix.setPosition(e.x,e.y),this._dirty=!0,t.equals(e)||this.posChanged$.notifyAll(this._position)}get dirty(){var e;return(null===(e=null==this?void 0:this.owner)||void 0===e?void 0:e.parent)&&this.parent.dirty||this._dirty}get globalPos(){const e=this.getGlobalMatrix();return new Fi({getX:()=>e.data[ce.X],getY:()=>e.data[ce.Y],setX:t=>{var i;const n=this.matrix.data[ce.X];if(this.parent){const{x:n}=null===(i=this.parent)||void 0===i?void 0:i.getGlobalMatrix().getAffineInverse().multiply(P(t,e.data[ce.Y]));this.matrix.data[ce.X]=n}else this.matrix.data[ce.X]=t;n!==this.matrix.data[ce.X]&&this.posChanged$.notifyAll(this._position)},setY:t=>{var i;const n=this.matrix.data[ce.Y];if(this.parent){const{y:n}=null===(i=this.parent)||void 0===i?void 0:i.getGlobalMatrix().getAffineInverse().multiply(P(e.data[ce.X],t));this.matrix.data[ce.Y]=n}else this.matrix.data[ce.Y]=t;n!==this.matrix.data[ce.Y]&&this.posChanged$.notifyAll(this._position)}})}set globalPos(e){const t=this.pos,i=this.parent;this.pos=i?i.getGlobalMatrix().getAffineInverse().multiply(e):e,t.equals(e)||this.posChanged$.notifyAll(this.pos)}get z(){return this._z}set z(e){const t=this._z;this._z=e,t!==e&&this.zIndexChanged$.notifyAll(e)}get rotation(){return this._dirty&&this._recalculate(),this._rotation}set rotation(e){this.matrix.setRotation(e),this._dirty=!0}get globalRotation(){return this.getGlobalMatrix().getRotation()}set globalRotation(e){const t=this.parent;this.rotation=t?e-t.globalRotation:e}get scale(){return this._dirty&&this._recalculate(),this._scale}set scale(e){this.matrix.setScale(e),this._dirty=!0}get globalScale(){const e=this.getGlobalMatrix();return new Fi({getX:()=>e.getScaleX(),getY:()=>e.getScaleY(),setX:e=>{if(this.parent){const t=this.parent.globalScale.x;this.matrix.setScaleX(e/t)}else this.matrix.setScaleX(e)},setY:e=>{if(this.parent){const t=this.parent.globalScale.y;this.matrix.setScaleY(e/t)}else this.matrix.setScaleY(e)}})}set globalScale(e){const t=this.parent;this.scale=t?P(e.x/t.globalScale.x,e.y/t.globalScale.y):e}apply(e){return this.matrix.multiply(e)}applyInverse(e){return this.matrix.getAffineInverse().multiply(e)}}class Ui extends Oi{constructor(){super(...arguments),this.type="ex.motion",this.vel=E.Zero,this.acc=E.Zero,this.scaleFactor=E.Zero,this.angularVelocity=0,this.torque=0,this.inertia=1}}class Hi{constructor(e,t,i){this._name=e,this._category=t,this._mask=i}get name(){return this._name}get category(){return this._category}get mask(){return this._mask}canCollide(e){return 0!=(this.category&e.mask)&&0!=(e.category&this.mask)}invert(){return new Hi("~("+this.name+")",~this.category,~this.mask)}static combine(e){const t=e.map((e=>e.name)).join("+"),i=e.reduce(((e,t)=>t.category|e),0);return new Hi(t,i,~i)}static collidesWith(e){return Hi.combine(e).invert()}}Hi.All=new Hi("Collide with all groups",-1,-1);class ji{constructor(e,t){this.colliderA=e,this.colliderB=t,this.id=null,this.id=ji.calculatePairHash(e.id,t.id)}static canCollide(e,t){var i,n;const r=null===(i=null==e?void 0:e.owner)||void 0===i?void 0:i.get(fn),s=null===(n=null==t?void 0:t.owner)||void 0===n?void 0:n.get(fn);return!(e.id===t.id||e.owner&&t.owner&&e.owner.id===t.owner.id||e.localBounds.hasZeroDimensions()||t.localBounds.hasZeroDimensions()||!r||!s||!r.group.canCollide(s.group)||r.collisionType===Ei.Fixed&&s.collisionType===Ei.Fixed||s.collisionType===Ei.PreventCollision||r.collisionType===Ei.PreventCollision||!r.active||!s.active)}get canCollide(){const e=this.colliderA,t=this.colliderB;return ji.canCollide(e,t)}collide(){return this.colliderA.collide(this.colliderB)}hasCollider(e){return e===this.colliderA||e===this.colliderB}static calculatePairHash(e,t){return e.value<t.value?`#${e.value}+${t.value}`:`#${t.value}+${e.value}`}}class Wi{constructor(e,t){this.min=e,this.max=t}overlaps(e){return this.max>e.min&&e.max>this.min}getOverlap(e){return this.overlaps(e)?this.max>e.max?e.max-this.min:this.max-e.min:0}}class Gi{constructor(e){this.parent=e,this.parent=e||null,this.data=null,this.bounds=new I,this.left=null,this.right=null,this.height=0}isLeaf(){return!this.left&&!this.right}}class qi{constructor(e=new I(-Number.MAX_VALUE,-Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE)){this.worldBounds=e,this.root=null,this.nodes={}}_insert(e){if(null===this.root)return this.root=e,void(this.root.parent=null);const t=e.bounds;let i=this.root;for(;!i.isLeaf();){const e=i.left,n=i.right,r=i.bounds.getPerimeter(),s=i.bounds.combine(t).getPerimeter(),o=2*s,a=2*(s-r);let l=0;const c=t.combine(e.bounds);let d,h;e.isLeaf()?l=c.getPerimeter()+a:(h=e.bounds.getPerimeter(),d=c.getPerimeter(),l=d-h+a);let u=0;const p=t.combine(n.bounds);if(n.isLeaf()?u=p.getPerimeter()+a:(h=n.bounds.getPerimeter(),d=p.getPerimeter(),u=d-h+a),o<l&&o<u)break;i=l<u?e:n}const n=i.parent,r=new Gi(n);r.bounds=t.combine(i.bounds),r.height=i.height+1,null!==n?(n.left===i?n.left=r:n.right=r,r.left=i,r.right=e,i.parent=r,e.parent=r):(r.left=i,r.right=e,i.parent=r,e.parent=r,this.root=r);let s=e.parent;for(;s;){if(s=this._balance(s),!s.left)throw new Error("Parent of current leaf cannot have a null left child"+s);if(!s.right)throw new Error("Parent of current leaf cannot have a null right child"+s);s.height=1+Math.max(s.left.height,s.right.height),s.bounds=s.left.bounds.combine(s.right.bounds),s=s.parent}}_remove(e){if(e===this.root)return void(this.root=null);const t=e.parent,i=t.parent;let n;if(n=t.left===e?t.right:t.left,i){i.left===t?i.left=n:i.right=n,n.parent=i;let e=i;for(;e;)e=this._balance(e),e.bounds=e.left.bounds.combine(e.right.bounds),e.height=1+Math.max(e.left.height,e.right.height),e=e.parent}else this.root=n,n.parent=null}trackCollider(e){const t=new Gi;t.data=e,t.bounds=e.bounds,t.bounds.left-=2,t.bounds.top-=2,t.bounds.right+=2,t.bounds.bottom+=2,this.nodes[e.id.value]=t,this._insert(t)}updateCollider(e){var t;const i=this.nodes[e.id.value];if(!i)return!1;const n=e.bounds;if(!this.worldBounds.contains(n))return v.getInstance().warn("Collider with id "+e.id.value+" is outside the world bounds and will no longer be tracked for physics"),this.untrackCollider(e),!1;if(i.bounds.contains(n))return!1;if(this._remove(i),n.left-=Bi.boundsPadding,n.top-=Bi.boundsPadding,n.right+=Bi.boundsPadding,n.bottom+=Bi.boundsPadding,e.owner){const i=null===(t=e.owner)||void 0===t?void 0:t.get(fn);if(i){const e=32*i.vel.x/1e3*Bi.dynamicTreeVelocityMultiplier,t=32*i.vel.y/1e3*Bi.dynamicTreeVelocityMultiplier;e<0?n.left+=e:n.right+=e,t<0?n.top+=t:n.bottom+=t}}return i.bounds=n,this._insert(i),!0}untrackCollider(e){const t=this.nodes[e.id.value];t&&(this._remove(t),this.nodes[e.id.value]=null,delete this.nodes[e.id.value])}_balance(e){if(null===e)throw new Error("Cannot balance at null node");if(e.isLeaf()||e.height<2)return e;const t=e.left,i=e.right,n=e,r=t,s=i,o=t.left,a=t.right,l=i.left,c=i.right,d=s.height-r.height;if(d>1)return s.left=n,s.parent=n.parent,n.parent=s,s.parent?s.parent.left===n?s.parent.left=s:s.parent.right=s:this.root=s,l.height>c.height?(s.right=l,n.right=c,c.parent=n,n.bounds=r.bounds.combine(c.bounds),s.bounds=n.bounds.combine(l.bounds),n.height=1+Math.max(r.height,c.height),s.height=1+Math.max(n.height,l.height)):(s.right=c,n.right=l,l.parent=n,n.bounds=r.bounds.combine(l.bounds),s.bounds=n.bounds.combine(c.bounds),n.height=1+Math.max(r.height,l.height),s.height=1+Math.max(n.height,c.height)),s;if(d<-1){if(r.left=n,r.parent=n.parent,n.parent=r,r.parent)if(r.parent.left===n)r.parent.left=r;else{if(r.parent.right!==n)throw"Error rotating Dynamic Tree";r.parent.right=r}else this.root=r;return o.height>a.height?(r.right=o,n.left=a,a.parent=n,n.bounds=s.bounds.combine(a.bounds),r.bounds=n.bounds.combine(o.bounds),n.height=1+Math.max(s.height,a.height),r.height=1+Math.max(n.height,o.height)):(r.right=a,n.left=o,o.parent=n,n.bounds=s.bounds.combine(o.bounds),r.bounds=n.bounds.combine(a.bounds),n.height=1+Math.max(s.height,o.height),r.height=1+Math.max(n.height,a.height)),r}return e}getHeight(){return null===this.root?0:this.root.height}query(e,t){const i=e.bounds,n=r=>{if(r&&r.bounds.intersect(i)){if(!r.isLeaf()||r.data===e)return n(r.left)||n(r.right);if(t.call(e,r.data))return!0}return!1};n(this.root)}rayCastQuery(e,t=1/0,i){const n=r=>{if(r&&r.bounds.rayCast(e,t)){if(!r.isLeaf())return n(r.left)||n(r.right);if(i.call(e,r.data))return!0}return!1};n(this.root)}getNodes(){const e=t=>t?[t].concat(e(t.left),e(t.right)):[];return e(this.root)}debug(e){const t=i=>{i&&(i.isLeaf()?i.bounds.draw(e,D.Green):i.bounds.draw(e,D.White),i.left&&t(i.left),i.right&&t(i.right))};t(this.root)}}class Ki{constructor(e,t){this.pos=e,this.dir=t.normalize()}intersect(e){const t=e.begin.sub(this.pos);if(0===this.dir.cross(e.getSlope())&&0!==t.cross(this.dir))return-1;const i=this.dir.cross(e.getSlope());if(0===i)return-1;const n=t.cross(e.getSlope())/i;if(n>=0){const r=t.cross(this.dir)/i/e.getLength();if(r>=0&&r<=1)return n}return-1}intersectPoint(e){const t=this.intersect(e);return t<0?null:this.getPoint(t)}getPoint(e){return this.pos.add(this.dir.scale(e))}}class Xi{constructor(){this._dynamicCollisionTree=new qi,this._pairs=new Set,this._collisionPairCache=[],this._colliders=[]}getColliders(){return this._colliders}track(e){if(e)if(e instanceof Qi){const t=e.getColliders();for(const i of t)i.owner=e.owner,this._colliders.push(i),this._dynamicCollisionTree.trackCollider(i)}else this._colliders.push(e),this._dynamicCollisionTree.trackCollider(e);else v.getInstance().warn("Cannot track null collider")}untrack(e){if(e)if(e instanceof Qi){const t=e.getColliders();for(const e of t){const t=this._colliders.indexOf(e);-1!==t&&this._colliders.splice(t,1),this._dynamicCollisionTree.untrackCollider(e)}}else{const t=this._colliders.indexOf(e);-1!==t&&this._colliders.splice(t,1),this._dynamicCollisionTree.untrackCollider(e)}else v.getInstance().warn("Cannot untrack a null collider")}_pairExists(e,t){const i=ji.calculatePairHash(e.id,t.id);return this._pairs.has(i)}broadphase(e,t,i){const n=t/1e3,r=e.filter((e=>{var t,i;const n=null===(t=e.owner)||void 0===t?void 0:t.get(fn);return(null===(i=e.owner)||void 0===i?void 0:i.active)&&n.collisionType!==Ei.PreventCollision}));let s;this._collisionPairCache=[],this._pairs.clear();for(let e=0,t=r.length;e<t;e++)s=r[e],this._dynamicCollisionTree.query(s,(e=>{if(!this._pairExists(s,e)&&ji.canCollide(s,e)){const t=new ji(s,e);this._pairs.add(t.id),this._collisionPairCache.push(t)}return!1}));if(i&&(i.physics.pairs=this._collisionPairCache.length),Bi.checkForFastBodies)for(const e of r){const t=e.owner.get(fn);if(t.collisionType!==Ei.Active)continue;const r=t.vel.size*n+.5*t.acc.size*n*n,s=Math.min(e.bounds.height,e.bounds.width);if(Bi.disableMinimumSpeedForFastBody||r>s/2){i&&i.physics.fastBodies++;const n=t.pos.sub(t.oldPos),s=e.center,o=e.getFurthestPoint(t.vel),a=o.sub(n),l=new Ki(a,t.vel);let c;l.pos=l.pos.add(l.dir.scale(-2*Bi.surfaceEpsilon));let d=new E(1/0,1/0);if(this._dynamicCollisionTree.rayCastQuery(l,r+2*Bi.surfaceEpsilon,(t=>{if(!this._pairExists(e,t)&&ji.canCollide(e,t)){const e=t.rayCast(l,r+10*Bi.surfaceEpsilon);if(e){const i=e.sub(a);i.size<d.size&&(d=i,c=t)}}return!1})),c&&E.isValid(d)){const n=new ji(e,c);this._pairs.has(n.id)||(this._pairs.add(n.id),this._collisionPairCache.push(n));const r=s.sub(o);t.pos=a.add(r).add(d).add(l.dir.scale(10*Bi.surfaceEpsilon)),e.update(t.transform),i&&i.physics.fastBodyCollisions++}}}return this._collisionPairCache}narrowphase(e,t){let i=[];for(let n=0;n<e.length;n++){const r=e[n].collide();if(i=i.concat(r),t&&r.length>0)for(const e of r)t.physics.contacts.set(e.id,e)}return t&&(t.physics.collisions+=i.length),i}update(e){let t=0;const i=e.length;for(let n=0;n<i;n++)this._dynamicCollisionTree.updateCollider(e[n])&&t++;return t}debug(e){this._dynamicCollisionTree.debug(e)}}class Yi{constructor(){this.id=_("collider",Yi._ID++),this.events=new pt}touching(e){return!!this.collide(e)}}Yi._ID=0;class Qi extends Yi{constructor(e){super(),this._collisionProcessor=new Xi,this._dynamicAABBTree=new qi,this._colliders=[];for(const t of e)this.addCollider(t)}clearColliders(){this._colliders=[]}addCollider(e){this.events.wire(e.events),this._colliders.push(e),this._collisionProcessor.track(e),this._dynamicAABBTree.trackCollider(e)}removeCollider(e){this.events.unwire(e.events),ie(e,this._colliders),this._collisionProcessor.untrack(e),this._dynamicAABBTree.untrackCollider(e)}getColliders(){return this._colliders}get worldPos(){var e,t;return null!==(t=null===(e=this._transform)||void 0===e?void 0:e.pos)&&void 0!==t?t:E.Zero}get center(){var e,t;return null!==(t=null===(e=this._transform)||void 0===e?void 0:e.pos)&&void 0!==t?t:E.Zero}get bounds(){var e,t;const i=this.getColliders();return i.reduce(((e,t)=>e.combine(t.bounds)),null!==(t=null===(e=i[0])||void 0===e?void 0:e.bounds)&&void 0!==t?t:(new I).translate(this.worldPos))}get localBounds(){var e,t;const i=this.getColliders();return i.reduce(((e,t)=>e.combine(t.localBounds)),null!==(t=null===(e=i[0])||void 0===e?void 0:e.localBounds)&&void 0!==t?t:new I)}get axes(){const e=this.getColliders();let t=[];for(const i of e)t=t.concat(i.axes);return t}getFurthestPoint(e){const t=this.getColliders(),i=[];for(const n of t)i.push(n.getFurthestPoint(e));let n=i[0],r=-Number.MAX_VALUE;for(const t of i){const i=t.dot(e);i>r&&(n=t,r=i)}return n}getInertia(e){const t=this.getColliders();let i=0;for(const n of t)i+=n.getInertia(e);return i}collide(e){let t=[e];e instanceof Qi&&(t=e.getColliders());const i=[];for(const e of t)this._dynamicAABBTree.query(e,(t=>(i.push(new ji(e,t)),!1)));let n=[];for(const e of i)n=n.concat(e.collide());return n}getClosestLineBetween(e){const t=this.getColliders(),i=[];if(e instanceof Qi){const n=e.getColliders();for(const e of t)for(const t of n){const n=e.getClosestLineBetween(t);n&&i.push(n)}}else for(const n of t){const t=e.getClosestLineBetween(n);t&&i.push(t)}if(i.length){let e=i[0].getLength(),t=i[0];for(const n of i){const i=n.getLength();i<e&&(e=i,t=n)}return t}return null}contains(e){const t=this.getColliders();for(const i of t)if(i.contains(e))return!0;return!1}rayCast(e,t){const i=this.getColliders(),n=[];for(const r of i){const i=r.rayCast(e,t);i&&n.push(i)}if(n.length){let t=n[0],i=t.dot(e.dir);for(const r of n){const n=e.dir.dot(r);n<i&&(t=r,i=n)}return t}return null}project(e){const t=this.getColliders(),i=[];for(const n of t){const t=n.project(e);t&&i.push(t)}if(i.length){const e=new Wi(i[0].min,i[0].max);for(const t of i)e.min=Math.min(t.min,e.min),e.max=Math.max(t.max,e.max);return e}return null}update(e){if(e){const t=this.getColliders();for(const i of t)i.owner=this.owner,i.update(e)}}draw(e,t,i){const n=this.getColliders();for(const r of n)r.draw(e,t,i)}debug(e,t){const i=this.getColliders();for(const n of i)n.debug(e,t)}debugDraw(e,t){const i=this.getColliders();for(const n of i)n.draw(e,t)}clone(){return new Qi(this._colliders.map((e=>e.clone())))}}class Zi{constructor(e,t){this.begin=e,this.end=t}get slope(){return(this.end.y-this.begin.y)/(this.end.x-this.begin.x)}get intercept(){return this.begin.y-this.slope*this.begin.x}normal(){return this.end.sub(this.begin).normal()}dir(){return this.end.sub(this.begin)}getPoints(){return[this.begin,this.end]}getSlope(){const e=this.begin,t=this.end,i=e.distance(t);return t.sub(e).scale(1/i)}getEdge(){const e=this.begin;return this.end.sub(e)}getLength(){const e=this.begin,t=this.end;return e.distance(t)}get midpoint(){return this.begin.add(this.end).scale(.5)}flip(){return new Zi(this.end,this.begin)}below(e){return(this.end.x-this.begin.x)*(e.y-this.begin.y)-(this.end.y-this.begin.y)*(e.x-this.begin.x)>=0}clip(e,t){let i=e;i=i.normalize();const n=i.dot(this.begin)-t,r=i.dot(this.end)-t,s=[];if(n<=0&&s.push(this.begin),r<=0&&s.push(this.end),n*r<0){const e=n/(n-r);s.push(this.begin.add(this.end.sub(this.begin).scale(e)))}return 2!==s.length?null:new Zi(s[0],s[1])}distanceToPoint(e,t=!1){const i=e.x,n=e.y,r=this.getLength(),s=((this.end.y-this.begin.y)*i-(this.end.x-this.begin.x)*n+this.end.x*this.begin.y-this.end.y*this.begin.x)/r;return t?s:Math.abs(s)}findVectorToPoint(e){const t=this.begin.sub(e),i=this.getSlope();return t.sub(i.scale(t.dot(i)))}findPoint(e=null,t=null){const i=this.slope,n=this.intercept;if(null!==e)return new E(e,i*e+n);if(null!==t)return new E((t-n)/i,t);throw new Error("You must provide an X or a Y value")}hasPoint(){let e,t=0;if("number"==typeof arguments[0]&&"number"==typeof arguments[1])e=new E(arguments[0],arguments[1]),t=arguments[2]||0;else{if(!(arguments[0]instanceof E))throw"Could not determine the arguments for Vector.hasPoint";e=arguments[0],t=arguments[1]||0}const i=e.x-this.begin.x,n=e.y-this.begin.y,r=this.end.x-this.begin.x,s=this.end.y-this.begin.y,o=i*s-n*r;return!(Math.abs(o)>t)&&(Math.abs(r)>=Math.abs(s)?r>0?this.begin.x<=e.x&&e.x<=this.end.x:this.end.x<=e.x&&e.x<=this.begin.x:s>0?this.begin.y<=e.y&&e.y<=this.end.y:this.end.y<=e.y&&e.y<=this.begin.y)}}function Ji(e,t,i,n){const r=e.sub(i),s=t.dot(t),o=t.dot(n),a=n.dot(n),l=t.dot(r),c=n.dot(r),d=s*a-o*o;let h=d,u=d;if(0===d||d<=.01){const t=l/o;return new Zi(e,i.add(n.scale(t)))}let p=o*c-a*l,f=s*c-o*l;return p<0?(p=0,f=c,u=a):p>h&&(p=h,f=c+o,u=a),f<0?(f=0,-l<0?p=0:-l>s?p=h:(p=-l,h=s)):f>u&&(f=u,-l+o<0?p=0:-l+o>s?p=h:(p=-l+o,h=s)),p=Math.abs(p)<.001?0:p/h,f=Math.abs(f)<.001?0:f/u,new Zi(e.add(t.scale(p)),i.add(n.scale(f)))}const en={PolygonPolygonClosestLine(e,t){const i=t.worldPos,n=i.sub(e.worldPos),r=n.negate(),s=new Ki(e.worldPos,n),o=new Ki(i,r),a=e.rayCast(s).add(s.dir.scale(.1)),l=t.rayCast(o).add(o.dir.scale(.1)),c=e.getClosestFace(a),d=t.getClosestFace(l);return Ji(c.face.begin,c.face.getEdge(),d.face.begin,d.face.getEdge())},PolygonEdgeClosestLine(e,t){const i=t.worldPos.sub(e.worldPos),n=new Ki(e.worldPos,i),r=e.rayCast(n).add(n.dir.scale(.1)),s=e.getClosestFace(r),o=s.face.begin,a=s.face.getEdge(),l=t.asLine();return Ji(o,a,l.begin,l.getEdge())},PolygonCircleClosestLine(e,t){const i=t.worldPos,n=i.sub(e.worldPos),r=new Ki(e.worldPos,n.normalize()),s=e.rayCast(r).add(r.dir.scale(.1)),o=e.getClosestFace(s),a=o.face.begin,l=o.face.getEdge();let c=(l.x*(i.x-a.x)+l.y*(i.y-a.y))/(l.x*l.x+l.y*l.y);c>1?c=1:c<0&&(c=0);const d=Math.sqrt(Math.pow(a.x+l.x*c-i.x,2)+Math.pow(a.y+l.y*c-i.y,2))-t.radius,h=(a.x+l.x*c-i.x)*t.radius/(t.radius+d),u=(a.y+l.y*c-i.y)*t.radius/(t.radius+d);return new Zi(l.scale(c).add(a),new E(i.x+h,i.y+u))},CircleCircleClosestLine(e,t){const i=t.worldPos.sub(e.worldPos),n=e.worldPos.sub(t.worldPos),r=new Ki(e.worldPos,i),s=new Ki(t.worldPos,n),o=e.rayCast(r),a=t.rayCast(s);return new Zi(o,a)},CircleEdgeClosestLine(e,t){const i=e.worldPos,n=t.asLine(),r=n.begin,s=n.getEdge();let o=(s.x*(i.x-r.x)+s.y*(i.y-r.y))/(s.x*s.x+s.y*s.y);o>1?o=1:o<0&&(o=0);const a=Math.sqrt(Math.pow(r.x+s.x*o-i.x,2)+Math.pow(r.y+s.y*o-i.y,2))-e.radius,l=(r.x+s.x*o-i.x)*e.radius/(e.radius+a),c=(r.y+s.y*o-i.y)*e.radius/(e.radius+a);return new Zi(s.scale(o).add(r),new E(i.x+l,i.y+c))},EdgeEdgeClosestLine(e,t){const i=e.asLine(),n=i.begin,r=i.getEdge(),s=t.asLine();return Ji(n,r,s.begin,s.getEdge())}};class tn extends Yi{constructor(e){super(),this.offset=E.Zero,this.offset=e.offset||E.Zero,this.radius=e.radius||0}get worldPos(){var e,t,i,n;const r=this._transform,s=null!==(e=null==r?void 0:r.globalScale)&&void 0!==e?e:E.One,o=null!==(t=null==r?void 0:r.globalRotation)&&void 0!==t?t:0,a=null!==(i=null==r?void 0:r.globalPos)&&void 0!==i?i:E.Zero;return(null!==(n=this.offset)&&void 0!==n?n:E.Zero).scale(s).rotate(o).add(a)}get radius(){var e;const t=this._transform,i=null!==(e=null==t?void 0:t.globalScale)&&void 0!==e?e:E.One;return this._naturalRadius*Math.min(i.x,i.y)}set radius(e){var t;const i=this._transform,n=null!==(t=null==i?void 0:i.globalScale)&&void 0!==t?t:E.One;this._naturalRadius=e/Math.min(n.x,n.y)}clone(){return new tn({offset:this.offset.clone(),radius:this.radius})}get center(){var e,t,i,n;const r=this._transform,s=null!==(e=null==r?void 0:r.globalScale)&&void 0!==e?e:E.One,o=null!==(t=null==r?void 0:r.globalRotation)&&void 0!==t?t:0,a=null!==(i=null==r?void 0:r.globalPos)&&void 0!==i?i:E.Zero;return(null!==(n=this.offset)&&void 0!==n?n:E.Zero).scale(s).rotate(o).add(a)}contains(e){var t,i;return(null!==(i=null===(t=this._transform)||void 0===t?void 0:t.pos)&&void 0!==i?i:this.offset).distance(e)<=this.radius}rayCast(e,t=1/0){const i=this.center,n=e.dir,r=e.pos,s=Math.sqrt(Math.pow(n.dot(r.sub(i)),2)-Math.pow(r.sub(i).distance(),2)+Math.pow(this.radius,2));if(s<0)return null;{let o=0;if(0===s)return o=-n.dot(r.sub(i)),o>0&&o<t?e.getPoint(o):null;{const o=-n.dot(r.sub(i))+s,a=-n.dot(r.sub(i))-s,l=[];o>=0&&l.push(o),a>=0&&l.push(a);const c=Math.min(...l);return c<=t?e.getPoint(c):null}}}getClosestLineBetween(e){if(e instanceof tn)return en.CircleCircleClosestLine(this,e);if(e instanceof an)return en.PolygonCircleClosestLine(e,this).flip();if(e instanceof on)return en.CircleEdgeClosestLine(this,e).flip();throw new Error("Polygon could not collide with unknown CollisionShape "+typeof e)}collide(e){if(e instanceof tn)return sn.CollideCircleCircle(this,e);if(e instanceof an)return sn.CollideCirclePolygon(this,e);if(e instanceof on)return sn.CollideCircleEdge(this,e);throw new Error("Circle could not collide with unknown CollisionShape "+typeof e)}getFurthestPoint(e){return this.center.add(e.normalize().scale(this.radius))}getFurthestLocalPoint(e){return e.normalize().scale(this.radius)}get bounds(){var e,t,i;const n=this._transform,r=null!==(e=null==n?void 0:n.globalScale)&&void 0!==e?e:E.One,s=null!==(t=null==n?void 0:n.globalRotation)&&void 0!==t?t:0,o=null!==(i=null==n?void 0:n.globalPos)&&void 0!==i?i:E.Zero;return new I(this.offset.x-this._naturalRadius,this.offset.y-this._naturalRadius,this.offset.x+this._naturalRadius,this.offset.y+this._naturalRadius).rotate(s).scale(r).translate(o)}get localBounds(){return new I(this.offset.x-this._naturalRadius,this.offset.y-this._naturalRadius,this.offset.x+this._naturalRadius,this.offset.y+this._naturalRadius)}get axes(){return[]}getInertia(e){return e*this.radius*this.radius/2}update(e){this._transform=e}project(e){const t=[],i=this.center.dot(e);return t.push(i),t.push(i+this.radius),t.push(i-this.radius),new Wi(Math.min.apply(Math,t),Math.max.apply(Math,t))}draw(e,t=D.Green,i=E.Zero){const n=i.add(this.offset);e.beginPath(),e.fillStyle=t.toString(),e.arc(n.x,n.y,this.radius,0,2*Math.PI),e.closePath(),e.fill()}debug(e,t){var i,n,r,s;const o=this._transform,a=null!==(i=null==o?void 0:o.globalScale)&&void 0!==i?i:E.One,l=null!==(n=null==o?void 0:o.globalRotation)&&void 0!==n?n:0,c=null!==(r=null==o?void 0:o.globalPos)&&void 0!==r?r:E.Zero;e.save(),e.translate(c.x,c.y),e.rotate(l),e.scale(a.x,a.y),e.drawCircle(null!==(s=this.offset)&&void 0!==s?s:E.Zero,this._naturalRadius,D.Transparent,t,2),e.restore()}debugDraw(e,t=D.Green){const i=this._transform,n=i?i.pos.add(this.offset):this.offset,r=i?i.rotation:0;e.beginPath(),e.strokeStyle=t.toString(),e.arc(n.x,n.y,this.radius,0,2*Math.PI),e.closePath(),e.stroke(),e.beginPath(),e.moveTo(n.x,n.y),e.lineTo(Math.cos(r)*this.radius+n.x,Math.sin(r)*this.radius+n.y),e.closePath(),e.stroke()}}class nn{constructor(e,t,i,n,r,s,o,a){this._canceled=!1,this.colliderA=e,this.colliderB=t,this.mtv=i,this.normal=n,this.tangent=r,this.points=s,this.localPoints=o,this.info=a,this.id=ji.calculatePairHash(e.id,t.id)}matchAwake(){const e=this.colliderA.owner.get(fn),t=this.colliderB.owner.get(fn);e&&t&&e.sleeping!==t.sleeping&&(e.sleeping&&e.collisionType!==Ei.Fixed&&t.sleepMotion>=Bi.wakeThreshold&&e.setSleeping(!1),t.sleeping&&t.collisionType!==Ei.Fixed&&e.sleepMotion>=Bi.wakeThreshold&&t.setSleeping(!1))}isCanceled(){return this._canceled}cancel(){this._canceled=!0}}class rn{static findPolygonPolygonSeparation(e,t){let i=-Number.MAX_VALUE,n=null,r=null,s=-1,o=null;const a=e.getSides(),l=e.getLocalSides();for(let e=0;e<a.length;e++){const l=a[e],c=l.normal(),d=t.getFurthestPoint(c.negate()),h=l.distanceToPoint(d,!0);h>i&&(i=h,n=l,r=c,s=e,o=d)}return{collider:e,separation:r?i:99,axis:r,side:n,localSide:l[s],sideId:s,point:o,localPoint:r?t.getFurthestLocalPoint(r.negate()):null}}static findCirclePolygonSeparation(e,t){const i=t.axes,n=t.center.sub(e.worldPos),r=t.getFurthestPoint(n.negate());i.push(r.sub(e.worldPos).normalize());let s=Number.MAX_VALUE,o=null,a=-1;for(let n=0;n<i.length;n++){const r=t.project(i[n]),l=e.project(i[n]),c=r.getOverlap(l);if(c<=0)return null;c<s&&(s=c,o=i[n],a=n)}return a<0?null:o.normalize().scale(s)}}const sn={CollideCircleCircle(e,t){const i=e.worldPos,n=t.worldPos,r=e.radius+t.radius,s=i.distance(n);if(s>r)return[];const o=r-s,a=n.sub(i).normalize(),l=a.perpendicular(),c=a.scale(o),d=e.getFurthestPoint(a),h=e.getFurthestLocalPoint(a);return[new nn(e,t,c,a,l,[d],[h],{collider:e,separation:o,axis:a,point:d})]},CollideCirclePolygon(e,t){var i,n;let r=rn.findCirclePolygonSeparation(e,t);if(!r)return[];const s=r.dot(t.center.sub(e.center));r=s<0?r.negate():r;const o=e.getFurthestPoint(r),a=(null!==(n=null===(i=e.owner)||void 0===i?void 0:i.get(Vi))&&void 0!==n?n:new Vi).applyInverse(o),l=r.normalize(),c={collider:e,separation:-r.size,axis:l,point:o,localPoint:a,side:t.findSide(l.negate()),localSide:t.findLocalSide(l.negate())};return[new nn(e,t,r,l,l.perpendicular(),[o],[a],c)]},CollideCircleEdge(e,t){const i=e.center,n=t.asLine(),r=n.end.sub(n.begin),s=r.dot(n.end.sub(i)),o=r.dot(i.sub(n.begin)),a=t.asLine(),l=t.asLocalLine();if(o<=0){const r=n.begin.sub(i),s=r.dot(r);if(s>e.radius*e.radius)return[];const o=r.normalize(),c=e.radius-Math.sqrt(s),d={collider:e,separation:c,axis:o,point:a.begin,side:a,localSide:l};return[new nn(e,t,o.scale(c),o,o.perpendicular(),[a.begin],[l.begin],d)]}if(s<=0){const r=n.end.sub(i),s=r.dot(r);if(s>e.radius*e.radius)return[];const o=r.normalize(),c=e.radius-Math.sqrt(s),d={collider:e,separation:c,axis:o,point:a.end,side:a,localSide:l};return[new nn(e,t,o.scale(c),o,o.perpendicular(),[a.end],[l.end],d)]}const c=r.dot(r),d=n.begin.scale(s).add(n.end.scale(o)).scale(1/c),h=i.sub(d),u=h.dot(h);if(u>e.radius*e.radius)return[];let p=r.perpendicular();p.dot(i.sub(n.begin))<0&&(p.x=-p.x,p.y=-p.y),p=p.normalize();const f=e.radius-Math.sqrt(u),g=p.scale(f),m={collider:e,separation:f,axis:p,point:d,side:a,localSide:l};return[new nn(e,t,g,p.negate(),p.negate().perpendicular(),[d],[d.sub(t.worldPos)],m)]},CollideEdgeEdge:()=>[],CollidePolygonEdge(e,t){var i;const n=e.center,r=t.center.sub(n).normalize(),s=new an({points:[t.begin,t.end,t.end.add(r.scale(100)),t.begin.add(r.scale(100))],offset:t.offset});s.owner=t.owner,(null===(i=t.owner)||void 0===i?void 0:i.get(Vi))&&s.update(t.owner.get(Vi));const o=this.CollidePolygonPolygon(e,s);return o.length&&(o[0].colliderB=t,o[0].id=ji.calculatePairHash(e.id,t.id)),o},CollidePolygonPolygon(e,t){var i,n,r,s;const o=rn.findPolygonPolygonSeparation(e,t);if(o.separation>0)return[];const a=rn.findPolygonPolygonSeparation(t,e);if(a.separation>0)return[];const l=o.separation>a.separation?o:a,c=(l.collider===e?t:e).findSide(l.axis.negate()),d=l.side,h=d.dir().normalize(),u=c.clip(h.negate(),-h.dot(d.begin));let p=null;if(u&&(p=u.clip(h,h.dot(d.end))),p){const o=p.getPoints().filter((e=>d.below(e)));let a=l.axis,c=a.perpendicular();t.center.sub(e.center).dot(a)<0&&(a=a.negate(),c=a.perpendicular());let h=[];if(l.collider===e){const e=null!==(n=null===(i=t.owner)||void 0===i?void 0:i.get(Vi))&&void 0!==n?n:new Vi;h=o.map((t=>e.applyInverse(t)))}else{const t=null!==(s=null===(r=e.owner)||void 0===r?void 0:r.get(Vi))&&void 0!==s?s:new Vi;h=o.map((e=>t.applyInverse(e)))}return[new nn(e,t,a.scale(-l.separation),a,c,o,h,l)]}return[]},FindContactSeparation(e,t){var i,n,r,s;const o=e.colliderA,a=null!==(n=null===(i=e.colliderA.owner)||void 0===i?void 0:i.get(Vi))&&void 0!==n?n:new Vi,l=e.colliderB,c=null!==(s=null===(r=e.colliderB.owner)||void 0===r?void 0:r.get(Vi))&&void 0!==s?s:new Vi;if(o instanceof tn&&l instanceof tn)return-(o.radius+l.radius-a.pos.distance(c.pos));if(o instanceof an&&l instanceof an&&e.info.localSide){let i,n;return e.info.collider===o?(i=new Zi(a.apply(e.info.localSide.begin),a.apply(e.info.localSide.end)),n=c.apply(t)):(i=new Zi(c.apply(e.info.localSide.begin),c.apply(e.info.localSide.end)),n=a.apply(t)),i.distanceToPoint(n,!0)}if(o instanceof an&&l instanceof tn||l instanceof an&&o instanceof tn){const i=a.apply(t);if(e.info.side)return e.info.side.distanceToPoint(i,!0)}if(o instanceof on&&l instanceof an||l instanceof on&&o instanceof an){let i;if(i=e.info.collider===o?c.apply(t):a.apply(t),e.info.side)return e.info.side.distanceToPoint(i,!0)}if(o instanceof tn&&l instanceof on||l instanceof tn&&o instanceof on){const i=c.apply(t);let n;o instanceof tn&&(n=o.getFurthestPoint(e.normal));const r=i.distance(n);if(e.info.side)return r>0?-r:0}return 0}};class on extends Yi{constructor(e){var t;super(),this.begin=e.begin||E.Zero,this.end=e.end||E.Zero,this.offset=null!==(t=e.offset)&&void 0!==t?t:E.Zero}clone(){return new on({begin:this.begin.clone(),end:this.end.clone()})}get worldPos(){var e;const t=this._transform;return null!==(e=null==t?void 0:t.globalPos.add(this.offset))&&void 0!==e?e:this.offset}get center(){return this.begin.average(this.end).add(this._getBodyPos())}_getBodyPos(){var e;const t=this._transform;return null!==(e=null==t?void 0:t.globalPos)&&void 0!==e?e:E.Zero}_getTransformedBegin(){const e=this._transform,t=e?e.globalRotation:0;return this.begin.rotate(t).add(this._getBodyPos())}_getTransformedEnd(){const e=this._transform,t=e?e.globalRotation:0;return this.end.rotate(t).add(this._getBodyPos())}getSlope(){const e=this._getTransformedBegin(),t=this._getTransformedEnd(),i=e.distance(t);return t.sub(e).scale(1/i)}getLength(){const e=this._getTransformedBegin(),t=this._getTransformedEnd();return e.distance(t)}contains(){return!1}rayCast(e,t=1/0){const i=this._getTransformedBegin().sub(e.pos);if(0===e.dir.cross(this.getSlope())&&0!==i.cross(e.dir))return null;const n=e.dir.cross(this.getSlope());if(0===n)return null;const r=i.cross(this.getSlope())/n;if(r>=0&&r<=t){const t=i.cross(e.dir)/n/this.getLength();if(t>=0&&t<=1)return e.getPoint(r)}return null}getClosestLineBetween(e){if(e instanceof tn)return en.CircleEdgeClosestLine(e,this);if(e instanceof an)return en.PolygonEdgeClosestLine(e,this).flip();if(e instanceof on)return en.EdgeEdgeClosestLine(this,e);throw new Error("Polygon could not collide with unknown CollisionShape "+typeof e)}collide(e){if(e instanceof tn)return sn.CollideCircleEdge(e,this);if(e instanceof an)return sn.CollidePolygonEdge(e,this);if(e instanceof on)return sn.CollideEdgeEdge();throw new Error("Edge could not collide with unknown CollisionShape "+typeof e)}getFurthestPoint(e){const t=this._getTransformedBegin(),i=this._getTransformedEnd();return e.dot(t)>0?t:i}_boundsFromBeginEnd(e,t,i=10){return new I(Math.min(e.x,t.x)-i,Math.min(e.y,t.y)-i,Math.max(e.x,t.x)+i,Math.max(e.y,t.y)+i)}get bounds(){const e=this._getTransformedBegin(),t=this._getTransformedEnd();return this._boundsFromBeginEnd(e,t)}get localBounds(){return this._boundsFromBeginEnd(this.begin,this.end)}asLine(){return new Zi(this._getTransformedBegin(),this._getTransformedEnd())}asLocalLine(){return new Zi(this.begin,this.end)}get axes(){const e=this._getTransformedEnd().sub(this._getTransformedBegin()).normal(),t=[];return t.push(e),t.push(e.negate()),t.push(e.normal()),t.push(e.normal().negate()),t}getInertia(e){const t=this.end.sub(this.begin).distance()/2;return e*t*t}update(e){this._transform=e}project(e){const t=[],i=[this._getTransformedBegin(),this._getTransformedEnd()],n=i.length;for(let r=0;r<n;r++)t.push(i[r].dot(e));return new Wi(Math.min.apply(Math,t),Math.max.apply(Math,t))}draw(e,t=D.Green,i=E.Zero){const n=this.begin.add(i),r=this.end.add(i);e.strokeStyle=t.toString(),e.beginPath(),e.moveTo(n.x,n.y),e.lineTo(r.x,r.y),e.closePath(),e.stroke()}debug(e,t){const i=this._getTransformedBegin(),n=this._getTransformedEnd();e.drawLine(i,n,t,2),e.drawCircle(i,2,t),e.drawCircle(n,2,t)}debugDraw(e,t=D.Red){const i=this._getTransformedBegin(),n=this._getTransformedEnd();e.strokeStyle=t.toString(),e.beginPath(),e.moveTo(i.x,i.y),e.lineTo(n.x,n.y),e.closePath(),e.stroke()}}class an extends Yi{constructor(e){var t,i;super(),this._logger=v.getInstance(),this._transformedPoints=[],this._axes=[],this._sides=[],this._localSides=[],this.offset=null!==(t=e.offset)&&void 0!==t?t:E.Zero,this.points=null!==(i=e.points)&&void 0!==i?i:[],this._isClockwiseWinding(this.points)||this.points.reverse(),this.isConvex()||this._logger.warn("Excalibur only supports convex polygon colliders and will not behave properly.Call PolygonCollider.triangulate() to build a new collider composed of smaller convex triangles"),this._calculateTransformation()}_isClockwiseWinding(e){let t=0;for(let i=0;i<e.length;i++)t+=(e[(i+1)%e.length].x-e[i].x)*(e[(i+1)%e.length].y+e[i].y);return t<0}isConvex(){if(this.points.length<3)return!1;let e=this.points[this.points.length-2],t=this.points[this.points.length-1],i=Math.atan2(t.y-e.y,t.x-e.x),n=0,r=0,s=0;for(const[o,a]of this.points.entries()){if(e=t,n=i,t=a,i=Math.atan2(t.y-e.y,t.x-e.x),e.equals(t))return!1;let l=i-n;if(l<=-Math.PI?l+=2*Math.PI:l>Math.PI&&(l-=2*Math.PI),0===o){if(0===l)return!1;r=l>0?1:-1}else if(r*l<=0)return!1;s+=l}return 1===Math.abs(Math.round(s/(2*Math.PI)))}tessellate(){const e=[];for(let t=1;t<this.points.length-2;t++)e.push([this.points[0],this.points[t+1],this.points[t+2]]);return e.push([this.points[0],this.points[1],this.points[2]]),new Qi(e.map((e=>ln.Polygon(e))))}triangulate(){if(this.points.length<3)throw Error("Invalid polygon");function e(e,t){return e>=t.length?t[e%t.length]:e<0?t[e%t.length+t.length]:t[e]}function t(e,t,i,n){const r=i.sub(t),s=n.sub(i),o=t.sub(n),a=e.sub(t),l=e.sub(i),c=e.sub(n),d=r.cross(a),h=s.cross(l),u=o.cross(c);return!(d>0||h>0||u>0)}const i=[],n=[...this.points],r=H(0,this.points.length-1);for(;r.length>3;)for(let s=0;s<r.length;s++){const o=r[s],a=e(s-1,r),l=e(s+1,r),c=n[o],d=n[a],h=n[l],u=d.sub(c);if(!(h.sub(c).cross(u)>0))continue;let p=!0;for(let e=0;e<r.length;e++){const i=r[e];if(i!==o&&i!==a&&i!==l&&t(n[i],d,c,h)){p=!1;break}}if(p){i.push([d,c,h]),r.splice(s,1);break}}return i.push([n[r[0]],n[r[1]],n[r[2]]]),new Qi(i.map((e=>ln.Polygon(e))))}clone(){return new an({offset:this.offset.clone(),points:this.points.map((e=>e.clone()))})}get worldPos(){return this._transform?this._transform.pos.add(this.offset):this.offset}get center(){return this.bounds.center}_calculateTransformation(){const e=this._transform,t=e?e.globalPos.add(this.offset):this.offset,i=e?e.globalRotation:0,n=e?e.globalScale:E.One,r=this.points.length;this._transformedPoints.length=0;for(let e=0;e<r;e++)this._transformedPoints[e]=this.points[e].scale(n).rotate(i).add(t)}getTransformedPoints(){return this._calculateTransformation(),this._transformedPoints}getSides(){if(this._sides.length)return this._sides;const e=[],t=this.getTransformedPoints(),i=t.length;for(let n=0;n<i;n++)e.push(new Zi(t[n],t[(n+1)%i]));return this._sides=e,this._sides}getLocalSides(){if(this._localSides.length)return this._localSides;const e=[],t=this.points,i=t.length;for(let n=0;n<i;n++)e.push(new Zi(t[n],t[(n+1)%i]));return this._localSides=e,this._localSides}findSide(e){const t=this.getSides();let i=t[0],n=-Number.MAX_VALUE;for(let r=0;r<t.length;r++){const s=t[r],o=s.normal().dot(e);o>n&&(i=s,n=o)}return i}findLocalSide(e){const t=this.getLocalSides();let i=t[0],n=-Number.MAX_VALUE;for(let r=0;r<t.length;r++){const s=t[r],o=s.normal().dot(e);o>n&&(i=s,n=o)}return i}get axes(){if(this._axes.length)return this._axes;const e=this.getSides().map((e=>e.normal()));return this._axes=e,this._axes}update(e){this._transform=e,this._sides.length=0,this._localSides.length=0,this._axes.length=0,this._transformedPoints.length=0,this.getTransformedPoints(),this.getSides(),this.getLocalSides()}contains(e){const t=new Ki(e,new E(1,0));return this.getSides().reduce((function(e,i){return t.intersect(i)>=0?e+1:e}),0)%2!=0}getClosestLineBetween(e){if(e instanceof tn)return en.PolygonCircleClosestLine(this,e);if(e instanceof an)return en.PolygonPolygonClosestLine(this,e);if(e instanceof on)return en.PolygonEdgeClosestLine(this,e);throw new Error("Polygon could not collide with unknown CollisionShape "+typeof e)}collide(e){if(e instanceof tn)return sn.CollideCirclePolygon(e,this);if(e instanceof an)return sn.CollidePolygonPolygon(this,e);if(e instanceof on)return sn.CollidePolygonEdge(this,e);throw new Error("Polygon could not collide with unknown CollisionShape "+typeof e)}getFurthestPoint(e){const t=this.getTransformedPoints();let i=null,n=-Number.MAX_VALUE;for(let r=0;r<t.length;r++){const s=e.dot(t[r]);s>n&&(n=s,i=t[r])}return i}getFurthestLocalPoint(e){const t=this.points;let i=t[0],n=-Number.MAX_VALUE;for(let r=0;r<t.length;r++){const s=e.dot(t[r]);s>n&&(n=s,i=t[r])}return i}getClosestFace(e){const t=this.getSides();let i=Number.POSITIVE_INFINITY,n=-1,r=-1;for(let s=0;s<t.length;s++){const o=t[s].distanceToPoint(e);o<i&&(i=o,n=s,r=o)}return-1!==n?{distance:t[n].normal().scale(r),face:t[n]}:null}get bounds(){var e,t,i;const n=this._transform,r=null!==(e=null==n?void 0:n.globalScale)&&void 0!==e?e:E.One,s=null!==(t=null==n?void 0:n.globalRotation)&&void 0!==t?t:0,o=(null!==(i=null==n?void 0:n.globalPos)&&void 0!==i?i:E.Zero).add(this.offset);return this.localBounds.scale(r).rotate(s).translate(o)}get localBounds(){return I.fromPoints(this.points)}getInertia(e){let t=0,i=0;for(let e=0;e<this.points.length;e++){const n=(e+1)%this.points.length,r=this.points[n].cross(this.points[e]);t+=r*(this.points[e].dot(this.points[e])+this.points[e].dot(this.points[n])+this.points[n].dot(this.points[n])),i+=r}return e/6*(t/i)}rayCast(e,t=1/0){const i=this.getSides(),n=i.length;let r=Number.MAX_VALUE,s=-1;for(let o=0;o<n;o++){const n=e.intersect(i[o]);n>=0&&n<r&&n<=t&&(r=n,s=o)}return s>=0?e.getPoint(r):null}project(e){const t=this.getTransformedPoints(),i=t.length;let n=Number.MAX_VALUE,r=-Number.MAX_VALUE;for(let s=0;s<i;s++){const i=t[s].dot(e);n=Math.min(n,i),r=Math.max(r,i)}return new Wi(n,r)}draw(e,t=D.Green,i=E.Zero){const n=i.add(this.offset);e.beginPath(),e.fillStyle=t.toString();const r=this.points[0].add(n);e.moveTo(r.x,r.y),this.points.map((e=>e.add(n))).forEach((function(t){e.lineTo(t.x,t.y)})),e.lineTo(r.x,r.y),e.closePath(),e.fill()}debug(e,t){const i=this.getTransformedPoints()[0],n=[i,...this.getTransformedPoints(),i];for(let i=0;i<n.length-1;i++)e.drawLine(n[i],n[i+1],t,2),e.drawCircle(n[i],2,t),e.drawCircle(n[i+1],2,t)}debugDraw(e,t=D.Red){e.beginPath(),e.strokeStyle=t.toString();const i=this.getTransformedPoints()[0];e.moveTo(i.x,i.y),this.getTransformedPoints().forEach((function(t){e.lineTo(t.x,t.y)})),e.lineTo(i.x,i.y),e.closePath(),e.stroke()}}class ln{static Box(e,t,i=E.Half,n=E.Zero){return new an({points:new I(-e*i.x,-t*i.y,e-e*i.x,t-t*i.y).getPoints(),offset:n})}static Polygon(e,t=E.Zero){return new an({points:e,offset:t})}static Circle(e,t=E.Zero){return new tn({radius:e,offset:t})}static Edge(e,t){return new on({begin:e,end:t})}static Capsule(e,t,i=E.Zero){const n=v.getInstance();return e===t&&n.warn("A capsule collider with equal width and height is a circle, consider using a ex.Shape.Circle or ex.CircleCollider"),new Qi(t>=e?[ln.Circle(e/2,P(0,-t/2+e/2).add(i)),ln.Box(e,t-e,E.Half,i),ln.Circle(e/2,P(0,t/2-e/2).add(i))]:[ln.Circle(t/2,P(-e/2+t/2,0).add(i)),ln.Box(e-t,t,E.Half,i),ln.Circle(t/2,P(e/2-t/2,0).add(i))])}}class cn extends Oi{constructor(e){super(),this.type="ex.collider",this.events=new pt,this.$colliderAdded=new Ni,this.$colliderRemoved=new Ni,this.set(e)}get(){return this._collider}set(e){return this.clear(),e&&(this._collider=e,this._collider.owner=this.owner,this.events.wire(e.events),this.$colliderAdded.notifyAll(e),this.update()),e}clear(){this._collider&&(this.events.unwire(this._collider.events),this.$colliderRemoved.notifyAll(this._collider),this._collider.owner=null,this._collider=null)}get bounds(){var e,t;return null!==(t=null===(e=this._collider)||void 0===e?void 0:e.bounds)&&void 0!==t?t:new I}get localBounds(){var e,t;return null!==(t=null===(e=this._collider)||void 0===e?void 0:e.localBounds)&&void 0!==t?t:new I}update(){var e;const t=null===(e=this.owner)||void 0===e?void 0:e.get(Vi);this._collider&&(this._collider.owner=this.owner,t&&this._collider.update(t))}collide(e){let t=this._collider,i=e._collider;if(!t||!i)return[];let n=!1;if(i instanceof Qi&&(t=i,i=this._collider,n=!0),this._collider){const r=t.collide(i);return r?(n&&r.forEach((t=>{t.mtv=t.mtv.negate(),t.normal=t.normal.negate(),t.tangent=t.normal.perpendicular(),t.colliderA=this._collider,t.colliderB=e._collider})),r):[]}return[]}onAdd(e){this._collider&&this.update(),this.events.on("precollision",(t=>{const i=t;e.events.emit("precollision",new Ze(i.target.owner,i.other.owner,i.side,i.intersection))})),this.events.on("postcollision",(t=>{const i=t;e.events.emit("postcollision",new Je(i.target.owner,i.other.owner,i.side,i.intersection))})),this.events.on("collisionstart",(t=>{const i=t;e.events.emit("collisionstart",new rt(i.target.owner,i.other.owner,i.contact))})),this.events.on("collisionend",(t=>{const i=t;e.events.emit("collisionend",new st(i.target.owner,i.other.owner))}))}onRemove(){this.events.clear(),this.$colliderRemoved.notifyAll(this._collider)}useBoxCollider(e,t,i=E.Half,n=E.Zero){const r=ln.Box(e,t,i,n);return this.set(r)}usePolygonCollider(e,t=E.Zero){const i=ln.Polygon(e,t);return this.set(i)}useCircleCollider(e,t=E.Zero){const i=ln.Circle(e,t);return this.set(i)}useEdgeCollider(e,t){const i=ln.Edge(e,t);return this.set(i)}useCompositeCollider(e){return this.set(new Qi(e))}}var dn,hn,un,pn;(hn=dn||(dn={})).Rotation="rotation",hn.X="x",hn.Y="y";class fn extends Oi{constructor(e){var t,i,n;super(),this.type="ex.body",this.dependencies=[Vi,Ui],this.id=_("body",fn._ID++),this.events=new pt,this.collisionType=Ei.PreventCollision,this.group=Hi.All,this.mass=Bi.defaultMass,this.sleepMotion=5*Bi.sleepEpsilon,this.canSleep=Bi.bodiesCanSleepByDefault,this._sleeping=!1,this.bounciness=.2,this.friction=.99,this.useGravity=!0,this.limitDegreeOfFreedom=[],this.oldPos=new E(0,0),this.oldVel=new E(0,0),this.oldAcc=E.Zero,this.oldRotation=0,this.oldScale=E.One,e&&(this.collisionType=null!==(t=e.type)&&void 0!==t?t:this.collisionType,this.group=null!==(i=e.group)&&void 0!==i?i:this.group,this.useGravity=null!==(n=e.useGravity)&&void 0!==n?n:this.useGravity)}get inverseMass(){return this.collisionType===Ei.Fixed?0:1/this.mass}get sleeping(){return this._sleeping}setSleeping(e){this._sleeping=e,e?(this.vel=E.Zero,this.acc=E.Zero,this.angularVelocity=0,this.sleepMotion=0):this.sleepMotion=5*Bi.sleepEpsilon}updateMotion(){this._sleeping&&this.setSleeping(!0);const e=this.vel.size*this.vel.size+Math.abs(this.angularVelocity*this.angularVelocity),t=Bi.sleepBias;this.sleepMotion=t*this.sleepMotion+(1-t)*e,this.sleepMotion=z(this.sleepMotion,0,10*Bi.sleepEpsilon),this.canSleep&&this.sleepMotion<Bi.sleepEpsilon&&this.setSleeping(!0)}get inertia(){const e=this.owner.get(cn);return(null==e?void 0:e.get())?e.get().getInertia(this.mass):0}get inverseInertia(){return this.collisionType===Ei.Fixed?0:1/this.inertia}get active(){var e;return!!(null===(e=this.owner)||void 0===e?void 0:e.active)}get center(){return this.pos}get transform(){var e;return null===(e=this.owner)||void 0===e?void 0:e.get(Vi)}get motion(){var e;return null===(e=this.owner)||void 0===e?void 0:e.get(Ui)}get pos(){return this.transform.globalPos}set pos(e){this.transform.globalPos=e}get vel(){return this.motion.vel}set vel(e){this.motion.vel=e}get acc(){return this.motion.acc}set acc(e){this.motion.acc=e}get torque(){return this.motion.torque}set torque(e){this.motion.torque=e}get rotation(){return this.transform.globalRotation}set rotation(e){this.transform.globalRotation=e}get scale(){return this.transform.globalScale}set scale(e){this.transform.globalScale=e}get sx(){return this.motion.scaleFactor.x}set sx(e){this.motion.scaleFactor.x=e}get sy(){return this.motion.scaleFactor.y}set sy(e){this.motion.scaleFactor.y=e}get rx(){return this.motion.angularVelocity}set rx(e){this.motion.angularVelocity=e}get angularVelocity(){return this.motion.angularVelocity}set angularVelocity(e){this.motion.angularVelocity=e}applyImpulse(e,t){if(this.collisionType!==Ei.Active)return;const i=t.scale(this.inverseMass);if(this.limitDegreeOfFreedom.includes(dn.X)&&(i.x=0),this.limitDegreeOfFreedom.includes(dn.Y)&&(i.y=0),this.vel.addEqual(i),!this.limitDegreeOfFreedom.includes(dn.Rotation)){const i=e.sub(this.pos);this.angularVelocity+=this.inverseInertia*i.cross(t)}}applyLinearImpulse(e){if(this.collisionType!==Ei.Active)return;const t=e.scale(this.inverseMass);this.limitDegreeOfFreedom.includes(dn.X)&&(t.x=0),this.limitDegreeOfFreedom.includes(dn.Y)&&(t.y=0),this.vel=this.vel.add(t)}applyAngularImpulse(e,t){if(this.collisionType===Ei.Active&&!this.limitDegreeOfFreedom.includes(dn.Rotation)){const i=e.sub(this.pos);this.angularVelocity+=this.inverseInertia*i.cross(t)}}captureOldTransform(){this.oldVel.setTo(this.vel.x,this.vel.y),this.oldPos.setTo(this.pos.x,this.pos.y),this.oldAcc.setTo(this.acc.x,this.acc.y),this.oldScale.setTo(this.scale.x,this.scale.y),this.oldRotation=this.rotation}debugDraw(e){}}fn._ID=0;class gn{constructor(){this._topLeft=new E(0,0),this._topRight=new E(0,0),this._bottomLeft=new E(0,0),this._bottomRight=new E(0,0)}isSpriteOffScreen(e,t){const i=e.currentDrawing.drawWidth,n=e.currentDrawing.drawHeight,r=e.rotation,s=e.center,o=e.getGlobalPos();this._topLeft=P(o.x-i/2,o.y-n/2),this._topLeft=this._topLeft.rotate(r,s),this._topRight=P(o.x+i/2,o.y-n/2),this._topRight=this._topRight.rotate(r,s),this._bottomLeft=P(o.x-i/2,o.y+n/2),this._bottomLeft=this._bottomLeft.rotate(r,s),this._bottomRight=P(o.x+i/2,o.y+n/2),this._bottomRight=this._bottomRight.rotate(r,s);const a=t.worldToScreenCoordinates(this._topLeft),l=t.worldToScreenCoordinates(this._topRight),c=t.worldToScreenCoordinates(this._bottomLeft),d=t.worldToScreenCoordinates(this._bottomRight);this._xCoords=[],this._yCoords=[],this._xCoords.push(a.x,l.x,c.x,d.x),this._yCoords.push(a.y,l.y,c.y,d.y),this._xMin=Math.min.apply(null,this._xCoords),this._yMin=Math.min.apply(null,this._yCoords),this._xMax=Math.max.apply(null,this._xCoords),this._yMax=Math.max.apply(null,this._yCoords);const h=t.screenToWorldCoordinates(new E(this._xMin,this._yMin)),u=t.screenToWorldCoordinates(new E(this._xMax,this._yMax));this._xMinWorld=h.x,this._yMinWorld=h.y,this._xMaxWorld=u.x,this._yMaxWorld=u.y;const p=[new E(this._xMin,this._yMin),new E(this._xMax,this._yMin),new E(this._xMin,this._yMax),new E(this._xMax,this._yMax)];if(p[0].x<0&&p[1].x>t.canvas.clientWidth&&(p[0].y>0||p[2].y<t.canvas.clientHeight))return!1;if(p[0].y<0&&p[2].y>t.canvas.clientHeight&&(p[1].x>0||p[0].x<t.canvas.clientWidth))return!1;for(let e=0;e<p.length;e++)if(p[e].x>0&&p[e].y>0&&p[e].x<t.canvas.clientWidth&&p[e].y<t.canvas.clientHeight)return!1;return!0}debugDraw(e){e.beginPath(),e.strokeStyle=D.White.toString(),e.rect(this._xMinWorld,this._yMinWorld,this._xMaxWorld-this._xMinWorld,this._yMaxWorld-this._yMinWorld),e.stroke(),e.fillStyle=D.Red.toString(),e.beginPath(),e.arc(this._topLeft.x,this._topLeft.y,5,0,2*Math.PI),e.closePath(),e.fill(),e.fillStyle=D.Green.toString(),e.beginPath(),e.arc(this._topRight.x,this._topRight.y,5,0,2*Math.PI),e.closePath(),e.fill(),e.fillStyle=D.Blue.toString(),e.beginPath(),e.arc(this._bottomLeft.x,this._bottomLeft.y,5,0,2*Math.PI),e.closePath(),e.fill(),e.fillStyle=D.Magenta.toString(),e.beginPath(),e.arc(this._bottomRight.x,this._bottomRight.y,5,0,2*Math.PI),e.closePath(),e.fill()}}class mn{constructor(){this.cullingBox=new gn}update(e,t){const i=e.eventDispatcher;let n=!0;null!=e.currentDrawing&&(n=this.cullingBox.isSpriteOffScreen(e,t));let r=!1;t&&t.currentScene&&t.currentScene.camera&&t.currentScene.camera.viewport&&!e.parent&&(r=!t.currentScene.camera.viewport.intersect(e.collider.bounds)),e.isOffScreen?r&&n||(i.emit("enterviewport",new dt(e)),e.removeComponent("offscreen")):r&&n&&(i.emit("exitviewport",new ct(e)),e.addComponent(new zi("offscreen")))}}class _n{constructor(e){this.data=e,this.type="Component Added"}}function vn(e){return!!e&&"Component Added"===e.type}class bn{constructor(e){this.data=e,this.type="Component Removed"}}function wn(e){return!!e&&"Component Removed"===e.type}class yn extends mi{constructor(e,t){if(super(),this.id=yn._ID++,this._name="anonymous",this.active=!0,this._componentsToRemove=[],this._componentTypeToInstance=new Map,this._componentStringToInstance=new Map,this._tagsMemo=[],this._typesMemo=[],this.componentAdded$=new Ni,this.componentRemoved$=new Ni,this._parent=null,this.childrenAdded$=new Ni,this.childrenRemoved$=new Ni,this._children=[],this._isInitialized=!1,this._setName(t),e)for(const t of e)this.addComponent(t)}_setName(e){e&&(this._name=e)}get name(){return this._name}get events(){return this.eventDispatcher}kill(){this.active=!1}isKilled(){return!this.active}get tags(){return this._tagsMemo}hasTag(e){return this.tags.includes(e)}addTag(e){return this.addComponent(new zi(e))}removeTag(e,t=!1){return this.removeComponent(e,t)}get types(){return this._typesMemo}_rebuildMemos(){this._tagsMemo=Array.from(this._componentStringToInstance.values()).filter((e=>e instanceof zi)).map((e=>e.type)),this._typesMemo=Array.from(this._componentStringToInstance.keys())}getComponents(){return Array.from(this._componentStringToInstance.values())}_notifyAddComponent(e){this._rebuildMemos();const t=new _n({component:e,entity:this});this.componentAdded$.notifyAll(t)}_notifyRemoveComponent(e){const t=new bn({component:e,entity:this});this.componentRemoved$.notifyAll(t),this._rebuildMemos()}get parent(){return this._parent}get children(){return this._children}unparent(){this._parent&&(this._parent.removeChild(this),this._parent=null)}addChild(e){if(null!==e.parent)throw new Error("Entity already has a parent, cannot add without unparenting");if(this.getAncestors().includes(e))throw new Error("Cycle detected, cannot add entity");return this._children.push(e),e._parent=this,this.childrenAdded$.notifyAll(e),this}removeChild(e){return e.parent===this&&(ie(e,this._children),e._parent=null,this.childrenRemoved$.notifyAll(e)),this}removeAllChildren(){return this.children.forEach((e=>{this.removeChild(e)})),this}getAncestors(){const e=[this];let t=this.parent;for(;t;)e.push(t),t=t.parent;return e.reverse()}getDescendants(){let e=[this],t=[this];for(;t.length>0;){const i=t.pop();t=t.concat(i.children),e=e.concat(i.children)}return e}clone(){const e=new yn;for(const t of this.types)e.addComponent(this.get(t).clone());for(const t of this.children)e.addChild(t.clone());return e}addTemplate(e,t=!1){for(const i of e.getComponents())this.addComponent(i.clone(),t);for(const t of e.children)this.addChild(t.clone().addTemplate(t));return this}addComponent(e,t=!1){if(this.has(e.type)){if(!t)return this;this.removeComponent(e)}if(e.dependencies&&e.dependencies.length)for(const t of e.dependencies)this.addComponent(new t);e.owner=this;const i=e.constructor;return this._componentTypeToInstance.set(i,e),this._componentStringToInstance.set(e.type,e),e.onAdd&&e.onAdd(this),this._notifyAddComponent(e),this}removeComponent(e,t=!1){return t?"string"==typeof e?this._removeComponentByType(e):e instanceof Oi&&this._removeComponentByType(e.type):this._componentsToRemove.push(e),this}_removeComponentByType(e){if(this.has(e)){const t=this.get(e);t.owner=null,t.onRemove&&t.onRemove(this);const i=t.constructor;this._componentTypeToInstance.delete(i),this._componentStringToInstance.delete(t.type),this._notifyRemoveComponent(t)}}processComponentRemoval(){for(const e of this._componentsToRemove){const t="string"==typeof e?e:e.type;this._removeComponentByType(t)}this._componentsToRemove.length=0}has(e){return"string"==typeof e?this._componentStringToInstance.has(e):this._componentTypeToInstance.has(e)}get(e){return"string"==typeof e?this._componentStringToInstance.get(e):this._componentTypeToInstance.get(e)}get isInitialized(){return this._isInitialized}_initialize(e){this.isInitialized||(this.onInitialize(e),super.emit("initialize",new ot(e,this)),this._isInitialized=!0)}_preupdate(e,t){this.emit("preupdate",new Ne(e,t,this)),this.onPreUpdate(e,t)}_postupdate(e,t){this.emit("postupdate",new Ve(e,t,this)),this.onPostUpdate(e,t)}onInitialize(e){}onPreUpdate(e,t){}onPostUpdate(e,t){}update(e,t){this._initialize(e),this._preupdate(e,t);for(const i of this.children)i.update(e,t);this._postupdate(e,t)}}yn._ID=0;class xn extends Oi{constructor(e){var t;super(),this.draw=e,this.type="ex.canvas",this.draw=null!==(t=this.draw)&&void 0!==t?t:()=>{}}}function $n(e){return!!e.tick}class Cn{constructor(e,t){this._options=e,this._graphics=t,this.graphics=[]}get name(){return this._options.name}hide(e){if(e){let t=null;t=e instanceof we?e:this._graphics.getGraphic(e),this.graphics=this.graphics.filter((e=>e.graphic!==t)),this._graphics.recalculateBounds()}else this.graphics.length=0}show(e,t){let i;return t={...t},e instanceof we?i=this._graphics.copyGraphics?e.clone():e:(i=this._graphics.getGraphic(e),i||v.getInstance().error(`No such graphic added to component named ${e}. These named graphics are available: `,this._graphics.getNames())),i?(this.graphics.push({graphic:i,options:t}),this._graphics.recalculateBounds(),i):null}use(e,t){return t={...t},this.hide(),this.show(e,t)}get order(){return this._options.order}set order(e){this._options.order=e}get offset(){var e;return null!==(e=this._options.offset)&&void 0!==e?e:E.Zero}set offset(e){this._options.offset=e}get currentKeys(){var e;return null!==(e=this.name)&&void 0!==e?e:"anonymous"}}class Sn{constructor(e){this._component=e,this._layers=[],this._layerMap={},this.default=new Cn({name:"default",order:0},e),this._maybeAddLayer(this.default)}create(e){const t=new Cn(e,this._component);return this._maybeAddLayer(t)}get(e){return e?this._getLayer(e):this._layers}currentKeys(){const e=[];for(const t of this._layers)e.push(t.currentKeys);return e}has(e){return e in this._layerMap}_maybeAddLayer(e){return this._layerMap[e.name]?this._layerMap[e.name]:(this._layerMap[e.name]=e,this._layers.push(e),this._layers.sort(((e,t)=>e.order-t.order)),e)}_getLayer(e){return this._layerMap[e]}}class En extends Oi{constructor(e){super(),this.type="ex.graphics",this._graphics={},this.visible=!0,this.opacity=1,this.offset=E.Zero,this.anchor=E.Half,this.copyGraphics=!1,this._localBounds=null,e={visible:this.visible,...e};const{current:t,anchor:i,opacity:n,visible:r,graphics:s,offset:o,copyGraphics:a,onPreDraw:l,onPostDraw:c}=e;this._graphics=s||{},this.offset=null!=o?o:this.offset,this.opacity=null!=n?n:this.opacity,this.anchor=null!=i?i:this.anchor,this.copyGraphics=null!=a?a:this.copyGraphics,this.onPreDraw=null!=l?l:this.onPreDraw,this.onPostDraw=null!=c?c:this.onPostDraw,this.visible=!!r,this.layers=new Sn(this),t&&this._graphics[t]&&this.show(this._graphics[t])}getGraphic(e){return this._graphics[e]}getNames(){return Object.keys(this._graphics)}get current(){return this.layers.default.graphics}get graphics(){return this._graphics}add(e,t){let i="default",n=null;return"string"==typeof e?(i=e,n=t):n=e,this._graphics[i]=this.copyGraphics?n.clone():n,"default"===i&&this.show("default"),n}show(e,t){const i=this.layers.default.show(e,t);return this.recalculateBounds(),i}use(e,t){const i=this.layers.default.use(e,t);return this.recalculateBounds(),i}hide(e){this.layers.default.hide(e)}set localBounds(e){this._localBounds=e}recalculateBounds(){let e=new I;for(const t of this.layers.get())for(const{graphic:i,options:n}of t.graphics){let r=this.anchor,s=this.offset;(null==n?void 0:n.anchor)&&(r=n.anchor),(null==n?void 0:n.offset)&&(s=n.offset);const o=i.localBounds,a=-o.width*r.x+s.x,l=-o.height*r.y+s.y;e=null==i?void 0:i.localBounds.translate(P(a+t.offset.x,l+t.offset.y)).combine(e)}this._localBounds=e}get localBounds(){return this._localBounds||this.recalculateBounds(),this._localBounds}update(e,t=0){for(const i of this.layers.get())for(const{graphic:n}of i.graphics)$n(n)&&(null==n||n.tick(e,t))}}class Pn extends ke{constructor(e){super(e),this.width=e.width,this.height=e.height,this.rasterize()}clone(){return new Pn({width:this.width,height:this.height,...this.cloneGraphicOptions(),...this.cloneRasterOptions()})}execute(e){this.color&&e.fillRect(0,0,this.width,this.height),this.strokeColor&&e.strokeRect(0,0,this.width,this.height)}}class kn extends ke{constructor(e){var t,i;super(e),this._radius=0,this.padding=null!==(t=e.padding)&&void 0!==t?t:2,this.radius=e.radius,this.filtering=null!==(i=e.filtering)&&void 0!==i?i:he.Blended,this.rasterize()}get radius(){return this._radius}set radius(e){this._radius=e,this.width=2*this._radius,this.height=2*this._radius,this.flagDirty()}clone(){return new kn({radius:this.radius,...this.cloneGraphicOptions(),...this.cloneRasterOptions()})}execute(e){this.radius>0&&(e.beginPath(),e.arc(this.radius,this.radius,this.radius,0,2*Math.PI),this.color&&e.fill(),this.strokeColor&&e.stroke())}}class Tn extends Oi{constructor(){super(...arguments),this.type="ex.pointer",this.useColliderShape=!0,this.useGraphicsBounds=!1}}class An{static CreateReversibleEasingFunction(e){return(t,i,n,r)=>n<i?i-(e(t,n,i,r)-n):e(t,i,n,r)}static CreateReversableEasingFunction(e){return An.CreateReversibleEasingFunction(e)}static CreateVectorEasingFunction(e){return(t,i,n,r)=>new E(e(t,i.x,n.x,r),e(t,i.y,n.y,r))}}An.Linear=An.CreateReversibleEasingFunction(((e,t,i,n)=>(i-=t)*e/n+t)),An.EaseInQuad=An.CreateReversibleEasingFunction(((e,t,i,n)=>(i-=t)*(e/=n)*e+t)),An.EaseOutQuad=An.CreateReversibleEasingFunction(((e,t,i,n)=>-(i-=t)*(e/=n)*(e-2)+t)),An.EaseInOutQuad=An.CreateReversibleEasingFunction(((e,t,i,n)=>(i-=t,(e/=n/2)<1?i/2*e*e+t:-i/2*(--e*(e-2)-1)+t))),An.EaseInCubic=An.CreateReversibleEasingFunction(((e,t,i,n)=>(i-=t)*(e/=n)*e*e+t)),An.EaseOutCubic=An.CreateReversibleEasingFunction(((e,t,i,n)=>(e/=n,(i-=t)*(--e*e*e+1)+t))),An.EaseInOutCubic=An.CreateReversibleEasingFunction(((e,t,i,n)=>(i-=t,(e/=n/2)<1?i/2*e*e*e+t:i/2*((e-=2)*e*e+2)+t))),function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);s>3&&o&&Object.defineProperty(t,i,o)}([S({message:"Alias for incorrect spelling used in older versions, will be removed in v0.25.0",alternateMethod:"CreateReversibleEasingFunction"})],An,"CreateReversableEasingFunction",null);class Dn{constructor(e){this._actions=[],this._completedActions=[],this._entity=e}add(e){this._actions.push(e)}remove(e){const t=this._actions.indexOf(e);this._actions.splice(t,1)}clearActions(){this._actions.length=0,this._completedActions.length=0,this._currentAction&&this._currentAction.stop()}getActions(){return this._actions.concat(this._completedActions)}hasNext(){return this._actions.length>0}isComplete(){return 0===this._actions.length}reset(){this._actions=this.getActions();const e=this._actions.length;for(let t=0;t<e;t++)this._actions[t].reset();this._completedActions=[]}update(e){this._actions.length>0&&(this._currentAction=this._actions[0],this._currentAction.update(e),this._currentAction.isComplete(this._entity)&&this._completedActions.push(this._actions.shift()))}}class Rn{constructor(e,t,i){this._stopped=!1,this._repeatBuilder=t,this._repeatContext=new Kn(e),this._actionQueue=this._repeatContext.getQueue(),this._repeat=i,this._originalRepeat=i,this._repeatBuilder(this._repeatContext),this._repeat--}update(e){this._actionQueue.isComplete()&&(this._actionQueue.clearActions(),this._repeatBuilder(this._repeatContext),this._repeat--),this._actionQueue.update(e)}isComplete(){return this._stopped||this._repeat<=0&&this._actionQueue.isComplete()}stop(){this._stopped=!0}reset(){this._repeat=this._originalRepeat}}class In{constructor(e,t){this._stopped=!1,this._repeatBuilder=t,this._repeatContext=new Kn(e),this._actionQueue=this._repeatContext.getQueue(),this._repeatBuilder(this._repeatContext)}update(e){this._stopped||(this._actionQueue.isComplete()&&(this._actionQueue.clearActions(),this._repeatBuilder(this._repeatContext)),this._actionQueue.update(e))}isComplete(){return this._stopped}stop(){this._stopped=!0,this._actionQueue.clearActions()}reset(){}}class Mn{constructor(e,t,i,n){if(this._started=!1,this._stopped=!1,this._entity=e,this._tx=e.get(Vi),this._motion=e.get(Ui),this._speed=n,this._offset=new E(t,i),n<=0)throw v.getInstance().error("Attempted to moveBy with speed less than or equal to zero : "+n),new Error("Speed must be greater than 0 pixels per second")}update(e){this._started||(this._started=!0,this._start=new E(this._tx.pos.x,this._tx.pos.y),this._end=this._start.add(this._offset),this._distance=this._offset.size,this._dir=this._end.sub(this._start).normalize()),this.isComplete(this._entity)?(this._tx.pos=P(this._end.x,this._end.y),this._motion.vel=P(0,0)):this._motion.vel=this._dir.scale(this._speed)}isComplete(e){const t=e.get(Vi);return this._stopped||t.pos.distance(this._start)>=this._distance}stop(){this._motion.vel=P(0,0),this._stopped=!0}reset(){this._started=!1}}class Ln{constructor(e,t,i,n){this.entity=e,this._started=!1,this._stopped=!1,this._tx=e.get(Vi),this._motion=e.get(Ui),this._end=new E(t,i),this._speed=n}update(e){this._started||(this._started=!0,this._start=new E(this._tx.pos.x,this._tx.pos.y),this._distance=this._start.distance(this._end),this._dir=this._end.sub(this._start).normalize());const t=this._dir.scale(this._speed);this._motion.vel=P(t.x,t.y),this.isComplete(this.entity)&&(this._tx.pos=P(this._end.x,this._end.y),this._motion.vel=P(0,0))}isComplete(e){const t=e.get(Vi);return this._stopped||new E(t.pos.x,t.pos.y).distance(this._start)>=this._distance}stop(){this._motion.vel=P(0,0),this._stopped=!0}reset(){this._started=!1}}(pn=un||(un={}))[pn.ShortestPath=0]="ShortestPath",pn[pn.LongestPath=1]="LongestPath",pn[pn.Clockwise=2]="Clockwise",pn[pn.CounterClockwise=3]="CounterClockwise";class Bn{constructor(e,t,i,n){this._started=!1,this._stopped=!1,this._tx=e.get(Vi),this._motion=e.get(Ui),this._end=t,this._speed=i,this._rotationType=n||un.ShortestPath}update(e){if(!this._started){this._started=!0,this._start=this._tx.rotation,this._currentNonCannonAngle=this._tx.rotation;const e=Math.abs(this._end-this._start),t=B-e;switch(e>t?(this._shortDistance=t,this._longDistance=e):(this._shortDistance=e,this._longDistance=t),this._shortestPathIsPositive=(this._start-this._end+B)%B>=Math.PI,this._rotationType){case un.ShortestPath:this._distance=this._shortDistance,this._shortestPathIsPositive?this._direction=1:this._direction=-1;break;case un.LongestPath:this._distance=this._longDistance,this._shortestPathIsPositive?this._direction=-1:this._direction=1;break;case un.Clockwise:this._direction=1,this._shortestPathIsPositive?this._distance=this._shortDistance:this._distance=this._longDistance;break;case un.CounterClockwise:this._direction=-1,this._shortestPathIsPositive?this._distance=this._longDistance:this._distance=this._shortDistance}}this._motion.angularVelocity=this._direction*this._speed,this._currentNonCannonAngle+=this._direction*this._speed*(e/1e3),this.isComplete()&&(this._tx.rotation=this._end,this._motion.angularVelocity=0,this._stopped=!0)}isComplete(){const e=Math.abs(this._currentNonCannonAngle-this._start);return this._stopped||e>=Math.abs(this._distance)}stop(){this._motion.angularVelocity=0,this._stopped=!0}reset(){this._started=!1}}class Fn{constructor(e,t,i,n){this._started=!1,this._stopped=!1,this._tx=e.get(Vi),this._motion=e.get(Ui),this._speed=i,this._offset=t,this._rotationType=n||un.ShortestPath}update(e){if(!this._started){this._started=!0,this._start=this._tx.rotation,this._currentNonCannonAngle=this._tx.rotation,this._end=this._start+this._offset;const e=Math.abs(this._end-this._start),t=B-e;switch(e>t?(this._shortDistance=t,this._longDistance=e):(this._shortDistance=e,this._longDistance=t),this._shortestPathIsPositive=(this._start-this._end+B)%B>=Math.PI,this._rotationType){case un.ShortestPath:this._distance=this._shortDistance,this._shortestPathIsPositive?this._direction=1:this._direction=-1;break;case un.LongestPath:this._distance=this._longDistance,this._shortestPathIsPositive?this._direction=-1:this._direction=1;break;case un.Clockwise:this._direction=1,this._shortDistance>=0?this._distance=this._shortDistance:this._distance=this._longDistance;break;case un.CounterClockwise:this._direction=-1,this._shortDistance<=0?this._distance=this._shortDistance:this._distance=this._longDistance}}this._motion.angularVelocity=this._direction*this._speed,this._currentNonCannonAngle+=this._direction*this._speed*(e/1e3),this.isComplete()&&(this._tx.rotation=this._end,this._motion.angularVelocity=0,this._stopped=!0)}isComplete(){const e=Math.abs(this._currentNonCannonAngle-this._start);return this._stopped||e>=Math.abs(this._distance)}stop(){this._motion.angularVelocity=0,this._stopped=!0}reset(){this._started=!1}}class On{constructor(e,t,i,n,r){this._started=!1,this._stopped=!1,this._tx=e.get(Vi),this._motion=e.get(Ui),this._endX=t,this._endY=i,this._speedX=n,this._speedY=r}update(e){if(this._started||(this._started=!0,this._startX=this._tx.scale.x,this._startY=this._tx.scale.y,this._distanceX=Math.abs(this._endX-this._startX),this._distanceY=Math.abs(this._endY-this._startY)),Math.abs(this._tx.scale.x-this._startX)>=this._distanceX)this._motion.scaleFactor.x=0;else{const e=this._endY<this._startY?-1:1;this._motion.scaleFactor.x=this._speedX*e}if(Math.abs(this._tx.scale.y-this._startY)>=this._distanceY)this._motion.scaleFactor.y=0;else{const e=this._endY<this._startY?-1:1;this._motion.scaleFactor.y=this._speedY*e}this.isComplete()&&(this._tx.scale=P(this._endX,this._endY),this._motion.scaleFactor.x=0,this._motion.scaleFactor.y=0)}isComplete(){return this._stopped||Math.abs(this._tx.scale.y-this._startX)>=this._distanceX&&Math.abs(this._tx.scale.y-this._startY)>=this._distanceY}stop(){this._motion.scaleFactor.x=0,this._motion.scaleFactor.y=0,this._stopped=!0}reset(){this._started=!1}}class zn{constructor(e,t,i,n){this._started=!1,this._stopped=!1,this._tx=e.get(Vi),this._motion=e.get(Ui),this._offset=new E(t,i),this._speedX=this._speedY=n}update(e){this._started||(this._started=!0,this._startScale=this._tx.scale.clone(),this._endScale=this._startScale.add(this._offset),this._distanceX=Math.abs(this._endScale.x-this._startScale.x),this._distanceY=Math.abs(this._endScale.y-this._startScale.y),this._directionX=this._endScale.x<this._startScale.x?-1:1,this._directionY=this._endScale.y<this._startScale.y?-1:1),this._motion.scaleFactor.x=this._speedX*this._directionX,this._motion.scaleFactor.y=this._speedY*this._directionY,this.isComplete()&&(this._tx.scale=this._endScale,this._motion.scaleFactor.x=0,this._motion.scaleFactor.y=0)}isComplete(){return this._stopped||Math.abs(this._tx.scale.x-this._startScale.x)>=this._distanceX&&Math.abs(this._tx.scale.y-this._startScale.y)>=this._distanceY}stop(){this._motion.scaleFactor.x=0,this._motion.scaleFactor.y=0,this._stopped=!0}reset(){this._started=!1}}class Nn{constructor(e){this._method=null,this._hasBeenCalled=!1,this._method=e}update(e){this._method(),this._hasBeenCalled=!0}isComplete(){return this._hasBeenCalled}reset(){this._hasBeenCalled=!1}stop(){this._hasBeenCalled=!0}}class Vn{constructor(e,t,i,n,r){this.easingFcn=r,this._currentLerpTime=0,this._lerpDuration=1e3,this._lerpStart=new E(0,0),this._lerpEnd=new E(0,0),this._initialized=!1,this._stopped=!1,this._distance=0,this._tx=e.get(Vi),this._motion=e.get(Ui),this._lerpDuration=n,this._lerpEnd=new E(t,i)}_initialize(){this._lerpStart=new E(this._tx.pos.x,this._tx.pos.y),this._currentLerpTime=0,this._distance=this._lerpStart.distance(this._lerpEnd)}update(e){this._initialized||(this._initialize(),this._initialized=!0),this._currentLerpTime+=e;let t=this._tx.pos.x,i=this._tx.pos.y;this._currentLerpTime<this._lerpDuration?(t=this._lerpEnd.x<this._lerpStart.x?this._lerpStart.x-(this.easingFcn(this._currentLerpTime,this._lerpEnd.x,this._lerpStart.x,this._lerpDuration)-this._lerpEnd.x):this.easingFcn(this._currentLerpTime,this._lerpStart.x,this._lerpEnd.x,this._lerpDuration),i=this._lerpEnd.y<this._lerpStart.y?this._lerpStart.y-(this.easingFcn(this._currentLerpTime,this._lerpEnd.y,this._lerpStart.y,this._lerpDuration)-this._lerpEnd.y):this.easingFcn(this._currentLerpTime,this._lerpStart.y,this._lerpEnd.y,this._lerpDuration),this._motion.vel=P((t-this._tx.pos.x)/(e/1e3),(i-this._tx.pos.y)/(e/1e3))):(this._tx.pos=P(this._lerpEnd.x,this._lerpEnd.y),this._motion.vel=E.Zero)}isComplete(e){return this._stopped||new E(e.pos.x,e.pos.y).distance(this._lerpStart)>=this._distance}reset(){this._initialized=!1}stop(){this._motion.vel=P(0,0),this._stopped=!0}}class Un{constructor(e,t,i,n=1){this._timeVisible=0,this._timeNotVisible=0,this._elapsedTime=0,this._totalTime=0,this._stopped=!1,this._started=!1,this._graphics=e.get(En),this._timeVisible=t,this._timeNotVisible=i,this._duration=(t+i)*n}update(e){this._started||(this._started=!0),this._graphics&&(this._elapsedTime+=e,this._totalTime+=e,this._graphics.visible&&this._elapsedTime>=this._timeVisible&&(this._graphics.visible=!1,this._elapsedTime=0),!this._graphics.visible&&this._elapsedTime>=this._timeNotVisible&&(this._graphics.visible=!0,this._elapsedTime=0),this.isComplete()&&(this._graphics.visible=!0))}isComplete(){return this._stopped||this._totalTime>=this._duration}stop(){this._graphics&&(this._graphics.visible=!0),this._stopped=!0}reset(){this._started=!1,this._elapsedTime=0,this._totalTime=0}}class Hn{constructor(e,t,i){this._multiplier=1,this._started=!1,this._stopped=!1,this._graphics=e.get(En),this._endOpacity=t,this._speed=i}update(e){this._graphics&&(this._started||(this._started=!0,this._endOpacity<this._graphics.opacity?this._multiplier=-1:this._multiplier=1),this._speed>0&&(this._graphics.opacity+=this._multiplier*(Math.abs(this._graphics.opacity-this._endOpacity)*e)/this._speed),this._speed-=e,this.isComplete()&&(this._graphics.opacity=this._endOpacity),v.getInstance().debug("[Action fade] Actor opacity:",this._graphics.opacity))}isComplete(){return this._stopped||Math.abs(this._graphics.opacity-this._endOpacity)<.05}stop(){this._stopped=!0}reset(){this._started=!1}}class jn{constructor(e){this._elapsedTime=0,this._started=!1,this._stopped=!1,this._delay=e}update(e){this._started||(this._started=!0),this._elapsedTime+=e}isComplete(){return this._stopped||this._elapsedTime>=this._delay}stop(){this._stopped=!0}reset(){this._elapsedTime=0,this._started=!1}}class Wn{constructor(e){this._stopped=!1,this._entity=e}update(e){this._entity.get(Xn).clearActions(),this._entity.kill(),this._stopped=!0}isComplete(){return this._stopped}stop(){}reset(){}}class Gn{constructor(e,t,i){this._started=!1,this._stopped=!1,this._tx=e.get(Vi),this._motion=e.get(Ui),this._followTx=t.get(Vi),this._followMotion=t.get(Ui),this._current=new E(this._tx.pos.x,this._tx.pos.y),this._end=new E(this._followTx.pos.x,this._followTx.pos.y),this._maximumDistance=void 0!==i?i:this._current.distance(this._end),this._speed=0}update(e){this._started||(this._started=!0,this._distanceBetween=this._current.distance(this._end),this._dir=this._end.sub(this._current).normalize());const t=Math.sqrt(Math.pow(this._followMotion.vel.x,2)+Math.pow(this._followMotion.vel.y,2));if(0!==t&&(this._speed=t),this._current=P(this._tx.pos.x,this._tx.pos.y),this._end=P(this._followTx.pos.x,this._followTx.pos.y),this._distanceBetween=this._current.distance(this._end),this._dir=this._end.sub(this._current).normalize(),this._distanceBetween>=this._maximumDistance){const e=this._dir.scale(this._speed);this._motion.vel=P(e.x,e.y)}else this._motion.vel=P(0,0);this.isComplete()&&(this._tx.pos=P(this._end.x,this._end.y),this._motion.vel=P(0,0))}stop(){this._motion.vel=P(0,0),this._stopped=!0}isComplete(){return this._stopped}reset(){this._started=!1}}class qn{constructor(e,t,i){this._started=!1,this._stopped=!1,this._speedWasSpecified=!1,this._tx=e.get(Vi),this._motion=e.get(Ui),this._meetTx=t.get(Vi),this._meetMotion=t.get(Ui),this._current=new E(this._tx.pos.x,this._tx.pos.y),this._end=new E(this._meetTx.pos.x,this._meetTx.pos.y),this._speed=i||0,void 0!==i&&(this._speedWasSpecified=!0)}update(e){this._started||(this._started=!0,this._distanceBetween=this._current.distance(this._end),this._dir=this._end.sub(this._current).normalize());const t=Math.sqrt(Math.pow(this._meetMotion.vel.x,2)+Math.pow(this._meetMotion.vel.y,2));0===t||this._speedWasSpecified||(this._speed=t),this._current=P(this._tx.pos.x,this._tx.pos.y),this._end=P(this._meetTx.pos.x,this._meetTx.pos.y),this._distanceBetween=this._current.distance(this._end),this._dir=this._end.sub(this._current).normalize();const i=this._dir.scale(this._speed);this._motion.vel=P(i.x,i.y),this.isComplete()&&(this._tx.pos=P(this._end.x,this._end.y),this._motion.vel=P(0,0))}isComplete(){return this._stopped||this._distanceBetween<=1}stop(){this._motion.vel=P(0,0),this._stopped=!0}reset(){this._started=!1}}class Kn{constructor(e){this._entity=e,this._queue=new Dn(e)}getQueue(){return this._queue}update(e){this._queue.update(e)}clearActions(){this._queue.clearActions()}easeTo(...e){var t,i;let n=0,r=0,s=0,o=An.Linear;return e[0]instanceof E?(n=e[0].x,r=e[0].y,s=e[1],o=null!==(t=e[2])&&void 0!==t?t:o):(n=e[0],r=e[1],s=e[2],o=null!==(i=e[3])&&void 0!==i?i:o),this._queue.add(new Vn(this._entity,n,r,s,o)),this}moveTo(e,t,i){let n=0,r=0,s=0;return e instanceof E?(n=e.x,r=e.y,s=t):(n=e,r=t,s=i),this._queue.add(new Ln(this._entity,n,r,s)),this}moveBy(e,t,i){let n=0,r=0,s=0;return e instanceof E?(n=e.x,r=e.y,s=t):(n=e,r=t,s=i),this._queue.add(new Mn(this._entity,n,r,s)),this}rotateTo(e,t,i){return this._queue.add(new Bn(this._entity,e,t,i)),this}rotateBy(e,t,i){return this._queue.add(new Fn(this._entity,e,t,i)),this}scaleTo(e,t,i,n){let r=1,s=1,o=0,a=0;return e instanceof E&&t instanceof E&&(r=e.x,s=e.y,o=t.x,a=t.y),"number"==typeof e&&"number"==typeof t&&(r=e,s=t,o=i,a=n),this._queue.add(new On(this._entity,r,s,o,a)),this}scaleBy(e,t,i){let n=1,r=1;return e instanceof E&&(n=e.x,r=e.y,i=t),"number"==typeof e&&"number"==typeof t&&(n=e,r=t),this._queue.add(new zn(this._entity,n,r,i)),this}blink(e,t,i=1){return this._queue.add(new Un(this._entity,e,t,i)),this}fade(e,t){return this._queue.add(new Hn(this._entity,e,t)),this}delay(e){return this._queue.add(new jn(e)),this}die(){return this._queue.add(new Wn(this._entity)),this}callMethod(e){return this._queue.add(new Nn(e)),this}repeat(e,t){return t?(this._queue.add(new Rn(this._entity,e,t)),this):(this.repeatForever(e),this)}repeatForever(e){return this._queue.add(new In(this._entity,e)),this}follow(e,t){return void 0===t?this._queue.add(new Gn(this._entity,e)):this._queue.add(new Gn(this._entity,e,t)),this}meet(e,t){return void 0===t?this._queue.add(new qn(this._entity,e)):this._queue.add(new qn(this._entity,e,t)),this}asPromise(){return this.toPromise()}toPromise(){return new Promise((e=>{this._queue.add(new Nn((()=>{e()})))}))}}class Xn extends Oi{constructor(){super(...arguments),this.type="ex.actions",this.dependencies=[Vi,Ui]}onAdd(e){this._ctx=new Kn(e)}onRemove(){this._ctx=null}getQueue(){var e;return null===(e=this._ctx)||void 0===e?void 0:e.getQueue()}update(e){var t;return null===(t=this._ctx)||void 0===t?void 0:t.update(e)}clearActions(){var e;null===(e=this._ctx)||void 0===e||e.clearActions()}easeTo(...e){return this._ctx.easeTo.apply(this._ctx,e)}moveTo(e,t,i){return this._ctx.moveTo.apply(this._ctx,[e,t,i])}moveBy(e,t,i){return this._ctx.moveBy.apply(this._ctx,[e,t,i])}rotateTo(e,t,i){return this._ctx.rotateTo(e,t,i)}rotateBy(e,t,i){return this._ctx.rotateBy(e,t,i)}scaleTo(e,t,i,n){return this._ctx.scaleTo.apply(this._ctx,[e,t,i,n])}scaleBy(e,t,i){return this._ctx.scaleBy.apply(this._ctx,[e,t,i])}blink(e,t,i){return this._ctx.blink(e,t,i)}fade(e,t){return this._ctx.fade(e,t)}delay(e){return this._ctx.delay(e)}die(){return this._ctx.die()}callMethod(e){return this._ctx.callMethod(e)}repeat(e,t){return this._ctx.repeat(e,t)}repeatForever(e){return this._ctx.repeatForever(e)}follow(e,t){return this._ctx.follow(e,t)}meet(e,t){return this._ctx.meet(e,t)}asPromise(){return this.toPromise()}toPromise(){return this._ctx.toPromise()}}class Yn extends we{constructor(e={}){var t,i,n,r,s,o,a,l,c,d,h,u,p,f,g,m,_,v,b;super(e),this.filtering=he.Blended,this.quality=2,this.padding=2,this.smoothing=!1,this.lineWidth=1,this.lineDash=[],this.color=D.Black,this.family="sans-serif",this.style=zt.Normal,this.bold=!1,this.unit=It.Px,this.textAlign=Lt.Left,this.baseAlign=Ft.Alphabetic,this.direction=Vt.LeftToRight,this.size=10,this.shadow=null,this._textBounds=new I,this._textToBitmap=new Map,this._bitmapUsage=new Map,this.smoothing=null!==(t=null==e?void 0:e.smoothing)&&void 0!==t?t:this.smoothing,this.padding=null!==(i=null==e?void 0:e.padding)&&void 0!==i?i:this.padding,this.color=null!==(n=null==e?void 0:e.color)&&void 0!==n?n:this.color,this.strokeColor=null!==(r=null==e?void 0:e.strokeColor)&&void 0!==r?r:this.strokeColor,this.lineDash=null!==(s=null==e?void 0:e.lineDash)&&void 0!==s?s:this.lineDash,this.lineWidth=null!==(o=null==e?void 0:e.lineWidth)&&void 0!==o?o:this.lineWidth,this.filtering=null!==(a=null==e?void 0:e.filtering)&&void 0!==a?a:this.filtering,this.family=null!==(l=null==e?void 0:e.family)&&void 0!==l?l:this.family,this.style=null!==(c=null==e?void 0:e.style)&&void 0!==c?c:this.style,this.bold=null!==(d=null==e?void 0:e.bold)&&void 0!==d?d:this.bold,this.size=null!==(h=null==e?void 0:e.size)&&void 0!==h?h:this.size,this.unit=null!==(u=null==e?void 0:e.unit)&&void 0!==u?u:this.unit,this.textAlign=null!==(p=null==e?void 0:e.textAlign)&&void 0!==p?p:this.textAlign,this.baseAlign=null!==(f=null==e?void 0:e.baseAlign)&&void 0!==f?f:this.baseAlign,this.direction=null!==(g=null==e?void 0:e.direction)&&void 0!==g?g:this.direction,this.quality=null!==(m=null==e?void 0:e.quality)&&void 0!==m?m:this.quality,(null==e?void 0:e.shadow)&&(this.shadow={},this.shadow.blur=null!==(_=e.shadow.blur)&&void 0!==_?_:this.shadow.blur,this.shadow.offset=null!==(v=e.shadow.offset)&&void 0!==v?v:this.shadow.offset,this.shadow.color=null!==(b=e.shadow.color)&&void 0!==b?b:this.shadow.color)}clone(){return new Yn({...this.cloneGraphicOptions(),size:this.size,unit:this.unit,family:this.family,style:this.style,bold:this.bold,textAlign:this.textAlign,baseAlign:this.baseAlign,direction:this.direction,shadow:this.shadow?{blur:this.shadow.blur,offset:this.shadow.offset,color:this.shadow.color}:null})}get fontString(){return`${this.style} ${this.bold?"bold":""} ${this.size}${this.unit} ${this.family}`}get localBounds(){return this._textBounds}_drawImage(e,t,i){}_rotate(e){var t;const i=null!==(t=this.origin)&&void 0!==t?t:this._textBounds.center;e.translate(i.x,i.y),e.rotate(this.rotation),e.translate(-i.x,-i.y)}_flip(e){this.flipHorizontal&&(e.translate(this._textBounds.width/this.scale.x,0),e.scale(-1,1)),this.flipVertical&&(e.translate(0,-this._textBounds.height/2/this.scale.y),e.scale(1,-1))}measureText(e){const t=e.split("\n"),i=t.reduce(((e,t)=>e.length>t.length?e:t)),n=this._getTextBitmap(e);this._applyFont(n);const r=n.measureText(i);let s=Math.abs(r.actualBoundingBoxAscent)+Math.abs(r.actualBoundingBoxDescent);const o=s*t.length;s=o;const a=o-Math.abs(r.actualBoundingBoxAscent);return new I({left:0-Math.abs(r.actualBoundingBoxLeft)-this.padding,top:0-Math.abs(r.actualBoundingBoxAscent)-this.padding,bottom:0+a+this.padding,right:0+Math.abs(r.actualBoundingBoxRight)+this.padding})}_setDimension(e,t){t.canvas.width=2*(e.width+2*this.padding)*this.quality,t.canvas.height=2*(e.height+2*this.padding)*this.quality}_postDraw(e){e.restore()}_getRasterPropertiesHash(e){var t,i;return"__hashcode__"+this.fontString+this.showDebug+this.textAlign+this.baseAlign+this.direction+JSON.stringify(this.shadow)+(this.padding.toString()+this.smoothing.toString()+this.lineWidth.toString()+this.lineDash.toString()+(null===(t=this.strokeColor)||void 0===t?void 0:t.toString())+(e?e.toString():null===(i=this.color)||void 0===i?void 0:i.toString()).toString())}_applyRasterProperties(e,t){var i,n,r;e.translate(this.padding,this.padding),e.imageSmoothingEnabled=this.smoothing,e.lineWidth=this.lineWidth,e.setLineDash(null!==(i=this.lineDash)&&void 0!==i?i:e.getLineDash()),e.strokeStyle=null===(n=this.strokeColor)||void 0===n?void 0:n.toString(),e.fillStyle=t?t.toString():null===(r=this.color)||void 0===r?void 0:r.toString()}_applyFont(e){e.translate(this.padding+e.canvas.width/2,this.padding+e.canvas.height/2),e.scale(this.quality,this.quality),e.textAlign=this.textAlign,e.textBaseline=this.baseAlign,e.font=this.fontString,e.direction=this.direction,this.shadow&&(e.shadowColor=this.shadow.color.toString(),e.shadowBlur=this.shadow.blur,e.shadowOffsetX=this.shadow.offset.x,e.shadowOffsetY=this.shadow.offset.y)}_drawText(e,t,i,n){const r=t.split("\n");this._applyRasterProperties(e,i),this._applyFont(e);for(let t=0;t<r.length;t++){const i=r[t];this.color&&e.fillText(i,0,t*n),this.strokeColor&&e.strokeText(i,0,t*n)}this.showDebug&&(_i(e,D.Red,-e.canvas.width/2,0,e.canvas.width/2,0,2),_i(e,D.Red,0,-e.canvas.height/2,0,e.canvas.height/2,2))}_getTextBitmap(e,t){const i=e+this._getRasterPropertiesHash(t),n=this._textToBitmap.get(i);if(n)return n;const r=document.createElement("canvas").getContext("2d");return this._textToBitmap.set(i,r),r}render(e,t,i,n,r){this.showDebug&&this.clearCache(),this.checkAndClearCache();const s=this._getTextBitmap(t,i),o=!this._bitmapUsage.get(s);this._textBounds=this.measureText(t),o&&this._setDimension(this._textBounds,s),this._preDraw(e,n,r);const a=t.split("\n"),l=this._textBounds.height/a.length,c=s.canvas.width,d=s.canvas.height;o&&(this._drawText(s,t,i,l),Pe.load(s.canvas,this.filtering,!0)),e.drawImage(s.canvas,0,0,c,d,n-c/this.quality/2,r-d/this.quality/2,c/this.quality,d/this.quality),this._postDraw(e),this._bitmapUsage.set(s,performance.now())}get cacheSize(){return this._bitmapUsage.size}clearCache(){this._bitmapUsage.clear()}checkAndClearCache(){for(const[e,t]of this._bitmapUsage.entries())t+1e3<performance.now()&&this._bitmapUsage.delete(e)}}class Qn extends we{constructor(e){var t,i;super(e),this._text="",this._textWidth=0,this._textHeight=0,this.font=null!==(t=e.font)&&void 0!==t?t:new Yn,this.color=null!==(i=e.color)&&void 0!==i?i:this.color,this.text=e.text}clone(){var e,t;return new Qn({text:this.text.slice(),color:null!==(t=null===(e=this.color)||void 0===e?void 0:e.clone())&&void 0!==t?t:D.Black,font:this.font.clone()})}get text(){return this._text}set text(e){this._text=e;const t=this.font.measureText(this._text);this._textWidth=t.width,this._textHeight=t.height}get font(){return this._font}set font(e){this._font=e}get width(){return 0===this._textWidth&&this._calculateDimension(),this._textWidth*this.scale.x}get height(){return 0===this._textHeight&&this._calculateDimension(),this._textHeight*this.scale.y}_calculateDimension(){const{width:e,height:t}=this.font.measureText(this._text);this._textWidth=e,this._textHeight=t}get localBounds(){return this.font.measureText(this._text).scale(this.scale)}_rotate(e){}_flip(e){}_drawImage(e,t,i){var n;let r=D.Black;this.font instanceof Yn&&(r=null!==(n=this.color)&&void 0!==n?n:this.font.color),(this.isStale()||this.font.isStale())&&(this.font.flipHorizontal=this.flipHorizontal,this.font.flipVertical=this.flipVertical,this.font.rotation=this.rotation,this.font.origin=this.origin,this.font.opacity=this.opacity);const{width:s,height:o}=this.font.measureText(this._text);this._textWidth=s,this._textHeight=o,this.font.render(e,this._text,r,t,i),this.font.showDebug&&e.debug.drawRect(t-s,i-o,2*s,2*o)}}var Zn=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};class Jn extends yn{constructor(e){super(),this._anchor=ve(E.Half,(e=>this._handleAnchorChange(e))),this.logger=v.getInstance(),this.scene=null,this.frames={},this.currentDrawing=null,this._draggable=!1,this._dragging=!1,this._pointerDragStartHandler=()=>{this._dragging=!0},this._pointerDragEndHandler=()=>{this._dragging=!1},this._pointerDragMoveHandler=e=>{this._dragging&&(this.pos=e.worldPos)},this._pointerDragLeaveHandler=e=>{this._dragging&&(this.pos=e.worldPos)},this.traits=[];const{name:t,x:i,y:n,pos:r,coordPlane:s,scale:o,width:a,height:l,radius:c,collider:h,vel:u,acc:p,rotation:f,angularVelocity:g,z:_,color:b,visible:w,anchor:y,collisionType:x,collisionGroup:$}={...e};this._setName(t),this.anchor=null!=y?y:Jn.defaults.anchor.clone();const C=new Vi;this.addComponent(C),this.pos=null!=r?r:P(null!=i?i:0,null!=n?n:0),this.rotation=null!=f?f:0,this.scale=null!=o?o:P(1,1),this.z=null!=_?_:0,C.coordPlane=null!=s?s:Mi.World,this.addComponent(new Tn),this.addComponent(new En({anchor:this.anchor})),this.addComponent(new xn(((e,t)=>this.draw(e,t)))),this.addComponent(new Ui),this.vel=null!=u?u:E.Zero,this.acc=null!=p?p:E.Zero,this.angularVelocity=null!=g?g:0,this.addComponent(new Xn),this.addComponent(new fn),this.body.collisionType=null!=x?x:Ei.Passive,$&&(this.body.group=$),h?this.addComponent(new cn(h)):c?this.addComponent(new cn(ln.Circle(c,this.anchor))):a>0&&l>0?this.addComponent(new cn(ln.Box(a,l,this.anchor))):this.addComponent(new cn),this.graphics.visible=null==w||w,b&&(this.color=b,a&&l?this.graphics.add(new Pn({color:b,width:a,height:l})):c&&this.graphics.add(new kn({color:b,radius:c}))),m.isEnabled(d.LegacyDrawing)&&this.traits.push(new mn)}get body(){return this.get(fn)}get transform(){return this.get(Vi)}get motion(){return this.get(Ui)}get graphics(){return this.get(En)}get collider(){return this.get(cn)}get pointer(){return this.get(Tn)}get actions(){return this.get(Xn)}get pos(){return this.transform.pos}set pos(e){this.transform.pos=e.clone()}get oldPos(){return this.body.oldPos}set oldPos(e){this.body.oldPos.setTo(e.x,e.y)}get vel(){return this.motion.vel}set vel(e){this.motion.vel=e.clone()}get oldVel(){return this.body.oldVel}set oldVel(e){this.body.oldVel.setTo(e.x,e.y)}get acc(){return this.motion.acc}set acc(e){this.motion.acc=e.clone()}set oldAcc(e){this.body.oldAcc.setTo(e.x,e.y)}get oldAcc(){return this.body.oldAcc}get rotation(){return this.transform.rotation}set rotation(e){this.transform.rotation=e}get angularVelocity(){return this.motion.angularVelocity}set angularVelocity(e){this.motion.angularVelocity=e}get scale(){return this.get(Vi).scale}set scale(e){this.get(Vi).scale=e}get anchor(){return this._anchor}set anchor(e){this._anchor=ve(e,(e=>this._handleAnchorChange(e))),this._handleAnchorChange(e)}_handleAnchorChange(e){this.graphics&&(this.graphics.anchor=e)}get isOffScreen(){return this.hasTag("offscreen")}get visible(){return this.graphics.visible}set visible(e){this.graphics.visible=e}get opacity(){return this.graphics.opacity}set opacity(e){this.graphics.opacity=e}get draggable(){return this._draggable}set draggable(e){e&&(e&&!this._draggable?(this.on("pointerdragstart",this._pointerDragStartHandler),this.on("pointerdragend",this._pointerDragEndHandler),this.on("pointerdragmove",this._pointerDragMoveHandler),this.on("pointerdragleave",this._pointerDragLeaveHandler)):!e&&this._draggable&&(this.off("pointerdragstart",this._pointerDragStartHandler),this.off("pointerdragend",this._pointerDragEndHandler),this.off("pointerdragmove",this._pointerDragMoveHandler),this.off("pointerdragleave",this._pointerDragLeaveHandler)),this._draggable=e)}get color(){return this._color}set color(e){var t;this._color=e.clone();const i=null===(t=this.graphics.layers.default.graphics[0])||void 0===t?void 0:t.graphic;(i instanceof ke||i instanceof Qn)&&(i.color=this._color)}onInitialize(e){}_initialize(e){super._initialize(e);for(const t of this.children)t._initialize(e)}on(e,t){super.on(e,t)}once(e,t){super.once(e,t)}off(e,t){super.off(e,t)}_prekill(e){super.emit("prekill",new Re(this)),this.onPreKill(e)}onPreKill(e){}_postkill(e){super.emit("postkill",new Ie(this)),this.onPostKill(e)}onPostKill(e){}kill(){this.scene?(this._prekill(this.scene),this.emit("kill",new De(this)),super.kill(),this._postkill(this.scene)):this.logger.warn("Cannot kill actor, it was never added to the Scene")}unkill(){this.active=!0}isKilled(){return!this.active}setDrawing(e){e=e.toString(),this.currentDrawing!==this.frames[e]&&(null!=this.frames[e]?(this.frames[e].reset(),this.currentDrawing=this.frames[e]):v.getInstance().error(`the specified drawing key ${e} does not exist`)),this.currentDrawing&&this.currentDrawing instanceof Rt&&this.currentDrawing.tick(0)}addDrawing(){2===arguments.length?(this.frames[arguments[0]]=arguments[1],this.currentDrawing||(this.currentDrawing=arguments[1])):(arguments[0]instanceof kt&&this.addDrawing("default",arguments[0]),arguments[0]instanceof St&&this.addDrawing("default",arguments[0].asSprite()))}get z(){return this.get(Vi).z}getZIndex(){return this.get(Vi).z}set z(e){this.get(Vi).z=e}setZIndex(e){this.get(Vi).z=e}get center(){const e=this.getGlobalPos();return new E(e.x+this.width/2-this.anchor.x*this.width,e.y+this.height/2-this.anchor.y*this.height)}get localCenter(){return new E(this.pos.x+this.width/2-this.anchor.x*this.width,this.pos.y+this.height/2-this.anchor.y*this.height)}get width(){return this.collider.localBounds.width*this.getGlobalScale().x}get height(){return this.collider.localBounds.height*this.getGlobalScale().y}getGlobalRotation(){return this.get(Vi).globalRotation}getGlobalPos(){return this.get(Vi).globalPos}getGlobalScale(){return this.get(Vi).globalScale}contains(e,t,i=!1){const n=P(e,t),r=this.get(cn);r.update();const s=r.get();if(!s)return!1;const o=s.contains(n);return i?o||this.children.some((i=>i.contains(e,t,!0))):o}within(e,t){const i=this.get(cn),n=e.get(cn),r=i.get(),s=n.get();return!(!r||!s)&&r.getClosestLineBetween(s).getLength()<=t}update(e,t){this._initialize(e),this._preupdate(e,t);const i=this.currentDrawing;i&&i instanceof Rt&&i.tick(t,e.stats.currFrame.id);for(const i of this.traits)i.update(this,e,t);this._postupdate(e,t)}onPreUpdate(e,t){}onPostUpdate(e,t){}_preupdate(e,t){this.emit("preupdate",new Ne(e,t,this)),this.onPreUpdate(e,t)}_postupdate(e,t){this.emit("postupdate",new Ne(e,t,this)),this.onPostUpdate(e,t)}draw(e,t){var i;if(e.save(),this.currentDrawing){e.translate(-this.width*this.anchor.x,-this.height*this.anchor.y),this._predraw(e,t);const i=this.currentDrawing,n=(this.width-i.width*i.scale.x)*this.anchor.x,r=(this.height-i.height*i.scale.y)*this.anchor.y;this.currentDrawing.draw({ctx:e,x:n,y:r,opacity:this.graphics.opacity})}else if(this._predraw(e,t),this.color&&this.collider){const t=this.get(cn);t.update(),t&&!t.bounds.hasZeroDimensions()&&(e.globalAlpha=this.graphics.opacity,null===(i=t.get())||void 0===i||i.draw(e,this.color,P(0,0)))}e.restore(),this._postdraw(e,t)}onPreDraw(e,t){}onPostDraw(e,t){}_predraw(e,t){this.emit("predraw",new Be(e,t,this)),this.onPreDraw(e,t)}_postdraw(e,t){this.emit("postdraw",new Be(e,t,this)),this.onPostDraw(e,t)}debugDraw(e){}}Jn.defaults={anchor:E.Half},Zn([S({message:"Actor.visible will be removed in v0.26.0",alternateMethod:"Use Actor.graphics.visible"})],Jn.prototype,"visible",null),Zn([S({message:"Actor.opacity will be removed in v0.26.0",alternateMethod:"Use Actor.graphics.opacity"})],Jn.prototype,"opacity",null),Zn([S({message:"Actor.setDrawing will be removed in v0.26.0",alternateMethod:"Use Actor.graphics.show() or Actor.graphics.use()"})],Jn.prototype,"setDrawing",null),Zn([S({message:"Actor.addDrawing will be removed in v0.26.0",alternateMethod:"Use Actor.graphics.add()"})],Jn.prototype,"addDrawing",null),Zn([S({message:"Actor.getZIndex will be removed in v0.26.0",alternateMethod:"Use Actor.transform.z or Actor.z"})],Jn.prototype,"getZIndex",null),Zn([S({message:"Actor.setZIndex will be removed in v0.26.0",alternateMethod:"Use Actor.transform.z or Actor.z"})],Jn.prototype,"setZIndex",null);class er extends Jn{constructor(e){super({...e}),this.get(Vi).coordPlane=Mi.Screen,this.anchor=P(0,0),this.body.collisionType=Ei.PreventCollision,this.collider.useBoxCollider(this.width,this.height,this.anchor)}_initialize(e){this._engine=e,super._initialize(e)}contains(e,t,i=!0){if(i)return super.contains(e,t);const n=this._engine.worldToScreenCoordinates(new E(e,t));return super.contains(n.x,n.y)}}class tr{constructor(e,t,i,n){if(this._logger=v.getInstance(),this.id=0,this._elapsedTime=0,this._totalTimeAlive=0,this._running=!1,this._numberOfTicks=0,this.interval=10,this.repeats=!1,this.maxNumberOfRepeats=-1,this._complete=!1,this.scene=null,"function"!=typeof e){const r=e;e=r.fcn,t=r.interval,i=r.repeats,n=r.numberOfRepeats}if(n&&n>=0&&(this.maxNumberOfRepeats=n,!i))throw new Error("repeats must be set to true if numberOfRepeats is set");this.id=tr._MAX_ID++,this.interval=t||this.interval,this.repeats=i||this.repeats,this._callbacks=[],e&&this.on(e)}get complete(){return this._complete}on(e){this._callbacks.push(e)}off(e){const t=this._callbacks.indexOf(e);this._callbacks.splice(t,1)}update(e){this._running&&(this._totalTimeAlive+=e,this._elapsedTime+=e,this.maxNumberOfRepeats>-1&&this._numberOfTicks>=this.maxNumberOfRepeats&&(this._complete=!0,this._running=!1,this._elapsedTime=0),!this.complete&&this._elapsedTime>=this.interval&&(this._callbacks.forEach((e=>{e.call(this)})),this._numberOfTicks++,this.repeats||(this._complete=!0,this._running=!1),this._elapsedTime=0))}reset(e,t){if(e&&e>=0&&(this.interval=e),this.maxNumberOfRepeats&&this.maxNumberOfRepeats>=0&&(this.maxNumberOfRepeats=t,!this.repeats))throw new Error("repeats must be set to true if numberOfRepeats is set");this._complete=!1,this._elapsedTime=0,this._numberOfTicks=0}get timesRepeated(){return this._numberOfTicks}getTimeRunning(){return this._totalTimeAlive}get timeToNextAction(){return this.complete?0:this.interval-this._elapsedTime}get timeElapsedTowardNextAction(){return this._elapsedTime}get isRunning(){return this._running}pause(){return this._running=!1,this}unpause(){this._running=!0}resume(){return this._running=!0,this}start(){return this.scene||this._logger.warn("Cannot start a timer not part of a scene, timer wont start until added"),this._running=!0,this.complete&&(this._complete=!1,this._elapsedTime=0,this._numberOfTicks=0),this}stop(){return this._running=!1,this._elapsedTime=0,this._numberOfTicks=0,this}cancel(){this.pause(),this.scene&&this.scene.cancelTimer(this)}}tr._MAX_ID=0,function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);s>3&&o&&Object.defineProperty(t,i,o)}([S({message:"Will be removed in v0.26.0",alternateMethod:"Use Timer.resume()"})],tr.prototype,"unpause",null);class ir extends Oi{constructor(e,t=!0){super(),this.draw=e,this.useTransform=t,this.type="ex.debuggraphics"}}var nr,rr,sr=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};class or extends yn{constructor(e){var t;super(null,e.name),this._token=0,this._onScreenXStart=0,this._onScreenXEnd=Number.MAX_VALUE,this._onScreenYStart=0,this._onScreenYEnd=Number.MAX_VALUE,this._spriteSheets={},this._legacySpriteMap=new Map,this.logger=v.getInstance(),this.tiles=[],this._rows=[],this._cols=[],this._collidersDirty=!0,this._originalOffsets=new WeakMap,this.addComponent(new Vi),this.addComponent(new Ui),this.addComponent(new fn({type:Ei.Fixed})),this.addComponent(new xn(((e,t)=>this.draw(e,t)))),this.addComponent(new En({onPostDraw:(e,t)=>this.draw(e,t)})),this.addComponent(new ir((e=>this.debug(e)))),this.addComponent(new cn),this._transform=this.get(Vi),this._motion=this.get(Ui),this._collider=this.get(cn),this._composite=this._collider.useCompositeCollider([]),this._transform.pos=null!==(t=e.pos)&&void 0!==t?t:E.Zero,this._transform.posChanged$.subscribe((()=>this.flagCollidersDirty())),this.tileWidth=e.tileWidth,this.tileHeight=e.tileHeight,this.height=e.height,this.width=e.width,this.tiles=new Array(this.height*this.width),this._rows=new Array(this.height),this._cols=new Array(this.width);let i=[];for(let e=0;e<this.width;e++){for(let t=0;t<this.height;t++){const n=new ar({x:e,y:t,map:this});n.map=this,this.tiles[e+t*this.width]=n,i.push(n),this._rows[t]||(this._rows[t]=[]),this._rows[t].push(n)}this._cols[e]=i,i=[]}this.get(En).localBounds=new I({left:0,top:0,right:this.width*this.tileWidth,bottom:this.height*this.tileHeight})}flagCollidersDirty(){this._collidersDirty=!0}get x(){var e;return null!==(e=this._transform.pos.x)&&void 0!==e?e:0}set x(e){var t;(null===(t=this._transform)||void 0===t?void 0:t.pos)&&(this.get(Vi).pos=P(e,this.y))}get y(){var e,t;return null!==(t=null===(e=this._transform)||void 0===e?void 0:e.pos.y)&&void 0!==t?t:0}set y(e){var t;(null===(t=this._transform)||void 0===t?void 0:t.pos)&&(this._transform.pos=P(this.x,e))}get z(){var e;return null!==(e=this._transform.z)&&void 0!==e?e:0}set z(e){this._transform&&(this._transform.z=e)}get rotation(){var e,t;return null!==(t=null===(e=this._transform)||void 0===e?void 0:e.rotation)&&void 0!==t?t:0}set rotation(e){var t;(null===(t=this._transform)||void 0===t?void 0:t.rotation)&&(this._transform.rotation=e)}get scale(){var e,t;return null!==(t=null===(e=this._transform)||void 0===e?void 0:e.scale)&&void 0!==t?t:E.One}set scale(e){var t;(null===(t=this._transform)||void 0===t?void 0:t.scale)&&(this._transform.scale=e)}get pos(){return this._transform.pos}set pos(e){this._transform.pos=e}get vel(){return this._motion.vel}set vel(e){this._motion.vel=e}on(e,t){super.on(e,t)}_initialize(e){super._initialize(e)}registerSpriteSheet(e,t){this._spriteSheets[e]=t instanceof Wt?t:Wt.fromLegacySpriteSheet(t)}_getOrSetColliderOriginalOffset(e){if(this._originalOffsets.has(e))return this._originalOffsets.get(e);{const t=e.offset;return this._originalOffsets.set(e,t),t}}_updateColliders(){this._composite.clearColliders();const e=[];let t;this._composite=this._collider.useCompositeCollider([]);for(let i=0;i<this.width;i++){for(let n=0;n<this.height;n++){0===n&&(t=null);const r=this.tiles[i+n*this.width];if(r.solid)if(r.getColliders().length>0){for(const e of r.getColliders()){const t=this._getOrSetColliderOriginalOffset(e);e.offset=P(r.x*this.tileWidth,r.y*this.tileHeight).add(t),e.owner=this,this._composite.addCollider(e)}t=null}else t=t?t.combine(r.bounds):r.bounds;else t&&e.push(t),t=null}if(t){const i=e[e.length-1];i&&i.top===t.top&&i.bottom===t.bottom?e[e.length-1]=i.combine(t):e.push(t)}}for(const t of e){const e=ln.Box(t.width,t.height,E.Zero,P(t.left-this.pos.x,t.top-this.pos.y));e.owner=this,this._composite.addCollider(e)}this._collider.update()}getTileByIndex(e){return this.tiles[e]}getTile(e,t){return e<0||t<0||e>=this.width||t>=this.height?null:this.tiles[e+t*this.width]}getTileByPoint(e){const t=Math.floor((e.x-this.pos.x)/this.tileWidth),i=Math.floor((e.y-this.pos.y)/this.tileHeight),n=this.getTile(t,i);return t>=0&&i>=0&&t<this.width&&i<this.height&&n?n:null}getRows(){return this._rows}getColumns(){return this._cols}update(e,t){this.onPreUpdate(e,t),this.emit("preupdate",new Ne(e,t,this)),this._collidersDirty&&(this._collidersDirty=!1,this._updateColliders()),this._token++;const i=e.getWorldBounds(),n=P(i.left,i.top),r=P(i.right,i.bottom);this._onScreenXStart=Math.max(Math.floor((n.x-this.x)/this.tileWidth)-2,0),this._onScreenYStart=Math.max(Math.floor((n.y-this.y)/this.tileHeight)-2,0),this._onScreenXEnd=Math.max(Math.floor((r.x-this.x)/this.tileWidth)+2,0),this._onScreenYEnd=Math.max(Math.floor((r.y-this.y)/this.tileHeight)+2,0),this._transform.pos=P(this.x,this.y),this.onPostUpdate(e,t),this.emit("postupdate",new Ve(e,t,this))}draw(e,t){this.emit("predraw",new Be(e,t,this));let i=this._onScreenXStart;const n=Math.min(this._onScreenXEnd,this.width);let r=this._onScreenYStart;const s=Math.min(this._onScreenYEnd,this.height);let o,a,l;for(;i<n;i++){for(;r<s;r++)for(o=this.getTile(i,r).getGraphics(),a=0,l=o.length;a<l;a++){const n=o[a];n&&(e instanceof CanvasRenderingContext2D?n instanceof Tt&&(this._legacySpriteMap.has(n)||this._legacySpriteMap.set(n,Tt.toLegacySprite(n)),this._legacySpriteMap.get(n).draw(e,i*this.tileWidth,r*this.tileHeight)):($n(n)&&(null==n||n.tick(t,this._token)),n.draw(e,i*this.tileWidth,r*this.tileHeight)))}r=this._onScreenYStart}this.emit("postdraw",new Fe(e,t,this))}debug(e){const t=this.tileWidth*this.width,i=this.tileHeight*this.height,n=E.Zero;for(let i=0;i<this.height+1;i++){const r=P(0,i*this.tileHeight);e.drawLine(n.add(r),n.add(P(t,r.y)),D.Red,2)}for(let t=0;t<this.width+1;t++){const r=P(t*this.tileWidth,0);e.drawLine(n.add(r),n.add(P(r.x,i)),D.Red,2)}const r=this._composite.getColliders();for(const t of r){const i=D.Gray;i.a=.5;const n=t.localBounds,r=t.worldPos.sub(this.pos);e.drawRectangle(r,n.width,n.height,i)}}}sr([S({message:"No longer used, will be removed in v0.26.0"})],or.prototype,"registerSpriteSheet",null);class ar extends yn{constructor(e){var t,i;super(),this._posDirty=!1,this._solid=!1,this._graphics=[],this._colliders=[],this.data=new Map,this.x=e.x,this.y=e.y,this.map=e.map,this.width=e.map.tileWidth,this.height=e.map.tileHeight,this.solid=null!==(t=e.solid)&&void 0!==t?t:this.solid,this._graphics=null!==(i=e.graphics)&&void 0!==i?i:[],this._recalculate(),this._transform=e.map.get(Vi),this._transform.posChanged$.subscribe((()=>{this._posDirty=!0}))}get pos(){return this._posDirty&&(this._recalculate(),this._posDirty=!1),this._pos}get solid(){return this._solid}set solid(e){var t;null===(t=this.map)||void 0===t||t.flagCollidersDirty(),this._solid=e}getGraphics(){return this._graphics}addGraphic(e){e instanceof kt?this._graphics.push(Tt.fromLegacySprite(e)):this._graphics.push(e)}removeGraphic(e){ie(e,this._graphics)}clearGraphics(){this._graphics.length=0}getColliders(){return this._colliders}addCollider(e){this._colliders.push(e),this.map.flagCollidersDirty()}removeCollider(e){const t=this._colliders.indexOf(e);t>-1&&this._colliders.splice(t,1),this.map.flagCollidersDirty()}clearColliders(){this._colliders.length=0,this.map.flagCollidersDirty()}_recalculate(){this._pos=this.map.pos.add(P(this.x*this.map.tileWidth,this.y*this.map.tileHeight)),this._bounds=new I(this._pos.x,this._pos.y,this._pos.x+this.width,this._pos.y+this.height)}get bounds(){return this._posDirty&&(this._recalculate(),this._posDirty=!1),this._bounds}get center(){return new E(this._pos.x+this.width/2,this._pos.y+this.height/2)}pushSprite(e){this.addGraphic(e)}}sr([S({message:"Will be removed in v0.26.0",alternateMethod:"addSprite"})],ar.prototype,"pushSprite",null);class lr{constructor(e){this.camera=e}lockToActor(e){this.camera.addStrategy(new cr(e))}lockToActorAxis(e,t){this.camera.addStrategy(new dr(e,t))}elasticToActor(e,t,i){this.camera.addStrategy(new hr(e,t,i))}radiusAroundActor(e,t){this.camera.addStrategy(new ur(e,t))}limitCameraBounds(e){this.camera.addStrategy(new pr(e))}}(rr=nr||(nr={}))[rr.X=0]="X",rr[rr.Y=1]="Y";class cr{constructor(e){this.target=e,this.action=(e,t,i,n)=>e.center}}class dr{constructor(e,t){this.target=e,this.axis=t,this.action=(e,t,i,n)=>{const r=e.center,s=t.getFocus();return this.axis===nr.X?new E(r.x,s.y):new E(s.x,r.y)}}}class hr{constructor(e,t,i){this.target=e,this.cameraElasticity=t,this.cameraFriction=i,this.action=(e,t,i,n)=>{const r=e.center;let s=t.getFocus(),o=t.vel.clone();const a=r.sub(s).scale(this.cameraElasticity);o=o.add(a);const l=o.scale(-1).scale(this.cameraFriction);return o=o.add(l),s=s.add(o),s}}}class ur{constructor(e,t){this.target=e,this.radius=t,this.action=(e,t,i,n)=>{const r=e.center,s=t.getFocus(),o=r.sub(s),a=o.size;if(a>=this.radius){const e=a-this.radius;return s.add(o.normalize().scale(e))}return s}}}class pr{constructor(e){this.target=e,this.boundSizeChecked=!1,this.action=(e,t,i,n)=>{const r=t.getFocus();this.boundSizeChecked||((e.bottom-e.top<i.drawHeight||e.right-e.left<i.drawWidth)&&v.getInstance().warn("Camera bounds should not be smaller than the engine viewport"),this.boundSizeChecked=!0);let s=r.x,o=r.y;return r.x<e.left+i.halfDrawWidth?s=e.left+i.halfDrawWidth:r.x>e.right-i.halfDrawWidth&&(s=e.right-i.halfDrawWidth),r.y<e.top+i.halfDrawHeight?o=e.top+i.halfDrawHeight:r.y>e.bottom-i.halfDrawHeight&&(o=e.bottom-i.halfDrawHeight),P(s,o)}}}class fr extends mi{constructor(){super(...arguments),this.transform=ge.identity(),this.inverse=ge.identity(),this._cameraStrategies=[],this.strategy=new lr(this),this._z=1,this.dz=0,this.az=0,this.rotation=0,this.rx=0,this._posChanged=!1,this._pos=be(E.Zero,(()=>this._posChanged=!0)),this.vel=E.Zero,this.acc=E.Zero,this._cameraMoving=!1,this._currentLerpTime=0,this._lerpDuration=1e3,this._lerpStart=null,this._lerpEnd=null,this._isShaking=!1,this._shakeMagnitudeX=0,this._shakeMagnitudeY=0,this._shakeDuration=0,this._elapsedShakeTime=0,this._xShake=0,this._yShake=0,this._isZooming=!1,this._zoomStart=1,this._zoomEnd=1,this._currentZoomTime=0,this._zoomDuration=0,this._zoomEasing=An.EaseInOutCubic,this._easing=An.EaseInOutCubic,this._halfWidth=0,this._halfHeight=0,this._viewport=null,this._isInitialized=!1}get zoom(){return this._z}set zoom(e){this._z=e,this._engine&&(this._halfWidth=this._engine.halfDrawWidth,this._halfHeight=this._engine.halfDrawHeight)}get angularVelocity(){return this.rx}set angularVelocity(e){this.rx=e}get pos(){return this._pos}set pos(e){this._pos=be(e,(()=>this._posChanged=!0)),this._posChanged=!0}get x(){return this.pos.x}set x(e){this._follow||this._cameraMoving||(this.pos=P(e,this.pos.y))}get y(){return this.pos.y}set y(e){this._follow||this._cameraMoving||(this.pos=P(this.pos.x,e))}get dx(){return this.vel.x}set dx(e){this.vel=P(e,this.vel.y)}get dy(){return this.vel.y}set dy(e){this.vel=P(this.vel.x,e)}get ax(){return this.acc.x}set ax(e){this.acc=P(e,this.acc.y)}get ay(){return this.acc.y}set ay(e){this.acc=P(this.acc.x,e)}getFocus(){return this.pos}move(e,t,i=An.EaseInOutCubic){if("function"!=typeof i)throw"Please specify an EasingFunction";return this._follow?Promise.reject(e):(this._lerpPromise&&this._lerpResolve&&this._lerpResolve(e),this._lerpPromise=new Promise((e=>{this._lerpResolve=e})),this._lerpStart=this.getFocus().clone(),this._lerpDuration=t,this._lerpEnd=e,this._currentLerpTime=0,this._cameraMoving=!0,this._easing=i,this._lerpPromise)}shake(e,t,i){this._isShaking=!0,this._shakeMagnitudeX=e,this._shakeMagnitudeY=t,this._shakeDuration=i}zoomOverTime(e,t=0,i=An.EaseInOutCubic){return this._zoomPromise=new Promise((e=>{this._zoomResolve=e})),t?(this._isZooming=!0,this._zoomEasing=i,this._currentZoomTime=0,this._zoomDuration=t,this._zoomStart=this.zoom,this._zoomEnd=e,this._zoomPromise):(this._isZooming=!1,this.zoom=e,Promise.resolve(!0))}get viewport(){return this._viewport?this._viewport:new I(0,0,0,0)}addStrategy(e){this._cameraStrategies.push(e)}removeStrategy(e){ie(e,this._cameraStrategies)}clearAllStrategies(){this._cameraStrategies.length=0}_preupdate(e,t){this.emit("preupdate",new Ne(e,t,this)),this.onPreUpdate(e,t)}onPreUpdate(e,t){}_postupdate(e,t){this.emit("postupdate",new Ve(e,t,this)),this.onPostUpdate(e,t)}onPostUpdate(e,t){}get isInitialized(){return this._isInitialized}_initialize(e){if(!this.isInitialized){this._engine=e,this._screen=e.screen;const t=this._screen.resolution;let i=P(t.width/2,t.height/2);if(!this._engine.loadingComplete){const e=this._screen.peekResolution();e&&(i=P(e.width/2,e.height/2))}this._halfWidth=i.x,this._halfHeight=i.y,this._posChanged||(this.pos=i),this.updateTransform(),this.runStrategies(e,e.clock.elapsed()),this.updateViewport(),this.updateTransform(),this.onInitialize(e),super.emit("initialize",new ot(e,this)),this._isInitialized=!0}}onInitialize(e){}on(e,t){super.on(e,t)}off(e,t){super.off(e,t)}once(e,t){super.once(e,t)}runStrategies(e,t){for(const i of this._cameraStrategies)this.pos=i.action.call(i,i.target,this,e,t)}updateViewport(){this._viewport=new I(this.x-this._halfWidth,this.y-this._halfHeight,this.x+this._halfWidth,this.y+this._halfHeight)}update(e,t){if(this._initialize(e),this._preupdate(e,t),this.pos=this.pos.add(this.vel.scale(t/1e3)),this.zoom+=this.dz*t/1e3,this.vel=this.vel.add(this.acc.scale(t/1e3)),this.dz+=this.az*t/1e3,this.rotation+=this.angularVelocity*t/1e3,this._isZooming)if(this._currentZoomTime<this._zoomDuration){const e=(0,this._zoomEasing)(this._currentZoomTime,this._zoomStart,this._zoomEnd,this._zoomDuration);this.zoom=e,this._currentZoomTime+=t}else this._isZooming=!1,this.zoom=this._zoomEnd,this._currentZoomTime=0,this._zoomResolve(!0);if(this._cameraMoving)if(this._currentLerpTime<this._lerpDuration){const e=An.CreateVectorEasingFunction(this._easing)(this._currentLerpTime,this._lerpStart,this._lerpEnd,this._lerpDuration);this.pos=e,this._currentLerpTime+=t}else{this.pos=this._lerpEnd;const e=this._lerpEnd.clone();this._lerpStart=null,this._lerpEnd=null,this._currentLerpTime=0,this._cameraMoving=!1,this._lerpResolve(e)}this._isDoneShaking()?(this._isShaking=!1,this._elapsedShakeTime=0,this._shakeMagnitudeX=0,this._shakeMagnitudeY=0,this._shakeDuration=0,this._xShake=0,this._yShake=0):(this._elapsedShakeTime+=t,this._xShake=1+(Math.random()*this._shakeMagnitudeX|0),this._yShake=1+(Math.random()*this._shakeMagnitudeY|0)),this.runStrategies(e,t),this.updateViewport(),this.updateTransform(),this._postupdate(e,t)}draw(e){if(e instanceof CanvasRenderingContext2D){const t=this.getFocus(),i=this._screen.resolution.width/this.zoom,n=this._screen.resolution.height/this.zoom,r=P(-t.x+i/2+this._xShake,-t.y+n/2+this._yShake);e.scale(this.zoom,this.zoom),e.translate(r.x,r.y)}else e.multiply(this.transform)}updateTransform(){const e=this._screen.resolution.width/this.zoom,t=this._screen.resolution.height/this.zoom,i=P(-this.x+e/2+this._xShake,-this.y+t/2+this._yShake);this.transform.reset(),this.transform.scale(this.zoom,this.zoom),this.transform.translate(i.x,i.y),this.transform.getAffineInverse(this.inverse)}debugDraw(e){}_isDoneShaking(){return!this._isShaking||this._elapsedShakeTime>=this._shakeDuration}}function gr(e){return e instanceof er}const mr={pos:E.Zero,width:10,height:10,visible:!1,action:()=>{},filter:()=>!0,repeat:-1};class _r extends Jn{constructor(e){super({x:e.pos.x,y:e.pos.y,width:e.width,height:e.height}),this.action=()=>{},this.filter=()=>!0,this.repeat=-1,e={...mr,...e},this.filter=e.filter||this.filter,this.repeat=e.repeat||this.repeat,this.action=e.action||this.action,e.target&&(this.target=e.target),this.graphics.visible=e.visible,this.body.collisionType=Ei.Passive,this.eventDispatcher=new pt,this.events.on("collisionstart",(e=>{this.filter(e.other)&&(this.emit("enter",new ht(this,e.other)),this._dispatchAction(),0===this.repeat&&this.kill())})),this.events.on("collisionend",(e=>{this.filter(e.other)&&this.emit("exit",new ut(this,e.other))}))}set target(e){this._target=e,this.filter=t=>t===e}get target(){return this._target}_initialize(e){super._initialize(e)}_dispatchAction(){0!==this.repeat&&(this.action.call(this),this.repeat--)}debugDraw(e){super.debugDraw(e),e.save(),e.translate(this.pos.x,this.pos.y);const t=this.collider.bounds,i=this.getGlobalPos();t.left=t.left-i.x,t.right=t.right-i.x,t.top=t.top-i.y,t.bottom=t.bottom-i.y,e.fillStyle=D.Violet.toString(),e.strokeStyle=D.Violet.toString(),e.fillText("Trigger",10,10),t.debugDraw(e),e.restore()}}var vr,br;(br=vr||(vr={})).Update="update",br.Draw="draw";class wr{constructor(){this.priority=0}notify(e){}}class yr{constructor(e){this.data=e,this.type="Entity Added"}}function xr(e){return!!e&&"Entity Added"===e.type}class $r{constructor(e){this.data=e,this.type="Entity Removed"}}function Cr(e){return!!e&&"Entity Removed"===e.type}class Sr{constructor(e){this._world=e,this.entities=[],this._entityIndex={},this._entitiesToRemove=[]}updateEntities(e,t){for(const i of this.entities)i.update(e.engine,t),i.active||this.removeEntity(i)}findEntitiesForRemoval(){for(const e of this.entities)e.active||this.removeEntity(e)}notify(e){vn(e)&&this._world.queryManager.addEntity(e.data.entity),wn(e)&&this._world.queryManager.removeComponent(e.data.entity,e.data.component)}addEntity(e){e.active=!0,e&&!this._entityIndex[e.id]&&(this._entityIndex[e.id]=e,this.entities.push(e),this._world.queryManager.addEntity(e),e.componentAdded$.register(this),e.componentRemoved$.register(this),e.children.forEach((e=>this.addEntity(e))),e.childrenAdded$.register({notify:e=>{this.addEntity(e)}}),e.childrenRemoved$.register({notify:e=>{this.removeEntity(e,!1)}}))}removeEntity(e,t=!0){var i;let n=0;n=e instanceof yn?e.id:e;const r=this._entityIndex[n];r&&r.active&&r.kill(),r&&t?this._entitiesToRemove.push(r):(delete this._entityIndex[n],r&&(ie(r,this.entities),this._world.queryManager.removeEntity(r),r.componentAdded$.unregister(this),r.componentRemoved$.unregister(this),r.children.forEach((e=>this.removeEntity(e,t))),r.childrenAdded$.clear(),r.childrenRemoved$.clear(),(null===(i=this._world.context)||void 0===i?void 0:i.engine)&&this._world.context.engine.stats.currFrame.actors.killed++))}processEntityRemovals(){for(const e of this._entitiesToRemove)e.active||this.removeEntity(e,!1)}processComponentRemovals(){for(const e of this.entities)e.processComponentRemoval()}getById(e){return this._entityIndex[e]}getByName(e){return this.entities.filter((t=>t.name===e))}clear(){for(const e of this.entities)this.removeEntity(e)}}const Er=e=>[...e].sort(((e,t)=>e.localeCompare(t))).join("+");class Pr extends Ni{constructor(e){super(),this._entities=[],e[0]instanceof Function?this.types=e.map((e=>(new e).type)):this.types=e}get key(){return this._key?this._key:this._key=Er(this.types)}getEntities(e){return e&&this._entities.sort(e),this._entities}addEntity(e){!ne(this._entities,e)&&this.matches(e)&&(this._entities.push(e),this.notifyAll(new yr(e)))}removeEntity(e){ie(e,this._entities)&&this.notifyAll(new $r(e))}clear(){this._entities.length=0;for(const e of this.observers)this.unregister(e)}matches(e){let t=[];t=e instanceof yn?e.types:e;let i=!0;for(const e of this.types)if(i=i&&t.indexOf(e)>-1,!i)return!1;return i}contain(e){return this.types.indexOf(e)>-1}}class kr{constructor(e){this._world=e,this._queries={}}_addQuery(e){this._queries[Er(e.types)]=e;for(const t of this._world.entityManager.entities)e.addEntity(t)}maybeRemoveQuery(e){0===e.observers.length&&(e.clear(),delete this._queries[Er(e.types)])}addEntity(e){for(const t in this._queries)this._queries[t]&&this._queries[t].addEntity(e)}removeComponent(e,t){for(const i in this._queries)this._queries[i].contain(t.type)&&this._queries[i].removeEntity(e)}removeEntity(e){for(const t in this._queries)this._queries[t].removeEntity(e)}createQuery(e){const t=this.getQuery(e);if(t)return t;const i=new Pr(e);return this._addQuery(i),i}getQuery(e){const t=Er(e);return this._queries[t]?this._queries[t]:null}}class Tr{constructor(e){this._world=e,this.systems=[],this.initialized=!1}get(e){return this.systems.find((t=>t instanceof e))}addSystem(e){if(!e.types||0===e.types.length)throw new Error("Attempted to add a System without any types");const t=this._world.queryManager.createQuery(e.types);this.systems.push(e),this.systems.sort(((e,t)=>e.priority-t.priority)),t.register(e),this.initialized&&e.initialize&&e.initialize(this._world.context)}removeSystem(e){ie(e,this.systems);const t=this._world.queryManager.getQuery(e.types);t&&(t.unregister(e),this._world.queryManager.maybeRemoveQuery(t))}initialize(){if(!this.initialized){this.initialized=!0;for(const e of this.systems)e.initialize&&e.initialize(this._world.context)}}updateSystems(e,t,i){const n=this.systems.filter((t=>t.systemType===e));for(const e of n)e.preupdate&&e.preupdate(t,i);for(const e of n){const n=this._world.queryManager.getQuery(e.types).getEntities(e.sort);if(t instanceof xs)for(const e of n)e._initialize(null==t?void 0:t.engine);e.update(n,i)}for(const e of n)e.postupdate&&e.postupdate(t,i)}clear(){for(const e of this.systems)this.removeSystem(e)}}class Ar{constructor(e){this.context=e,this.queryManager=new kr(this),this.entityManager=new Sr(this),this.systemManager=new Tr(this)}update(e,t){e===vr.Update&&this.entityManager.updateEntities(this.context,t),this.systemManager.updateSystems(e,this.context,t),this.entityManager.findEntitiesForRemoval(),this.entityManager.processComponentRemovals(),this.entityManager.processEntityRemovals()}add(e){e instanceof yn&&this.entityManager.addEntity(e),e instanceof wr&&this.systemManager.addSystem(e)}remove(e,t=!0){e instanceof yn&&this.entityManager.removeEntity(e,t),e instanceof wr&&this.systemManager.removeSystem(e)}clearEntities(){this.entityManager.clear()}clearSystems(){this.systemManager.clear()}}class Dr{static integrate(e,t,i,n){const r=n/1e3;t.vel.addEqual(i.scale(r)),e.pos.addEqual(t.vel.scale(r)).addEqual(i.scale(.5*r*r)),t.angularVelocity+=t.torque*(1/t.inertia)*r,e.rotation+=t.angularVelocity*r,e.scale.addEqual(t.scaleFactor.scale(r))}}class Rr extends wr{constructor(){super(...arguments),this.types=["ex.transform","ex.motion"],this.systemType=vr.Update,this.priority=-1}update(e,t){let i,n;for(const r of e){i=r.get(Vi),n=r.get(Ui);const e=r.get(fn);if(null==e?void 0:e.sleeping)continue;const s=n.acc.clone();(null==e?void 0:e.collisionType)===Ei.Active&&(null==e?void 0:e.useGravity)&&s.addEqual(Bi.gravity),null==e||e.captureOldTransform(),Dr.integrate(i,n,s,t)}}debugDraw(e){}}class Ir{solve(e){return this.preSolve(e),e=e.filter((e=>!e.isCanceled())),this.solveVelocity(e),this.solvePosition(e),this.postSolve(e),e}}class Mr extends Ir{preSolve(e){for(const t of e){const e=k.fromDirection(t.mtv),i=t.mtv.negate();t.colliderA.events.emit("precollision",new Ze(t.colliderA,t.colliderB,e,i)),t.colliderB.events.emit("precollision",new Ze(t.colliderB,t.colliderA,k.getOpposite(e),i.negate()))}}postSolve(e){var t,i;for(const n of e){const e=n.colliderA,r=n.colliderB,s=null===(t=e.owner)||void 0===t?void 0:t.get(fn),o=null===(i=r.owner)||void 0===i?void 0:i.get(fn);if(s&&o&&(s.collisionType===Ei.Passive||o.collisionType===Ei.Passive))continue;const a=k.fromDirection(n.mtv),l=n.mtv.negate();n.colliderA.events.emit("postcollision",new Je(n.colliderA,n.colliderB,a,l)),n.colliderB.events.emit("postcollision",new Je(n.colliderB,n.colliderA,k.getOpposite(a),l.negate()))}}solvePosition(e){var t,i;for(const n of e){if(!n.colliderA.bounds.intersect(n.colliderB.bounds))continue;let e=n.mtv;const r=n.colliderA,s=n.colliderB,o=null===(t=r.owner)||void 0===t?void 0:t.get(fn),a=null===(i=s.owner)||void 0===i?void 0:i.get(fn);if(o&&a){if(o.collisionType===Ei.Passive||a.collisionType===Ei.Passive)continue;o.collisionType===Ei.Active&&a.collisionType===Ei.Active&&(e=e.scale(.5)),o.collisionType===Ei.Active&&(o.pos.x-=e.x,o.pos.y-=e.y),a.collisionType===Ei.Active&&(a.pos.x+=e.x,a.pos.y+=e.y)}}}solveVelocity(e){var t,i;for(const n of e){const e=n.colliderA,r=n.colliderB,s=null===(t=e.owner)||void 0===t?void 0:t.get(fn),o=null===(i=r.owner)||void 0===i?void 0:i.get(fn);if(s&&o){if(s.collisionType===Ei.Passive||o.collisionType===Ei.Passive)continue;const e=n.normal,t=e.negate();if(s.collisionType===Ei.Active){const t=e.scale(e.dot(s.vel.negate()));s.vel=s.vel.add(t)}if(o.collisionType===Ei.Active){const e=t.scale(t.dot(o.vel.negate()));o.vel=o.vel.add(e)}}}}}class Lr{constructor(e,t,i){this.point=e,this.local=t,this.contact=i,this.normalImpulse=0,this.tangentImpulse=0,this.normalMass=0,this.tangentMass=0,this.aToContact=new E(0,0),this.bToContact=new E(0,0),this.update()}update(){var e,t;const i=null===(e=this.contact.colliderA.owner)||void 0===e?void 0:e.get(fn),n=null===(t=this.contact.colliderB.owner)||void 0===t?void 0:t.get(fn);if(i&&n){const e=this.contact.normal,t=this.contact.tangent;this.aToContact=this.point.sub(i.pos),this.bToContact=this.point.sub(n.pos);const r=this.aToContact.cross(e),s=this.bToContact.cross(e);this.normalMass=i.inverseMass+n.inverseMass+i.inverseInertia*r*r+n.inverseInertia*s*s;const o=this.aToContact.cross(t),a=this.bToContact.cross(t);this.tangentMass=i.inverseMass+n.inverseMass+i.inverseInertia*o*o+n.inverseInertia*a*a}return this}getRelativeVelocity(){var e,t;const i=null===(e=this.contact.colliderA.owner)||void 0===e?void 0:e.get(fn),n=null===(t=this.contact.colliderB.owner)||void 0===t?void 0:t.get(fn);if(i&&n){const e=i.vel.add(E.cross(i.angularVelocity,this.aToContact));return n.vel.add(E.cross(n.angularVelocity,this.bToContact)).sub(e)}return E.Zero}}class Br extends Ir{constructor(){super(...arguments),this.lastFrameContacts=new Map,this.idToContactConstraint=new Map}getContactConstraints(e){var t;return null!==(t=this.idToContactConstraint.get(e))&&void 0!==t?t:[]}preSolve(e){var t,i,n;for(const t of e){const e=k.fromDirection(t.mtv);t.colliderA.events.emit("precollision",new Ze(t.colliderA,t.colliderB,e,t.mtv)),t.colliderA.events.emit("beforecollisionresolve",new it(t.colliderA,t.colliderB,e,t.mtv,t)),t.colliderB.events.emit("precollision",new Ze(t.colliderB,t.colliderA,k.getOpposite(e),t.mtv.negate())),t.colliderB.events.emit("beforecollisionresolve",new it(t.colliderB,t.colliderA,k.getOpposite(e),t.mtv.negate(),t)),t.matchAwake()}const r=Array.from(this.idToContactConstraint.keys());for(const s of e){const e=r.indexOf(s.id);e>-1&&r.splice(e,1);const o=null!==(t=this.idToContactConstraint.get(s.id))&&void 0!==t?t:[];let a=0;const l=s.colliderA.owner.get(fn),c=s.colliderB.owner.get(fn);if(l&&c)for(const e of s.points){const t=s.normal,r=s.tangent,d=e.sub(l.pos),h=e.sub(c.pos),u=d.cross(t),p=h.cross(t),f=l.inverseMass+c.inverseMass+l.inverseInertia*u*u+c.inverseInertia*p*p,g=d.cross(r),m=h.cross(r),_=l.inverseMass+c.inverseMass+l.inverseInertia*g*g+c.inverseInertia*m*m;o[a]&&(null===(n=null===(i=o[a])||void 0===i?void 0:i.point)||void 0===n?void 0:n.squareDistance(e))<4?(o[a].point=e,o[a].local=s.localPoints[a]):o[a]=new Lr(e,s.localPoints[a],s),o[a].aToContact=d,o[a].bToContact=h,o[a].normalMass=f,o[a].tangentMass=_,a++}this.idToContactConstraint.set(s.id,o)}for(const e of r)this.idToContactConstraint.delete(e);if(Bi.warmStart)this.warmStart(e);else for(const t of e){const e=this.getContactConstraints(t.id);for(const t of e)t.normalImpulse=0,t.tangentImpulse=0}}postSolve(e){for(const t of e){const e=t.colliderA.owner.get(fn),i=t.colliderB.owner.get(fn);if(e&&i){if(e.collisionType===Ei.Passive||i.collisionType===Ei.Passive)continue;e.updateMotion(),i.updateMotion()}const n=k.fromDirection(t.mtv);t.colliderA.events.emit("postcollision",new Je(t.colliderA,t.colliderB,n,t.mtv)),t.colliderA.events.emit("aftercollisionresolve",new nt(t.colliderA,t.colliderB,n,t.mtv,t)),t.colliderB.events.emit("postcollision",new Je(t.colliderB,t.colliderA,k.getOpposite(n),t.mtv.negate())),t.colliderB.events.emit("aftercollisionresolve",new nt(t.colliderB,t.colliderA,k.getOpposite(n),t.mtv.negate(),t))}this.lastFrameContacts.clear();for(const t of e)this.lastFrameContacts.set(t.id,t)}warmStart(e){var t,i,n;for(const r of e){const e=null===(t=r.colliderA.owner)||void 0===t?void 0:t.get(fn),s=null===(i=r.colliderB.owner)||void 0===i?void 0:i.get(fn);if(e&&s){const t=null!==(n=this.idToContactConstraint.get(r.id))&&void 0!==n?n:[];for(const i of t)if(Bi.warmStart){const t=r.normal.scale(i.normalImpulse),n=r.tangent.scale(i.tangentImpulse),o=t.add(n);e.applyImpulse(i.point,o.negate()),s.applyImpulse(i.point,o)}else i.normalImpulse=0,i.tangentImpulse=0}}}solvePosition(e){var t,i,n;for(let r=0;r<Bi.positionIterations;r++)for(const r of e){const e=null===(t=r.colliderA.owner)||void 0===t?void 0:t.get(fn),s=null===(i=r.colliderB.owner)||void 0===i?void 0:i.get(fn);if(e&&s){if(e.collisionType===Ei.Passive||s.collisionType===Ei.Passive)continue;const t=null!==(n=this.idToContactConstraint.get(r.id))&&void 0!==n?n:[];for(const i of t){const t=r.normal,n=sn.FindContactSeparation(r,i.local),o=-5,a=z(Bi.steeringFactor*(n+Bi.slop),o,0),l=t.scale(-a/i.normalMass);e.collisionType===Ei.Active&&(e.pos=e.pos.add(l.negate().scale(e.inverseMass)),e.rotation-=i.aToContact.cross(l)*e.inverseInertia),s.collisionType===Ei.Active&&(s.pos=s.pos.add(l.scale(s.inverseMass)),s.rotation+=i.bToContact.cross(l)*s.inverseInertia)}}}}solveVelocity(e){var t,i,n;for(let r=0;r<Bi.velocityIterations;r++)for(const r of e){const e=null===(t=r.colliderA.owner)||void 0===t?void 0:t.get(fn),s=null===(i=r.colliderB.owner)||void 0===i?void 0:i.get(fn);if(e&&s){if(e.collisionType===Ei.Passive||s.collisionType===Ei.Passive)continue;const t=e.bounciness*s.bounciness,i=Math.min(e.friction,s.friction),o=null!==(n=this.idToContactConstraint.get(r.id))&&void 0!==n?n:[];for(const t of o){let n=-t.getRelativeVelocity().dot(r.tangent)/t.tangentMass;const o=i*t.normalImpulse,a=z(t.tangentImpulse+n,-o,o);n=a-t.tangentImpulse,t.tangentImpulse=a;const l=r.tangent.scale(n);e.applyImpulse(t.point,l.negate()),s.applyImpulse(t.point,l)}for(const i of o){let n=-(1+t)*i.getRelativeVelocity().dot(r.normal)/i.normalMass;const o=Math.max(i.normalImpulse+n,0);n=o-i.normalImpulse,i.normalImpulse=o;const a=r.normal.scale(n);e.applyImpulse(i.point,a.negate()),s.applyImpulse(i.point,a)}}}}}class Fr extends wr{constructor(){super(...arguments),this.types=["ex.transform","ex.motion","ex.collider"],this.systemType=vr.Update,this.priority=-1,this._realisticSolver=new Br,this._arcadeSolver=new Mr,this._processor=new Xi,this._lastFrameContacts=new Map,this._currentFrameContacts=new Map,this._trackCollider=e=>this._processor.track(e),this._untrackCollider=e=>this._processor.untrack(e)}notify(e){if(xr(e)){const t=e.data.get(cn);t.$colliderAdded.subscribe(this._trackCollider),t.$colliderRemoved.subscribe(this._untrackCollider);const i=t.get();i&&this._processor.track(i)}else{const t=e.data.get(cn),i=t.get();t&&i&&this._processor.untrack(i)}}initialize(e){this._engine=e.engine}update(e,t){var i;if(!Bi.enabled)return;let n=[];for(const t of e){const e=t.get(cn),r=null==e?void 0:e.get();e&&(null===(i=e.owner)||void 0===i?void 0:i.active)&&r&&(e.update(),r instanceof Qi?n=n.concat(r.getColliders()):n.push(r))}this._processor.update(n);const r=this._processor.broadphase(n,t);this._currentFrameContacts.clear();let s=this._processor.narrowphase(r,this._engine.debug.stats.currFrame);s=this.getSolver().solve(s),s.forEach((e=>this._currentFrameContacts.set(e.id,e))),this.runContactStartEnd(),this._lastFrameContacts.clear(),this._lastFrameContacts=new Map(this._currentFrameContacts)}getSolver(){return Bi.collisionResolutionStrategy===ki.Realistic?this._realisticSolver:this._arcadeSolver}debug(e){this._processor.debug(e)}runContactStartEnd(){for(const[e,t]of this._currentFrameContacts)if(!this._lastFrameContacts.has(e)){const e=t.colliderA,i=t.colliderB;e.events.emit("collisionstart",new rt(e,i,t)),e.events.emit("contactstart",new et(e,i,t)),i.events.emit("collisionstart",new rt(i,e,t)),i.events.emit("contactstart",new et(i,e,t))}for(const[e,t]of this._lastFrameContacts)if(!this._currentFrameContacts.has(e)){const e=t.colliderA,i=t.colliderB;e.events.emit("collisionend",new st(e,i)),e.events.emit("contactend",new tt(e,i)),i.events.emit("collisionend",new st(i,e)),i.events.emit("contactend",new tt(i,e))}}}var Or,zr,Nr,Vr,Ur,Hr;(zr=Or||(Or={})).Forward="forward",zr.Backward="backward",(Vr=Nr||(Nr={})).End="end",Vr.Loop="loop",Vr.PingPong="pingpong",Vr.Freeze="freeze";class jr extends we{constructor(e){var t,i;super(e),this.events=new pt,this.frames=[],this.strategy=Nr.Loop,this.frameDuration=100,this.timeScale=1,this._idempotencyToken=-1,this._firstTick=!0,this._currentFrame=0,this._timeLeftInFrame=0,this._direction=1,this._done=!1,this._playing=!0,this._reversed=!1,this.frames=e.frames,this.strategy=null!==(t=e.strategy)&&void 0!==t?t:this.strategy,this.frameDuration=e.totalDuration?e.totalDuration/this.frames.length:null!==(i=e.frameDuration)&&void 0!==i?i:this.frameDuration,e.reverse&&this.reverse(),this.goToFrame(0)}clone(){return new jr({frames:this.frames.map((e=>({...e}))),frameDuration:this.frameDuration,reverse:this._reversed,strategy:this.strategy,...this.cloneGraphicOptions()})}get width(){const e=this.currentFrame;return e?Math.abs(e.graphic.width*this.scale.x):0}get height(){const e=this.currentFrame;return e?Math.abs(e.graphic.height*this.scale.y):0}static fromSpriteSheet(e,t,i,n=Nr.Loop){const r=e.sprites.length-1,s=t.filter((e=>e<0||e>r));return s.length&&jr._LOGGER.warn(`Indices into SpriteSheet were provided that don't exist: ${s.join(",")} no frame will be shown`),new jr({frames:e.sprites.filter(((e,i)=>t.indexOf(i)>-1)).map((e=>({graphic:e,duration:i}))),strategy:n})}static toLegacyAnimation(e,t){const i=t.frames.map((e=>Tt.toLegacySprite(e.graphic)));return new Rt({sprites:i,loop:t.strategy===Nr.Loop,freezeFrame:t.strategy===Nr.Freeze?i.length-1:void 0,speed:t.frameDuration,engine:e})}get currentFrame(){return this._currentFrame>=0&&this._currentFrame<this.frames.length?this.frames[this._currentFrame]:null}get currentFrameIndex(){return this._currentFrame}get isPlaying(){return this._playing}reverse(){this.frames=this.frames.slice().reverse(),this._reversed=!this._reversed}get direction(){return this._reversed&&1===this._direction?Or.Backward:Or.Forward}play(){this._playing=!0}pause(){this._playing=!1,this._firstTick=!0}reset(){this._done=!1,this._firstTick=!0,this._currentFrame=0}get canFinish(){switch(this.strategy){case Nr.End:case Nr.Freeze:return!0;default:return!1}}get done(){return this._done}goToFrame(e){this._currentFrame=e,this._timeLeftInFrame=this.frameDuration;const t=this.frames[this._currentFrame];t&&!this._done&&(this._timeLeftInFrame=(null==t?void 0:t.duration)||this.frameDuration,this.events.emit("frame",t))}_nextFrame(){const e=this._currentFrame;if(this._done)return e;let t=-1;switch(this.strategy){case Nr.Loop:t=(e+1)%this.frames.length,0===t&&this.events.emit("loop",this);break;case Nr.End:t=e+1,t>=this.frames.length&&(this._done=!0,this._currentFrame=this.frames.length,this.events.emit("end",this));break;case Nr.Freeze:t=z(e+1,0,this.frames.length-1),t>=this.frames.length-1&&(this._done=!0,this.events.emit("end",this));break;case Nr.PingPong:e+this._direction>=this.frames.length&&(this._direction=-1,this.events.emit("loop",this)),e+this._direction<0&&(this._direction=1,this.events.emit("loop",this)),t=e+this._direction%this.frames.length}return t}tick(e,t=0){this._idempotencyToken!==t&&(this._idempotencyToken=t,this._playing&&(this._firstTick&&(this._firstTick=!1,this.events.emit("frame",this.currentFrame)),this._timeLeftInFrame-=e*this.timeScale,this._timeLeftInFrame<=0&&this.goToFrame(this._nextFrame())))}_drawImage(e,t,i){this.currentFrame&&this.currentFrame.graphic.draw(e,t,i)}}jr._LOGGER=v.getInstance();class Wr extends we{constructor(e){super(e),this.members=[],this.members=e.members,this._updateDimensions()}clone(){return new Wr({members:[...this.members],...this.cloneGraphicOptions()})}_updateDimensions(){let e=new I;for(const{graphic:t,pos:i}of this.members)e=t.localBounds.translate(i).combine(e);return this.width=e.width,this.height=e.height,e}get localBounds(){let e=new I;for(const{graphic:t,pos:i}of this.members)e=t.localBounds.translate(i).combine(e);return e}_isAnimationOrGroup(e){return e instanceof jr||e instanceof Wr}tick(e,t){for(const i of this.members){const n=i.graphic;this._isAnimationOrGroup(n)&&n.tick(e,t)}}reset(){for(const e of this.members){const t=e.graphic;this._isAnimationOrGroup(t)&&t.reset()}}_preDraw(e,t,i){this._updateDimensions(),super._preDraw(e,t,i)}_drawImage(e,t,i){for(const n of this.members)e.save(),e.translate(t,i),n.graphic.draw(e,n.pos.x,n.pos.y),this.showDebug&&e.debug.drawRect(0,0,this.width,this.height),e.restore()}}(Hr=Ur||(Ur={}))[Hr.Circle=0]="Circle",Hr[Hr.Rectangle=1]="Rectangle";class Gr extends yn{constructor(e,t,i,n,r,s,o,a,l,c){super(),this.position=new E(0,0),this.velocity=new E(0,0),this.acceleration=new E(0,0),this.particleRotationalVelocity=0,this.currentRotation=0,this.focus=null,this.focusAccel=0,this.opacity=1,this.beginColor=D.White,this.endColor=D.White,this.life=300,this.fadeFlag=!1,this._rRate=1,this._gRate=1,this._bRate=1,this._aRate=0,this._currentColor=D.White,this.emitter=null,this.particleSize=5,this.particleSprite=null,this.sizeRate=0,this.elapsedMultiplier=0,this.visible=!0,this.isOffscreen=!1;let d=e;if(d&&!(e instanceof Kr)){const h=e;d=h.emitter,t=h.life,i=h.opacity,r=h.endColor,n=h.beginColor,s=h.position,o=h.velocity,a=h.acceleration,l=h.startSize,c=h.endSize}this.emitter=d,this.life=t||this.life,this.opacity=i||this.opacity,this.endColor=r||this.endColor.clone(),this.beginColor=n||this.beginColor.clone(),this._currentColor=this.beginColor.clone(),this.position=(s||this.position).add(this.emitter.pos),this.velocity=o||this.velocity,this.acceleration=a||this.acceleration,this._rRate=(this.endColor.r-this.beginColor.r)/this.life,this._gRate=(this.endColor.g-this.beginColor.g)/this.life,this._bRate=(this.endColor.b-this.beginColor.b)/this.life,this._aRate=this.opacity/this.life,this.startSize=l||0,this.endSize=c||0,this.endSize>0&&this.startSize>0&&(this.sizeRate=(this.endSize-this.startSize)/this.life,this.particleSize=this.startSize),this.addComponent(this.transform=new Vi),this.addComponent(new xn((e=>this.draw(e)))),this.addComponent(this.graphics=new En),this.transform.pos=this.position,this.transform.rotation=this.currentRotation,this.transform.scale=P(1,1),this.particleSprite?(this.graphics.opacity=this.opacity,this.graphics.use(Tt.fromLegacySprite(this.particleSprite))):(this.graphics.localBounds=I.fromDimension(this.particleSize,this.particleSize,E.Half),this.graphics.onPostDraw=e=>{e.save(),this.graphics.opacity=this.opacity;const t=this._currentColor.clone();t.a=1,e.debug.drawPoint(P(0,0),{color:t,size:this.particleSize}),e.restore()})}kill(){this.emitter.removeParticle(this)}update(e,t){if(this.life=this.life-t,this.elapsedMultiplier=this.elapsedMultiplier+t,this.life<0&&this.kill(),this.fadeFlag&&(this.opacity=z(this._aRate*this.life,1e-4,1)),this.startSize>0&&this.endSize>0&&(this.particleSize=z(this.sizeRate*t+this.particleSize,Math.min(this.startSize,this.endSize),Math.max(this.startSize,this.endSize))),this._currentColor.r=z(this._currentColor.r+this._rRate*t,0,255),this._currentColor.g=z(this._currentColor.g+this._gRate*t,0,255),this._currentColor.b=z(this._currentColor.b+this._bRate*t,0,255),this._currentColor.a=z(this.opacity,1e-4,1),this.focus){const e=this.focus.sub(this.position).normalize().scale(this.focusAccel).scale(t/1e3);this.velocity=this.velocity.add(e)}else this.velocity=this.velocity.add(this.acceleration.scale(t/1e3));this.position=this.position.add(this.velocity.scale(t/1e3)),this.particleRotationalVelocity&&(this.currentRotation=(this.currentRotation+this.particleRotationalVelocity*t/1e3)%(2*Math.PI)),this.transform.pos=this.position,this.transform.rotation=this.currentRotation,this.transform.scale=P(1,1),this.graphics.opacity=this.opacity}draw(e){if(this.particleSprite)return this.particleSprite.opacity(this.opacity),void this.particleSprite.draw(e,0,0);e.save(),this._currentColor.a=z(this.opacity,1e-4,1),e.fillStyle=this._currentColor.toString(),e.beginPath(),e.arc(0,0,this.particleSize,0,2*Math.PI),e.fill(),e.closePath(),e.restore()}}class qr extends(Et(Gr)){constructor(e,t,i,n,r,s,o,a,l,c){super(e,t,i,n,r,s,o,a,l,c)}}class Kr extends Jn{constructor(e){var t,i;super({width:null!==(t=e.width)&&void 0!==t?t:0,height:null!==(i=e.height)&&void 0!==i?i:0}),this._particlesToEmit=0,this.numParticles=0,this.isEmitting=!0,this.particles=[],this.deadParticles=[],this.minVel=0,this.maxVel=0,this.acceleration=new E(0,0),this.minAngle=0,this.maxAngle=0,this.emitRate=1,this.particleLife=2e3,this.fadeFlag=!1,this.focus=null,this.focusAccel=null,this.startSize=null,this.endSize=null,this.minSize=5,this.maxSize=5,this.beginColor=D.White,this.endColor=D.White,this._og=null,this._sprite=null,this.emitterType=Ur.Rectangle,this.radius=0,this.particleRotationalVelocity=0,this.randomRotation=!1;const{x:n,y:r,pos:s,isEmitting:o,minVel:a,maxVel:l,acceleration:c,minAngle:d,maxAngle:h,emitRate:u,particleLife:p,opacity:f,fadeFlag:g,focus:m,focusAccel:_,startSize:v,endSize:b,minSize:w,maxSize:y,beginColor:x,endColor:$,particleSprite:C,emitterType:S,radius:k,particleRotationalVelocity:T,randomRotation:A,random:R}={...e};this.pos=null!=s?s:P(null!=n?n:0,null!=r?r:0),this.isEmitting=null!=o?o:this.isEmitting,this.minVel=null!=a?a:this.minVel,this.maxVel=null!=l?l:this.maxVel,this.acceleration=null!=c?c:this.acceleration,this.minAngle=null!=d?d:this.minAngle,this.maxAngle=null!=h?h:this.maxAngle,this.emitRate=null!=u?u:this.emitRate,this.particleLife=null!=p?p:this.particleLife,this.opacity=null!=f?f:this.opacity,this.fadeFlag=null!=g?g:this.fadeFlag,this.focus=null!=m?m:this.focus,this.focusAccel=null!=_?_:this.focusAccel,this.startSize=null!=v?v:this.startSize,this.endSize=null!=b?b:this.endSize,this.minSize=null!=w?w:this.minSize,this.maxSize=null!=y?y:this.maxSize,this.beginColor=null!=x?x:this.beginColor,this.endColor=null!=$?$:this.endColor,this.particleSprite=null!=C?C:this.particleSprite,this.emitterType=null!=S?S:this.emitterType,this.radius=null!=k?k:this.radius,this.particleRotationalVelocity=null!=T?T:this.particleRotationalVelocity,this.randomRotation=null!=A?A:this.randomRotation,this.body.collisionType=Ei.PreventCollision,this.random=null!=R?R:new L;for(let e=0;e<this.traits.length;e++)this.traits[e]instanceof mn&&this.traits.splice(e,1)}get opacity(){return super.graphics.opacity}set opacity(e){super.graphics.opacity=e}get particleSprite(){return this._og}set particleSprite(e){this._og=e,e&&(this._sprite=Tt.fromLegacySprite(e))}removeParticle(e){this.deadParticles.push(e)}emitParticles(e){var t;for(let i=0;i<e;i++){const e=this._createParticle();this.particles.push(e),(null===(t=null==this?void 0:this.scene)||void 0===t?void 0:t.world)&&this.scene.world.add(e)}}clearParticles(){this.particles.length=0}_createParticle(){let e=0,t=0;const i=j(this.minAngle,this.maxAngle,this.random),n=j(this.minVel,this.maxVel,this.random),r=this.startSize||j(this.minSize,this.maxSize,this.random),s=n*Math.cos(i),o=n*Math.sin(i);if(this.emitterType===Ur.Rectangle)e=j(0,this.width,this.random),t=j(0,this.height,this.random);else if(this.emitterType===Ur.Circle){const n=j(0,this.radius,this.random);e=n*Math.cos(i),t=n*Math.sin(i)}const a=new qr(this,this.particleLife,this.opacity,this.beginColor,this.endColor,new E(e,t),new E(s,o),this.acceleration,this.startSize,this.endSize);return a.fadeFlag=this.fadeFlag,a.particleSize=r,this.particleSprite&&(a.particleSprite=this.particleSprite,a.graphics.opacity=this.opacity,a.graphics.use(this._sprite)),a.particleRotationalVelocity=this.particleRotationalVelocity,this.randomRotation&&(a.currentRotation=j(0,2*Math.PI,this.random)),this.focus&&(a.focus=this.focus.add(new E(this.pos.x,this.pos.y)),a.focusAccel=this.focusAccel),a}update(e,t){var i;super.update(e,t),this.isEmitting&&(this._particlesToEmit+=this.emitRate*(t/1e3),this._particlesToEmit>1&&(this.emitParticles(Math.floor(this._particlesToEmit)),this._particlesToEmit=this._particlesToEmit-Math.floor(this._particlesToEmit)));for(let e=0;e<this.deadParticles.length;e++)ie(this.deadParticles[e],this.particles),(null===(i=null==this?void 0:this.scene)||void 0===i?void 0:i.world)&&this.scene.world.remove(this.deadParticles[e],!1);this.deadParticles.length=0}draw(e){this.particles.forEach((t=>t.draw(e)))}debugDraw(e){super.debugDraw(e),e.fillStyle=D.Black.toString(),e.fillText("Particles: "+this.particles.length,this.pos.x,this.pos.y+20),this.focus&&(e.fillRect(this.focus.x+this.pos.x,this.focus.y+this.pos.y,3,3),_i(e,D.Yellow,this.focus.x+this.pos.x,this.focus.y+this.pos.y,this.center.x,this.center.y),e.fillText("Focus",this.focus.x+this.pos.x,this.focus.y+this.pos.y))}}class Xr extends wr{constructor(){super(...arguments),this.types=["ex.transform","ex.graphics"],this.systemType=vr.Draw,this.priority=0,this._token=0,this._sortedTransforms=[],this._zHasChanged=!1,this._zIndexUpdate=()=>{this._zHasChanged=!0}}get sortedTransforms(){return this._sortedTransforms}initialize(e){this._graphicsContext=e.engine.graphicsContext,this._camera=e.camera,this._engine=e.engine}preupdate(){this._zHasChanged&&(this._sortedTransforms.sort(((e,t)=>e.z-t.z)),this._zHasChanged=!1)}notify(e){if(xr(e)){const t=e.data.get(Vi);this._sortedTransforms.push(t),t.zIndexChanged$.subscribe(this._zIndexUpdate),this._zHasChanged=!0}else{const t=e.data.get(Vi);t.zIndexChanged$.unsubscribe(this._zIndexUpdate);const i=this._sortedTransforms.indexOf(t);i>-1&&this._sortedTransforms.splice(i,1)}}update(e,t){let i;this._token++,this._graphicsContext.save(),this._camera&&this._camera.draw(this._graphicsContext);for(const e of this._sortedTransforms){const n=e.owner;if(n.hasTag("ex.offscreen"))continue;if(i=n.get(En),!i.visible)continue;e.coordPlane===Mi.Screen&&this._graphicsContext.restore(),this._graphicsContext.save(),i.update(t,this._token),this._applyTransform(n),i.onPreDraw&&i.onPreDraw(this._graphicsContext,t);const r=n instanceof qr?n.opacity:1;this._graphicsContext.opacity=i.opacity*r,this._drawGraphicsComponent(i),i.onPostDraw&&i.onPostDraw(this._graphicsContext,t),this._graphicsContext.restore(),e.coordPlane===Mi.Screen&&(this._graphicsContext.save(),this._camera&&this._camera.draw(this._graphicsContext))}this._graphicsContext.restore()}_drawGraphicsComponent(e){var t,i;if(e.visible)for(const n of e.layers.get())for(const{graphic:r,options:s}of n.graphics){let o=e.anchor,a=e.offset;(null==s?void 0:s.anchor)&&(o=s.anchor),(null==s?void 0:s.offset)&&(a=s.offset);const l=-r.width*o.x+a.x,c=-r.height*o.y+a.y;if(null==r||r.draw(this._graphicsContext,l+n.offset.x,c+n.offset.y),(null===(t=this._engine)||void 0===t?void 0:t.isDebug)&&this._engine.debug.graphics.showBounds){const e=P(l+n.offset.x,c+n.offset.y);if(r instanceof Wr)for(const t of r.members)null===(i=t.graphic)||void 0===i||i.localBounds.translate(e.add(t.pos)).draw(this._graphicsContext,this._engine.debug.graphics.boundsColor);else null==r||r.localBounds.translate(e).draw(this._graphicsContext,this._engine.debug.graphics.boundsColor)}}}_applyTransform(e){const t=e.getAncestors();for(const e of t){const t=null==e?void 0:e.get(Vi);t&&(this._graphicsContext.translate(t.pos.x,t.pos.y),this._graphicsContext.scale(t.scale.x,t.scale.y),this._graphicsContext.rotate(t.rotation))}}}class Yr extends wr{constructor(){super(...arguments),this.types=["ex.transform","ex.canvas"],this.systemType=vr.Draw,this.priority=-1}initialize(e){this._ctx=e.engine.ctx,this._engine=e.engine,this._camera=e.camera}sort(e,t){return e.get(Vi).z-t.get(Vi).z}update(e,t){var i,n,r;let s,o;this._clearScreen();const a=e.length;for(let l=0;l<a;l++){const a=null===(r=null===(n=null===(i=e[l])||void 0===i?void 0:i.graphics)||void 0===n?void 0:n.visible)||void 0===r||r,c=e[l].isOffScreen;a&&!c&&(s=e[l].get(Vi),o=e[l].get(xn),this._ctx.save(),this._pushCameraTransform(s),this._ctx.save(),this._applyTransform(e[l]),o.draw(this._ctx,t),this._ctx.restore(),this._popCameraTransform(s),this._ctx.restore()),this._engine.isDebug&&(this._ctx.save(),this._pushCameraTransform(s),this._ctx.strokeStyle="yellow",e[l].debugDraw(this._ctx),this._popCameraTransform(s),this._ctx.restore())}this._engine.isDebug&&(this._ctx.save(),this._camera.draw(this._ctx),this._camera.debugDraw(this._ctx),this._ctx.restore()),this._engine.stats.currFrame.graphics.drawnImages=ei.DrawnImagesCount,this._engine.stats.currFrame.graphics.drawCalls=ei.DrawCallCount}_applyTransform(e){const t=e.getAncestors();for(const e of t){const t=null==e?void 0:e.get(Vi);t&&(this._ctx.translate(t.pos.x,t.pos.y),this._ctx.rotate(t.rotation),this._ctx.scale(t.scale.x,t.scale.y))}}_clearScreen(){this._ctx.clearRect(0,0,this._ctx.canvas.width,this._ctx.canvas.height),this._ctx.fillStyle=this._engine.backgroundColor.toString(),this._ctx.fillRect(0,0,this._ctx.canvas.width,this._ctx.canvas.height)}_pushCameraTransform(e){e.coordPlane===Mi.World&&(this._ctx.save(),this._camera&&this._camera.draw(this._ctx))}_popCameraTransform(e){e.coordPlane===Mi.World&&this._ctx.restore()}}class Qr extends wr{constructor(){super(...arguments),this.types=["ex.transform"],this.systemType=vr.Draw,this.priority=999}initialize(e){this._graphicsContext=e.engine.graphicsContext,this._camera=e.camera,this._engine=e.engine,this._collisionSystem=e.world.systemManager.get(Fr)}update(e,t){var i,n;if(!this._engine.isDebug)return;const r=this._engine.debug.filter;let s,o;const a=this._engine.debug.entity;let l;const c=this._engine.debug.transform;let d;const h=this._engine.debug.motion;let u;const p=this._engine.debug.collider,f=this._engine.debug.physics;let g;const m=this._engine.debug.graphics;let _,v;const b=this._engine.debug.body,w=this._engine.debug.camera;for(const t of e){if(t.hasTag("offscreen"))continue;if(t instanceof qr)continue;if(r.useFilter){if(0!==r.ids.length&&!r.ids.includes(t.id))continue;if(""!==r.nameQuery&&!t.name.includes(r.nameQuery))continue}let e=E.Zero;const f=P(0,16);if(s=t.id,o=t.name,l=t.get(Vi),this._pushCameraTransform(l),this._graphicsContext.save(),this._applyTransform(t),l&&((c.showAll||c.showPosition)&&this._graphicsContext.debug.drawPoint(E.Zero,{size:4,color:c.positionColor}),(c.showAll||c.showPositionLabel)&&(this._graphicsContext.debug.drawText(`pos${l.pos.toString(2)}`,e),e=e.add(f)),(c.showAll||c.showZIndex)&&(this._graphicsContext.debug.drawText(`z(${l.z.toFixed(1)})`,e),e=e.add(f)),(a.showAll||a.showId)&&(this._graphicsContext.debug.drawText(`id(${s}) ${l.parent?"child of id("+(null===(n=null===(i=l.parent)||void 0===i?void 0:i.owner)||void 0===n?void 0:n.id)+")":""}`,e),e=e.add(f)),(a.showAll||a.showName)&&(this._graphicsContext.debug.drawText(`name(${o})`,e),e=e.add(f)),(c.showAll||c.showRotation)&&(this._graphicsContext.drawLine(E.Zero,E.fromAngle(l.rotation).scale(50).add(E.Zero),c.rotationColor,2),this._graphicsContext.debug.drawText(`rot deg(${V(l.rotation).toFixed(2)})`,e),e=e.add(f)),(c.showAll||c.showScale)&&this._graphicsContext.drawLine(E.Zero,l.scale.add(E.Zero),c.scaleColor,2)),g=t.get(En),g&&(m.showAll||m.showBounds)&&g.localBounds.draw(this._graphicsContext,m.boundsColor),_=t.get(ir),_&&(_.useTransform||this._graphicsContext.restore(),_.draw(this._graphicsContext),_.useTransform||(this._graphicsContext.save(),this._applyTransform(t))),v=t.get(fn),v&&((b.showAll||b.showCollisionGroup)&&(this._graphicsContext.debug.drawText(`collision group(${v.group.name})`,e),e=e.add(f)),(b.showAll||b.showCollisionType)&&(this._graphicsContext.debug.drawText(`collision type(${v.collisionType})`,e),e=e.add(f)),(b.showAll||b.showMass)&&(this._graphicsContext.debug.drawText(`mass(${v.mass})`,e),e=e.add(f)),(b.showAll||b.showMotion)&&(this._graphicsContext.debug.drawText(`motion(${v.sleepMotion})`,e),e=e.add(f)),(b.showAll||b.showSleeping)&&(this._graphicsContext.debug.drawText(`sleeping(${v.canSleep?v.sleeping:"cant sleep"})`,e),e=e.add(f))),this._graphicsContext.restore(),d=t.get(Ui),d&&((h.showAll||h.showVelocity)&&(this._graphicsContext.debug.drawText(`vel${d.vel.toString(2)}`,e.add(l.globalPos)),this._graphicsContext.drawLine(l.globalPos,l.globalPos.add(d.vel),h.velocityColor,2),e=e.add(f)),(h.showAll||h.showAcceleration)&&this._graphicsContext.drawLine(l.globalPos,l.globalPos.add(d.acc),h.accelerationColor,2)),u=t.get(cn),u){const e=u.get();if((p.showAll||p.showGeometry)&&e&&e.debug(this._graphicsContext,p.geometryColor),p.showAll||p.showBounds)if(e instanceof Qi){const t=e.getColliders();for(const e of t){const t=e.bounds,i=P(t.left,t.top);this._graphicsContext.debug.drawRect(i.x,i.y,t.width,t.height,{color:p.boundsColor}),(p.showAll||p.showOwner)&&this._graphicsContext.debug.drawText(`owner id(${e.owner.id})`,i)}u.bounds.draw(this._graphicsContext,p.boundsColor)}else if(e){const e=u.bounds,t=P(e.left,e.top);this._graphicsContext.debug.drawRect(t.x,t.y,e.width,e.height,{color:p.boundsColor}),(p.showAll||p.showOwner)&&this._graphicsContext.debug.drawText(`owner id(${u.owner.id})`,t)}}this._popCameraTransform(l)}if(this._graphicsContext.save(),this._camera.draw(this._graphicsContext),(f.showAll||f.showBroadphaseSpacePartitionDebug)&&this._collisionSystem.debug(this._graphicsContext),f.showAll||f.showCollisionContacts||f.showCollisionNormals)for(const[e,t]of this._engine.debug.stats.currFrame.physics.contacts){if(f.showAll||f.showCollisionContacts)for(const e of t.points)this._graphicsContext.debug.drawPoint(e,{size:5,color:f.collisionContactColor});if(f.showAll||f.showCollisionNormals)for(const e of t.points)this._graphicsContext.debug.drawLine(e,t.normal.scale(30).add(e),{color:f.collisionNormalColor})}this._graphicsContext.restore(),w&&(this._graphicsContext.save(),this._camera.draw(this._graphicsContext),(w.showAll||w.showFocus)&&this._graphicsContext.drawCircle(this._camera.pos,4,w.focusColor),(w.showAll||w.showZoom)&&this._graphicsContext.debug.drawText(`zoom(${this._camera.zoom})`,this._camera.pos),this._graphicsContext.restore()),this._graphicsContext.flush()}_applyTransform(e){const t=e.getAncestors();for(const e of t){const t=null==e?void 0:e.get(Vi);t&&(this._graphicsContext.translate(t.pos.x,t.pos.y),this._graphicsContext.scale(t.scale.x,t.scale.y),this._graphicsContext.rotate(t.rotation))}}_pushCameraTransform(e){e.coordPlane===Mi.World&&(this._graphicsContext.save(),this._camera&&this._camera.draw(this._graphicsContext))}_popCameraTransform(e){e.coordPlane===Mi.World&&this._graphicsContext.restore()}}class Zr extends wr{constructor(){super(...arguments),this.types=["ex.transform","ex.pointer"],this.systemType=vr.Update,this.priority=-1,this.overrideUseColliderShape=!1,this.overrideUseGraphicsBounds=!1,this.lastFrameEntityToPointers=new Map,this.currentFrameEntityToPointers=new Map,this._sortedTransforms=[],this._sortedEntities=[],this._zHasChanged=!1,this._zIndexUpdate=()=>{this._zHasChanged=!0}}initialize(e){this._engine=e.engine,this._receiver=this._engine.input.pointers}preupdate(){this._zHasChanged&&(this._sortedTransforms.sort(((e,t)=>t.z-e.z)),this._sortedEntities=this._sortedTransforms.map((e=>e.owner)),this._zHasChanged=!1)}notify(e){if(xr(e)){const t=e.data.get(Vi);this._sortedTransforms.push(t),this._sortedEntities.push(t.owner),t.zIndexChanged$.subscribe(this._zIndexUpdate),this._zHasChanged=!0}else{const t=e.data.get(Vi);t.zIndexChanged$.unsubscribe(this._zIndexUpdate);const i=this._sortedTransforms.indexOf(t);i>-1&&(this._sortedTransforms.splice(i,1),this._sortedEntities.splice(i,1))}}entityCurrentlyUnderPointer(e,t){return this.currentFrameEntityToPointers.has(e.id)&&this.currentFrameEntityToPointers.get(e.id).includes(t)}entityWasUnderPointer(e,t){return this.lastFrameEntityToPointers.has(e.id)&&this.lastFrameEntityToPointers.get(e.id).includes(t)}entered(e,t){return this.entityCurrentlyUnderPointer(e,t)&&!this.lastFrameEntityToPointers.has(e.id)}left(e,t){return!this.currentFrameEntityToPointers.has(e.id)&&this.entityWasUnderPointer(e,t)}addPointerToEntity(e,t){if(!this.currentFrameEntityToPointers.has(e.id))return void this.currentFrameEntityToPointers.set(e.id,[t]);const i=this.currentFrameEntityToPointers.get(e.id);this.currentFrameEntityToPointers.set(e.id,i.concat(t))}update(e){this._processPointerToEntity(this._sortedEntities),this._dispatchEvents(this._sortedEntities),this._receiver.update(),this.lastFrameEntityToPointers.clear(),this.lastFrameEntityToPointers=new Map(this.currentFrameEntityToPointers),this.currentFrameEntityToPointers.clear(),this._receiver.clear()}_processPointerToEntity(e){var t;let i,n,r,s;for(const o of e){if(i=o.get(Vi),s=null!==(t=o.get(Tn))&&void 0!==t?t:new Tn,n=o.get(cn),n&&(s.useColliderShape||this.overrideUseColliderShape)){const e=n.get();if(e)for(const[t,n]of this._receiver.currentFramePointerCoords.entries())e.contains(i.coordPlane===Mi.World?n.worldPos:n.screenPos)&&this.addPointerToEntity(o,t)}if(r=o.get(En),r&&(s.useGraphicsBounds||this.overrideUseGraphicsBounds)){const e=r.localBounds.transform(i.getGlobalMatrix());for(const[t,n]of this._receiver.currentFramePointerCoords.entries())e.contains(i.coordPlane===Mi.World?n.worldPos:n.screenPos)&&this.addPointerToEntity(o,t)}}}_processDownAndEmit(e){const t=new Map;for(const i of this._receiver.currentFrameDown)i.active&&e.active&&this.entityCurrentlyUnderPointer(e,i.pointerId)&&(e.events.emit("pointerdown",i),this._receiver.isDragStart(i.pointerId)&&e.events.emit("pointerdragstart",i)),t.set(i.pointerId,i);return t}_processUpAndEmit(e){const t=new Map;for(const i of this._receiver.currentFrameUp)i.active&&e.active&&this.entityCurrentlyUnderPointer(e,i.pointerId)&&(e.events.emit("pointerup",i),this._receiver.isDragEnd(i.pointerId)&&e.events.emit("pointerdragend",i)),t.set(i.pointerId,i);return t}_processMoveAndEmit(e){const t=new Map;for(const i of this._receiver.currentFrameMove)i.active&&e.active&&this.entityCurrentlyUnderPointer(e,i.pointerId)&&(e.events.emit("pointermove",i),this._receiver.isDragging(i.pointerId)&&e.events.emit("pointerdragmove",i)),t.set(i.pointerId,i);return t}_processEnterLeaveAndEmit(e,t){for(const i of t){if(i.active&&e.active&&this.entered(e,i.pointerId)){e.events.emit("pointerenter",i),this._receiver.isDragging(i.pointerId)&&e.events.emit("pointerdragenter",i);break}if(i.active&&e.active&&(this.left(e,i.pointerId)||this.entityCurrentlyUnderPointer(e,i.pointerId)&&"up"===i.type)){e.events.emit("pointerleave",i),this._receiver.isDragging(i.pointerId)&&e.events.emit("pointerdragleave",i);break}}}_processCancelAndEmit(e){for(const t of this._receiver.currentFrameCancel)t.active&&e.active&&this.entityCurrentlyUnderPointer(e,t.pointerId)&&e.events.emit("pointercancel",t)}_processWheelAndEmit(e){for(const t of this._receiver.currentFrameWheel)t.active&&e.active&&this.entityCurrentlyUnderPointer(e,0)&&e.events.emit("pointerwheel",t)}_dispatchEvents(e){const t=new Set(this.lastFrameEntityToPointers.keys()),i=new Set(this.currentFrameEntityToPointers.keys()),n=e.filter((e=>t.has(e.id)||i.has(e.id)));let r,s,o;for(const e of n){o=this._processDownAndEmit(e),s=this._processUpAndEmit(e),r=this._processMoveAndEmit(e);const t=[...r.values(),...o.values(),...s.values()];this._processEnterLeaveAndEmit(e,t),this._processCancelAndEmit(e),this._processWheelAndEmit(e)}}}class Jr extends wr{constructor(){super(...arguments),this.types=["ex.actions"],this.systemType=vr.Update,this.priority=-1,this._actions=[]}notify(e){if(xr(e)){const t=e.data.get(Xn);this._actions.push(t)}else{const t=e.data.get(Xn),i=this._actions.indexOf(t);i>-1&&this._actions.splice(i,1)}}update(e,t){for(const e of this._actions)e.update(t)}}class es extends Oi{constructor(e){super(),this.type="ex.isometricentity",this.elevation=0,this.map=e}}class ts extends wr{constructor(){super(...arguments),this.types=["ex.transform","ex.isometricentity"],this.systemType=vr.Update,this.priority=99}update(e,t){let i,n;for(const t of e){i=t.get(Vi),n=t.get(es);const e=Math.max(n.map.width*n.map.tileWidth,n.map.height*n.map.tileHeight)*n.elevation+i.pos.y;i.z=e}}}class is extends wr{constructor(){super(...arguments),this.types=["ex.transform","ex.graphics"],this.systemType=vr.Draw,this.priority=-1}initialize(e){this._camera=e.camera}update(e){let t,i;for(const n of e){i=n.get(En),t=n.get(Vi);const e=this._isOffscreen(t,i);e&&!n.hasTag("ex.offscreen")&&(n.eventDispatcher.emit("exitviewport",new ct(n)),n.addTag("ex.offscreen")),!e&&n.hasTag("ex.offscreen")&&(n.eventDispatcher.emit("enterviewport",new dt(n)),n.removeTag("ex.offscreen"))}}_isOffscreen(e,t){if(e.coordPlane===Mi.World){const i=t.localBounds.transform(e.getGlobalMatrix());return!this._camera.viewport.overlaps(i)}return!1}}var ns,rs,ss,os,as,ls,cs,ds,hs,us,ps,fs,gs,ms,_s,vs,bs,ws,ys=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};class xs extends mi{constructor(){super(),this._logger=v.getInstance(),this.camera=new fr,this.world=new Ar(this),this._isInitialized=!1,this._timers=[],this._cancelQueue=[],this.world.add(new Jr),this.world.add(new Rr),this.world.add(new Fr),this.world.add(new Zr),this.world.add(new ts),m.isEnabled(d.LegacyDrawing)?this.world.add(new Yr):(this.world.add(new is),this.world.add(new Xr)),this.world.add(new Qr)}get actors(){return this.world.entityManager.entities.filter((e=>e instanceof Jn))}get entities(){return this.world.entityManager.entities}get triggers(){return this.world.entityManager.entities.filter((e=>e instanceof _r))}get tileMaps(){return this.world.entityManager.entities.filter((e=>e instanceof or))}get screenElements(){return this.actors.filter((e=>e instanceof er))}get timers(){return this._timers}on(e,t){super.on(e,t)}once(e,t){super.once(e,t)}off(e,t){super.off(e,t)}onInitialize(e){}onActivate(e,t){}onDeactivate(e,t){}onPreUpdate(e,t){}onPostUpdate(e,t){}onPreDraw(e,t){}onPostDraw(e,t){}_initializeChildren(){for(const e of this.entities)e._initialize(this.engine)}get isInitialized(){return this._isInitialized}_initialize(e){this.isInitialized||(this.engine=e,this.camera._initialize(e),this.world.systemManager.initialize(),this.onInitialize.call(this,e),this._initializeChildren(),this._logger.debug("Scene.onInitialize",this,e),this.eventDispatcher.emit("initialize",new ot(e,this)),this._isInitialized=!0)}_activate(e,t){this._logger.debug("Scene.onActivate",this),this.onActivate(e,t)}_deactivate(e,t){this._logger.debug("Scene.onDeactivate",this),this.onDeactivate(e,t)}_preupdate(e,t){this.emit("preupdate",new Ne(e,t,this)),this.onPreUpdate(e,t)}_postupdate(e,t){this.emit("postupdate",new Ve(e,t,this)),this.onPostUpdate(e,t)}_predraw(e,t){this.emit("predraw",new Be(e,t,this)),this.onPreDraw(e,t)}_postdraw(e,t){this.emit("postdraw",new Fe(e,t,this)),this.onPostDraw(e,t)}update(e,t){let i,n;for(this._preupdate(e,t),i=0,n=this._cancelQueue.length;i<n;i++)this.removeTimer(this._cancelQueue[i]);this._cancelQueue.length=0;for(const e of this._timers)e.update(t);this.world.update(vr.Update,t),this.camera&&this.camera.update(e,t),this._collectActorStats(e),this._postupdate(e,t)}draw(e,t){var i;this._predraw(e,t),this.world.update(vr.Draw,t),(null===(i=this.engine)||void 0===i?void 0:i.isDebug)&&this.debugDraw(e),this._postdraw(e,t)}debugDraw(e){this.emit("predebugdraw",new Oe(e,this)),this.emit("postdebugdraw",new ze(e,this))}contains(e){return this.actors.indexOf(e)>-1}add(e){this.emit("entityadded",{target:e}),this.world.add(e),e.scene=this,e instanceof tr&&(ne(this._timers,e)||this.addTimer(e))}remove(e){e instanceof yn&&(this.emit("entityremoved",{target:e}),this.world.remove(e)),e instanceof tr&&this.removeTimer(e)}addScreenElement(e){this.add(e)}removeScreenElement(e){this.remove(e)}addTileMap(e){this.world.add(e)}removeTileMap(e){this.world.remove(e)}addTimer(e){return this._timers.push(e),e.scene=this,e}removeTimer(e){const t=this._timers.indexOf(e);return-1!==t&&this._timers.splice(t,1),e}cancelTimer(e){return this._cancelQueue.push(e),e}isTimerActive(e){return this._timers.indexOf(e)>-1&&!e.complete}isCurrentScene(){return!!this.engine&&this.engine.currentScene===this}_collectActorStats(e){const t=this.actors.filter((e=>e instanceof er));for(const i of t)e.stats.currFrame.actors.ui++;for(const t of this.actors){e.stats.currFrame.actors.alive++;for(const i of t.children)gr(i)?e.stats.currFrame.actors.ui++:e.stats.currFrame.actors.alive++}}}ys([S({message:"Will be removed in excalibur v0.26.0",alternateMethod:"ScreenElements now are normal actors with a Transform Coordinate Plane of Screen"})],xs.prototype,"screenElements",null),ys([S({message:"Will be removed in excalibur v0.26.0",alternateMethod:"Use Scene.add"})],xs.prototype,"addScreenElement",null),ys([S({message:"Will be removed in excalibur v0.26.0",alternateMethod:"Use Scene.remove"})],xs.prototype,"removeScreenElement",null),ys([S({message:"Will be removed in excalibur v0.26.0",alternateMethod:"Use Scene.add"})],xs.prototype,"addTileMap",null),ys([S({message:"Will be removed in excalibur v0.26.0",alternateMethod:"Use Scene.remove"})],xs.prototype,"removeTileMap",null),(rs=ns||(ns={})).Protanope="Protanope",rs.Deuteranope="Deuteranope",rs.Tritanope="Tritanope";class $s{constructor(e){this._shader=new Qt({vertexSource:"\n      attribute vec2 a_position;\n      attribute vec2 a_texcoord;\n      varying vec2 v_texcoord;\n\n      void main() {\n        gl_Position = vec4(a_position, 0.0, 1.0);\n        // Pass the texcoord to the fragment shader.\n        v_texcoord = a_texcoord;\n      }",fragmentSource:e}),this._shader.compile(),this._buffer=new Zt({type:"static",data:new Float32Array([-1,-1,0,0,-1,1,0,1,1,-1,1,0,1,-1,1,0,-1,1,0,1,1,1,1,1])}),this._layout=new Jt({shader:this._shader,vertexBuffer:this._buffer,attributes:[["a_position",2],["a_texcoord",2]]}),this._buffer.upload()}getShader(){return this._shader}getLayout(){return this._layout}}class Cs{constructor(e,t=!1){this._colorBlindnessMode=e,this._simulate=!1,this._simulate=t}initialize(e){this._shader=new $s("precision mediump float;\n// our texture\nuniform sampler2D u_image;\n// the texCoords passed in from the vertex shader.\nvarying vec2 v_texcoord;\n\n// color blind type\nuniform int u_type;\n\n// simulation?\nuniform bool u_simulate;\n\nvoid main() {\n  vec4 o =  texture2D(u_image, v_texcoord);\n  // RGB to LMS matrix conversion\n  float L = (17.8824 * o.r) + (43.5161 * o.g) + (4.11935 * o.b);\n  float M = (3.45565 * o.r) + (27.1554 * o.g) + (3.86714 * o.b);\n  float S = (0.0299566 * o.r) + (0.184309 * o.g) + (1.46709 * o.b);\n  // Simulate color blindness\n  float l;\n  float m;\n  float s;\n  //MODE CODE//\n  if (u_type == 0) {\n    // Protanope\n    l = 0.0 * L + 2.02344 * M + -2.52581 * S;\n    m = 0.0 * L + 1.0 * M + 0.0 * S;\n    s = 0.0 * L + 0.0 * M + 1.0 * S;;\n  } else if (u_type == 1) {\n    // Deuteranope\n    l = 1.0 * L + 0.0 * M + 0.0 * S;\n    m = 0.494207 * L + 0.0 * M + 1.24827 * S;\n    s = 0.0 * L + 0.0 * M + 1.0 * S;\n  } else if (u_type == 2) {\n    // Tritanope\n    l = 1.0 * L + 0.0 * M + 0.0 * S;\n    m = 0.0 * L + 1.0 * M + 0.0 * S;\n    s = -0.395913 * L + 0.801109 * M + 0.0 * S;\n  }\n\n  // LMS to RGB matrix conversion\n  vec4 error; // simulate the colors\n  error.r = (0.0809444479 * l) + (-0.130504409 * m) + (0.116721066 * s);\n  error.g = (-0.0102485335 * l) + (0.0540193266 * m) + (-0.113614708 * s);\n  error.b = (-0.000365296938 * l) + (-0.00412161469 * m) + (0.693511405 * s);\n  error.a = 1.0;\n  vec4 diff = o - error;\n  vec4 correction; // correct the colors\n  correction.r = 0.0;\n  correction.g =  (diff.r * 0.7) + (diff.g * 1.0);\n  correction.b =  (diff.r * 0.7) + (diff.b * 1.0);\n  correction = o + correction;\n  correction.a = o.a;\n  //SIMULATE//\n\n  // sim \n  if (u_simulate) {\n    gl_FragColor = error.rgba;\n  } else {\n    gl_FragColor = correction.rgba;\n  }\n}"),this.simulate=this._simulate,this.colorBlindnessMode=this._colorBlindnessMode}getShader(){return this._shader.getShader()}getLayout(){return this._shader.getLayout()}set colorBlindnessMode(e){if(this._colorBlindnessMode=e,this._shader){const e=this._shader.getShader();e.use(),this._colorBlindnessMode===ns.Protanope?e.setUniformInt("u_type",0):this._colorBlindnessMode===ns.Deuteranope?e.setUniformInt("u_type",1):this._colorBlindnessMode===ns.Tritanope&&e.setUniformInt("u_type",2)}}get colorBlindnessMode(){return this._colorBlindnessMode}set simulate(e){if(this._simulate=e,this._shader){const t=this._shader.getShader();t.use(),t.setUniformBoolean("u_simulate",e)}}get simulate(){return this._simulate}}class Ss{constructor(e){this._engine=e,this._colorBlindPostProcessor=new Cs(ns.Protanope)}correct(e){this._engine.graphicsContext instanceof ci&&(this.clear(),this._colorBlindPostProcessor.colorBlindnessMode=e,this._colorBlindPostProcessor.simulate=!1,this._engine.graphicsContext.addPostProcessor(this._colorBlindPostProcessor))}simulate(e){this._engine.graphicsContext instanceof ci&&(this.clear(),this._colorBlindPostProcessor.colorBlindnessMode=e,this._colorBlindPostProcessor.simulate=!0,this._engine.graphicsContext.addPostProcessor(this._colorBlindPostProcessor))}clear(){this._engine.graphicsContext.removePostProcessor(this._colorBlindPostProcessor)}}class Es{constructor(e){this.stats={currFrame:new Ps,prevFrame:new Ps},this.filter={useFilter:!1,nameQuery:"",ids:[]},this.entity={showAll:!1,showId:!0,showName:!1},this.transform={showAll:!1,showPosition:!1,showPositionLabel:!1,positionColor:D.Yellow,showZIndex:!1,showScale:!1,scaleColor:D.Green,showRotation:!1,rotationColor:D.Blue},this.graphics={showAll:!1,showBounds:!0,boundsColor:D.Yellow},this.collider={showAll:!1,showBounds:!0,boundsColor:D.Blue,showOwner:!1,showGeometry:!0,geometryColor:D.Green},this.physics={showAll:!1,showBroadphaseSpacePartitionDebug:!1,showCollisionNormals:!1,collisionNormalColor:D.Cyan,showCollisionContacts:!0,collisionContactColor:D.Red},this.motion={showAll:!1,showVelocity:!1,velocityColor:D.Yellow,showAcceleration:!1,accelerationColor:D.Red},this.body={showAll:!1,showCollisionGroup:!1,showCollisionType:!1,showSleeping:!1,showMotion:!1,showMass:!1},this.camera={showAll:!1,showFocus:!1,focusColor:D.Red,showZoom:!1},this._engine=e,this.colorBlindMode=new Ss(this._engine)}useTestClock(){const e=this._engine.clock,t=e.isRunning();e.stop();const i=e.toTestClock();return t&&i.start(),this._engine.clock=i,i}useStandardClock(){const e=this._engine.clock,t=e.isRunning();e.stop();const i=e.toStandardClock();return t&&i.start(),this._engine.clock=i,i}}class Ps{constructor(){this._id=0,this._delta=0,this._fps=0,this._actorStats={alive:0,killed:0,ui:0,get remaining(){return this.alive-this.killed},get total(){return this.remaining+this.ui}},this._durationStats={update:0,draw:0,get total(){return this.update+this.draw}},this._physicsStats=new ks,this._graphicsStats={drawCalls:0,drawnImages:0}}reset(e){e?(this.id=e.id,this.delta=e.delta,this.fps=e.fps,this.actors.alive=e.actors.alive,this.actors.killed=e.actors.killed,this.actors.ui=e.actors.ui,this.duration.update=e.duration.update,this.duration.draw=e.duration.draw,this._physicsStats.reset(e.physics),this.graphics.drawCalls=e.graphics.drawCalls,this.graphics.drawnImages=e.graphics.drawnImages):(this.id=this.delta=this.fps=0,this.actors.alive=this.actors.killed=this.actors.ui=0,this.duration.update=this.duration.draw=0,this._physicsStats.reset(),this.graphics.drawnImages=this.graphics.drawCalls=0)}clone(){const e=new Ps;return e.reset(this),e}get id(){return this._id}set id(e){this._id=e}get delta(){return this._delta}set delta(e){this._delta=e}get fps(){return this._fps}set fps(e){this._fps=e}get actors(){return this._actorStats}get duration(){return this._durationStats}get physics(){return this._physicsStats}get graphics(){return this._graphicsStats}}class ks{constructor(){this._pairs=0,this._collisions=0,this._contacts=new Map,this._fastBodies=0,this._fastBodyCollisions=0,this._broadphase=0,this._narrowphase=0}reset(e){e?(this.pairs=e.pairs,this.collisions=e.collisions,this.contacts=e.contacts,this.fastBodies=e.fastBodies,this.fastBodyCollisions=e.fastBodyCollisions,this.broadphase=e.broadphase,this.narrowphase=e.narrowphase):(this.pairs=this.collisions=this.fastBodies=0,this.fastBodyCollisions=this.broadphase=this.narrowphase=0,this.contacts.clear())}clone(){const e=new ks;return e.reset(this),e}get pairs(){return this._pairs}set pairs(e){this._pairs=e}get collisions(){return this._collisions}set collisions(e){this._collisions=e}get contacts(){return this._contacts}set contacts(e){this._contacts=e}get fastBodies(){return this._fastBodies}set fastBodies(e){this._fastBodies=e}get fastBodyCollisions(){return this._fastBodyCollisions}set fastBodyCollisions(e){this._fastBodyCollisions=e}get broadphase(){return this._broadphase}set broadphase(e){this._broadphase=e}get narrowphase(){return this._narrowphase}set narrowphase(e){this._narrowphase=e}}(os=ss||(ss={})).Canvas="Canvas",os.Document="Document",(ls=as||(as={})).Num0="Numpad0",ls.Num1="Numpad1",ls.Num2="Numpad2",ls.Num3="Numpad3",ls.Num4="Numpad4",ls.Num5="Numpad5",ls.Num6="Numpad6",ls.Num7="Numpad7",ls.Num8="Numpad8",ls.Num9="Numpad9",ls.NumAdd="NumpadAdd",ls.NumSubtract="NumpadSubtract",ls.NumMultiply="NumpadMultiply",ls.NumDivide="NumpadDivide",ls.NumDecimal="NumpadDecimal",ls.Numpad0="Numpad0",ls.Numpad1="Numpad1",ls.Numpad2="Numpad2",ls.Numpad3="Numpad3",ls.Numpad4="Numpad4",ls.Numpad5="Numpad5",ls.Numpad6="Numpad6",ls.Numpad7="Numpad7",ls.Numpad8="Numpad8",ls.Numpad9="Numpad9",ls.NumpadAdd="NumpadAdd",ls.NumpadSubtract="NumpadSubtract",ls.NumpadMultiply="NumpadMultiply",ls.NumpadDivide="NumpadDivide",ls.NumpadDecimal="NumpadDecimal",ls.NumLock="NumLock",ls.ShiftLeft="ShiftLeft",ls.ShiftRight="ShiftRight",ls.AltLeft="AltLeft",ls.AltRight="AltRight",ls.ControlLeft="ControlLeft",ls.ControlRight="ControlRight",ls.MetaLeft="MetaLeft",ls.MetaRight="MetaRight",ls.Key0="Digit0",ls.Key1="Digit1",ls.Key2="Digit2",ls.Key3="Digit3",ls.Key4="Digit4",ls.Key5="Digit5",ls.Key6="Digit6",ls.Key7="Digit7",ls.Key8="Digit8",ls.Key9="Digit9",ls.Digit0="Digit0",ls.Digit1="Digit1",ls.Digit2="Digit2",ls.Digit3="Digit3",ls.Digit4="Digit4",ls.Digit5="Digit5",ls.Digit6="Digit6",ls.Digit7="Digit7",ls.Digit8="Digit8",ls.Digit9="Digit9",ls.F1="F1",ls.F2="F2",ls.F3="F3",ls.F4="F4",ls.F5="F5",ls.F6="F6",ls.F7="F7",ls.F8="F8",ls.F9="F9",ls.F10="F10",ls.F11="F11",ls.F12="F12",ls.A="KeyA",ls.B="KeyB",ls.C="KeyC",ls.D="KeyD",ls.E="KeyE",ls.F="KeyF",ls.G="KeyG",ls.H="KeyH",ls.I="KeyI",ls.J="KeyJ",ls.K="KeyK",ls.L="KeyL",ls.M="KeyM",ls.N="KeyN",ls.O="KeyO",ls.P="KeyP",ls.Q="KeyQ",ls.R="KeyR",ls.S="KeyS",ls.T="KeyT",ls.U="KeyU",ls.V="KeyV",ls.W="KeyW",ls.X="KeyX",ls.Y="KeyY",ls.Z="KeyZ",ls.KeyA="KeyA",ls.KeyB="KeyB",ls.KeyC="KeyC",ls.KeyD="KeyD",ls.KeyE="KeyE",ls.KeyF="KeyF",ls.KeyG="KeyG",ls.KeyH="KeyH",ls.KeyI="KeyI",ls.KeyJ="KeyJ",ls.KeyK="KeyK",ls.KeyL="KeyL",ls.KeyM="KeyM",ls.KeyN="KeyN",ls.KeyO="KeyO",ls.KeyP="KeyP",ls.KeyQ="KeyQ",ls.KeyR="KeyR",ls.KeyS="KeyS",ls.KeyT="KeyT",ls.KeyU="KeyU",ls.KeyV="KeyV",ls.KeyW="KeyW",ls.KeyX="KeyX",ls.KeyY="KeyY",ls.KeyZ="KeyZ",ls.Semicolon="Semicolon",ls.Quote="Quote",ls.Comma="Comma",ls.Minus="Minus",ls.Period="Period",ls.Slash="Slash",ls.Equal="Equal",ls.BracketLeft="BracketLeft",ls.Backslash="Backslash",ls.BracketRight="BracketRight",ls.Backquote="Backquote",ls.Up="ArrowUp",ls.Down="ArrowDown",ls.Left="ArrowLeft",ls.Right="ArrowRight",ls.ArrowUp="ArrowUp",ls.ArrowDown="ArrowDown",ls.ArrowLeft="ArrowLeft",ls.ArrowRight="ArrowRight",ls.Space="Space",ls.Backspace="Backspace",ls.Delete="Delete",ls.Esc="Escape",ls.Escape="Escape",ls.Enter="Enter",ls.NumpadEnter="NumpadEnter",ls.ContextMenu="ContextMenu";class Ts extends Ae{constructor(e,t,i){super(),this.key=e,this.value=t,this.originalEvent=i}}class As extends mi{constructor(){super(),this._keys=[],this._keysUp=[],this._keysDown=[],this._handleKeyDown=e=>{const t=e.code;if(-1===this._keys.indexOf(t)){this._keys.push(t),this._keysDown.push(t);const i=new Ts(t,e.key,e);this.eventDispatcher.emit("down",i),this.eventDispatcher.emit("press",i)}},this._handleKeyUp=e=>{const t=e.code,i=this._keys.indexOf(t);this._keys.splice(i,1),this._keysUp.push(t);const n=new Ts(t,e.key,e);this.eventDispatcher.emit("up",n),this.eventDispatcher.emit("release",n)}}on(e,t){super.on(e,t)}init(e){if(!e)try{const t=()=>{};window.top.addEventListener("blur",t),window.top.removeEventListener("blur",t),e=window.top}catch(t){e=window,v.getInstance().warn("Failed to bind to keyboard events to top frame. If you are trying to embed Excalibur in a cross-origin iframe, keyboard events will not fire.")}e.addEventListener("blur",(()=>{this._keys.length=0})),e.addEventListener("keyup",this._handleKeyUp),e.addEventListener("keydown",this._handleKeyDown)}update(){this._keysDown.length=0,this._keysUp.length=0;for(let e=0;e<this._keys.length;e++)this.eventDispatcher.emit("hold",new Ts(this._keys[e]))}getKeys(){return this._keys}wasPressed(e){return this._keysDown.indexOf(e)>-1}isHeld(e){return this._keys.indexOf(e)>-1}wasReleased(e){return this._keysUp.indexOf(e)>-1}triggerEvent(e,t,i){"down"===e&&this._handleKeyDown(new KeyboardEvent("keydown",{code:t,key:null!=i?i:null})),"up"===e&&this._handleKeyUp(new KeyboardEvent("keyup",{code:t,key:null!=i?i:null}))}}class Ds extends mi{constructor(){super(),this.enabled=!1,this.supported=!!navigator.getGamepads,this._gamePadTimeStamps=[0,0,0,0],this._oldPads=[],this._pads=[],this._initSuccess=!1,this._navigator=navigator,this._minimumConfiguration=null}init(){this.supported&&(this._initSuccess||(this._oldPads=this._clonePads(this._navigator.getGamepads()),this._oldPads.length&&this._oldPads[0]&&(this._initSuccess=!0)))}setMinimumGamepadConfiguration(e){this._enableAndUpdate(),this._minimumConfiguration=e}_enableAndUpdate(){this.enabled||(this.enabled=!0,this.update())}_isGamepadValid(e){if(!this._minimumConfiguration)return!0;if(!e)return!1;const t=e.axes.filter((e=>!0)).length,i=e.buttons.filter((e=>!0)).length;return t>=this._minimumConfiguration.axis&&i>=this._minimumConfiguration.buttons&&e.connected}on(e,t){this._enableAndUpdate(),super.on(e,t)}off(e,t){this._enableAndUpdate(),super.off(e,t)}update(){if(!this.enabled||!this.supported)return;this.init();const e=this._navigator.getGamepads();for(let t=0;t<e.length;t++){if(!e[t]){const e=this.at(t);e.connected&&this.eventDispatcher.emit("disconnect",new We(t,e)),e.connected=!1;continue}if(!this.at(t).connected&&this._isGamepadValid(e[t])&&this.eventDispatcher.emit("connect",new je(t,this.at(t))),this.at(t).connected=!0,e[t].timestamp&&e[t].timestamp===this._gamePadTimeStamps[t])continue;let i,n,r,s,o;for(i in this._gamePadTimeStamps[t]=e[t].timestamp,this.at(t).navigatorGamepad=e[t],cs)n=cs[i],"number"==typeof n&&e[t].buttons[n]&&(o=e[t].buttons[n].value,o!==this._oldPads[t].getButton(n)&&(e[t].buttons[n].pressed?(this.at(t).updateButton(n,o),this.at(t).eventDispatcher.emit("button",new Ge(n,o,this.at(t)))):this.at(t).updateButton(n,0)));for(r in hs)s=hs[r],"number"==typeof s&&(o=e[t].axes[s],o!==this._oldPads[t].getAxes(s)&&(this.at(t).updateAxes(s,o),this.at(t).eventDispatcher.emit("axis",new qe(s,o,this.at(t)))));this._oldPads[t]=this._clonePad(e[t])}}at(e){if(this._enableAndUpdate(),e>=this._pads.length)for(let t=this._pads.length-1,i=e;t<i;t++)this._pads.push(new Rs),this._oldPads.push(new Rs);return this._pads[e]}getValidGamepads(){this._enableAndUpdate();const e=[];for(let t=0;t<this._pads.length;t++)this._isGamepadValid(this.at(t).navigatorGamepad)&&this.at(t).connected&&e.push(this.at(t));return e}count(){return this._pads.filter((e=>e.connected)).length}_clonePads(e){const t=[];for(let i=0,n=e.length;i<n;i++)t.push(this._clonePad(e[i]));return t}_clonePad(e){let t,i;const n=new Rs;if(!e)return n;for(t=0,i=e.buttons.length;t<i;t++)e.buttons[t]&&n.updateButton(t,e.buttons[t].value);for(t=0,i=e.axes.length;t<i;t++)n.updateAxes(t,e.axes[t]);return n}}Ds.MinAxisMoveThreshold=.05;class Rs extends mi{constructor(){super(),this.connected=!1,this._buttons=new Array(16),this._axes=new Array(4);for(let e=0;e<this._buttons.length;e++)this._buttons[e]=0;for(let e=0;e<this._axes.length;e++)this._axes[e]=0}isButtonPressed(e,t=1){return this._buttons[e]>=t}getButton(e){return this._buttons[e]}getAxes(e){const t=this._axes[e];return Math.abs(t)<Ds.MinAxisMoveThreshold?0:t}updateButton(e,t){this._buttons[e]=t}updateAxes(e,t){this._axes[e]=t}}(ds=cs||(cs={}))[ds.Face1=0]="Face1",ds[ds.Face2=1]="Face2",ds[ds.Face3=2]="Face3",ds[ds.Face4=3]="Face4",ds[ds.LeftBumper=4]="LeftBumper",ds[ds.RightBumper=5]="RightBumper",ds[ds.LeftTrigger=6]="LeftTrigger",ds[ds.RightTrigger=7]="RightTrigger",ds[ds.Select=8]="Select",ds[ds.Start=9]="Start",ds[ds.LeftStick=10]="LeftStick",ds[ds.RightStick=11]="RightStick",ds[ds.DpadUp=12]="DpadUp",ds[ds.DpadDown=13]="DpadDown",ds[ds.DpadLeft=14]="DpadLeft",ds[ds.DpadRight=15]="DpadRight",(us=hs||(hs={}))[us.LeftStickX=0]="LeftStickX",us[us.LeftStickY=1]="LeftStickY",us[us.RightStickX=2]="RightStickX",us[us.RightStickY=3]="RightStickY";class Is{constructor(e){this.nativeComponent=e,this._paused=!1,this._nativeHandlers={}}on(e,t){this._nativeHandlers[e]&&this.off(e,this._nativeHandlers[e]),this._nativeHandlers[e]=this._decorate(t),this.nativeComponent.addEventListener(e,this._nativeHandlers[e])}off(e,t){t||(t=this._nativeHandlers[e]),this.nativeComponent.removeEventListener(e,t),this._nativeHandlers[e]=null}_decorate(e){return t=>{this._paused||e(t)}}pause(){this._paused=!0}resume(){this._paused=!1}clear(){for(const e in this._nativeHandlers)this.off(e)}}class Ms{constructor(e,t){this._windowGlobal=e,this._documentGlobal=t,this._windowComponent=new Is(this._windowGlobal),this._documentComponent=new Is(this._documentGlobal)}get window(){return this._windowComponent}get document(){return this._documentComponent}pause(){this.window.pause(),this.document.pause()}resume(){this.window.resume(),this.document.resume()}clear(){this.window.clear(),this.document.clear()}}class Ls{constructor(e){this._ex=e,this._debugText=new qt}drawRect(e,t,i,n){this._ex.__ctx.save(),this._ex.__ctx.strokeStyle="red",this._ex.__ctx.strokeRect(this._ex.snapToPixel?~~e:e,this._ex.snapToPixel?~~t:t,this._ex.snapToPixel?~~i:i,this._ex.snapToPixel?~~n:n),this._ex.__ctx.restore()}drawLine(e,t,i={color:D.Black}){this._ex.__ctx.save(),this._ex.__ctx.beginPath(),this._ex.__ctx.strokeStyle=i.color.toString(),this._ex.__ctx.moveTo(this._ex.snapToPixel?~~e.x:e.x,this._ex.snapToPixel?~~e.y:e.y),this._ex.__ctx.lineTo(this._ex.snapToPixel?~~t.x:t.x,this._ex.snapToPixel?~~t.y:t.y),this._ex.__ctx.lineWidth=2,this._ex.__ctx.stroke(),this._ex.__ctx.closePath(),this._ex.__ctx.restore()}drawPoint(e,t={color:D.Black,size:5}){this._ex.__ctx.save(),this._ex.__ctx.beginPath(),this._ex.__ctx.fillStyle=t.color.toString(),this._ex.__ctx.arc(this._ex.snapToPixel?~~e.x:e.x,this._ex.snapToPixel?~~e.y:e.y,t.size,0,2*Math.PI),this._ex.__ctx.fill(),this._ex.__ctx.closePath(),this._ex.__ctx.restore()}drawText(e,t){this._debugText.write(this._ex,e,t)}}class Bs{constructor(e){this.backgroundColor=D.ExcaliburBlue,this._state=new _e,this.snapToPixel=!0,this.debug=new Ls(this);const{canvasElement:t,enableTransparency:i,snapToPixel:n,smoothing:r,backgroundColor:s}=e;this.__ctx=t.getContext("2d",{alpha:null==i||i}),this.backgroundColor=null!=s?s:this.backgroundColor,this.snapToPixel=null!=n?n:this.snapToPixel,this.smoothing=null!=r?r:this.smoothing}get width(){return this.__ctx.canvas.width}get height(){return this.__ctx.canvas.height}get opacity(){return this._state.current.opacity}set opacity(e){this._state.current.opacity=e}get smoothing(){return this.__ctx.imageSmoothingEnabled}set smoothing(e){this.__ctx.imageSmoothingEnabled=e}resetTransform(){this.__ctx.resetTransform()}updateViewport(e){}drawImage(e,t,i,n,r,s,o,a,l){if(0===n||0===r)return;if(0===a||0===l)return;if(0===e.width||0===e.height)return;this.__ctx.globalAlpha=this.opacity;const c=[e,t,i,n,r,s,o,a,l].filter((e=>void 0!==e)).map((e=>"number"==typeof e&&this.snapToPixel?~~e:e));this.__ctx.drawImage.apply(this.__ctx,c),ei.DrawCallCount++,ei.DrawnImagesCount=1}drawLine(e,t,i,n=1){this.__ctx.save(),this.__ctx.beginPath(),this.__ctx.strokeStyle=i.toString(),this.__ctx.moveTo(this.snapToPixel?~~e.x:e.x,this.snapToPixel?~~e.y:e.y),this.__ctx.lineTo(this.snapToPixel?~~t.x:t.x,this.snapToPixel?~~t.y:t.y),this.__ctx.lineWidth=n,this.__ctx.stroke(),this.__ctx.closePath(),this.__ctx.restore()}drawRectangle(e,t,i,n){this.__ctx.save(),this.__ctx.fillStyle=n.toString(),this.__ctx.fillRect(this.snapToPixel?~~e.x:e.x,this.snapToPixel?~~e.y:e.y,this.snapToPixel?~~t:t,this.snapToPixel?~~i:i),this.__ctx.restore()}drawCircle(e,t,i,n,r){this.__ctx.save(),this.__ctx.beginPath(),n&&(this.__ctx.strokeStyle=n.toString()),r&&(this.__ctx.lineWidth=r),this.__ctx.fillStyle=i.toString(),this.__ctx.arc(this.snapToPixel?~~e.x:e.x,this.snapToPixel?~~e.y:e.y,t,0,2*Math.PI),this.__ctx.fill(),n&&this.__ctx.stroke(),this.__ctx.closePath(),this.__ctx.restore()}save(){this.__ctx.save()}restore(){this.__ctx.restore()}translate(e,t){this.__ctx.translate(this.snapToPixel?~~e:e,this.snapToPixel?~~t:t)}rotate(e){this.__ctx.rotate(e)}scale(e,t){this.__ctx.scale(e,t)}getTransform(){throw new Error("Not implemented")}multiply(e){this.__ctx.setTransform(this.__ctx.getTransform().multiply(e.toDOMMatrix()))}addPostProcessor(e){throw Error("Not implemented")}removePostProcessor(e){throw Error("Not implemented")}clearPostProcessors(){throw Error("Not implemented")}beginDrawLifecycle(){}endDrawLifecycle(){}clear(){this.__ctx.clearRect(0,0,this.width,this.height),this.__ctx.fillStyle=this.backgroundColor.toString(),this.__ctx.fillRect(0,0,this.width,this.height),ei.clear()}flush(){}}class Fs{constructor(e,t,i){this.worldPos=e,this.pagePos=t,this.screenPos=i}static fromPagePosition(e,t,i){let n,r,s,o;3===arguments.length?(n=e,r=t,s=new E(n,r),o=i):(s=e,n=s.x,r=s.y,o=t);const a=o.screen.pageToScreenCoordinates(s),l=o.screen.screenToWorldCoordinates(a);return new Fs(l,s,a)}}class Os{constructor(e,t,i,n,r,s){this.type=e,this.pointerId=t,this.button=i,this.pointerType=n,this.coordinates=r,this.nativeEvent=s,this.active=!0}cancel(){this.active=!1}get pagePos(){return this.coordinates.pagePos}get screenPos(){return this.coordinates.screenPos}get worldPos(){return this.coordinates.worldPos}}class zs{constructor(e,t,i,n,r,s,o,a,l,c,d,h){this.x=e,this.y=t,this.pageX=i,this.pageY=n,this.screenX=r,this.screenY=s,this.index=o,this.deltaX=a,this.deltaY=l,this.deltaZ=c,this.deltaMode=d,this.ev=h,this.active=!0}cancel(){this.active=!1}}class Ns extends mi{constructor(){super(),this.lastPagePos=E.Zero,this.lastScreenPos=E.Zero,this.lastWorldPos=E.Zero,this._onPointerMove=e=>{this.lastPagePos=new E(e.pagePos.x,e.pagePos.y),this.lastScreenPos=new E(e.screenPos.x,e.screenPos.y),this.lastWorldPos=new E(e.worldPos.x,e.worldPos.y)},this._onPointerDown=e=>{this.lastPagePos=new E(e.pagePos.x,e.pagePos.y),this.lastScreenPos=new E(e.screenPos.x,e.screenPos.y),this.lastWorldPos=new E(e.worldPos.x,e.worldPos.y)},this.on("move",this._onPointerMove),this.on("down",this._onPointerDown)}on(e,t){super.on(e,t)}once(e,t){super.once(e,t)}off(e,t){super.off(e,t)}}(fs=ps||(ps={})).Pixel="Pixel",fs.Line="Line",fs.Page="Page",(ms=gs||(gs={}))[ms.NoButton=-1]="NoButton",ms[ms.Left=0]="Left",ms[ms.Middle=1]="Middle",ms[ms.Right=2]="Right",ms[ms.Unknown=3]="Unknown",(vs=_s||(_s={})).Left="Left",vs.Middle="Middle",vs.Right="Right",vs.Unknown="Unknown",vs.NoButton="NoButton",(ws=bs||(bs={})).Touch="Touch",ws.Mouse="Mouse",ws.Pen="Pen",ws.Unknown="Unknown";class Vs extends mi{constructor(e,t){super(),this.target=e,this.engine=t,this.primary=new Ns,this._activeNativePointerIdsToNormalized=new Map,this.lastFramePointerCoords=new Map,this.currentFramePointerCoords=new Map,this.currentFramePointerDown=new Map,this.lastFramePointerDown=new Map,this.currentFrameDown=[],this.currentFrameUp=[],this.currentFrameMove=[],this.currentFrameCancel=[],this.currentFrameWheel=[],this._pointers=[this.primary],this._boundHandle=this._handle.bind(this),this._boundWheel=this._handleWheel.bind(this)}at(e){if(e>=this._pointers.length)for(let t=this._pointers.length-1,i=e;t<i;t++)this._pointers.push(new Ns);return this._pointers[e]}count(){return this._pointers.length}isDown(e){var t;return null!==(t=this.currentFramePointerDown.get(e))&&void 0!==t&&t}wasDown(e){var t;return null!==(t=this.lastFramePointerDown.get(e))&&void 0!==t&&t}isDragging(e){return this.isDown(e)}isDragStart(e){return this.isDown(e)&&!this.wasDown(e)}isDragEnd(e){return!this.isDown(e)&&this.wasDown(e)}on(e,t){super.on(e,t)}once(e,t){super.once(e,t)}off(e,t){super.off(e,t)}update(){this.lastFramePointerDown=new Map(this.currentFramePointerDown),this.lastFramePointerCoords=new Map(this.currentFramePointerCoords);for(const e of this.currentFrameDown)this.emit("down",e),this.at(e.pointerId).emit("down",e),this.primary.emit("pointerdown",e);for(const e of this.currentFrameUp)this.emit("up",e),this.at(e.pointerId).emit("up",e);for(const e of this.currentFrameMove)this.emit("move",e),this.at(e.pointerId).emit("move",e);for(const e of this.currentFrameCancel)this.emit("cancel",e),this.at(e.pointerId).emit("cancel",e);for(const e of this.currentFrameWheel)this.emit("wheel",e),this.primary.emit("pointerwheel",e)}clear(){for(const e of this.currentFrameUp){this.currentFramePointerCoords.delete(e.pointerId);const t=this._activeNativePointerIdsToNormalized.entries();for(const[i,n]of t)n===e.pointerId&&this._activeNativePointerIdsToNormalized.delete(i)}this.currentFrameDown.length=0,this.currentFrameUp.length=0,this.currentFrameMove.length=0,this.currentFrameCancel.length=0,this.currentFrameWheel.length=0}init(){this.target===this.engine.canvas?this.engine.canvas.style.touchAction="none":document.body.style.touchAction="none",window.PointerEvent?(this.target.addEventListener("pointerdown",this._boundHandle),this.target.addEventListener("pointerup",this._boundHandle),this.target.addEventListener("pointermove",this._boundHandle),this.target.addEventListener("pointercancel",this._boundHandle)):(this.target.addEventListener("touchstart",this._boundHandle),this.target.addEventListener("touchend",this._boundHandle),this.target.addEventListener("touchmove",this._boundHandle),this.target.addEventListener("touchcancel",this._boundHandle),this.target.addEventListener("mousedown",this._boundHandle),this.target.addEventListener("mouseup",this._boundHandle),this.target.addEventListener("mousemove",this._boundHandle));const e={passive:!(this.engine.pageScrollPreventionMode===Gs.All||this.engine.pageScrollPreventionMode===Gs.Canvas)};"onwheel"in document.createElement("div")?this.target.addEventListener("wheel",this._boundWheel,e):void 0!==document.onmousewheel?this.target.addEventListener("mousewheel",this._boundWheel,e):this.target.addEventListener("MozMousePixelScroll",this._boundWheel,e)}detach(){window.PointerEvent?(this.target.removeEventListener("pointerdown",this._boundHandle),this.target.removeEventListener("pointerup",this._boundHandle),this.target.removeEventListener("pointermove",this._boundHandle),this.target.removeEventListener("pointercancel",this._boundHandle)):(this.target.removeEventListener("touchstart",this._boundHandle),this.target.removeEventListener("touchend",this._boundHandle),this.target.removeEventListener("touchmove",this._boundHandle),this.target.removeEventListener("touchcancel",this._boundHandle),this.target.removeEventListener("mousedown",this._boundHandle),this.target.removeEventListener("mouseup",this._boundHandle),this.target.removeEventListener("mousemove",this._boundHandle)),"onwheel"in document.createElement("div")?this.target.removeEventListener("wheel",this._boundWheel):void 0!==document.onmousewheel?this.target.addEventListener("mousewheel",this._boundWheel):this.target.addEventListener("MozMousePixelScroll",this._boundWheel)}_normalizePointerId(e){this._activeNativePointerIdsToNormalized.set(e,-1);const t=Array.from(this._activeNativePointerIdsToNormalized.keys()).sort(((e,t)=>e-t)).findIndex((t=>t===e));return this._activeNativePointerIdsToNormalized.set(e,t),t}_handle(e){e.preventDefault();const t=new Map;let i,n;if(r=e,globalThis.TouchEvent&&r instanceof globalThis.TouchEvent){i=_s.Unknown,n=bs.Touch;for(let i=0;i<e.changedTouches.length;i++){const n=e.changedTouches[i],r=Fs.fromPagePosition(n.pageX,n.pageY,this.engine),s=i+1,o=this._normalizePointerId(s);this.currentFramePointerCoords.set(o,r),t.set(o,r)}}else{i=this._nativeButtonToPointerButton(e.button),n=bs.Mouse;const r=Fs.fromPagePosition(e.pageX,e.pageY,this.engine);let s=1;(function(e){return globalThis.PointerEvent&&e instanceof globalThis.PointerEvent})(e)&&(s=e.pointerId,n=this._stringToPointerType(e.pointerType));const o=this._normalizePointerId(s);this.currentFramePointerCoords.set(o,r),t.set(o,r)}var r;for(const[r,s]of t.entries())switch(e.type){case"mousedown":case"pointerdown":case"touchstart":this.currentFrameDown.push(new Os("down",r,i,n,s,e)),this.currentFramePointerDown.set(r,!0);break;case"mouseup":case"pointerup":case"touchend":this.currentFrameUp.push(new Os("up",r,i,n,s,e)),this.currentFramePointerDown.set(r,!1);break;case"mousemove":case"pointermove":case"touchmove":this.currentFrameMove.push(new Os("move",r,i,n,s,e));break;case"touchcancel":case"pointercancel":this.currentFrameCancel.push(new Os("cancel",r,i,n,s,e))}}_handleWheel(e){(this.engine.pageScrollPreventionMode===Gs.All||this.engine.pageScrollPreventionMode===Gs.Canvas&&e.target===this.engine.canvas)&&e.preventDefault();const t=this.engine.screen.pageToScreenCoordinates(P(e.pageX,e.pageY)),i=this.engine.screen.screenToWorldCoordinates(t),n=-.025,r=e.deltaX||e.wheelDeltaX*n||0,s=e.deltaY||e.wheelDeltaY*n||e.wheelDelta*n||e.detail||0,o=e.deltaZ||0;let a=ps.Pixel;e.deltaMode&&(1===e.deltaMode?a=ps.Line:2===e.deltaMode&&(a=ps.Page));const l=new zs(i.x,i.y,e.pageX,e.pageY,t.x,t.y,0,r,s,o,a,e);this.currentFrameWheel.push(l)}triggerEvent(e,t){const i=this.engine.screen.worldToPageCoordinates(t);window.PointerEvent?this._handle(new window.PointerEvent("pointer"+e,{pointerId:0,clientX:i.x,clientY:i.y})):this._handle(new window.MouseEvent("mouse"+e,{clientX:i.x,clientY:i.y}));const n=this.engine.currentScene.world.systemManager.get(Zr),r=this.engine.currentScene.world.queryManager.createQuery(n.types);n.update(r.getEntities())}_nativeButtonToPointerButton(e){switch(e){case gs.NoButton:return _s.NoButton;case gs.Left:return _s.Left;case gs.Middle:return _s.Middle;case gs.Right:return _s.Right;case gs.Unknown:return _s.Unknown;default:return ae(e)}}_stringToPointerType(e){switch(e){case"touch":return bs.Touch;case"mouse":return bs.Mouse;case"pen":return bs.Pen;default:return bs.Unknown}}}class Us{constructor(e){var t;this._samplePeriod=100,this._currentFrameTime=0,this._frames=0,this._previousSampleTime=0,this._beginFrameTime=0,this._fps=e.initialFps,this._samplePeriod=null!==(t=e.samplePeriod)&&void 0!==t?t:this._samplePeriod,this._currentFrameTime=1e3/e.initialFps,this._nowFn=e.nowFn,this._previousSampleTime=this._nowFn()}start(){this._beginFrameTime=this._nowFn()}end(){this._frames++;const e=this._nowFn();this._currentFrameTime=e-this._beginFrameTime,e>=this._previousSampleTime+this._samplePeriod&&(this._fps=1e3*this._frames/(e-this._previousSampleTime),this._previousSampleTime=e,this._frames=0)}get fps(){return this._fps}get instant(){return 1e3/this._currentFrameTime}}class Hs{constructor(e){var t,i,n;this._onFatalException=()=>{},this._maxFps=1/0,this._lastTime=0,this._elapsed=1,this._scheduledCbs=[],this._totalElapsed=0,this._options=e,this.tick=e.tick,this._lastTime=null!==(t=this.now())&&void 0!==t?t:0,this._maxFps=null!==(i=e.maxFps)&&void 0!==i?i:this._maxFps,this._onFatalException=null!==(n=e.onFatalException)&&void 0!==n?n:this._onFatalException,this.fpsSampler=new Us({initialFps:60,nowFn:()=>this.now()})}elapsed(){return this._elapsed}now(){return performance.now()}toTestClock(){return new Ws({...this._options,defaultUpdateMs:16.6})}toStandardClock(){return new js({...this._options})}setFatalExceptionHandler(e){this._onFatalException=e}schedule(e,t=0){const i=this.now()+t;this._scheduledCbs.push([e,i])}_runScheduledCbs(){for(let e=this._scheduledCbs.length-1;e>-1;e--)this._scheduledCbs[e][1]<=this._totalElapsed&&(this._scheduledCbs[e][0](),this._scheduledCbs.splice(e,1))}update(e){try{this.fpsSampler.start();const t=this.now();let i=t-this._lastTime||1;const n=1e3/this._maxFps;if(i>=n){let r=0;0!==n&&(r=i%n,i-=r),i>200&&(i=1),this._elapsed=e||i,this._totalElapsed+=this._elapsed,this._runScheduledCbs(),this.tick(e||i),this._lastTime=0!==n?t-r:t,this.fpsSampler.end()}}catch(e){this._onFatalException(e),this.stop()}}}class js extends Hs{constructor(e){super(e),this._running=!1}isRunning(){return this._running}start(){if(this._running)return;this._running=!0;const e=()=>{if(this._running)try{this._requestId=window.requestAnimationFrame(e),this.update()}catch(e){throw window.cancelAnimationFrame(this._requestId),e}};e()}stop(){this._running=!1}}class Ws extends Hs{constructor(e){super({...e}),this._logger=v.getInstance(),this._running=!1,this._currentTime=0,this._updateMs=e.defaultUpdateMs}now(){var e;return null!==(e=this._currentTime)&&void 0!==e?e:0}isRunning(){return this._running}start(){this._running=!0}stop(){this._running=!1}step(e){const t=null!=e?e:this._updateMs;this._running?(this.update(t),this._currentTime+=t):this._logger.warn("The clock is not running, no step will be performed")}run(e,t){for(let i=0;i<e;i++)this.step(null!=t?t:this._updateMs)}}var Gs,qs,Ks=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};g(),(qs=Gs||(Gs={}))[qs.None=0]="None",qs[qs.Canvas=1]="Canvas",qs[qs.All=2]="All";class Xs extends mi{constructor(e){var t,i,n,r;super(),this.maxFps=Number.POSITIVE_INFINITY,this._hasStarted=!1,this.scenes={},this._animations=[],this._suppressPlayButton=!1,this.pauseAudioWhenHidden=!0,this._isDebug=!1,this.debugColor=new D(255,255,255),this.enableCanvasTransparency=!0,this.onFatalException=e=>{v.getInstance().fatal(e)},this._timescale=1,this._isInitialized=!1,this._deferredGoTo=null,this._loadingComplete=!1,this._isReady=!1,this._isReadyPromise=new Promise((e=>{this._isReadyResolve=e})),this._screenShotRequests=[],e={...Xs._DEFAULT_ENGINE_OPTIONS,...e},m.freeze(),this.browser=new Ms(window,document);const s=new Si;if(!e.suppressMinimumBrowserFeatureDetection&&!(this._compatible=s.test())){const t=document.createElement("div");if(t.innerText="Sorry, your browser does not support all the features needed for Excalibur",document.body.appendChild(t),s.failedTests.forEach((function(e){const t=document.createElement("div");t.innerText="Browser feature missing "+e,document.body.appendChild(t)})),e.canvasElementId){const t=document.getElementById(e.canvasElementId);t&&t.parentElement.removeChild(t)}return}this._compatible=!0,console.log&&!e.suppressConsoleBootMessage&&(console.log(`%cPowered by Excalibur.js (v${Mo})`,"background: #176BAA; color: white; border-radius: 5px; padding: 15px; font-size: 1.5em; line-height: 80px;"),console.log("\n      /| ________________\nO|===|* >________________>\n      \\|"),console.log("Visit","http://excaliburjs.com","for more information")),e.suppressPlayButton&&(this._suppressPlayButton=!0),this._logger=v.getInstance(),this._logger.defaultLevel===u.Debug&&s.logBrowserFeatures(),this._logger.debug("Building engine..."),this.canvasElementId=e.canvasElementId,e.canvasElementId?(this._logger.debug("Using Canvas element specified: "+e.canvasElementId),this.canvas=document.getElementById(e.canvasElementId)):e.canvasElement?(this._logger.debug("Using Canvas element specified:",e.canvasElement),this.canvas=e.canvasElement):(this._logger.debug("Using generated canvas element"),this.canvas=document.createElement("canvas"));let o=null!==(t=e.displayMode)&&void 0!==t?t:di.Fixed;if(e.width&&e.height||e.viewport?(void 0===e.displayMode&&(o=di.Fixed),this._logger.debug("Engine viewport is size "+e.width+" x "+e.height)):e.displayMode||(this._logger.debug("Engine viewport is fit"),o=di.FitScreen),m.isEnabled(d.Canvas)){const t=new Bs({canvasElement:this.canvas,enableTransparency:this.enableCanvasTransparency,smoothing:e.antialiasing,backgroundColor:e.backgroundColor,snapToPixel:e.snapToPixel});this.graphicsContext=t,this.ctx=t.__ctx}else{const t=new ci({canvasElement:this.canvas,enableTransparency:this.enableCanvasTransparency,smoothing:e.antialiasing,backgroundColor:e.backgroundColor,snapToPixel:e.snapToPixel});this.graphicsContext=t,this.ctx=t.__ctx}this.screen=new pi({canvas:this.canvas,context:this.graphicsContext,antialiasing:null===(i=e.antialiasing)||void 0===i||i,browser:this.browser,viewport:null!==(n=e.viewport)&&void 0!==n?n:e.width&&e.height?{width:e.width,height:e.height}:ui.SVGA,resolution:e.resolution,displayMode:o,position:e.position,pixelRatio:e.suppressHiDPIScaling?1:null}),Pe.filtering=e.antialiasing?he.Blended:he.Pixel,e.backgroundColor&&(this.backgroundColor=e.backgroundColor.clone()),this.maxFps=null!==(r=e.maxFps)&&void 0!==r?r:this.maxFps,this.clock=new js({maxFps:this.maxFps,tick:this._mainloop.bind(this),onFatalException:e=>this.onFatalException(e)}),this.enableCanvasTransparency=e.enableCanvasTransparency,this._loader=new $i,this._loader.wireEngine(this),this.debug=new Es(this),this._initialize(e),this.rootScene=this.currentScene=new xs,this.addScene("root",this.rootScene),window.___EXCALIBUR_DEVTOOL=this}get canvasWidth(){return this.screen.canvasWidth}get halfCanvasWidth(){return this.screen.halfCanvasWidth}get canvasHeight(){return this.screen.canvasHeight}get halfCanvasHeight(){return this.screen.halfCanvasHeight}get drawWidth(){return this.screen.drawWidth}get halfDrawWidth(){return this.screen.halfDrawWidth}get drawHeight(){return this.screen.drawHeight}get halfDrawHeight(){return this.screen.halfDrawHeight}get isHiDpi(){return this.screen.isHiDpi}get stats(){return this.debug.stats}get isFullscreen(){return this.screen.isFullScreen}get displayMode(){return this.screen.displayMode}get pixelRatio(){return this.screen.pixelRatio}get isDebug(){return this._isDebug}get snapToPixel(){return this.graphicsContext.snapToPixel}set snapToPixel(e){this.graphicsContext.snapToPixel=e}on(e,t){super.on(e,t)}once(e,t){super.once(e,t)}off(e,t){super.off(e,t)}getWorldBounds(){return this.screen.getWorldBounds()}get timescale(){return this._timescale}set timescale(e){e<=0?v.getInstance().error("Cannot set engine.timescale to a value of 0 or less than 0."):this._timescale=e}playAnimation(e,t,i){this._animations.push(new Ys(e,t,i))}addTileMap(e){this.currentScene.addTileMap(e)}removeTileMap(e){this.currentScene.removeTileMap(e)}addTimer(e){return this.currentScene.addTimer(e)}removeTimer(e){return this.currentScene.removeTimer(e)}addScene(e,t){this.scenes[e]&&this._logger.warn("Scene",e,"already exists overwriting"),this.scenes[e]=t}removeScene(e){if(e instanceof xs)for(const t in this.scenes)this.scenes.hasOwnProperty(t)&&this.scenes[t]===e&&delete this.scenes[t];"string"==typeof e&&delete this.scenes[e]}add(e){2!==arguments.length?this._deferredGoTo&&this.scenes[this._deferredGoTo]?this.scenes[this._deferredGoTo].add(e):this.currentScene.add(e):this.addScene(arguments[0],arguments[1])}remove(e){e instanceof yn&&this.currentScene.remove(e),e instanceof xs&&this.removeScene(e),"string"==typeof e&&this.removeScene(e)}goToScene(e){if(this.isInitialized)if(this.scenes[e]){const t=this.currentScene,i=this.scenes[e];this._logger.debug("Going to scene:",e),this.currentScene.isInitialized&&(this.currentScene._deactivate.apply(this.currentScene,[t,i]),this.currentScene.eventDispatcher.emit("deactivate",new lt(i,this.currentScene))),this.currentScene=i,this.screen.setCurrentCamera(i.camera),this.currentScene._initialize(this),this.currentScene._activate.apply(this.currentScene,[t,i]),this.currentScene.eventDispatcher.emit("activate",new at(t,this.currentScene))}else this._logger.error("Scene",e,"does not exist!");else this._deferredGoTo=e}screenToWorldCoordinates(e){return this.screen.screenToWorldCoordinates(e)}worldToScreenCoordinates(e){return this.screen.worldToScreenCoordinates(e)}_initialize(e){this.pageScrollPreventionMode=e.scrollPreventionMode;const t=e&&e.pointerScope===ss.Document?document:this.canvas;let i,n;this.input={keyboard:new As,pointers:new Vs(t,this),gamepads:new Ds},this.input.keyboard.init(),this.input.pointers.init(),this.input.gamepads.init(),void 0!==document.hidden?(i="hidden",n="visibilitychange"):"msHidden"in document?(i="msHidden",n="msvisibilitychange"):"webkitHidden"in document&&(i="webkitHidden",n="webkitvisibilitychange"),this.browser.document.on(n,(()=>{document[i]?(this.eventDispatcher.emit("hidden",new Qe(this)),this._logger.debug("Window hidden")):(this.eventDispatcher.emit("visible",new Ye(this)),this._logger.debug("Window visible"))})),this.canvasElementId||e.canvasElement||document.body.appendChild(this.canvas)}onInitialize(e){}setAntialiasing(e){this.screen.antialiasing=e}getAntialiasing(){return this.screen.antialiasing}get isInitialized(){return this._isInitialized}_overrideInitialize(e){this.isInitialized||(this.onInitialize(e),super.emit("initialize",new ot(e,this)),this._isInitialized=!0,this._deferredGoTo?this.goToScene(this._deferredGoTo):this.goToScene("root"))}_update(e){if(!this.ready)return this._loader.update(this,e),this.input.keyboard.update(),void this.input.gamepads.update();this._preupdate(e),this.currentScene.update(this,e),this._animations=this._animations.filter((function(e){return!e.animation.isDone()})),this._postupdate(e),this.input.keyboard.update(),this.input.gamepads.update()}_preupdate(e){this.emit("preupdate",new Ne(this,e,this)),this.onPreUpdate(this,e)}onPreUpdate(e,t){}_postupdate(e){this.emit("postupdate",new Ve(this,e,this)),this.onPostUpdate(this,e)}onPostUpdate(e,t){}_draw(e){const t=this.ctx;if(this.graphicsContext.beginDrawLifecycle(),this.graphicsContext.clear(),this._predraw(t,e),!this._isReady)return this._loader.canvas.draw(this.graphicsContext,0,0),void this.graphicsContext.flush();this.graphicsContext.backgroundColor=this.backgroundColor,this.currentScene.draw(this.ctx,e);let i=0;const n=this._animations.length;for(;i<n;i++)this._animations[i].animation.draw(t,this._animations[i].x,this._animations[i].y);if(this.isDebug){this.ctx.font="Consolas",this.ctx.fillStyle=this.debugColor.toString();const e=this.input.keyboard.getKeys();for(let t=0;t<e.length;t++)this.ctx.fillText(e[t].toString()+" : "+(as[e[t]]?as[e[t]]:"Not Mapped"),100,10*t+10);this.ctx.fillText("FPS:"+this.stats.currFrame.fps.toFixed(2).toString(),10,10)}this._postdraw(t,e),this.graphicsContext.flush(),this.graphicsContext.endDrawLifecycle(),this._checkForScreenShots()}_predraw(e,t){this.emit("predraw",new Be(e,t,this)),this.onPreDraw(e,t)}onPreDraw(e,t){}_postdraw(e,t){this.emit("postdraw",new Fe(e,t,this)),this.onPostDraw(e,t)}onPostDraw(e,t){}showDebug(e){this._isDebug=e}toggleDebug(){return this._isDebug=!this._isDebug,this._isDebug}get loadingComplete(){return this._loadingComplete}get ready(){return this._isReady}isReady(){return this._isReadyPromise}async start(e){if(!this._compatible)throw new Error("Excalibur is incompatible with your browser");return e&&(this.screen.pushResolutionAndViewport(),this.screen.resolution=this.screen.viewport,this.screen.applyResolutionAndViewport(),this._loader=e,this._loader.suppressPlayButton=this._suppressPlayButton||this._loader.suppressPlayButton,this._loader.wireEngine(this)),this._logger.debug("Starting game clock..."),this.browser.resume(),this.clock.start(),this._logger.debug("Game clock started"),e&&(await this.load(this._loader),this._loadingComplete=!0,this.screen.popResolutionAndViewport(),this.screen.applyResolutionAndViewport()),this._loadingComplete=!0,this._overrideInitialize(this),this._isReady=!0,this._isReadyResolve(),this.emit("start",new Me(this)),this._isReadyPromise}_mainloop(e){this.emit("preframe",new Ue(this,this.stats.prevFrame));const t=e*this.timescale,i=this.stats.prevFrame.id+1;this.stats.currFrame.reset(),this.stats.currFrame.id=i,this.stats.currFrame.delta=t,this.stats.currFrame.fps=this.clock.fpsSampler.fps,ei.clear();const n=this.clock.now();this._update(t);const r=this.clock.now();this._draw(t);const s=this.clock.now();this.stats.currFrame.duration.update=r-n,this.stats.currFrame.duration.draw=s-r,this.stats.currFrame.graphics.drawnImages=ei.DrawnImagesCount,this.stats.currFrame.graphics.drawCalls=ei.DrawCallCount,this.emit("postframe",new He(this,this.stats.currFrame)),this.stats.prevFrame.reset(this.stats.currFrame)}static createMainLoop(e,t,i){let n=i();const r=new Us({nowFn:i,initialFps:e.maxFps===1/0?60:e.maxFps});return function s(){if(e._hasStarted)try{e._requestId=t(s),r.start(),e.emit("preframe",new Ue(e,e.stats.prevFrame));const o=i();let a=o-n||1;const l=e.maxFps===Number.POSITIVE_INFINITY?0:1e3/e.maxFps;if(a<=l)return;a>200&&(a=1);const c=a*e.timescale,d=e.stats.prevFrame.id+1;e.stats.currFrame.reset(),e.stats.currFrame.id=d,e.stats.currFrame.delta=c,e.stats.currFrame.fps=r.fps;const h=i();e._update(c);const u=i();e._draw(c);const p=i();e.stats.currFrame.duration.update=u-h,e.stats.currFrame.duration.draw=p-u,n=l>0?o-a%l:o,e.emit("postframe",new He(e,e.stats.currFrame)),r.end(),e.stats.prevFrame.reset(e.stats.currFrame)}catch(t){window.cancelAnimationFrame(e._requestId),e.stop(),e.onFatalException(t)}}}stop(){this.clock.isRunning()&&(this.emit("stop",new Le(this)),this.browser.pause(),this.clock.stop(),this._logger.debug("Game stopped"))}isPaused(){return!this.clock.isRunning()}isRunning(){return this.clock.isRunning()}screenshot(e=!1){return new Promise((t=>{this._screenShotRequests.push({preserveHiDPIResolution:e,resolve:t})}))}_checkForScreenShots(){for(const e of this._screenShotRequests){const t=e.preserveHiDPIResolution?this.canvas.width:this.screen.resolution.width,i=e.preserveHiDPIResolution?this.canvas.height:this.screen.resolution.height,n=document.createElement("canvas");n.width=t,n.height=i,n.getContext("2d").drawImage(this.canvas,0,0,t,i);const r=new Image,s=n.toDataURL("image/png");r.src=s,e.resolve(r)}this._screenShotRequests.length=0}async load(e){try{await e.load()}catch(e){await Promise.resolve()}}}Xs._DEFAULT_ENGINE_OPTIONS={width:0,height:0,enableCanvasTransparency:!0,canvasElementId:"",canvasElement:void 0,snapToPixel:!1,pointerScope:ss.Canvas,suppressConsoleBootMessage:null,suppressMinimumBrowserFeatureDetection:null,suppressHiDPIScaling:null,suppressPlayButton:null,scrollPreventionMode:Gs.Canvas,backgroundColor:D.fromHex("#2185d0")},Ks([S({message:"Will be removed in excalibur v0.26.0",alternateMethod:"Use Actor.graphics"})],Xs.prototype,"playAnimation",null);let Ys=class{constructor(e,t,i){this.animation=e,this.x=t,this.y=i}};Ys=Ks([S({message:"Will be removed in excalibur v0.26.0"})],Ys);class Qs extends Ae{constructor(e,t="MediaEvent"){super(),this.target=e,this._name=t}set bubbles(e){}get bubbles(){return!1}get _path(){return null}set _path(e){}stopPropagation(){}action(){}propagate(){}layPath(e){}}class Zs extends Qs{constructor(e,t){super(e,"NativeSoundEvent"),this.track=t}}class Js extends Qs{constructor(e,t){super(e,"NativeSoundProcessedEvent"),this._processedData=t,this.data=this._processedData}}var eo=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};class to extends Jn{constructor(e){super(e),this._font=new Yn,this._text=new Qn({text:"",font:this._font}),this.letterSpacing=0,this.caseInsensitive=!0;const{text:t,pos:i,x:n,y:r,spriteFont:s,font:o,color:a}=e;this.pos=null!=i?i:n&&r?P(n,r):this.pos,this.text=null!=t?t:this.text,this.font=null!=o?o:this.font,this.spriteFont=null!=s?s:this.spriteFont,this._text.color=null!=a?a:this.color;const l=this.get(En);l.anchor=E.Zero,l.use(this._text)}get font(){return this._font}set font(e){this._font=e,this._text.font=e}get text(){return this._text.text}set text(e){this._text.text=e}get color(){return this._text.color}set color(e){this._text&&(this._text.color=e)}get opacity(){return this._text.opacity}set opacity(e){this._text.opacity=e}get bold(){return this.font.bold}set bold(e){this.font.bold=e}get fontFamily(){return this.font.family}set fontFamily(e){this.font.family=e}get fontSize(){return this.font.size}set fontSize(e){this.font.size=e}get fontStyle(){return this.font.style}set fontStyle(e){this.font.style=e}get fontUnit(){return this.font.unit}set fontUnit(e){this.font.unit=e}get textAlign(){return this.font.textAlign}set textAlign(e){this.font.textAlign=e}get baseAlign(){return this.font.baseAlign}set baseAlign(e){this.font.baseAlign=e}get spriteFont(){return this._legacySpriteFont}set spriteFont(e){if(e){if(e instanceof jt)return this._legacySpriteFont=e,this._spriteFont=Gt.fromLegacySpriteFont(e),void(this._text.font=this._spriteFont);this._spriteFont=e,this._text.font=this._spriteFont}}_initialize(e){super._initialize(e),this._graphicsContext=e.graphicsContext}getTextWidth(){return this._text.width}setTextShadow(e,t,i){this.font.shadow={offset:P(e,t),blur:2,color:i}}useTextShadow(e){this.spriteFont&&this.spriteFont.useTextShadow(e)}clearTextShadow(){this.font.shadow=null}draw(e,t){const i=this._graphicsContext;this._text.draw(i,0,0)}}eo([S({message:"Label.bold will be removed in v0.26.0",alternateMethod:"Use Label.font.bold"})],to.prototype,"bold",null),eo([S({message:"Label.fontFamily will be removed in v0.26.0",alternateMethod:"Use Label.font.family"})],to.prototype,"fontFamily",null),eo([S({message:"Label.fontSize will be removed in v0.26.0",alternateMethod:"Use Label.font.size"})],to.prototype,"fontSize",null),eo([S({message:"Label.fontStyle will be removed in v0.26.0",alternateMethod:"Use Label.font.style"})],to.prototype,"fontStyle",null),eo([S({message:"Label.fontUnit will be removed in v0.26.0",alternateMethod:"Use Label.font.unit"})],to.prototype,"fontUnit",null),eo([S({message:"Label.textAlign will be removed in v0.26.0",alternateMethod:"Use Label.font.textAlign"})],to.prototype,"textAlign",null),eo([S({message:"Label.baseAlign will be removed in v0.26.0",alternateMethod:"Use Label.font.baseAlign"})],to.prototype,"baseAlign",null),eo([S({message:"Label.setTextShadow will be removed in v0.26.0",alternateMethod:"Use Label.font.shadow"})],to.prototype,"setTextShadow",null),eo([S({message:"Label.useTextShadow will be removed in v0.26.0",alternateMethod:"Use Label.font.shadow"})],to.prototype,"useTextShadow",null),eo([S({message:"Label.clearTextShadow will be removed in v0.26.0",alternateMethod:"Use Label.font.shadow"})],to.prototype,"clearTextShadow",null);class io extends yn{constructor(e,t,i,n){super([new Vi,new En({offset:null!=i?i:E.Zero,onPostDraw:(e,t)=>this.draw(e,t)}),new es(n)]),this.solid=!1,this._tileBounds=new I,this._graphics=[],this._colliders=[],this.x=e,this.y=t,this.map=n,this._transform=this.get(Vi),this._isometricEntityComponent=this.get(es);const r=this.map.tileWidth/2,s=this.map.tileHeight/2,o=(this.x-this.y)*r,a=(this.x+this.y)*s;this._transform.pos=P(o,a),this._isometricEntityComponent.elevation=0,this._gfx=this.get(En),this._gfx.visible=!1;const l=this.map.tileWidth,c=this.map.tileHeight,d=P(0,this.map.renderFromTopOfGraphic?c:0);this._gfx.localBounds=this._tileBounds=new I({left:-l/2,top:-c,right:l/2,bottom:c}).translate(d)}getGraphics(){return this._graphics}addGraphic(e){this._graphics.push(e),this._gfx.visible=!0,this._gfx.localBounds=this._recalculateBounds()}_recalculateBounds(){let e=this._tileBounds.clone();for(const t of this._graphics){const i=P(this.map.graphicsOffset.x-this.map.tileWidth/2,this.map.graphicsOffset.y-(this.map.renderFromTopOfGraphic?0:t.height-this.map.tileHeight));e=e.combine(t.localBounds.translate(i))}return e}removeGraphic(e){const t=this._graphics.indexOf(e);t>-1&&this._graphics.splice(t,1),this._gfx.localBounds=this._recalculateBounds()}clearGraphics(){this._graphics.length=0,this._gfx.visible=!1,this._gfx.localBounds=this._recalculateBounds()}getColliders(){return this._colliders}addCollider(e){this._colliders.push(e),this.map.flagCollidersDirty()}removeCollider(e){const t=this._colliders.indexOf(e);t>-1&&this._colliders.splice(t,1),this.map.flagCollidersDirty()}clearColliders(){this._colliders.length=0,this.map.flagCollidersDirty()}get pos(){return this.map.tileToWorld(P(this.x,this.y))}get center(){return this.pos.add(P(0,this.map.tileHeight/2))}draw(e,t){const i=this.map.tileWidth/2;e.save(),e.translate(-i,0);for(const t of this._graphics)t.draw(e,this.map.graphicsOffset.x,this.map.graphicsOffset.y-(this.map.renderFromTopOfGraphic?0:t.height-this.map.tileHeight));e.restore()}}class no extends yn{constructor(e){super([new Vi,new fn({type:Ei.Fixed}),new cn,new ir((e=>this.debug(e)),!1)],e.name),this.renderFromTopOfGraphic=!1,this.graphicsOffset=P(0,0),this._collidersDirty=!1,this._originalOffsets=new WeakMap;const{pos:t,tileWidth:i,tileHeight:n,width:r,height:s,renderFromTopOfGraphic:o,graphicsOffset:a}=e;this.transform=this.get(Vi),t&&(this.transform.pos=t),this.collider=this.get(cn),this.collider&&this.collider.set(this._composite=new Qi([])),this.renderFromTopOfGraphic=null!=o?o:this.renderFromTopOfGraphic,this.graphicsOffset=null!=a?a:this.graphicsOffset,this.tileWidth=i,this.tileHeight=n,this.width=r,this.height=s,this.tiles=new Array(r*s);for(let e=0;e<s;e++)for(let t=0;t<r;t++){const i=new io(t,e,this.graphicsOffset,this);this.tiles[t+e*r]=i,this.addChild(i)}}update(){this._collidersDirty&&(this.updateColliders(),this._collidersDirty=!1)}flagCollidersDirty(){this._collidersDirty=!0}_getOrSetColliderOriginalOffset(e){if(this._originalOffsets.has(e))return this._originalOffsets.get(e);{const t=e.offset;return this._originalOffsets.set(e,t),t}}updateColliders(){this._composite.clearColliders();for(const e of this.tiles)if(e.solid)for(const t of e.getColliders()){const i=this._getOrSetColliderOriginalOffset(t);t.offset=this.tileToWorld(P(e.x,e.y)).add(i).sub(P(this.tileWidth/2,this.tileHeight)),t.owner=this,this._composite.addCollider(t)}this.collider.update()}worldToTile(e){e=e.sub(this.transform.globalPos);const t=this.tileWidth/2,i=this.tileHeight/2;return P(~~((e.x/t+e.y/i)/2),~~((e.y/i-e.x/t)/2))}tileToWorld(e){const t=this.tileWidth/2,i=this.tileHeight/2;return P((e.x-e.y)*t,(e.x+e.y)*i).add(this.transform.pos)}getTile(e,t){return e<0||t<0||e>=this.width||t>=this.height?null:this.tiles[e+t*this.width]}getTileByPoint(e){const t=this.worldToTile(e);return this.getTile(t.x,t.y)}debug(e){for(let t=0;t<this.height+1;t++){const i=this.tileToWorld(P(0,t)),n=this.tileToWorld(P(this.width,t));e.drawLine(i,n,D.Red,2)}for(let t=0;t<this.width+1;t++){const i=this.tileToWorld(P(t,0)),n=this.tileToWorld(P(t,this.height));e.drawLine(i,n,D.Red,2)}for(const t of this.tiles)e.drawCircle(this.tileToWorld(P(t.x,t.y)),3,D.Yellow)}}class ro{static create(e,t){if(this._CURRENT_GROUP>this._MAX_GROUPS)throw new Error(`Cannot have more than ${this._MAX_GROUPS} collision groups`);if(this._GROUPS.get(e))throw new Error(`Collision group ${e} already exists`);const i=new Hi(e,this._CURRENT_BIT,void 0!==t?t:~this._CURRENT_BIT);return this._CURRENT_BIT=this._CURRENT_BIT<<1|0,this._CURRENT_GROUP++,this._GROUPS.set(e,i),i}static get groups(){return Array.from(this._GROUPS.values())}static groupByName(e){return this._GROUPS.get(e)}static reset(){this._GROUPS=new Map,this._CURRENT_BIT=this._STARTING_BIT,this._CURRENT_GROUP=1}}ro._STARTING_BIT=1,ro._MAX_GROUPS=32,ro._CURRENT_GROUP=1,ro._CURRENT_BIT=ro._STARTING_BIT,ro._GROUPS=new Map;let so=class{constructor(e){this.lineWidth=5,this.filled=!1,this._points=[],this.anchor=E.Zero,this.offset=E.Zero,this.rotation=0,this.scale=E.One,this.opacity=1,this._points=e;const t=this._points.reduce(((e,t)=>Math.min(e,t.x)),0),i=this._points.reduce(((e,t)=>Math.max(e,t.x)),0);this.drawWidth=i-t;const n=this._points.reduce(((e,t)=>Math.min(e,t.y)),0),r=this._points.reduce(((e,t)=>Math.max(e,t.y)),0);this.drawHeight=r-n,this.height=this.drawHeight,this.width=this.drawWidth}addEffect(){}removeEffect(){}clearEffects(){}reset(){}draw(e,t,i){e instanceof CanvasRenderingContext2D?this._drawWithOptions({ctx:e,x:t,y:i}):this._drawWithOptions(e)}_drawWithOptions(e){var t,i,n,r,s,o,a,l,c;const{ctx:d,x:h,y:u,rotation:p,drawWidth:f,drawHeight:g,anchor:m,offset:_,opacity:v,flipHorizontal:b,flipVertical:w}={...e,rotation:null!==(t=e.rotation)&&void 0!==t?t:this.rotation,drawWidth:null!==(i=e.drawWidth)&&void 0!==i?i:this.drawWidth,drawHeight:null!==(n=e.drawHeight)&&void 0!==n?n:this.drawHeight,flipHorizontal:null!==(r=e.flipHorizontal)&&void 0!==r?r:this.flipHorizontal,flipVertical:null!==(s=e.flipVertical)&&void 0!==s?s:this.flipVertical,anchor:null!==(o=e.anchor)&&void 0!==o?o:this.anchor,offset:null!==(a=e.offset)&&void 0!==a?a:this.offset,opacity:(null!==(l=e.opacity)&&void 0!==l?l:1)*(null!==(c=this.opacity)&&void 0!==c?c:1)},y=f*m.x+_.x+h,x=g*m.y+_.y+u;d.save(),d.translate(y,x),d.scale(this.scale.x,this.scale.y),d.rotate(p),d.beginPath(),d.lineWidth=this.lineWidth;const $=this._points[0];d.moveTo($.x,$.y);let C=0;const S=this._points.length;for(;C<S;C++)d.lineTo(this._points[C].x,this._points[C].y);d.lineTo($.x,$.y),d.closePath(),this.filled&&(d.fillStyle=this.fillColor.toString(),d.fill()),d.strokeStyle=this.lineColor.toString(),b&&(d.translate(f,0),d.scale(-1,1)),w&&(d.translate(0,g),d.scale(1,-1));const E=d.globalAlpha;d.globalAlpha=v,d.stroke(),d.globalAlpha=E,d.restore()}};so=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o}([S({message:"Polygon will be removed in v0.26.0",alternateMethod:"Use Graphics.Polygon"})],so);class oo{}function ao(e){return!!e._initialize}function lo(e){return!!e.onInitialize}function co(e){return!!e._preupdate}function ho(e){return!!e.onPreUpdate}function uo(e){return!!e.onPostUpdate}function po(e){return!!e.onPostUpdate}function fo(e){return!!e.onPreDraw}function go(e){return!!e.onPostDraw}oo.type={any:"",blob:"blob",json:"json",text:"text",document:"document",arraybuffer:"arraybuffer"};class mo{constructor(e){this._src=e,this._volume=1,this._duration=void 0,this._loop=!1,this._isPlaying=!1,this._isPaused=!1,this._audioContext=fi.create(),this._volumeNode=this._audioContext.createGain(),this._currentOffset=0,this._createNewBufferSource()}set loop(e){this._loop=e,this._instance&&(this._instance.loop=e,this._wireUpOnEnded())}get loop(){return this._loop}set volume(e){e=z(e,0,1),this._volume=e,this._isPlaying&&this._volumeNode.gain.setTargetAtTime?this._volumeNode.gain.setTargetAtTime(e,this._audioContext.currentTime,.1):this._volumeNode.gain.value=e}get volume(){return this._volume}set duration(e){this._duration=e}get duration(){return this._duration}get _playbackRate(){return this._instance?1/(this._instance.playbackRate.value||1):null}isPlaying(){return this._isPlaying}play(e=(()=>{})){return this._isPaused&&(this._resumePlayBack(),e()),this._isPlaying||(this._startPlayBack(),e()),this._playingPromise}pause(){this._isPlaying&&(this._isPaused=!0,this._isPlaying=!1,this._instance.stop(0),this._setPauseOffset())}stop(){this._isPlaying&&(this._isPlaying=!1,this._isPaused=!1,this._currentOffset=0,this._instance.stop(0),this._instance.onended||this._handleOnEnded())}_startPlayBack(){this._isPlaying=!0,this._isPaused=!1,this._playingPromise=new Promise((e=>{this._playingResolve=e})),this._instance||this._createNewBufferSource(),this._rememberStartTime(),this._volumeNode.connect(this._audioContext.destination),this._instance.start(0,0),this._currentOffset=0,this._wireUpOnEnded()}_resumePlayBack(){if(!this._isPaused)return;this._isPaused=!1,this._isPlaying=!0,this._instance.onended=null,this._createNewBufferSource();const e=this._playbackRate*this._src.duration,t=this._currentOffset%e;this._rememberStartTime(-1e3*t),this._instance.start(0,t),this._wireUpOnEnded()}_wireUpOnEnded(){this.loop||(this._instance.onended=()=>this._handleOnEnded())}_handleOnEnded(){this._isPaused||(this._isPlaying=!1,this._playingResolve(!0))}_rememberStartTime(e){this._startTime=(new Date).getTime()+(0|e)}_setPauseOffset(){this._currentOffset=((new Date).getTime()-this._startTime)*this._playbackRate/1e3}_createNewBufferSource(){this._instance=this._audioContext.createBufferSource(),this._instance.buffer=this._src,this._instance.loop=this.loop,this._instance.playbackRate.setValueAtTime(1,0),this._instance.connect(this._volumeNode)}}function _o(e){try{const t=new Audio,i=/.*\.([A-Za-z0-9]+)(?:\?[0-9]+)$/,n=e.match(i)[1];return!!t.canPlayType("audio/"+n)}catch(e){return v.getInstance().warn("Cannot determine audio support, assuming no support for the Audio Tag",e),!1}}class vo extends mi{constructor(...e){super(),this.logger=v.getInstance(),this._loop=!1,this._volume=1,this._duration=void 0,this._isStopped=!1,this._isPaused=!1,this._tracks=[],this._wasPlayingOnHidden=!1,this._audioContext=fi.create(),this._resource=new ft("",oo.type.arraybuffer);for(const t of e)if(_o(t)){this.path=t;break}this.path||(this.logger.warn("This browser does not support any of the audio files specified:",e.join(", ")),this.logger.warn("Attempting to use",e[0]),this.path=e[0])}set loop(e){this._loop=e;for(const e of this._tracks)e.loop=this._loop;this.logger.debug("Set loop for all instances of sound",this.path,"to",this._loop)}get loop(){return this._loop}set volume(e){this._volume=e;for(const e of this._tracks)e.volume=this._volume;this.emit("volumechange",new Zs(this)),this.logger.debug("Set loop for all instances of sound",this.path,"to",this._volume)}get volume(){return this._volume}get duration(){return this._duration}get instances(){return this._tracks}get path(){return this._resource.path}set path(e){this._resource.path=e}isLoaded(){return!!this.data}async load(){if(this.data)return this.data;const e=await this._resource.load(),t=await this.decodeAudio(e.slice(0));return this._duration="object"==typeof t?t.duration:void 0,this.emit("processed",new Js(this,t)),this.data=t}async decodeAudio(e){try{return await this._audioContext.decodeAudioData(e.slice(0))}catch(e){return this.logger.error("Unable to decode audio"+this.path+" this browser may not fully support this format, or the file may be corrupt, if this is an mp3 try removing id3 tags and album art from the file."),await Promise.reject()}}wireEngine(e){e&&(this._engine=e,this._engine.on("hidden",(()=>{e.pauseAudioWhenHidden&&this.isPlaying()&&(this._wasPlayingOnHidden=!0,this.pause())})),this._engine.on("visible",(()=>{e.pauseAudioWhenHidden&&this._wasPlayingOnHidden&&(this.play(),this._wasPlayingOnHidden=!1)})),this._engine.on("start",(()=>{this._isStopped=!1})),this._engine.on("stop",(()=>{this.stop(),this._isStopped=!0})))}instanceCount(){return this._tracks.length}isPlaying(){return this._tracks.some((e=>e.isPlaying()))}play(e){return this.isLoaded()?this._isStopped?(this.logger.warn("Cannot start playing. Engine is in a stopped state."),Promise.resolve(!1)):(this.volume=e||this.volume,this._isPaused?this._resumePlayback():this._startPlayback()):(this.logger.warn("Cannot start playing. Resource",this.path,"is not loaded yet"),Promise.resolve(!0))}pause(){if(this.isPlaying()){for(const e of this._tracks)e.pause();this._isPaused=!0,this.emit("pause",new Zs(this)),this.logger.debug("Paused all instances of sound",this.path)}}stop(){for(const e of this._tracks)e.stop();this.emit("stop",new Zs(this)),this._isPaused=!1,this._tracks.length=0,this.logger.debug("Stopped all instances of sound",this.path)}getTrackId(e){return this._tracks.indexOf(e)}async _resumePlayback(){if(this._isPaused){const e=[];for(const t of this._tracks)e.push(t.play());this._isPaused=!1,this.emit("resume",new Zs(this)),this.logger.debug("Resuming paused instances for sound",this.path,this._tracks),await Promise.all(e)}return!0}async _startPlayback(){const e=await this._getTrackInstance(this.data),t=await e.play((()=>{this.emit("playbackstart",new Zs(this,e)),this.logger.debug("Playing new instance for sound",this.path)}));return this.emit("playbackend",new Zs(this,e)),this._tracks.splice(this.getTrackId(e),1),t}_getTrackInstance(e){const t=new mo(e);return t.loop=this.loop,t.volume=this.volume,t.duration=this.duration,this._tracks.push(t),t}}class bo{constructor(e,t=D.Magenta,i=!0){this.path=e,this.color=t,this.bustCache=i,this._stream=null,this._gif=null,this._textures=[],this._animation=null,this._transparentColor=null,this._resource=new ft(e,"arraybuffer",i),this._transparentColor=t}async load(){const e=await this._resource.load();this._stream=new xo(e),this._gif=new $o(this._stream,this._transparentColor);const t=this._gif.images.map((e=>new At(e.src,!1)));return await Promise.all(t.map((e=>e.load()))),this.data=this._textures=t}isLoaded(){return!!this.data}toLegacySprite(e=0){return Tt.toLegacySprite(this.toSprite(e))}toLegacySpriteSheet(){return Wt.toLegacySpriteSheet(this.toSpriteSheet())}toLegacyAnimation(e,t){return jr.toLegacyAnimation(e,this.toAnimation(t))}toSprite(e=0){return this._textures[e].toSprite()}toSpriteSheet(){const e=this._textures.map((e=>e.toSprite()));return new Wt({sprites:e})}toAnimation(e){const t=this.toSpriteSheet(),i=t.sprites.length;return this._animation=jr.fromSpriteSheet(t,H(0,i),e),this._animation}get readCheckBytes(){return this._gif.checkBytes}}const wo=e=>e.reduce((function(e,t){return 2*e+t}),0),yo=e=>{const t=[];for(let i=7;i>=0;i--)t.push(!!(e&1<<i));return t};class xo{constructor(e){if(this.data=null,this.len=0,this.position=0,this.readByte=()=>{if(this.position>=this.data.byteLength)throw new Error("Attempted to read past end of stream.");return this.data[this.position++]},this.readBytes=e=>{const t=[];for(let i=0;i<e;i++)t.push(this.readByte());return t},this.read=e=>{let t="";for(let i=0;i<e;i++)t+=String.fromCharCode(this.readByte());return t},this.readUnsigned=()=>{const e=this.readBytes(2);return(e[1]<<8)+e[0]},this.data=new Uint8Array(e),this.len=this.data.byteLength,0===this.len)throw new Error("No data loaded from file")}}class $o{constructor(e,t=D.Magenta){this._st=null,this._handler={},this._transparentColor=null,this.frames=[],this.images=[],this.globalColorTable=[],this.checkBytes=[],this.parseColorTable=e=>{const t=[];for(let i=0;i<e;i++){const e="#"+this._st.readBytes(3).map((e=>{const t=e.toString(16);return 1===t.length?"0"+t:t})).join("");t.push(e)}return t},this.readSubBlocks=()=>{let e,t;t="";do{e=this._st.readByte(),t+=this._st.read(e)}while(0!==e);return t},this.parseHeader=()=>{const e={sig:null,ver:null,width:null,height:null,colorRes:null,globalColorTableSize:null,gctFlag:null,sorted:null,globalColorTable:[],bgColor:null,pixelAspectRatio:null};if(e.sig=this._st.read(3),e.ver=this._st.read(3),"GIF"!==e.sig)throw new Error("Not a GIF file.");e.width=this._st.readUnsigned(),e.height=this._st.readUnsigned();const t=yo(this._st.readByte());e.gctFlag=t.shift(),e.colorRes=wo(t.splice(0,3)),e.sorted=t.shift(),e.globalColorTableSize=wo(t.splice(0,3)),e.bgColor=this._st.readByte(),e.pixelAspectRatio=this._st.readByte(),e.gctFlag&&(e.globalColorTable=this.parseColorTable(1<<e.globalColorTableSize+1),this.globalColorTable=e.globalColorTable),this._handler.hdr&&this._handler.hdr(e)&&this.checkBytes.push(this._handler.hdr)},this.parseExt=e=>{const t=e=>{this.checkBytes.push(this._st.readByte());const t=yo(this._st.readByte());e.reserved=t.splice(0,3),e.disposalMethod=wo(t.splice(0,3)),e.userInput=t.shift(),e.transparencyGiven=t.shift(),e.delayTime=this._st.readUnsigned(),e.transparencyIndex=this._st.readByte(),e.terminator=this._st.readByte(),this._handler.gce&&this._handler.gce(e)&&this.checkBytes.push(this._handler.gce)},i=e=>{e.comment=this.readSubBlocks(),this._handler.com&&this._handler.com(e)&&this.checkBytes.push(this._handler.com)},n=e=>{this.checkBytes.push(this._st.readByte()),e.ptHeader=this._st.readBytes(12),e.ptData=this.readSubBlocks(),this._handler.pte&&this._handler.pte(e)&&this.checkBytes.push(this._handler.pte)},r=e=>{const t=e=>{this.checkBytes.push(this._st.readByte()),e.unknown=this._st.readByte(),e.iterations=this._st.readUnsigned(),e.terminator=this._st.readByte(),this._handler.app&&this._handler.app.NETSCAPE&&this._handler.app.NETSCAPE(e)&&this.checkBytes.push(this._handler.app)},i=e=>{e.appData=this.readSubBlocks(),this._handler.app&&this._handler.app[e.identifier]&&this._handler.app[e.identifier](e)&&this.checkBytes.push(this._handler.app[e.identifier])};this.checkBytes.push(this._st.readByte()),e.identifier=this._st.read(8),e.authCode=this._st.read(3),"NETSCAPE"===e.identifier?t(e):i(e)},s=e=>{e.data=this.readSubBlocks(),this._handler.unknown&&this._handler.unknown(e)&&this.checkBytes.push(this._handler.unknown)};switch(e.label=this._st.readByte(),e.label){case 249:e.extType="gce",t(e);break;case 254:e.extType="com",i(e);break;case 1:e.extType="pte",n(e);break;case 255:e.extType="app",r(e);break;default:e.extType="unknown",s(e)}},this.parseImg=e=>{e.leftPos=this._st.readUnsigned(),e.topPos=this._st.readUnsigned(),e.width=this._st.readUnsigned(),e.height=this._st.readUnsigned();const t=yo(this._st.readByte());e.lctFlag=t.shift(),e.interlaced=t.shift(),e.sorted=t.shift(),e.reserved=t.splice(0,2),e.lctSize=wo(t.splice(0,3)),e.lctFlag&&(e.lct=this.parseColorTable(1<<e.lctSize+1)),e.lzwMinCodeSize=this._st.readByte();const i=this.readSubBlocks();e.pixels=function(e,t){let i=0;const n=function(e){let n=0;for(let r=0;r<e;r++)t.charCodeAt(i>>3)&1<<(7&i)&&(n|=1<<r),i++;return n},r=[],s=1<<e,o=s+1;let a=e+1,l=[];const c=function(){l=[],a=e+1;for(let e=0;e<s;e++)l[e]=[e];l[s]=[],l[o]=null};let d,h;for(;;)if(h=d,d=n(a),d!==s){if(d===o)break;if(d<l.length)h!==s&&l.push(l[h].concat(l[d][0]));else{if(d!==l.length)throw new Error("Invalid LZW code.");l.push(l[h].concat(l[h][0]))}r.push.apply(r,l[d]),l.length===1<<a&&a<12&&a++}else c();return r}(e.lzwMinCodeSize,i),e.interlaced&&(e.pixels=((e,t)=>{const i=new Array(e.length),n=e.length/t,r=(n,r)=>{const s=e.slice(r*t,(r+1)*t);i.splice.apply(i,[n*t,t].concat(s))},s=[0,4,2,1],o=[8,8,4,2];let a=0;for(let e=0;e<4;e++)for(let t=s[e];t<n;t+=o[e])r(t,a),a++;return i})(e.pixels,e.width)),this.frames.push(e),this.arrayToImage(e),this._handler.img&&this._handler.img(e)&&this.checkBytes.push(this._handler)},this.parseBlock=()=>{const e={sentinel:this._st.readByte(),type:""};switch(String.fromCharCode(e.sentinel)){case"!":e.type="ext",this.parseExt(e);break;case",":e.type="img",this.parseImg(e);break;case";":e.type="eof",this._handler.eof&&this._handler.eof(e)&&this.checkBytes.push(this._handler.eof);break;default:throw new Error("Unknown block: 0x"+e.sentinel.toString(16))}"eof"!==e.type&&this.parseBlock()},this.arrayToImage=e=>{let t=0;const i=document.createElement("canvas");i.id=t.toString(),i.width=e.width,i.height=e.height,t++;const n=i.getContext("2d");let r=0,s=0;for(let t=0;t<e.pixels.length;t++)s%e.width==0&&(r++,s=0),this.globalColorTable[e.pixels[t]]===this._transparentColor.toHex()?n.fillStyle="rgba(0, 0, 0, 0)":n.fillStyle=this.globalColorTable[e.pixels[t]],n.fillRect(s,r,1,1),s++;const o=new Image;o.src=i.toDataURL(),this.images.push(o)},this._st=e,this._handler={},this._transparentColor=t,this.parseHeader(),this.parseBlock()}}class Co extends ke{constructor(e){super(e),this.points=e.points,this.filtering=he.Blended,this.rasterize()}get points(){return this._points}set points(e){this._points=e;const t=this.minPoint;this.width=this._points.reduce(((e,t)=>Math.max(t.x,e)),0)-t.x,this.height=this._points.reduce(((e,t)=>Math.max(t.y,e)),0)-t.y,this.flagDirty()}get minPoint(){return P(this._points.reduce(((e,t)=>Math.min(t.x,e)),1/0),this._points.reduce(((e,t)=>Math.min(t.y,e)),1/0))}clone(){return new Co({points:this.points.map((e=>e.clone())),...this.cloneGraphicOptions(),...this.cloneRasterOptions()})}execute(e){if(this.points&&this.points.length){e.beginPath();const t=this.minPoint.negate(),i=this.points[0].add(t);e.moveTo(i.x,i.y),this.points.forEach((i=>{e.lineTo(i.x+t.x,i.y+t.y)})),e.lineTo(i.x,i.y),e.closePath(),this.color&&e.fill(),this.strokeColor&&e.stroke()}}}var So=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};let Eo=class{constructor(e){this._getComparable=e}find(e){return this._find(this._root,e)}_find(e,t){return null!=e&&(this._getComparable(t)===e.getKey()?e.getData().indexOf(t)>-1:this._getComparable(t)<e.getKey()?this._find(e.getLeft(),t):this._find(e.getRight(),t))}get(e){return this._get(this._root,e)}_get(e,t){return null==e?[]:t===e.getKey()?e.getData():t<e.getKey()?this._get(e.getLeft(),t):this._get(e.getRight(),t)}add(e){return null==this._root?(this._root=new Po(this._getComparable(e),[e],null,null),!0):this._insert(this._root,e)}_insert(e,t){return null!=e&&(this._getComparable(t)===e.getKey()?!(e.getData().indexOf(t)>-1||(e.getData().push(t),0)):this._getComparable(t)<e.getKey()?null==e.getLeft()?(e.setLeft(new Po(this._getComparable(t),[t],null,null)),!0):this._insert(e.getLeft(),t):null==e.getRight()?(e.setRight(new Po(this._getComparable(t),[t],null,null)),!0):this._insert(e.getRight(),t))}removeByComparable(e){this._root=this._remove(this._root,e)}_remove(e,t){if(null==e)return null;if(this._getComparable(t)!==e.getKey())return this._getComparable(t)<e.getKey()?(e.setLeft(this._remove(e.getLeft(),t)),e):(e.setRight(this._remove(e.getRight(),t)),e);{const i=e.getData().indexOf(t);if(i>-1){if(e.getData().splice(i,1),0===e.getData().length){if(null==e.getLeft()&&null==e.getRight())return null;if(null==e.getLeft())return e.getRight();if(null==e.getRight())return e.getLeft();const t=this._findMinNode(e.getRight());return e.setKey(t.getKey()),e.setData(t.getData()),e.setRight(this._cleanup(e.getRight(),t)),e}return e}}return null}_cleanup(e,t){const i=t.getKey();if(null==e)return null;if(i===e.getKey()){if(null==e.getLeft()&&null==e.getRight())return null;if(null==e.getLeft())return e.getRight();if(null==e.getRight())return e.getLeft();const t=this._findMinNode(e.getRight());return e.setKey(t.getKey()),e.setData(t.getData()),e.setRight(this._cleanup(e.getRight(),t)),e}return t.getKey()<e.getKey()?(e.setLeft(this._cleanup(e.getLeft(),t)),e):(e.setRight(this._cleanup(e.getRight(),t)),e)}_findMinNode(e){let t=e;for(;null!=t.getLeft();)t=t.getLeft();return t}list(){const e=new Array;return this._list(this._root,e),e}_list(e,t){null!=e&&(this._list(e.getLeft(),t),e.getData().forEach((e=>{t.push(e)})),this._list(e.getRight(),t))}};Eo=So([S({message:"Will be removed in excalibur v0.26.0",alternateMethod:"Use built in JS array.sort"})],Eo);let Po=class{constructor(e,t,i,n){this._key=e,this._data=t,this._left=i,this._right=n}getKey(){return this._key}setKey(e){this._key=e}getData(){return this._data}setData(e){this._data=e}getLeft(){return this._left}setLeft(e){this._left=e}getRight(){return this._right}setRight(e){this._right=e}};Po=So([S({message:"Will be removed in excalibur v0.26.0"})],Po);class ko{constructor(e){this._key=0,this._key=e}getTheKey(){return this._key}setKey(e){this._key=e}}class To{constructor(e,t,i=100){this.builder=e,this.recycler=t,this.maxObjects=i,this.totalAllocations=0,this.index=0,this.objects=[],this._logger=v.getInstance()}using(e){const t=e(this);return t?this.done(...t):this.done()}borrow(e){e(this.get()),this.index--}get(...e){return this.index===this.maxObjects&&(this._logger.warn("Max pooled objects reached, possible memory leak? Doubling"),this.maxObjects=2*this.maxObjects),this.objects[this.index]?this.recycler(this.objects[this.index++],...e):(this.totalAllocations++,this.objects[this.index++]=this.builder(...e))}done(...e){this.index=0;for(const t of e){const e=this.objects.indexOf(t);this.objects[e]=this.builder(),this.totalAllocations++}return e}}var Ao,Do,Ro;(Ro=Do||(Do={}))[Ro.Resolved=0]="Resolved",Ro[Ro.Rejected=1]="Rejected",Ro[Ro.Pending=2]="Pending";let Io=Ao=class{constructor(){this._state=Do.Pending,this._successCallbacks=[],this._rejectCallback=()=>{}}static resolve(e){return(new Ao).resolve(e)}static reject(e){return(new Ao).reject(e)}static join(){let e=[];if(arguments.length>0&&!Array.isArray(arguments[0]))for(let t=0;t<arguments.length;t++)e[t-0]=arguments[t];else 1===arguments.length&&Array.isArray(arguments[0])&&(e=arguments[0]);const t=new Ao;if(!e||!e.length)return t.resolve();const i=e.length;let n=0,r=0;const s=[];return e.forEach((e=>{e.then((()=>{n+=1,n===i?t.resolve():n+r+s.length===i&&t.reject(s)}),(()=>{r+=1,n+r+s.length===i&&t.reject(s)})).error((e=>{s.push(e),s.length+n+r===i&&t.reject(s)}))})),t}then(e,t){if(e&&(this._successCallbacks.push(e),this.state()===Do.Resolved))try{e.call(this,this._value)}catch(e){this._handleError(e)}if(t&&(this._rejectCallback=t,this.state()===Do.Rejected))try{t.call(this,this._value)}catch(e){this._handleError(e)}return this}error(e){return e&&(this._errorCallback=e),this}resolve(e){if(this._state!==Do.Pending)throw new Error("Cannot resolve a promise that is not in a pending state!");this._value=e;try{this._state=Do.Resolved,this._successCallbacks.forEach((e=>{e.call(this,this._value)}))}catch(e){this._handleError(e)}return this}reject(e){if(this._state!==Do.Pending)throw new Error("Cannot reject a promise that is not in a pending state!");this._value=e;try{this._state=Do.Rejected,this._rejectCallback.call(this,this._value)}catch(e){this._handleError(e)}return this}state(){return this._state}_handleError(e){if(!this._errorCallback)throw e;this._errorCallback.call(this,e)}};Io=Ao=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o}([S({message:"ex.Promises are being replaced by native browser promises in v0.26.0",alternateMethod:"Use browser native promises"})],Io);const Mo="0.26.0-alpha.128+483dc65";g()})(),n})()},e.exports=i()})),parcelRequire.register("7mbQa",(function(e,t){var i=$b63e377f8a561b77$exports.Global;function n(){return i.localStorage}function r(e){return n().getItem(e)}e.exports={name:"localStorage",read:r,write:function(e,t){return n().setItem(e,t)},each:function(e){for(var t=n().length-1;t>=0;t--){var i=n().key(t);e(r(i),i)}},remove:function(e){return n().removeItem(e)},clearAll:function(){return n().clear()}}}));var $b63e377f8a561b77$exports={},$b63e377f8a561b77$var$assign=$b63e377f8a561b77$var$make_assign(),$b63e377f8a561b77$var$create=$b63e377f8a561b77$var$make_create(),$b63e377f8a561b77$var$trim=$b63e377f8a561b77$var$make_trim(),$b63e377f8a561b77$var$Global="undefined"!=typeof window?window:$parcel$global;function $b63e377f8a561b77$var$make_assign(){return Object.assign?Object.assign:function(e,t,i,n){for(var r=1;r<arguments.length;r++)$b63e377f8a561b77$var$each(Object(arguments[r]),(function(t,i){e[i]=t}));return e}}function $b63e377f8a561b77$var$make_create(){if(Object.create)return function(e,t,i,n){var r=$b63e377f8a561b77$var$slice(arguments,1);return $b63e377f8a561b77$var$assign.apply(this,[Object.create(e)].concat(r))};{function e(){}return function(t,i,n,r){var s=$b63e377f8a561b77$var$slice(arguments,1);return e.prototype=t,$b63e377f8a561b77$var$assign.apply(this,[new e].concat(s))}}}function $b63e377f8a561b77$var$make_trim(){return String.prototype.trim?function(e){return String.prototype.trim.call(e)}:function(e){return e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}}function $b63e377f8a561b77$var$bind(e,t){return function(){return t.apply(e,Array.prototype.slice.call(arguments,0))}}function $b63e377f8a561b77$var$slice(e,t){return Array.prototype.slice.call(e,t||0)}function $b63e377f8a561b77$var$each(e,t){$b63e377f8a561b77$var$pluck(e,(function(e,i){return t(e,i),!1}))}function $b63e377f8a561b77$var$map(e,t){var i=$b63e377f8a561b77$var$isList(e)?[]:{};return $b63e377f8a561b77$var$pluck(e,(function(e,n){return i[n]=t(e,n),!1})),i}function $b63e377f8a561b77$var$pluck(e,t){if($b63e377f8a561b77$var$isList(e)){for(var i=0;i<e.length;i++)if(t(e[i],i))return e[i]}else for(var n in e)if(e.hasOwnProperty(n)&&t(e[n],n))return e[n]}function $b63e377f8a561b77$var$isList(e){return null!=e&&"function"!=typeof e&&"number"==typeof e.length}function $b63e377f8a561b77$var$isFunction(e){return e&&"[object Function]"==={}.toString.call(e)}function $b63e377f8a561b77$var$isObject(e){return e&&"[object Object]"==={}.toString.call(e)}$b63e377f8a561b77$exports={assign:$b63e377f8a561b77$var$assign,create:$b63e377f8a561b77$var$create,trim:$b63e377f8a561b77$var$trim,bind:$b63e377f8a561b77$var$bind,slice:$b63e377f8a561b77$var$slice,each:$b63e377f8a561b77$var$each,map:$b63e377f8a561b77$var$map,pluck:$b63e377f8a561b77$var$pluck,isList:$b63e377f8a561b77$var$isList,isFunction:$b63e377f8a561b77$var$isFunction,isObject:$b63e377f8a561b77$var$isObject,Global:$b63e377f8a561b77$var$Global},parcelRequire.register("deyjU",(function(e,t){var i=$b63e377f8a561b77$exports.Global;e.exports={name:"oldFF-globalStorage",read:function(e){return n[e]},write:function(e,t){n[e]=t},each:r,remove:function(e){return n.removeItem(e)},clearAll:function(){r((function(e,t){delete n[e]}))}};var n=i.globalStorage;function r(e){for(var t=n.length-1;t>=0;t--){var i=n.key(t);e(n[i],i)}}})),parcelRequire.register("eCrE3",(function(e,t){var i=$b63e377f8a561b77$exports.Global;e.exports={name:"oldIE-userDataStorage",write:function(e,t){if(o)return;var i=l(e);s((function(e){e.setAttribute(i,t),e.save(n)}))},read:function(e){if(o)return;var t=l(e),i=null;return s((function(e){i=e.getAttribute(t)})),i},each:function(e){s((function(t){for(var i=t.XMLDocument.documentElement.attributes,n=i.length-1;n>=0;n--){var r=i[n];e(t.getAttribute(r.name),r.name)}}))},remove:function(e){var t=l(e);s((function(e){e.removeAttribute(t),e.save(n)}))},clearAll:function(){s((function(e){var t=e.XMLDocument.documentElement.attributes;e.load(n);for(var i=t.length-1;i>=0;i--)e.removeAttribute(t[i].name);e.save(n)}))}};var n="storejs",r=i.document,s=function(){if(!r||!r.documentElement||!r.documentElement.addBehavior)return null;var e,t,i;try{(t=new ActiveXObject("htmlfile")).open(),t.write('<script>document.w=window<\/script><iframe src="/favicon.ico"></iframe>'),t.close(),e=t.w.frames[0].document,i=e.createElement("div")}catch(t){i=r.createElement("div"),e=r.body}return function(t){var r=[].slice.call(arguments,0);r.unshift(i),e.appendChild(i),i.addBehavior("#default#userData"),i.load(n),t.apply(this,r),e.removeChild(i)}}(),o=(i.navigator?i.navigator.userAgent:"").match(/ (MSIE 8|MSIE 9|MSIE 10)\./);var a=new RegExp("[!\"#$%&'()*+,/\\\\:;<=>?@[\\]^`{|}~]","g");function l(e){return e.replace(/^\d/,"___$&").replace(a,"___")}})),parcelRequire.register("hmYM5",(function(e,t){var i=$b63e377f8a561b77$exports.Global,n=$b63e377f8a561b77$exports.trim;e.exports={name:"cookieStorage",read:function(e){if(!e||!a(e))return null;var t="(?:^|.*;\\s*)"+escape(e).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=\\s*((?:[^;](?!;))*[^;]?).*";return unescape(r.cookie.replace(new RegExp(t),"$1"))},write:function(e,t){if(!e)return;r.cookie=escape(e)+"="+escape(t)+"; expires=Tue, 19 Jan 2038 03:14:07 GMT; path=/"},each:s,remove:o,clearAll:function(){s((function(e,t){o(t)}))}};var r=i.document;function s(e){for(var t=r.cookie.split(/; ?/g),i=t.length-1;i>=0;i--)if(n(t[i])){var s=t[i].split("="),o=unescape(s[0]);e(unescape(s[1]),o)}}function o(e){e&&a(e)&&(r.cookie=escape(e)+"=; expires=Thu, 01 Jan 1970 00:00:00 GMT; path=/")}function a(e){return new RegExp("(?:^|;\\s*)"+escape(e).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=").test(r.cookie)}})),parcelRequire.register("64b1H",(function(e,t){var i=$b63e377f8a561b77$exports.Global;function n(){return i.sessionStorage}function r(e){return n().getItem(e)}e.exports={name:"sessionStorage",read:r,write:function(e,t){return n().setItem(e,t)},each:function(e){for(var t=n().length-1;t>=0;t--){var i=n().key(t);e(r(i),i)}},remove:function(e){return n().removeItem(e)},clearAll:function(){return n().clear()}}})),parcelRequire.register("ibNr9",(function(e,t){e.exports={name:"memoryStorage",read:function(e){return i[e]},write:function(e,t){i[e]=t},each:function(e){for(var t in i)i.hasOwnProperty(t)&&e(i[t],t)},remove:function(e){delete i[e]},clearAll:function(e){i={}}};var i={}})),parcelRequire.register("8RueS",(function(e,t){e.exports=function(){return parcelRequire("fZtw7"),{}}})),parcelRequire.register("fZtw7",(function(module,exports){"object"!=typeof JSON&&(JSON={}),function(){var rx_one=/^[\],:{}\s]*$/,rx_two=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,rx_three=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,rx_four=/(?:^|:|,)(?:\s*\[)+/g,rx_escapable=/[\\"\u0000-\u001f\u007f-\u009f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,rx_dangerous=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta,rep;function f(e){return e<10?"0"+e:e}function this_value(){return this.valueOf()}function quote(e){return rx_escapable.lastIndex=0,rx_escapable.test(e)?'"'+e.replace(rx_escapable,(function(e){var t=meta[e];return"string"==typeof t?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)}))+'"':'"'+e+'"'}function str(e,t){var i,n,r,s,o,a=gap,l=t[e];switch(l&&"object"==typeof l&&"function"==typeof l.toJSON&&(l=l.toJSON(e)),"function"==typeof rep&&(l=rep.call(t,e,l)),typeof l){case"string":return quote(l);case"number":return isFinite(l)?String(l):"null";case"boolean":case"null":return String(l);case"object":if(!l)return"null";if(gap+=indent,o=[],"[object Array]"===Object.prototype.toString.apply(l)){for(s=l.length,i=0;i<s;i+=1)o[i]=str(i,l)||"null";return r=0===o.length?"[]":gap?"[\n"+gap+o.join(",\n"+gap)+"\n"+a+"]":"["+o.join(",")+"]",gap=a,r}if(rep&&"object"==typeof rep)for(s=rep.length,i=0;i<s;i+=1)"string"==typeof rep[i]&&(r=str(n=rep[i],l))&&o.push(quote(n)+(gap?": ":":")+r);else for(n in l)Object.prototype.hasOwnProperty.call(l,n)&&(r=str(n,l))&&o.push(quote(n)+(gap?": ":":")+r);return r=0===o.length?"{}":gap?"{\n"+gap+o.join(",\n"+gap)+"\n"+a+"}":"{"+o.join(",")+"}",gap=a,r}}"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},Boolean.prototype.toJSON=this_value,Number.prototype.toJSON=this_value,String.prototype.toJSON=this_value),"function"!=typeof JSON.stringify&&(meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},JSON.stringify=function(e,t,i){var n;if(gap="",indent="","number"==typeof i)for(n=0;n<i;n+=1)indent+=" ";else"string"==typeof i&&(indent=i);if(rep=t,t&&"function"!=typeof t&&("object"!=typeof t||"number"!=typeof t.length))throw new Error("JSON.stringify");return str("",{"":e})}),"function"!=typeof JSON.parse&&(JSON.parse=function(text,reviver){var j;function walk(e,t){var i,n,r=e[t];if(r&&"object"==typeof r)for(i in r)Object.prototype.hasOwnProperty.call(r,i)&&(void 0!==(n=walk(r,i))?r[i]=n:delete r[i]);return reviver.call(e,t,r)}if(text=String(text),rx_dangerous.lastIndex=0,rx_dangerous.test(text)&&(text=text.replace(rx_dangerous,(function(e){return"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)}))),rx_one.test(text.replace(rx_two,"@").replace(rx_three,"]").replace(rx_four,"")))return j=eval("("+text+")"),"function"==typeof reviver?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})}()}));var $81e2b5a58503157e$exports={};parcelRequire("27Lyk").register(JSON.parse('{"aEVhr":"index.766176f6.js","93Bqc":"sword.a45e8cc8.png","1OAey":"sand-placeholder.e8c0e779.png","5rmOr":"sandcastle-placeholder.53b9737d.png","gQlT2":"tower-bucket-placeholder.365aebaf.png","auVjM":"tower-bucket-broken-placeholder.538d05a4.png","hRuM7":"base-tower.0363d652.png","75r3y":"tower-placeholder-broken.2884aa51.png","lPda5":"catapult.019c055d.png","7HMHc":"catapult-broken.0dc8299a.png","8x8B2":"catapult-loaded.f33cf4a9.png","afO87":"wall.87848ab7.png","cOMLy":"waves.03ea2a4c.png","6lBDw":"tower-bucket.f07c370d.png","1busq":"sand.a9b2679b.png","awm6k":"beachball.ecb82f6f.png","dZKZi":"turtle.6f2bec47.png","71OAl":"crab.5c397dcd.png","e0iBh":"bottom-border.43822226.png","lxy2T":"clank.3e05cde9.wav","4mjPq":"bg-beach.a23d9e18.mp3","f26Rk":"bg-music.eada03a4.mp3","cU9uD":"wave-appear.105e72d4.ogg","bwBDW":"wave-appear.050b46e5.mp3","1VlMd":"impact-enemy-rock.d60ea759.ogg","aBWrd":"impact-enemy-rock.7a55f79b.mp3","eOI58":"impact-tower.356ed1df.ogg","3JmJy":"impact-tower.acf2e6e8.mp3","jmly2":"impact-castle.15884401.ogg","kcsGH":"impact-castle.1a7c5cd7.mp3","fhRi3":"pick-tower.14a85fc1.ogg","uJMWc":"pick-tower.a6c05d41.mp3","3Wb9q":"place-tower.cada49fa.mp3","5IV6z":"fling-01.fa960c0c.mp3","259Q1":"fling-02.d67f35ac.mp3","81n99":"fling-03.56fb4fa3.mp3","bcEwN":"fling-04.f50fc15f.mp3","9pOd6":"fling-05.f1898619.mp3","3bwcs":"fling-06.addd7a61.mp3","7mgYs":"index.929fd214.css"}'));var $7b02d682eb115277$exports={},$7e96a608cb33bf79$export$882461b6382ed46c,$7e96a608cb33bf79$export$757ceba2d55c277e;$7b02d682eb115277$exports=parcelRequire("1b2ls"),parcelRequire("acw62");var $11492dca620dcaa5$exports={},$7e96a608cb33bf79$var$i,c,o,c1,h,o1;function $11492dca620dcaa5$var$checkDCE(){if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE($11492dca620dcaa5$var$checkDCE)}catch(e){console.error(e)}}$11492dca620dcaa5$var$checkDCE(),$11492dca620dcaa5$exports=parcelRequire("Xw6Mv"),$7e96a608cb33bf79$export$882461b6382ed46c=$11492dca620dcaa5$exports.createRoot,$7e96a608cb33bf79$export$757ceba2d55c277e=$11492dca620dcaa5$exports.hydrateRoot;var $acw62=parcelRequire("acw62"),$jgD1p=parcelRequire("jgD1p"),$jgD1p=parcelRequire("jgD1p"),$73991847afc42666$exports={};$73991847afc42666$exports=new URL(parcelRequire("27Lyk").resolve("93Bqc"),import.meta.url).toString();var $2d79280c69f571b0$exports={};$2d79280c69f571b0$exports=new URL(parcelRequire("27Lyk").resolve("1OAey"),import.meta.url).toString();var $e9408ce807de14d6$exports={};$e9408ce807de14d6$exports=new URL(parcelRequire("27Lyk").resolve("5rmOr"),import.meta.url).toString();var $36553100560faec3$exports={};$36553100560faec3$exports=new URL(parcelRequire("27Lyk").resolve("gQlT2"),import.meta.url).toString();var $37c86edae3d286e4$exports={};$37c86edae3d286e4$exports=new URL(parcelRequire("27Lyk").resolve("auVjM"),import.meta.url).toString();var $c82fd7e8cd6f5ae1$exports={};$c82fd7e8cd6f5ae1$exports=new URL(parcelRequire("27Lyk").resolve("hRuM7"),import.meta.url).toString();var $d92d32b4f5d735dc$exports={};$d92d32b4f5d735dc$exports=new URL(parcelRequire("27Lyk").resolve("75r3y"),import.meta.url).toString();var $548a292e07c598c7$exports={};$548a292e07c598c7$exports=new URL(parcelRequire("27Lyk").resolve("lPda5"),import.meta.url).toString();var $1343604dd009c1ae$exports={};$1343604dd009c1ae$exports=new URL(parcelRequire("27Lyk").resolve("7HMHc"),import.meta.url).toString();var $366c3af3e41fa257$exports={};$366c3af3e41fa257$exports=new URL(parcelRequire("27Lyk").resolve("8x8B2"),import.meta.url).toString();var $4df5a4ee8210e632$exports={};$4df5a4ee8210e632$exports=new URL(parcelRequire("27Lyk").resolve("afO87"),import.meta.url).toString();var $e17a7e4025495fd4$exports={};$e17a7e4025495fd4$exports=new URL(parcelRequire("27Lyk").resolve("cOMLy"),import.meta.url).toString();var $3bff3138ce173eed$exports={};$3bff3138ce173eed$exports=new URL(parcelRequire("27Lyk").resolve("6lBDw"),import.meta.url).toString();var $d0dcccda3e92303c$exports={};$d0dcccda3e92303c$exports=new URL(parcelRequire("27Lyk").resolve("1busq"),import.meta.url).toString();var $10392d9157a6b93a$exports={};$10392d9157a6b93a$exports=new URL(parcelRequire("27Lyk").resolve("awm6k"),import.meta.url).toString();var $28f9d96eafa2d727$exports={};$28f9d96eafa2d727$exports=new URL(parcelRequire("27Lyk").resolve("dZKZi"),import.meta.url).toString();var $0fa41119ffc140e6$exports={};$0fa41119ffc140e6$exports=new URL(parcelRequire("27Lyk").resolve("71OAl"),import.meta.url).toString();var $2d27e0493d1e0965$exports={};$2d27e0493d1e0965$exports=new URL(parcelRequire("27Lyk").resolve("e0iBh"),import.meta.url).toString();var $b6db5538437aa8f6$exports={};$b6db5538437aa8f6$exports=new URL(parcelRequire("27Lyk").resolve("lxy2T"),import.meta.url).toString();var $da15516a49670932$exports={};$da15516a49670932$exports=new URL(parcelRequire("27Lyk").resolve("4mjPq"),import.meta.url).toString();var $064db1bf4e558834$exports={};$064db1bf4e558834$exports=new URL(parcelRequire("27Lyk").resolve("f26Rk"),import.meta.url).toString();var $b71598fa10507731$exports={};$b71598fa10507731$exports=new URL(parcelRequire("27Lyk").resolve("cU9uD"),import.meta.url).toString();var $550046cc09acf93a$exports={};$550046cc09acf93a$exports=new URL(parcelRequire("27Lyk").resolve("bwBDW"),import.meta.url).toString();var $59ecb550e002dd77$exports={};$59ecb550e002dd77$exports=new URL(parcelRequire("27Lyk").resolve("1VlMd"),import.meta.url).toString();var $cf4043dd0f8113ff$exports={};$cf4043dd0f8113ff$exports=new URL(parcelRequire("27Lyk").resolve("aBWrd"),import.meta.url).toString();var $a7476afbe369a46e$exports={};$a7476afbe369a46e$exports=new URL(parcelRequire("27Lyk").resolve("eOI58"),import.meta.url).toString();var $9ed3962cb2b685f1$exports={};$9ed3962cb2b685f1$exports=new URL(parcelRequire("27Lyk").resolve("3JmJy"),import.meta.url).toString();var $57394b6ef317d00d$exports={};$57394b6ef317d00d$exports=new URL(parcelRequire("27Lyk").resolve("jmly2"),import.meta.url).toString();var $195acd8b311bf407$exports={};$195acd8b311bf407$exports=new URL(parcelRequire("27Lyk").resolve("kcsGH"),import.meta.url).toString();var $92e3f00ca4586425$exports={};$92e3f00ca4586425$exports=new URL(parcelRequire("27Lyk").resolve("fhRi3"),import.meta.url).toString();var $3e43acb614b76427$exports={};$3e43acb614b76427$exports=new URL(parcelRequire("27Lyk").resolve("uJMWc"),import.meta.url).toString();var $9bb6f3f3973a5860$exports={};$9bb6f3f3973a5860$exports=new URL(parcelRequire("27Lyk").resolve("3Wb9q"),import.meta.url).toString();var $78b1245a70abc612$exports={};$78b1245a70abc612$exports=new URL(parcelRequire("27Lyk").resolve("5IV6z"),import.meta.url).toString();var $77153a6db5ef8531$exports={};$77153a6db5ef8531$exports=new URL(parcelRequire("27Lyk").resolve("259Q1"),import.meta.url).toString();var $46d3bd78e8337797$exports={};$46d3bd78e8337797$exports=new URL(parcelRequire("27Lyk").resolve("81n99"),import.meta.url).toString();var $01469baeafd07db5$exports={};$01469baeafd07db5$exports=new URL(parcelRequire("27Lyk").resolve("bcEwN"),import.meta.url).toString();var $efc9c430200cb84d$exports={};$efc9c430200cb84d$exports=new URL(parcelRequire("27Lyk").resolve("9pOd6"),import.meta.url).toString();var $ed6ee06a6e46cf6d$exports={};$ed6ee06a6e46cf6d$exports=new URL(parcelRequire("27Lyk").resolve("3bwcs"),import.meta.url).toString();const $7c4c300842bd4cf2$export$e9a269813a6315a4={Sword:new $jgD1p.ImageSource($parcel$interopDefault($73991847afc42666$exports)),Sand:new $jgD1p.ImageSource($parcel$interopDefault($2d79280c69f571b0$exports),!1,$jgD1p.ImageFiltering.Pixel),SandCastle:new $jgD1p.ImageSource($parcel$interopDefault($e9408ce807de14d6$exports),!1,$jgD1p.ImageFiltering.Pixel),BaseTower:new $jgD1p.ImageSource($parcel$interopDefault($c82fd7e8cd6f5ae1$exports),!1,$jgD1p.ImageFiltering.Pixel),BaseTowerBroken:new $jgD1p.ImageSource($parcel$interopDefault($d92d32b4f5d735dc$exports),!1,$jgD1p.ImageFiltering.Pixel),CatapultTower:new $jgD1p.ImageSource($parcel$interopDefault($548a292e07c598c7$exports),!1,$jgD1p.ImageFiltering.Pixel),CatapultTowerLoaded:new $jgD1p.ImageSource($parcel$interopDefault($366c3af3e41fa257$exports),!1,$jgD1p.ImageFiltering.Pixel),CatapultTowerBroken:new $jgD1p.ImageSource($parcel$interopDefault($1343604dd009c1ae$exports),!1,$jgD1p.ImageFiltering.Pixel),BucketTower:new $jgD1p.ImageSource($parcel$interopDefault($36553100560faec3$exports),!1,$jgD1p.ImageFiltering.Pixel),BucketTowerBroken:new $jgD1p.ImageSource($parcel$interopDefault($37c86edae3d286e4$exports),!1,$jgD1p.ImageFiltering.Pixel),Sandwall:new $jgD1p.ImageSource($parcel$interopDefault($4df5a4ee8210e632$exports),!1,$jgD1p.ImageFiltering.Pixel),Water:new $jgD1p.ImageSource($parcel$interopDefault($e17a7e4025495fd4$exports),!1,$jgD1p.ImageFiltering.Pixel),BucketSheet:new $jgD1p.ImageSource($parcel$interopDefault($3bff3138ce173eed$exports),!1,$jgD1p.ImageFiltering.Pixel),CompactedSand:new $jgD1p.ImageSource($parcel$interopDefault($d0dcccda3e92303c$exports),!1,$jgD1p.ImageFiltering.Pixel),Beachball:new $jgD1p.ImageSource($parcel$interopDefault($10392d9157a6b93a$exports),!1,$jgD1p.ImageFiltering.Pixel),TurtleSheet:new $jgD1p.ImageSource($parcel$interopDefault($28f9d96eafa2d727$exports),!1,$jgD1p.ImageFiltering.Pixel),CrabSheet:new $jgD1p.ImageSource($parcel$interopDefault($0fa41119ffc140e6$exports),!1,$jgD1p.ImageFiltering.Pixel),BottomBorder:new $jgD1p.ImageSource($parcel$interopDefault($2d27e0493d1e0965$exports),!1,$jgD1p.ImageFiltering.Pixel),Clank:new $jgD1p.Sound($parcel$interopDefault($b6db5538437aa8f6$exports)),BackgroundAmbiance:new $jgD1p.Sound($parcel$interopDefault($da15516a49670932$exports)),BackgroundMusic:new $jgD1p.Sound($parcel$interopDefault($064db1bf4e558834$exports)),FxWaveAppear:new $jgD1p.Sound($parcel$interopDefault($550046cc09acf93a$exports),$parcel$interopDefault($b71598fa10507731$exports)),FxImpactEnemyRock:new $jgD1p.Sound($parcel$interopDefault($cf4043dd0f8113ff$exports),$parcel$interopDefault($59ecb550e002dd77$exports)),FxImpactTowerByEnemy:new $jgD1p.Sound($parcel$interopDefault($9ed3962cb2b685f1$exports),$parcel$interopDefault($a7476afbe369a46e$exports)),FxImpactCastleByEnemy:new $jgD1p.Sound($parcel$interopDefault($195acd8b311bf407$exports),$parcel$interopDefault($57394b6ef317d00d$exports)),FxPlaceTower:new $jgD1p.Sound($parcel$interopDefault($9bb6f3f3973a5860$exports)),FxHarvestTower:new $jgD1p.Sound($parcel$interopDefault($9bb6f3f3973a5860$exports)),FxTowerFlings01:new $jgD1p.Sound($parcel$interopDefault($78b1245a70abc612$exports)),FxTowerFlings02:new $jgD1p.Sound($parcel$interopDefault($77153a6db5ef8531$exports)),FxTowerFlings03:new $jgD1p.Sound($parcel$interopDefault($46d3bd78e8337797$exports)),FxTowerFlings04:new $jgD1p.Sound($parcel$interopDefault($01469baeafd07db5$exports)),FxTowerFlings05:new $jgD1p.Sound($parcel$interopDefault($efc9c430200cb84d$exports)),FxTowerFlings06:new $jgD1p.Sound($parcel$interopDefault($ed6ee06a6e46cf6d$exports)),UiPickTower:new $jgD1p.Sound($parcel$interopDefault($3e43acb614b76427$exports),$parcel$interopDefault($92e3f00ca4586425$exports))},$7c4c300842bd4cf2$export$2af0f46a4934f77d=[$7c4c300842bd4cf2$export$e9a269813a6315a4.FxTowerFlings01,$7c4c300842bd4cf2$export$e9a269813a6315a4.FxTowerFlings02,$7c4c300842bd4cf2$export$e9a269813a6315a4.FxTowerFlings03,$7c4c300842bd4cf2$export$e9a269813a6315a4.FxTowerFlings04,$7c4c300842bd4cf2$export$e9a269813a6315a4.FxTowerFlings05,$7c4c300842bd4cf2$export$e9a269813a6315a4.FxTowerFlings06];var $9d936a2aecb96285$export$2e2bcd8739ae039={DatGuiMenuEnabled:!0,ShowDevTool:!0,SoundVolume:.3,BackgroundAmbianceVolume:1,BackgroundMusicVolume:.2,Seed:1337,grid:{width:9,height:5,padding:1,tileWidth:64,tileHeight:64},sandcastle:{maxHealth:10},healthBarWidthPixels:54,player:{startingMonies:100,passiveWealthTick:15,passiveWealthAmt:1},tower:{default:{baseTowerFireRateMs:5e3,bulletDamage:1,bulletRadius:10,bulletSpeedPixelsPerSecond:100,color:$jgD1p.Color.Orange,cost:1,firesBullets:!0,displayName:"Hatty",hoverText:"A sand turret to spray",maxHealth:5,resourceSpawnTimer:0,resourceSpawnValue:0,sprite:$7c4c300842bd4cf2$export$e9a269813a6315a4.BaseTower,spriteBroken:$7c4c300842bd4cf2$export$e9a269813a6315a4.BaseTowerBroken,spriteReady:$7c4c300842bd4cf2$export$e9a269813a6315a4.BaseTower},upgradeCatapult:{baseTowerFireRateMs:5e3,bulletDamage:3,bulletRadius:10,bulletSpeedPixelsPerSecond:750,color:$jgD1p.Color.DarkGray,cost:3,firesBullets:!0,displayName:"Sandapult",hoverText:"Seas the day to fling sand!",maxHealth:2,resourceSpawnTimer:0,resourceSpawnValue:0,sprite:$7c4c300842bd4cf2$export$e9a269813a6315a4.CatapultTower,spriteBroken:$7c4c300842bd4cf2$export$e9a269813a6315a4.CatapultTowerBroken,spriteReady:$7c4c300842bd4cf2$export$e9a269813a6315a4.CatapultTowerLoaded},sandBucket:{bulletSpeedPixelsPerSecond:0,bulletRadius:0,baseTowerFireRateMs:0,bulletDamage:0,color:$jgD1p.Color.Azure,cost:1,firesBullets:!1,displayName:"Buckaroo",hoverText:"All the kids need sand to build!",maxHealth:5,resourceSpawnTimer:15,resourceSpawnValue:1,sprite:$7c4c300842bd4cf2$export$e9a269813a6315a4.BucketTower,spriteBroken:$7c4c300842bd4cf2$export$e9a269813a6315a4.BucketTowerBroken,spriteReady:$7c4c300842bd4cf2$export$e9a269813a6315a4.BucketTower},sandWall:{bulletSpeedPixelsPerSecond:0,bulletRadius:0,baseTowerFireRateMs:0,bulletDamage:0,color:$jgD1p.Color.Orange,cost:2,firesBullets:!1,displayName:"Sandguard",hoverText:"Piled sand to hold the nastys at bay!",maxHealth:10,resourceSpawnTimer:0,resourceSpawnValue:0,sprite:$7c4c300842bd4cf2$export$e9a269813a6315a4.Sandwall,spriteBroken:null,spriteReady:$7c4c300842bd4cf2$export$e9a269813a6315a4.Sandwall}},enemy:{crab:{width:50,height:50,health:3,damage:2,damageTimerMs:1e3,speed:15,color:$jgD1p.Color.Red,sprite:null},turtle:{width:50,height:50,health:5,damage:1,damageTimerMs:1e3,speed:8,color:$jgD1p.Color.Green,sprite:null}},waves:{0:{name:"The Beginning",offsets:{2:[{type:"crab",count:0}],15:[{type:"crab",count:1}],25:[{type:"crab",count:2}],35:[{type:"turtle",count:1},{type:"crab",count:2}]}},1:{name:"Wave 1",offsets:{7:[{type:"crab",count:1}],11:[{type:"turtle",count:2}],20:[{type:"crab",count:2},{type:"turtle",count:3}]}},2:{name:"Wave 2",offsets:{7:[{type:"crab",count:5}],11:[{type:"crab",count:5}],20:[{type:"crab",count:5}]}},3:{name:"Wave 3",offsets:{7:[{type:"crab",count:4}],11:[{type:"crab",count:4}],20:[{type:"crab",count:4}]}},4:{name:"Wave INEVITABLE",offsets:{2:[{type:"crab",count:5},{type:"turtle",count:6}],7:[{type:"crab",count:5},{type:"turtle",count:6}],12:[{type:"crab",count:5},{type:"turtle",count:9}],17:[{type:"crab",count:5},{type:"turtle",count:12}],22:[{type:"crab",count:5},{type:"turtle",count:15}],27:[{type:"crab",count:5},{type:"turtle",count:18}]}}}},$jgD1p=parcelRequire("jgD1p"),$jgD1p=parcelRequire("jgD1p"),$jgD1p=parcelRequire("jgD1p");class $c1dde4dfd69f9e67$export$427ab9d1af813cd extends $jgD1p.Actor{healthBarOpacity=0;healthBarOpacityFade=3;constructor(e){super({name:"Healthbar",pos:$jgD1p.vec(0,-10),width:$9d936a2aecb96285$export$2e2bcd8739ae039.healthBarWidthPixels,height:5,color:$jgD1p.Color.Black,collisionType:$jgD1p.CollisionType.PreventCollision}),this.MaxHealth=e,this.CurHealth=e,this._fillColor=new $jgD1p.Actor({name:"Healthbar_fill",pos:$jgD1p.vec(0,0),width:this.width-2,height:this.height-2,color:$jgD1p.Color.Green,collisionType:$jgD1p.CollisionType.PreventCollision}),this.addChild(this._fillColor)}onPostUpdate(e,t){this.healthBarOpacity>=0&&(this.healthBarOpacity=this.healthBarOpacity-1*t/1e3/this.healthBarOpacityFade,this.graphics.opacity=this.healthBarOpacity,this._fillColor.graphics.opacity=this.healthBarOpacity)}takeDamage(e){this.CurHealth-=e;const t=$9d936a2aecb96285$export$2e2bcd8739ae039.healthBarWidthPixels/this.MaxHealth,i=this.graphics.current[0].graphic;i.width=this.CurHealth*t,this._fillColor.graphics.current[0].graphic.width=i.width-2,this.healthBarOpacity=1,this.CurHealth<=this.MaxHealth/4?this._fillColor.color=$jgD1p.Color.Red:this.CurHealth<=this.MaxHealth/2&&(this._fillColor.color=$jgD1p.Color.Yellow)}}class $1536b058750c3eeb$export$eefe978c73a9a6 extends $jgD1p.Actor{static CollisionGroup=$jgD1p.CollisionGroupManager.create("enemy");_currentAttackingTower=null;_occupiedTile=null;static TileDataEnemyCounterKey="enemies";constructor(e,t,i,n){const r=$9d936a2aecb96285$export$2e2bcd8739ae039.enemy[e];super({name:"Enemy",x:i,y:n,width:r.width,height:r.height,color:r.color,collisionType:$jgD1p.CollisionType.Active,collisionGroup:$1536b058750c3eeb$export$eefe978c73a9a6.CollisionGroup,vel:new $jgD1p.Vector(-1*r.speed,0)}),this.addTag("enemy"),this.type=e,this._grid=t,this._configValues=r,this.maxHealth=this._configValues.health,this.currentHp=this.maxHealth,this.damage=this._configValues.damage,this.on("postcollision",(e=>this.onPostCollision(e))),this.on("kill",(e=>this.onKill(e)));const s=$9d936a2aecb96285$export$2e2bcd8739ae039.enemy[this.type].sprite?.toSprite();s&&this.graphics.use(s);const o=$jgD1p.SpriteSheet.fromImageSource({image:$7c4c300842bd4cf2$export$e9a269813a6315a4.TurtleSheet,grid:{rows:1,columns:8,spriteHeight:64,spriteWidth:64}});this.turtleAnim=$jgD1p.Animation.fromSpriteSheet(o,$jgD1p.range(0,7),200,$jgD1p.AnimationStrategy.Loop);const a=$jgD1p.SpriteSheet.fromImageSource({image:$7c4c300842bd4cf2$export$e9a269813a6315a4.CrabSheet,grid:{rows:1,columns:3,spriteHeight:64,spriteWidth:64}});switch(this.crabAnim=$jgD1p.Animation.fromSpriteSheet(a,$jgD1p.range(0,2),200,$jgD1p.AnimationStrategy.PingPong),this.type){case $1536b058750c3eeb$export$1a91c501cca01afe.Turtle:this.graphics.use(this.turtleAnim);break;case $1536b058750c3eeb$export$1a91c501cca01afe.Crab:this.graphics.use(this.crabAnim)}this.healthBar=new $c1dde4dfd69f9e67$export$427ab9d1af813cd(this.maxHealth),this.addChild(this.healthBar)}takeDamage(e){this.currentHp-=e,this.healthBar.takeDamage(e),$7c4c300842bd4cf2$export$e9a269813a6315a4.FxImpactEnemyRock.play(),this.currentHp<=0&&this.kill()}_stopped=!1;stop(){this._stopped=!0}isAttacking(){return!!this._currentAttackingTower&&this._currentAttackingTower.active}static addEnemyToTile(e){e.data.has($1536b058750c3eeb$export$eefe978c73a9a6.TileDataEnemyCounterKey)?e.data.set($1536b058750c3eeb$export$eefe978c73a9a6.TileDataEnemyCounterKey,e.data.get($1536b058750c3eeb$export$eefe978c73a9a6.TileDataEnemyCounterKey)+1):e.data.set($1536b058750c3eeb$export$eefe978c73a9a6.TileDataEnemyCounterKey,1)}static removeEnemyFromTile(e){const t=this.enemiesInTile(e);t<=1&&e.data.delete($1536b058750c3eeb$export$eefe978c73a9a6.TileDataEnemyCounterKey),e.data.set($1536b058750c3eeb$export$eefe978c73a9a6.TileDataEnemyCounterKey,t-1)}static enemiesInTile(e){return e.data.has($1536b058750c3eeb$export$eefe978c73a9a6.TileDataEnemyCounterKey)?e.data.get($1536b058750c3eeb$export$eefe978c73a9a6.TileDataEnemyCounterKey):0}onKill(e){null!=this._occupiedTile&&$1536b058750c3eeb$export$eefe978c73a9a6.removeEnemyFromTile(this._occupiedTile)}claimTile(e){this._occupiedTile!=e&&(null!=this._occupiedTile&&$1536b058750c3eeb$export$eefe978c73a9a6.removeEnemyFromTile(this._occupiedTile),this._occupiedTile=e,null!=this._occupiedTile&&$1536b058750c3eeb$export$eefe978c73a9a6.addEnemyToTile(this._occupiedTile))}_damageTimer=0;onPostCollision(e){if(e.other instanceof $383a203830abe9d2$export$eba177f38926edac){if(this._damageTimer<=0){this._damageTimer=this._configValues.damageTimerMs;e.other.takeDamage(this.damage)}this.vel=new $jgD1p.Vector(0,0)}}onPostUpdate(e,t){if(this._stopped)return;this._damageTimer-=t;const i=this._grid.tileMap.getTileByPoint(this.pos.sub($jgD1p.vec(this.width/2,0)));this.claimTile(i),this.isAttacking()||(this.vel=new $jgD1p.Vector(-1*$9d936a2aecb96285$export$2e2bcd8739ae039.enemy[this.type].speed,0))}}let $1536b058750c3eeb$export$1a91c501cca01afe;!function(e){e.Crab="crab",e.Turtle="turtle"}($1536b058750c3eeb$export$1a91c501cca01afe||($1536b058750c3eeb$export$1a91c501cca01afe={}));var $jgD1p=parcelRequire("jgD1p"),$1b5031d44df7baeb$exports={},$b56da5de5b72d494$exports={},$b56da5de5b72d494$var$slice=$b63e377f8a561b77$exports.slice,$b56da5de5b72d494$var$pluck=$b63e377f8a561b77$exports.pluck,$b56da5de5b72d494$var$each=$b63e377f8a561b77$exports.each,$b56da5de5b72d494$var$bind=$b63e377f8a561b77$exports.bind,$b56da5de5b72d494$var$create=$b63e377f8a561b77$exports.create,$b56da5de5b72d494$var$isList=$b63e377f8a561b77$exports.isList,$b56da5de5b72d494$var$isFunction=$b63e377f8a561b77$exports.isFunction,$b56da5de5b72d494$var$isObject=$b63e377f8a561b77$exports.isObject;$b56da5de5b72d494$exports={createStore:$b56da5de5b72d494$var$createStore};var $b56da5de5b72d494$var$storeAPI={version:"2.0.12",enabled:!1,get:function(e,t){var i=this.storage.read(this._namespacePrefix+e);return this._deserialize(i,t)},set:function(e,t){return void 0===t?this.remove(e):(this.storage.write(this._namespacePrefix+e,this._serialize(t)),t)},remove:function(e){this.storage.remove(this._namespacePrefix+e)},each:function(e){var t=this;this.storage.each((function(i,n){e.call(t,t._deserialize(i),(n||"").replace(t._namespaceRegexp,""))}))},clearAll:function(){this.storage.clearAll()},hasNamespace:function(e){return this._namespacePrefix=="__storejs_"+e+"_"},createStore:function(){return $b56da5de5b72d494$var$createStore.apply(this,arguments)},addPlugin:function(e){this._addPlugin(e)},namespace:function(e){return $b56da5de5b72d494$var$createStore(this.storage,this.plugins,e)}};function $b56da5de5b72d494$var$_warn(){var e="undefined"==typeof console?null:console;if(e){var t=e.warn?e.warn:e.log;t.apply(e,arguments)}}function $b56da5de5b72d494$var$createStore(e,t,i){i||(i=""),e&&!$b56da5de5b72d494$var$isList(e)&&(e=[e]),t&&!$b56da5de5b72d494$var$isList(t)&&(t=[t]);var n=i?"__storejs_"+i+"_":"",r=i?new RegExp("^"+n):null;if(!/^[a-zA-Z0-9_\-]*$/.test(i))throw new Error("store.js namespaces can only have alphanumerics + underscores and dashes");var s={_namespacePrefix:n,_namespaceRegexp:r,_testStorage:function(e){try{var t="__storejs__test__";e.write(t,t);var i=e.read(t)===t;return e.remove(t),i}catch(e){return!1}},_assignPluginFnProp:function(e,t){var i=this[t];this[t]=function(){var t=$b56da5de5b72d494$var$slice(arguments,0),n=this;function r(){if(i)return $b56da5de5b72d494$var$each(arguments,(function(e,i){t[i]=e})),i.apply(n,t)}var s=[r].concat(t);return e.apply(n,s)}},_serialize:function(e){return JSON.stringify(e)},_deserialize:function(e,t){if(!e)return t;var i="";try{i=JSON.parse(e)}catch(t){i=e}return void 0!==i?i:t},_addStorage:function(e){this.enabled||this._testStorage(e)&&(this.storage=e,this.enabled=!0)},_addPlugin:function(e){var t=this;if($b56da5de5b72d494$var$isList(e))$b56da5de5b72d494$var$each(e,(function(e){t._addPlugin(e)}));else if(!$b56da5de5b72d494$var$pluck(this.plugins,(function(t){return e===t}))){if(this.plugins.push(e),!$b56da5de5b72d494$var$isFunction(e))throw new Error("Plugins must be function values that return objects");var i=e.call(this);if(!$b56da5de5b72d494$var$isObject(i))throw new Error("Plugins must return an object of function properties");$b56da5de5b72d494$var$each(i,(function(i,n){if(!$b56da5de5b72d494$var$isFunction(i))throw new Error("Bad plugin property: "+n+" from plugin "+e.name+". Plugins should only return functions.");t._assignPluginFnProp(i,n)}))}},addStorage:function(e){$b56da5de5b72d494$var$_warn("store.addStorage(storage) is deprecated. Use createStore([storages])"),this._addStorage(e)}},o=$b56da5de5b72d494$var$create(s,$b56da5de5b72d494$var$storeAPI,{plugins:[]});return o.raw={},$b56da5de5b72d494$var$each(o,(function(e,t){$b56da5de5b72d494$var$isFunction(e)&&(o.raw[t]=$b56da5de5b72d494$var$bind(o,e))})),$b56da5de5b72d494$var$each(e,(function(e){o._addStorage(e)})),$b56da5de5b72d494$var$each(t,(function(e){o._addPlugin(e)})),o}var $f590d80a5de1f4a7$exports={};$f590d80a5de1f4a7$exports=[parcelRequire("7mbQa"),parcelRequire("deyjU"),parcelRequire("eCrE3"),parcelRequire("hmYM5"),parcelRequire("64b1H"),parcelRequire("ibNr9")];var $1b5031d44df7baeb$var$plugins=[parcelRequire("8RueS")];$1b5031d44df7baeb$exports=$b56da5de5b72d494$exports.createStore($f590d80a5de1f4a7$exports,$1b5031d44df7baeb$var$plugins);let $3d149cbfd3136500$export$6b7b6cff4ccb438b={muteBackgroundMusic:!1,muteAll:!1},$3d149cbfd3136500$var$_origPreferences={...$3d149cbfd3136500$export$6b7b6cff4ccb438b};function $3d149cbfd3136500$export$de31a87075fdbfcc(){$3d149cbfd3136500$export$6b7b6cff4ccb438b={...$3d149cbfd3136500$var$_origPreferences}}function $3d149cbfd3136500$export$f1786e2fa4419c16(){$parcel$interopDefault($1b5031d44df7baeb$exports).set("pref",$3d149cbfd3136500$export$6b7b6cff4ccb438b)}function $3d149cbfd3136500$export$add4fa36ca2fc569(){$3d149cbfd3136500$export$6b7b6cff4ccb438b={...$3d149cbfd3136500$export$6b7b6cff4ccb438b,...$parcel$interopDefault($1b5031d44df7baeb$exports).get("pref")}}var $jgD1p=parcelRequire("jgD1p"),$jgD1p=parcelRequire("jgD1p");class $1b9c19121388f259$export$ef2184bd89960b14{constructor(e,t,i,n,r){this.tileMap=new $jgD1p.TileMap({name:"Sand Grid",pos:e,width:i,height:t,tileWidth:n,tileHeight:r}),this.tileMap.z=-1;const s=$7c4c300842bd4cf2$export$e9a269813a6315a4.Sand.toSprite();for(let e of this.tileMap.tiles)e.addGraphic(s)}}var $jgD1p=parcelRequire("jgD1p");class $202a856f300cb394$export$6d3bb735c0cfe084 extends $jgD1p.Actor{constructor(e,t,i){super({name:"Sand Castle",pos:e.tileMap.pos.add($jgD1p.vec(-$9d936a2aecb96285$export$2e2bcd8739ae039.grid.tileWidth/2,i*$9d936a2aecb96285$export$2e2bcd8739ae039.grid.tileHeight+$9d936a2aecb96285$export$2e2bcd8739ae039.grid.tileHeight/2)),width:$9d936a2aecb96285$export$2e2bcd8739ae039.grid.tileWidth,height:$9d936a2aecb96285$export$2e2bcd8739ae039.grid.tileHeight,collisionType:$jgD1p.CollisionType.Fixed,collisionGroup:$jgD1p.CollisionGroup.collidesWith([$1536b058750c3eeb$export$eefe978c73a9a6.CollisionGroup])}),this.gameOver=t,this.maxHp=$9d936a2aecb96285$export$2e2bcd8739ae039.sandcastle.maxHealth,this.currentHp=this.maxHp,this.on("postcollision",(e=>this.onPostCollision(e)));const n=$7c4c300842bd4cf2$export$e9a269813a6315a4.SandCastle.toSprite();this.graphics.use(n),this.healthBar=new $c1dde4dfd69f9e67$export$427ab9d1af813cd(this.maxHp),this.addChild(this.healthBar)}onPostCollision(e){this.takeDamage(),e.other.kill()}takeDamage(){this.currentHp-=1,this.healthBar.takeDamage(1),$7c4c300842bd4cf2$export$e9a269813a6315a4.FxImpactCastleByEnemy.play(),this.currentHp<=0&&(this.kill(),this.gameOver.triggerGameOver())}}var $jgD1p=parcelRequire("jgD1p");class $de8be84271b58ead$export$be9b8cc71a71c056{constructor(e,t){this.level=e,this.random=t,this.possibleSpawnTiles=[];for(let e=0;e<$9d936a2aecb96285$export$2e2bcd8739ae039.grid.height;e++)this.possibleSpawnTiles.push(this.level.grid.tileMap.getTile($9d936a2aecb96285$export$2e2bcd8739ae039.grid.width-1,e))}spawnEnemy(e,t,i){const n=this.level.grid.tileMap.getTile(t,i),r=new $1536b058750c3eeb$export$eefe978c73a9a6(e,this.level.grid,n.pos.x+$9d936a2aecb96285$export$2e2bcd8739ae039.grid.tileWidth/2,n.pos.y+$9d936a2aecb96285$export$2e2bcd8739ae039.grid.tileHeight/2);return this.level.add(r),r.claimTile(n),r}spawnEnemyAtRandomTile(e,t){const i=this.random.integer(0,this.possibleSpawnTiles.length-1);return this.spawnEnemy(e,$9d936a2aecb96285$export$2e2bcd8739ae039.grid.width-1,i)}spawnEnemies(e,t){const i=this.random.pickSet($jgD1p.range(0,this.possibleSpawnTiles.length-1),t,!0);let n=[];for(let t of i)n.push(this.spawnEnemy(e,$9d936a2aecb96285$export$2e2bcd8739ae039.grid.width-1,t));return n}}var $jgD1p=parcelRequire("jgD1p"),$jgD1p=parcelRequire("jgD1p");class $8a50fef1724e9620$export$252b2ceb7b3e3d5d extends $jgD1p.Actor{constructor(e,t,i,n,r){console.log("Making broken tower"),super({name:"BrokenTower",pos:t.pos.add($jgD1p.vec($9d936a2aecb96285$export$2e2bcd8739ae039.grid.tileWidth/2,$9d936a2aecb96285$export$2e2bcd8739ae039.grid.tileHeight/2)),width:$9d936a2aecb96285$export$2e2bcd8739ae039.grid.tileWidth,height:$9d936a2aecb96285$export$2e2bcd8739ae039.grid.tileHeight,collisionType:$jgD1p.CollisionType.PreventCollision});const s=$9d936a2aecb96285$export$2e2bcd8739ae039.tower[e].spriteBroken?.toSprite();s&&this.graphics.use(s),$8a50fef1724e9620$export$252b2ceb7b3e3d5d.removeBrokenTower(t),t.data.set($8a50fef1724e9620$export$252b2ceb7b3e3d5d.DataKey,this)}towerOpacity=1;towerOpacityFade=5;onPostUpdate(e,t){this.towerOpacity>=0&&(this.towerOpacity=this.towerOpacity-1*t/1e3/this.towerOpacityFade,this.graphics.opacity=this.towerOpacity)}static DataKey="BrokenTower";static removeBrokenTower(e){e.data.has($8a50fef1724e9620$export$252b2ceb7b3e3d5d.DataKey)&&(e.data.get($8a50fef1724e9620$export$252b2ceb7b3e3d5d.DataKey).kill(),e.data.delete($8a50fef1724e9620$export$252b2ceb7b3e3d5d.DataKey))}}class $26db8c8762619bb5$export$d97afb273a2ed2b9{_highlightedTile=null;selectedTowerType=$383a203830abe9d2$export$13e3300c8755380c.default;constructor(e,t){this._grid=e,this._engine=t,t.input.pointers.primary.on("move",(e=>this.onPointerMove(e))),t.input.pointers.primary.on("down",(e=>this.onConfirm(e))),this._highlight=new $jgD1p.Actor({pos:$jgD1p.vec(-100,-100)}),this.ghostTower=new $jgD1p.Actor,this.ghostTower.graphics.opacity=.5,this._highlight.onPostUpdate=()=>{null!=this._highlightedTile&&(this._highlightedTile.data.has("tower")?(this._rect.strokeColor=$jgD1p.Color.Yellow,this._placeable=!1):$1536b058750c3eeb$export$eefe978c73a9a6.enemiesInTile(this._highlightedTile)>0||this._highlightedTile.data.has("water")?(this._placeable=!this._highlightedTile.data.has("water"),this._rect.strokeColor=$jgD1p.Color.Red):(this._rect.strokeColor=$jgD1p.Color.Green,this._placeable=!0),this.updateGhostTowerVisibility())},this._rect=new $jgD1p.Rectangle({width:$9d936a2aecb96285$export$2e2bcd8739ae039.grid.tileWidth,height:$9d936a2aecb96285$export$2e2bcd8739ae039.grid.tileHeight,color:$jgD1p.Color.Transparent,strokeColor:$jgD1p.Color.Green,lineWidth:3,lineDash:[3,3]}),this._highlight.graphics.use(this._rect),t.add(this._highlight),t.add(this.ghostTower)}_placeable=!0;_hasSprite=!0;showGhostTower(){return this._placeable&&this._hasSprite}updateGhostTowerVisibility(){this.ghostTower.graphics.visible=this.showGhostTower()}onPointerMove(e){const t=this._grid.tileMap.getTileByPoint(e.worldPos),i=$9d936a2aecb96285$export$2e2bcd8739ae039.tower[window.TowerPickerUI.selectedTower()]?.sprite?.toSprite();i?(this.ghostTower.graphics.use(i),this._hasSprite=!0):this._hasSprite=!1,this.updateGhostTowerVisibility(),t&&(this._highlightedTile=t,this._highlight.pos=this._highlightedTile.pos.add($jgD1p.vec($9d936a2aecb96285$export$2e2bcd8739ae039.grid.tileWidth/2,$9d936a2aecb96285$export$2e2bcd8739ae039.grid.tileHeight/2)),this.ghostTower.pos=this._highlight.pos)}onConfirm(e){if(e.pointerType===$jgD1p.Input.PointerType.Touch){const t=this._grid.tileMap.getTileByPoint(e.worldPos);t&&(this._highlightedTile=t,this._highlight.pos=this._highlightedTile.pos.add($jgD1p.vec($9d936a2aecb96285$export$2e2bcd8739ae039.grid.tileWidth/2,$9d936a2aecb96285$export$2e2bcd8739ae039.grid.tileHeight/2)))}if(e.pointerType===$jgD1p.Input.PointerType.Mouse){if(2===e.nativeEvent.button)return}if(this._highlightedTile)if(this._highlightedTile.data.has("tower")||this._highlightedTile.data.has("water"))console.log("Tower already there!");else if($1536b058750c3eeb$export$eefe978c73a9a6.enemiesInTile(this._highlightedTile)>0)console.log("Enemy already there!");else{const e=window.TowerPickerUI.selectedTower(),t=new $383a203830abe9d2$export$eba177f38926edac(e,this._grid,this._highlightedTile.x,this._highlightedTile.y);$128d6f7911904d7e$export$e3425b961a6a8509.SubtractMoney(t.cost)&&(this._highlightedTile.data.set("tower",t),$8a50fef1724e9620$export$252b2ceb7b3e3d5d.removeBrokenTower(this._highlightedTile),this._engine.add(t),$7c4c300842bd4cf2$export$e9a269813a6315a4.FxPlaceTower.play())}}}var $jgD1p=parcelRequire("jgD1p");class $143290d3d7adafdc$export$75538c773353a2ee extends $jgD1p.Actor{constructor(e){super({name:"WaveDispatcher"}),this._spawner=e,this._textActor=new $jgD1p.Actor({pos:$jgD1p.vec($9d936a2aecb96285$export$2e2bcd8739ae039.grid.width*$9d936a2aecb96285$export$2e2bcd8739ae039.grid.tileWidth+500,$9d936a2aecb96285$export$2e2bcd8739ae039.grid.height/2*$9d936a2aecb96285$export$2e2bcd8739ae039.grid.tileHeight),z:10}),this._text=new $jgD1p.Text({text:"Wave 1",font:new $jgD1p.Font({size:32,family:"Kanit, sans-serif",quality:8,smoothing:!0})}),this._textActor.graphics.use(this._text),this.addChild(this._textActor)}onInitialize(e){}_stopped=!1;stop(){this._stopped=!0}_currentTime=0;_currentWave=0;_currentEnemies=[];_dispatched=[];onPostUpdate(e,t){if(this._stopped)return;this._currentTime+=t,$9d936a2aecb96285$export$2e2bcd8739ae039.waves[this._currentWave]&&this._dispatched.length===Object.keys($9d936a2aecb96285$export$2e2bcd8739ae039.waves[this._currentWave].offsets).length&&this.enemiesComplete()&&(this._currentWave++,this._currentTime=0,this._dispatched.length=0,this._currentEnemies.length=0,console.log("Wave Complete"));const i=$9d936a2aecb96285$export$2e2bcd8739ae039.waves[this._currentWave];if(i)for(let e in i.offsets)if(!this._dispatched.find((t=>t===Number(e)))&&this._currentTime/1e3>=Number(e)){this.isBeginningOfWave()&&this.showWaveBanner(),this._dispatched.push(Number(e));for(let t of i.offsets[e])this._currentEnemies=this._currentEnemies.concat(this._spawner.spawnEnemies(t.type,t.count))}}enemiesComplete(){return this._currentEnemies.every((e=>!e.active))}isBeginningOfWave(){return 0===this._dispatched.length}showWaveBanner(){$7c4c300842bd4cf2$export$e9a269813a6315a4.FxWaveAppear.play();const e=$9d936a2aecb96285$export$2e2bcd8739ae039.waves[this._currentWave];this._text.text=e.name,this._textActor.actions.easeTo($jgD1p.vec($9d936a2aecb96285$export$2e2bcd8739ae039.grid.tileWidth*$9d936a2aecb96285$export$2e2bcd8739ae039.grid.width/1.33,$9d936a2aecb96285$export$2e2bcd8739ae039.grid.height/2*$9d936a2aecb96285$export$2e2bcd8739ae039.grid.tileHeight),1e3,$jgD1p.EasingFunctions.EaseInOutCubic),this._textActor.actions.delay(1e3),this._textActor.actions.easeTo(this._textActor.pos.add($jgD1p.vec(1e3,0)),1e3,$jgD1p.EasingFunctions.EaseInOutCubic),this._textActor.actions.callMethod((()=>{this._textActor.pos=$jgD1p.vec($9d936a2aecb96285$export$2e2bcd8739ae039.grid.width*$9d936a2aecb96285$export$2e2bcd8739ae039.grid.tileWidth+500,$9d936a2aecb96285$export$2e2bcd8739ae039.grid.height/2*$9d936a2aecb96285$export$2e2bcd8739ae039.grid.tileHeight)}))}}var $jgD1p=parcelRequire("jgD1p");class $3ce5eaa42dfda069$export$5b8da01f83922c02{constructor(e,t,i){this.engine=e,this.level=t,this.waveDispatcher=i,this.enemyQuery=this.engine.currentScene.world.queryManager.createQuery(["enemy"]);const n=new $jgD1p.Text({text:"Game Over",font:new $jgD1p.Font({size:64,family:"Kanit, sans-serif",quality:4,smoothing:!0,filtering:$jgD1p.ImageFiltering.Blended})});this.gameOverActor=new $jgD1p.Actor({pos:$jgD1p.vec(e.screen.center.x,800),z:10,collisionType:$jgD1p.CollisionType.PreventCollision}),this.gameOverActor.graphics.use(n),e.currentScene.add(this.gameOverActor);const r=document.getElementById("restart-game");r?.addEventListener("click",(()=>this.restart())),this.restartGame$=r}triggerGameOver(){this.waveDispatcher.stop();const e=this.enemyQuery.getEntities();for(let t of e){const e=t.get($jgD1p.MotionComponent);e&&setTimeout((()=>{t.stop(),e.vel=$jgD1p.Vector.Zero}))}this.gameOverActor.actions.easeTo($jgD1p.vec(this.engine.screen.center.x,200),1e3,$jgD1p.EasingFunctions.EaseInOutCubic).blink(2e3,1e3),this.restartGame$.style.visibility="visible"}restart(){this.level.restart(),this.restartGame$.style.visibility="hidden"}}var $jgD1p=parcelRequire("jgD1p"),$60313e3b9e75c852$exports={};
/*!
  Copyright (c) 2018 Jed Watson.
  Licensed under the MIT License (MIT), see
  http://jedwatson.github.io/classnames
*/!function(){var e={}.hasOwnProperty;function t(){for(var i=[],n=0;n<arguments.length;n++){var r=arguments[n];if(r){var s=typeof r;if("string"===s||"number"===s)i.push(r);else if(Array.isArray(r)){if(r.length){var o=t.apply(null,r);o&&i.push(o)}}else if("object"===s)if(r.toString===Object.prototype.toString)for(var a in r)e.call(r,a)&&r[a]&&i.push(a);else i.push(r.toString())}}return i.join(" ")}$60313e3b9e75c852$exports?(t.default=t,$60313e3b9e75c852$exports=t):"function"==typeof define&&"object"==typeof define.amd&&define.amd?define("classnames",[],(function(){return t})):window.classNames=t}();class $613a632b39062363$export$a62869ddf53aa3e3{static setSoundSpecificVolume(){$7c4c300842bd4cf2$export$e9a269813a6315a4.Clank.volume=.5,$7c4c300842bd4cf2$export$e9a269813a6315a4.FxWaveAppear.volume=.8,$7c4c300842bd4cf2$export$e9a269813a6315a4.FxImpactEnemyRock.volume=.4,$7c4c300842bd4cf2$export$e9a269813a6315a4.FxImpactTowerByEnemy.volume=.5,$7c4c300842bd4cf2$export$e9a269813a6315a4.FxImpactCastleByEnemy.volume=.7,$7c4c300842bd4cf2$export$e9a269813a6315a4.FxPlaceTower.volume=1,$7c4c300842bd4cf2$export$e9a269813a6315a4.UiPickTower.volume=.3}static init(){$613a632b39062363$export$a62869ddf53aa3e3.setSoundSpecificVolume(),$3d149cbfd3136500$export$6b7b6cff4ccb438b.muteBackgroundMusic&&$613a632b39062363$export$a62869ddf53aa3e3.muteBackgroundMusic(),$3d149cbfd3136500$export$6b7b6cff4ccb438b.muteAll&&$613a632b39062363$export$a62869ddf53aa3e3.muteAll(),$("#mute-music").on("click",(()=>($3d149cbfd3136500$export$6b7b6cff4ccb438b.muteBackgroundMusic?$613a632b39062363$export$a62869ddf53aa3e3.unmuteBackgroundMusic():$613a632b39062363$export$a62869ddf53aa3e3.muteBackgroundMusic(),$3d149cbfd3136500$export$f1786e2fa4419c16(),!1))),$("#mute-all").on("click",(()=>($3d149cbfd3136500$export$6b7b6cff4ccb438b.muteAll?$613a632b39062363$export$a62869ddf53aa3e3.unmuteAll():$613a632b39062363$export$a62869ddf53aa3e3.muteAll(),$3d149cbfd3136500$export$f1786e2fa4419c16(),!1)))}static muteAll(){$3d149cbfd3136500$export$6b7b6cff4ccb438b.muteAll=!0,$3d149cbfd3136500$export$6b7b6cff4ccb438b.muteBackgroundMusic=!0;for(let e in $7c4c300842bd4cf2$export$e9a269813a6315a4){let t=$7c4c300842bd4cf2$export$e9a269813a6315a4[e];t instanceof $jgD1p.Sound&&(t.volume=0)}$613a632b39062363$export$a62869ddf53aa3e3.muteBackgroundMusic(),$613a632b39062363$export$a62869ddf53aa3e3._updateMuteAllButton()}static unmuteAll(){for(var e in $3d149cbfd3136500$export$6b7b6cff4ccb438b.muteAll=!1,$3d149cbfd3136500$export$6b7b6cff4ccb438b.muteBackgroundMusic=!1,$7c4c300842bd4cf2$export$e9a269813a6315a4){let t=$7c4c300842bd4cf2$export$e9a269813a6315a4[e];t instanceof $jgD1p.Sound&&(t.volume=$9d936a2aecb96285$export$2e2bcd8739ae039.SoundVolume)}$613a632b39062363$export$a62869ddf53aa3e3.setSoundSpecificVolume(),$613a632b39062363$export$a62869ddf53aa3e3.unmuteBackgroundMusic(),$613a632b39062363$export$a62869ddf53aa3e3._updateMuteAllButton()}static startBackgroundMusic(){$7c4c300842bd4cf2$export$e9a269813a6315a4.BackgroundAmbiance.volume=$3d149cbfd3136500$export$6b7b6cff4ccb438b.muteBackgroundMusic?0:$9d936a2aecb96285$export$2e2bcd8739ae039.BackgroundAmbianceVolume,$7c4c300842bd4cf2$export$e9a269813a6315a4.BackgroundAmbiance.loop=!0,$7c4c300842bd4cf2$export$e9a269813a6315a4.BackgroundAmbiance.isPlaying()||$7c4c300842bd4cf2$export$e9a269813a6315a4.BackgroundAmbiance.play(),$7c4c300842bd4cf2$export$e9a269813a6315a4.BackgroundMusic.volume=$3d149cbfd3136500$export$6b7b6cff4ccb438b.muteBackgroundMusic?0:$9d936a2aecb96285$export$2e2bcd8739ae039.BackgroundMusicVolume,$7c4c300842bd4cf2$export$e9a269813a6315a4.BackgroundMusic.loop=!0,$7c4c300842bd4cf2$export$e9a269813a6315a4.BackgroundMusic.isPlaying()||$7c4c300842bd4cf2$export$e9a269813a6315a4.BackgroundMusic.play()}static stopBackgroundMusic(){$7c4c300842bd4cf2$export$e9a269813a6315a4.BackgroundAmbiance.loop=!1,$7c4c300842bd4cf2$export$e9a269813a6315a4.BackgroundMusic.loop=!1}static muteBackgroundMusic(){$3d149cbfd3136500$export$6b7b6cff4ccb438b.muteBackgroundMusic=!0,$7c4c300842bd4cf2$export$e9a269813a6315a4.BackgroundAmbiance.volume=0,$7c4c300842bd4cf2$export$e9a269813a6315a4.BackgroundMusic.volume=0,$613a632b39062363$export$a62869ddf53aa3e3._updateMusicButton()}static unmuteBackgroundMusic(){$3d149cbfd3136500$export$6b7b6cff4ccb438b.muteBackgroundMusic=!1,$7c4c300842bd4cf2$export$e9a269813a6315a4.BackgroundAmbiance.volume=$9d936a2aecb96285$export$2e2bcd8739ae039.BackgroundAmbianceVolume,$7c4c300842bd4cf2$export$e9a269813a6315a4.BackgroundMusic.volume=$9d936a2aecb96285$export$2e2bcd8739ae039.BackgroundMusicVolume,$613a632b39062363$export$a62869ddf53aa3e3._updateMusicButton()}static _updateMusicButton(){$("#mute-music i").get(0).className=$parcel$interopDefault($60313e3b9e75c852$exports)("fa",{"fa-music":!$3d149cbfd3136500$export$6b7b6cff4ccb438b.muteBackgroundMusic,"fa-play":$3d149cbfd3136500$export$6b7b6cff4ccb438b.muteBackgroundMusic})}static _updateMuteAllButton(){$("#mute-all i").get(0).className=$parcel$interopDefault($60313e3b9e75c852$exports)("fa",{"fa-volume-up":!$3d149cbfd3136500$export$6b7b6cff4ccb438b.muteAll,"fa-volume-off":$3d149cbfd3136500$export$6b7b6cff4ccb438b.muteAll})}}var $jgD1p=parcelRequire("jgD1p");class $25cac55b35f98e31$export$1832bdd7a783545e extends $jgD1p.Actor{constructor(e,t,i,n,r){const s=e.tileMap.getTile($9d936a2aecb96285$export$2e2bcd8739ae039.grid.width-1,0).pos;super({name:"Water",pos:$jgD1p.vec(s.x+t,i*$9d936a2aecb96285$export$2e2bcd8739ae039.grid.tileHeight-2*$9d936a2aecb96285$export$2e2bcd8739ae039.grid.tileHeight+n),width:$9d936a2aecb96285$export$2e2bcd8739ae039.grid.tileWidth,height:$9d936a2aecb96285$export$2e2bcd8739ae039.grid.tileHeight,collisionType:$jgD1p.CollisionType.PreventCollision}),this.grid=e,this.phaseYOffset=n,this.delay=r;const o=$7c4c300842bd4cf2$export$e9a269813a6315a4.Water.toSprite();this.graphics.use(o)}onInitialize(){const e=this.pos.clone();this.actions.delay(this.delay),this.actions.repeatForever((t=>{t.easeTo(e.add($jgD1p.vec(-20,0)),3e3,$jgD1p.EasingFunctions.EaseInOutCubic),t.easeTo(e.add($jgD1p.vec(20,0)),3e3,$jgD1p.EasingFunctions.EaseInOutCubic)}))}}class $84ab826914df134a$export$ca664994d1d54bff extends $jgD1p.Scene{random=new $jgD1p.Random(Date.now());sandCastles=[];_playerWealthTick=0;_playerWealthGeneration=$9d936a2aecb96285$export$2e2bcd8739ae039.player.passiveWealthTick;onPostUpdate(e,t){this._playerWealthTick+=t/1e3,this._playerWealthTick>=this._playerWealthGeneration&&($128d6f7911904d7e$export$e3425b961a6a8509.AddMoney($9d936a2aecb96285$export$2e2bcd8739ae039.player.passiveWealthAmt),this._playerWealthTick=0)}onInitialize(e){$613a632b39062363$export$a62869ddf53aa3e3.startBackgroundMusic(),$9d936a2aecb96285$export$2e2bcd8739ae039.Seed=this.random.seed,this.grid=new $1b9c19121388f259$export$ef2184bd89960b14($jgD1p.vec($9d936a2aecb96285$export$2e2bcd8739ae039.grid.tileWidth,0),$9d936a2aecb96285$export$2e2bcd8739ae039.grid.height,$9d936a2aecb96285$export$2e2bcd8739ae039.grid.width,$9d936a2aecb96285$export$2e2bcd8739ae039.grid.tileWidth,$9d936a2aecb96285$export$2e2bcd8739ae039.grid.tileHeight),this.add(this.grid.tileMap);for(let e=0;e<2*$9d936a2aecb96285$export$2e2bcd8739ae039.grid.height;e++){const t=new $25cac55b35f98e31$export$1832bdd7a783545e(this.grid,$9d936a2aecb96285$export$2e2bcd8739ae039.grid.tileWidth/2,e,0,0);t.z=0,this.add(t);const i=new $25cac55b35f98e31$export$1832bdd7a783545e(this.grid,$9d936a2aecb96285$export$2e2bcd8739ae039.grid.tileWidth,e,$9d936a2aecb96285$export$2e2bcd8739ae039.grid.tileHeight/2,500);i.z=5,this.add(i);const n=this.grid.tileMap.getTile($9d936a2aecb96285$export$2e2bcd8739ae039.grid.width-1,e);n&&n.data.set("water",!0)}this.enemyGenerator=new $de8be84271b58ead$export$be9b8cc71a71c056(this,this.random);const t=new $383a203830abe9d2$export$eba177f38926edac($383a203830abe9d2$export$13e3300c8755380c.default,this.grid,4,3);this.grid.tileMap.getTile(4,3).data.set("tower",t),this.add(t);const i=new $383a203830abe9d2$export$eba177f38926edac($383a203830abe9d2$export$13e3300c8755380c.sandBucket,this.grid,0,3);this.grid.tileMap.getTile(0,3).data.set("tower",i),this.add(i);const n=()=>{console.log("adding tutorial enemy");const e=this.enemyGenerator.spawnEnemy($1536b058750c3eeb$export$1a91c501cca01afe.Crab,7,3);this.add(e)},r=new $jgD1p.Timer({interval:5e3,fcn:()=>{n()}});this.add(r),r.start(),this.towerPlacer=new $26db8c8762619bb5$export$d97afb273a2ed2b9(this.grid,e),this.waveDispatcher=new $143290d3d7adafdc$export$75538c773353a2ee(this.enemyGenerator),this.add(this.waveDispatcher),this.gameOver=new $3ce5eaa42dfda069$export$5b8da01f83922c02(e,this,this.waveDispatcher);for(let e=0;e<$9d936a2aecb96285$export$2e2bcd8739ae039.grid.height;e++){const t=new $202a856f300cb394$export$6d3bb735c0cfe084(this.grid,this.gameOver,e);this.sandCastles.push(t),this.add(t)}const s=new $jgD1p.Actor({pos:$jgD1p.vec(e.screen.resolution.width/2,e.screen.resolution.height-32),height:50,width:50,color:$jgD1p.Color.Orange,z:-1});s.graphics.use($7c4c300842bd4cf2$export$e9a269813a6315a4.BottomBorder.toSprite()),this.add(s);document.getElementById("towerSelection").style.display="flex"}restart(){this.engine.currentScene.entities.forEach((e=>e.kill())),this.engine.currentScene.onInitialize(this.engine),$128d6f7911904d7e$export$e3425b961a6a8509.moneyResource=$9d936a2aecb96285$export$2e2bcd8739ae039.player.startingMonies}}var $d82f9d57af76c42b$exports={},t1;
/*! For license information please see dev-tools.js.LICENSE.txt */function $a4c493de23d91c5d$var$___$insertStyle(e){if(e&&"undefined"!=typeof window){var t=document.createElement("style");return t.setAttribute("type","text/css"),t.innerHTML=e,document.head.appendChild(t),e}}function $a4c493de23d91c5d$var$colorToString(e,t){var i=e.__state.conversionName.toString(),n=Math.round(e.r),r=Math.round(e.g),s=Math.round(e.b),o=e.a,a=Math.round(e.h),l=e.s.toFixed(1),c=e.v.toFixed(1);if(t||"THREE_CHAR_HEX"===i||"SIX_CHAR_HEX"===i){for(var d=e.hex.toString(16);d.length<6;)d="0"+d;return"#"+d}return"CSS_RGB"===i?"rgb("+n+","+r+","+s+")":"CSS_RGBA"===i?"rgba("+n+","+r+","+s+","+o+")":"HEX"===i?"0x"+e.hex.toString(16):"RGB_ARRAY"===i?"["+n+","+r+","+s+"]":"RGBA_ARRAY"===i?"["+n+","+r+","+s+","+o+"]":"RGB_OBJ"===i?"{r:"+n+",g:"+r+",b:"+s+"}":"RGBA_OBJ"===i?"{r:"+n+",g:"+r+",b:"+s+",a:"+o+"}":"HSV_OBJ"===i?"{h:"+a+",s:"+l+",v:"+c+"}":"HSVA_OBJ"===i?"{h:"+a+",s:"+l+",v:"+c+",a:"+o+"}":"unknown format"}self,t1=parcelRequire("jgD1p"),$d82f9d57af76c42b$exports=(()=>{var e={"./picker-system.ts":(e,t,i)=>{i.r(t),i.d(t,{PickerSystem:()=>r});var n=i("excalibur");class r extends n.System{constructor(){super(...arguments),this.types=["ex.transform"],this.systemType=n.SystemType.Update,this.priority=99,this.lastFrameEntityToPointers=new Map,this.currentFrameEntityToPointers=new Map}initialize(e){this._engine=e.engine,this._receiver=this._engine.input.pointers}addPointerToEntity(e,t){if(!this.currentFrameEntityToPointers.has(e.id))return void this.currentFrameEntityToPointers.set(e.id,[t]);const i=this.currentFrameEntityToPointers.get(e.id);this.currentFrameEntityToPointers.set(e.id,i.concat(t))}_processPointerToEntity(e){var t;let i,r,s;for(const o of e)if(!(o instanceof n.Particle)){if(i=o.get(n.TransformComponent),r=o.get(n.ColliderComponent),r){const e=r.get();if(e)for(const[t,r]of this._receiver.currentFramePointerCoords.entries())e.contains(i.coordPlane===n.CoordPlane.World?r.worldPos:r.screenPos)&&this.addPointerToEntity(o,t)}if(s=o.get(n.GraphicsComponent),s){const e=s.localBounds.transform(i.getGlobalMatrix());for(const[t,r]of this._receiver.currentFramePointerCoords.entries())e.contains(i.coordPlane===n.CoordPlane.World?r.worldPos:r.screenPos)&&this.addPointerToEntity(o,t)}if(!(null===(t=null==s?void 0:s.current)||void 0===t?void 0:t.length)&&!(null==r?void 0:r.get())||o instanceof n.ParticleEmitter){const e=n.BoundingBox.fromDimension(100,100).transform(i.getGlobalMatrix());for(const[t,r]of this._receiver.currentFramePointerCoords.entries())e.contains(i.coordPlane===n.CoordPlane.World?r.worldPos:r.screenPos)&&this.addPointerToEntity(o,t)}}}update(e,t){this._processPointerToEntity(e),this.lastFrameEntityToPointers.clear(),this.lastFrameEntityToPointers=new Map(this.currentFrameEntityToPointers),this.currentFrameEntityToPointers.clear()}}},"./node_modules/tweakpane/dist/tweakpane.js":function(e,t){!function(e){class t{constructor(e){this.controller_=e}get disabled(){return this.controller_.viewProps.get("disabled")}set disabled(e){this.controller_.viewProps.set("disabled",e)}get hidden(){return this.controller_.viewProps.get("hidden")}set hidden(e){this.controller_.viewProps.set("hidden",e)}dispose(){this.controller_.viewProps.set("disposed",!0)}}class i{constructor(e){this.target=e}}class n extends i{constructor(e,t,i,n){super(e),this.value=t,this.presetKey=i,this.last=null==n||n}}class r extends i{constructor(e,t,i){super(e),this.value=t,this.presetKey=i}}class s extends i{constructor(e,t){super(e),this.expanded=t}}function o(e){return null==e}function a(e,t){if(e.length!==t.length)return!1;for(let i=0;i<e.length;i++)if(e[i]!==t[i])return!1;return!0}const l={alreadydisposed:()=>"View has been already disposed",invalidparams:e=>`Invalid parameters for '${e.name}'`,nomatchingcontroller:e=>`No matching controller for '${e.key}'`,nomatchingview:e=>`No matching view for '${JSON.stringify(e.params)}'`,notbindable:()=>"Value is not bindable",propertynotfound:e=>`Property '${e.name}' not found`,shouldneverhappen:()=>"This error should never happen"};class c{constructor(e){var t;this.message=null!==(t=l[e.type](e.context))&&void 0!==t?t:"Unexpected error",this.name=this.constructor.name,this.stack=new Error(this.message).stack,this.type=e.type}static alreadyDisposed(){return new c({type:"alreadydisposed"})}static notBindable(){return new c({type:"notbindable"})}static propertyNotFound(e){return new c({type:"propertynotfound",context:{name:e}})}static shouldNeverHappen(){return new c({type:"shouldneverhappen"})}}class d{constructor(e,t,i){this.obj_=e,this.key_=t,this.presetKey_=null!=i?i:t}static isBindable(e){return null!==e&&"object"==typeof e}get key(){return this.key_}get presetKey(){return this.presetKey_}read(){return this.obj_[this.key_]}write(e){this.obj_[this.key_]=e}writeProperty(e,t){const i=this.read();if(!d.isBindable(i))throw c.notBindable();if(!(e in i))throw c.propertyNotFound(e);i[e]=t}}class h extends t{get label(){return this.controller_.props.get("label")}set label(e){this.controller_.props.set("label",e)}get title(){var e;return null!==(e=this.controller_.valueController.props.get("title"))&&void 0!==e?e:""}set title(e){this.controller_.valueController.props.set("title",e)}on(e,t){const n=t.bind(this);return this.controller_.valueController.emitter.on(e,(()=>{n(new i(this))})),this}}class u{constructor(){this.observers_={}}on(e,t){let i=this.observers_[e];return i||(i=this.observers_[e]=[]),i.push({handler:t}),this}off(e,t){const i=this.observers_[e];return i&&(this.observers_[e]=i.filter((e=>e.handler!==t))),this}emit(e,t){const i=this.observers_[e];i&&i.forEach((e=>{e.handler(t)}))}}const p="tp";function f(e){return(t,i)=>[p,"-",e,"v",t?`_${t}`:"",i?`-${i}`:""].join("")}function g(e){return e.rawValue}function m(e,t){var i,n;e.emitter.on("change",(i=g,n=t,e=>n(i(e)))),t(e.rawValue)}function _(e,t,i){m(e.value(t),i)}function v(e,t){return i=>{!function(e,t,i){i?e.classList.add(t):e.classList.remove(t)}(e,t,i)}}function b(e,t){m(e,(e=>{t.textContent=null!=e?e:""}))}const w=f("btn");class y{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(w()),t.viewProps.bindClassModifiers(this.element);const i=e.createElement("button");i.classList.add(w("b")),t.viewProps.bindDisabled(i),this.element.appendChild(i),this.buttonElement=i;const n=e.createElement("div");n.classList.add(w("t")),b(t.props.value("title"),n),this.buttonElement.appendChild(n)}}class x{constructor(e,t){this.emitter=new u,this.onClick_=this.onClick_.bind(this),this.props=t.props,this.viewProps=t.viewProps,this.view=new y(e,{props:this.props,viewProps:this.viewProps}),this.view.buttonElement.addEventListener("click",this.onClick_)}onClick_(){this.emitter.emit("click",{sender:this})}}class ${constructor(e,t){var i;this.constraint_=null==t?void 0:t.constraint,this.equals_=null!==(i=null==t?void 0:t.equals)&&void 0!==i?i:(e,t)=>e===t,this.emitter=new u,this.rawValue_=e}get constraint(){return this.constraint_}get rawValue(){return this.rawValue_}set rawValue(e){this.setRawValue(e,{forceEmit:!1,last:!0})}setRawValue(e,t){const i=null!=t?t:{forceEmit:!1,last:!0},n=this.constraint_?this.constraint_.constrain(e):e;(!this.equals_(this.rawValue_,n)||i.forceEmit)&&(this.emitter.emit("beforechange",{sender:this}),this.rawValue_=n,this.emitter.emit("change",{options:i,rawValue:n,sender:this}))}}class C{constructor(e){this.emitter=new u,this.value_=e}get rawValue(){return this.value_}set rawValue(e){this.setRawValue(e,{forceEmit:!1,last:!0})}setRawValue(e,t){const i=null!=t?t:{forceEmit:!1,last:!0};(this.value_!==e||i.forceEmit)&&(this.emitter.emit("beforechange",{sender:this}),this.value_=e,this.emitter.emit("change",{options:i,rawValue:this.value_,sender:this}))}}function S(e,t){const i=null==t?void 0:t.constraint,n=null==t?void 0:t.equals;return i||n?new $(e,t):new C(e)}class E{constructor(e){this.emitter=new u,this.valMap_=e;for(const e in this.valMap_)this.valMap_[e].emitter.on("change",(()=>{this.emitter.emit("change",{key:e,sender:this})}))}static createCore(e){return Object.keys(e).reduce(((t,i)=>Object.assign(t,{[i]:S(e[i])})),{})}static fromObject(e){const t=this.createCore(e);return new E(t)}get(e){return this.valMap_[e].rawValue}set(e,t){this.valMap_[e].rawValue=t}value(e){return this.valMap_[e]}}function P(e){return t=>i=>{if(!t&&void 0===i)return{succeeded:!1,value:void 0};if(t&&void 0===i)return{succeeded:!0,value:void 0};const n=e(i);return void 0!==n?{succeeded:!0,value:n}:{succeeded:!1,value:void 0}}}function k(e){return{custom:t=>P(t)(e),boolean:P((e=>"boolean"==typeof e?e:void 0))(e),number:P((e=>"number"==typeof e?e:void 0))(e),string:P((e=>"string"==typeof e?e:void 0))(e),function:P((e=>"function"==typeof e?e:void 0))(e),constant:t=>P((e=>e===t?t:void 0))(e),raw:P((e=>e))(e),object:t=>P((e=>{if(null!==(i=e)&&"object"==typeof i)return function(e,t){return Object.keys(t).reduce(((i,n)=>{if(void 0===i)return;const r=(0,t[n])(e[n]);return r.succeeded?Object.assign(Object.assign({},i),{[n]:r.value}):void 0}),{})}(e,t);var i}))(e),array:t=>P((e=>{if(Array.isArray(e))return i=t,e.reduce(((e,t)=>{if(void 0===e)return;const n=i(t);return n.succeeded&&void 0!==n.value?[...e,n.value]:void 0}),[]);var i}))(e)}}const T={optional:k(!0),required:k(!1)};function A(e,t){const i=T.required.object(t)(e);return i.succeeded?i.value:void 0}const D=f(""),R={veryfirst:"vfst",first:"fst",last:"lst",verylast:"vlst"};class I{constructor(e){this.parent_=null,this.blade=e.blade,this.view=e.view,this.viewProps=e.viewProps;const t=this.view.element;this.blade.value("positions").emitter.on("change",(()=>{["veryfirst","first","last","verylast"].forEach((e=>{t.classList.remove(D(void 0,R[e]))})),this.blade.get("positions").forEach((e=>{t.classList.add(D(void 0,R[e]))}))})),this.viewProps.handleDispose((()=>{!function(e){e&&e.parentElement&&e.parentElement.removeChild(e)}(t)}))}get parent(){return this.parent_}}const M="http://www.w3.org/2000/svg";function L(e){e.offsetHeight}function B(e){return void 0!==e.ontouchstart}function F(){return new Function("return this")().document}const O={check:'<path d="M2 8l4 4l8 -8"/>',dropdown:'<path d="M5 7h6l-3 3 z"/>',p2dpad:'<path d="M8 4v8"/><path d="M4 8h8"/><circle cx="12" cy="12" r="1.2"/>'};function z(e,t){const i=e.createElementNS(M,"svg");return i.innerHTML=O[t],i}function N(e,t,i){e.insertBefore(t,e.children[i])}function V(e){e.parentElement&&e.parentElement.removeChild(e)}function U(e){for(;e.children.length>0;)e.removeChild(e.children[0])}function H(e){return e.relatedTarget?e.relatedTarget:"explicitOriginalTarget"in e?e.explicitOriginalTarget:null}const j=f("lbl");class W{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(j()),t.viewProps.bindClassModifiers(this.element);const i=e.createElement("div");i.classList.add(j("l")),_(t.props,"label",(t=>{o(t)?this.element.classList.add(j(void 0,"nol")):(this.element.classList.remove(j(void 0,"nol")),function(e){for(;e.childNodes.length>0;)e.removeChild(e.childNodes[0])}(i),i.appendChild(function(e,t){const i=e.createDocumentFragment();return t.split("\n").map((t=>e.createTextNode(t))).forEach(((t,n)=>{n>0&&i.appendChild(e.createElement("br")),i.appendChild(t)})),i}(e,t)))})),this.element.appendChild(i),this.labelElement=i;const n=e.createElement("div");n.classList.add(j("v")),this.element.appendChild(n),this.valueElement=n}}class G extends I{constructor(e,t){const i=t.valueController.viewProps;super(Object.assign(Object.assign({},t),{view:new W(e,{props:t.props,viewProps:i}),viewProps:i})),this.props=t.props,this.valueController=t.valueController,this.view.valueElement.appendChild(this.valueController.view.element)}}const q={id:"button",type:"blade",accept(e){const t=T,i=A(e,{title:t.required.string,view:t.required.constant("button"),label:t.optional.string});return i?{params:i}:null},controller:e=>new G(e.document,{blade:e.blade,props:E.fromObject({label:e.params.label}),valueController:new x(e.document,{props:E.fromObject({title:e.params.title}),viewProps:e.viewProps})}),api:e=>e.controller instanceof G&&e.controller.valueController instanceof x?new h(e.controller):null};class K extends I{constructor(e){super(e),this.value=e.value}}function X(){return new E({positions:S([],{equals:a})})}class Y extends E{constructor(e){super(e)}static create(e){const t={completed:!0,expanded:e,expandedHeight:null,shouldFixHeight:!1,temporaryExpanded:null},i=E.createCore(t);return new Y(i)}get styleExpanded(){var e;return null!==(e=this.get("temporaryExpanded"))&&void 0!==e?e:this.get("expanded")}get styleHeight(){if(!this.styleExpanded)return"0";const e=this.get("expandedHeight");return this.get("shouldFixHeight")&&!o(e)?`${e}px`:"auto"}bindExpandedClass(e,t){_(this,"expanded",(()=>{this.styleExpanded?e.classList.add(t):e.classList.remove(t)}))}}function Q(e,t){t.style.height=e.styleHeight}function Z(e,t){e.value("expanded").emitter.on("beforechange",(()=>{e.set("completed",!1),o(e.get("expandedHeight"))&&e.set("expandedHeight",function(e,t){let i=0;return function(e,t){const i=e.style.transition;e.style.transition="none",t(),e.style.transition=i}(t,(()=>{e.set("expandedHeight",null),e.set("temporaryExpanded",!0),L(t),i=t.clientHeight,e.set("temporaryExpanded",null),L(t)})),i}(e,t)),e.set("shouldFixHeight",!0),L(t)})),e.emitter.on("change",(()=>{Q(e,t)})),Q(e,t),t.addEventListener("transitionend",(t=>{"height"===t.propertyName&&(e.set("shouldFixHeight",!1),e.set("expandedHeight",null),e.set("completed",!0))}))}class J extends t{constructor(e,t){super(e),this.rackApi_=t}}class ee{constructor(e){this.emitter=new u,this.items_=[],this.cache_=new Set,this.onSubListAdd_=this.onSubListAdd_.bind(this),this.onSubListRemove_=this.onSubListRemove_.bind(this),this.extract_=e}get items(){return this.items_}allItems(){return Array.from(this.cache_)}find(e){for(const t of this.allItems())if(e(t))return t;return null}includes(e){return this.cache_.has(e)}add(e,t){if(this.includes(e))throw c.shouldNeverHappen();const i=void 0!==t?t:this.items_.length;this.items_.splice(i,0,e),this.cache_.add(e);const n=this.extract_(e);n&&(n.emitter.on("add",this.onSubListAdd_),n.emitter.on("remove",this.onSubListRemove_),n.allItems().forEach((e=>{this.cache_.add(e)}))),this.emitter.emit("add",{index:i,item:e,root:this,target:this})}remove(e){const t=this.items_.indexOf(e);if(t<0)return;this.items_.splice(t,1),this.cache_.delete(e);const i=this.extract_(e);i&&(i.emitter.off("add",this.onSubListAdd_),i.emitter.off("remove",this.onSubListRemove_)),this.emitter.emit("remove",{index:t,item:e,root:this,target:this})}onSubListAdd_(e){this.cache_.add(e.item),this.emitter.emit("add",{index:e.index,item:e.item,root:this,target:e.target})}onSubListRemove_(e){this.cache_.delete(e.item),this.emitter.emit("remove",{index:e.index,item:e.item,root:this,target:e.target})}}class te extends t{constructor(e){super(e),this.onBindingChange_=this.onBindingChange_.bind(this),this.emitter_=new u,this.controller_.binding.emitter.on("change",this.onBindingChange_)}get label(){return this.controller_.props.get("label")}set label(e){this.controller_.props.set("label",e)}on(e,t){const i=t.bind(this);return this.emitter_.on(e,(e=>{i(e.event)})),this}refresh(){this.controller_.binding.read()}onBindingChange_(e){const t=e.sender.target.read();this.emitter_.emit("change",{event:new n(this,t,this.controller_.binding.target.presetKey,e.options.last)})}}class ie extends G{constructor(e,t){super(e,t),this.binding=t.binding}}class ne extends t{constructor(e){super(e),this.onBindingUpdate_=this.onBindingUpdate_.bind(this),this.emitter_=new u,this.controller_.binding.emitter.on("update",this.onBindingUpdate_)}get label(){return this.controller_.props.get("label")}set label(e){this.controller_.props.set("label",e)}on(e,t){const i=t.bind(this);return this.emitter_.on(e,(e=>{i(e.event)})),this}refresh(){this.controller_.binding.read()}onBindingUpdate_(e){const t=e.sender.target.read();this.emitter_.emit("update",{event:new r(this,t,this.controller_.binding.target.presetKey)})}}class re extends G{constructor(e,t){super(e,t),this.binding=t.binding,this.viewProps.bindDisabled(this.binding.ticker),this.viewProps.handleDispose((()=>{this.binding.dispose()}))}}function se(e){return e instanceof le?e.apiSet_:e instanceof J?e.rackApi_.apiSet_:null}function oe(e,t){const i=e.find((e=>e.controller_===t));if(!i)throw c.shouldNeverHappen();return i}function ae(e,t,i){if(!d.isBindable(e))throw c.notBindable();return new d(e,t,i)}class le extends t{constructor(e,t){super(e),this.onRackAdd_=this.onRackAdd_.bind(this),this.onRackRemove_=this.onRackRemove_.bind(this),this.onRackInputChange_=this.onRackInputChange_.bind(this),this.onRackMonitorUpdate_=this.onRackMonitorUpdate_.bind(this),this.emitter_=new u,this.apiSet_=new ee(se),this.pool_=t;const i=this.controller_.rack;i.emitter.on("add",this.onRackAdd_),i.emitter.on("remove",this.onRackRemove_),i.emitter.on("inputchange",this.onRackInputChange_),i.emitter.on("monitorupdate",this.onRackMonitorUpdate_),i.children.forEach((e=>{this.setUpApi_(e)}))}get children(){return this.controller_.rack.children.map((e=>oe(this.apiSet_,e)))}addInput(e,t,i){const n=i||{},r=this.controller_.view.element.ownerDocument,s=this.pool_.createInput(r,ae(e,t,n.presetKey),n),o=new te(s);return this.add(o,n.index)}addMonitor(e,t,i){const n=i||{},r=this.controller_.view.element.ownerDocument,s=this.pool_.createMonitor(r,ae(e,t),n),o=new ne(s);return this.add(o,n.index)}addFolder(e){return function(e,t){return e.addBlade(Object.assign(Object.assign({},t),{view:"folder"}))}(this,e)}addButton(e){return function(e,t){return e.addBlade(Object.assign(Object.assign({},t),{view:"button"}))}(this,e)}addSeparator(e){return function(e,t){const i=t||{};return e.addBlade(Object.assign(Object.assign({},i),{view:"separator"}))}(this,e)}addTab(e){return function(e,t){return e.addBlade(Object.assign(Object.assign({},t),{view:"tab"}))}(this,e)}add(e,t){this.controller_.rack.add(e.controller_,t);const i=this.apiSet_.find((t=>t.controller_===e.controller_));return i&&this.apiSet_.remove(i),this.apiSet_.add(e),e}remove(e){this.controller_.rack.remove(e.controller_)}addBlade(e){const t=this.controller_.view.element.ownerDocument,i=this.pool_.createBlade(t,e),n=this.pool_.createBladeApi(i);return this.add(n,e.index)}on(e,t){const i=t.bind(this);return this.emitter_.on(e,(e=>{i(e.event)})),this}setUpApi_(e){this.apiSet_.find((t=>t.controller_===e))||this.apiSet_.add(this.pool_.createBladeApi(e))}onRackAdd_(e){this.setUpApi_(e.bladeController)}onRackRemove_(e){if(e.isRoot){const t=oe(this.apiSet_,e.bladeController);this.apiSet_.remove(t)}}onRackInputChange_(e){const t=e.bladeController;if(t instanceof ie){const i=oe(this.apiSet_,t),r=t.binding;this.emitter_.emit("change",{event:new n(i,r.target.read(),r.target.presetKey,e.options.last)})}else if(t instanceof K){const i=oe(this.apiSet_,t);this.emitter_.emit("change",{event:new n(i,t.value.rawValue,void 0,e.options.last)})}}onRackMonitorUpdate_(e){if(!(e.bladeController instanceof re))throw c.shouldNeverHappen();const t=oe(this.apiSet_,e.bladeController),i=e.bladeController.binding;this.emitter_.emit("update",{event:new r(t,i.target.read(),i.target.presetKey)})}}class ce extends J{constructor(e,t){super(e,new le(e.rackController,t)),this.emitter_=new u,this.controller_.foldable.value("expanded").emitter.on("change",(e=>{this.emitter_.emit("fold",{event:new s(this,e.sender.rawValue)})})),this.rackApi_.on("change",(e=>{this.emitter_.emit("change",{event:e})})),this.rackApi_.on("update",(e=>{this.emitter_.emit("update",{event:e})}))}get expanded(){return this.controller_.foldable.get("expanded")}set expanded(e){this.controller_.foldable.set("expanded",e)}get title(){return this.controller_.props.get("title")}set title(e){this.controller_.props.set("title",e)}get children(){return this.rackApi_.children}addInput(e,t,i){return this.rackApi_.addInput(e,t,i)}addMonitor(e,t,i){return this.rackApi_.addMonitor(e,t,i)}addFolder(e){return this.rackApi_.addFolder(e)}addButton(e){return this.rackApi_.addButton(e)}addSeparator(e){return this.rackApi_.addSeparator(e)}addTab(e){return this.rackApi_.addTab(e)}add(e,t){return this.rackApi_.add(e,t)}remove(e){this.rackApi_.remove(e)}addBlade(e){return this.rackApi_.addBlade(e)}on(e,t){const i=t.bind(this);return this.emitter_.on(e,(e=>{i(e.event)})),this}}class de extends I{constructor(e){super({blade:e.blade,view:e.view,viewProps:e.rackController.viewProps}),this.rackController=e.rackController}}class he{constructor(e,t){const i=f(t.viewName);this.element=e.createElement("div"),this.element.classList.add(i()),t.viewProps.bindClassModifiers(this.element)}}function ue(e){return e instanceof ge?e.rack:e instanceof de?e.rackController.rack:null}function pe(e){const t=ue(e);return t?t.bcSet_:null}class fe{constructor(e){var t;this.onBladePositionsChange_=this.onBladePositionsChange_.bind(this),this.onSetAdd_=this.onSetAdd_.bind(this),this.onSetRemove_=this.onSetRemove_.bind(this),this.onChildDispose_=this.onChildDispose_.bind(this),this.onChildPositionsChange_=this.onChildPositionsChange_.bind(this),this.onChildInputChange_=this.onChildInputChange_.bind(this),this.onChildMonitorUpdate_=this.onChildMonitorUpdate_.bind(this),this.onChildValueChange_=this.onChildValueChange_.bind(this),this.onChildViewPropsChange_=this.onChildViewPropsChange_.bind(this),this.onDescendantLayout_=this.onDescendantLayout_.bind(this),this.onDescendantInputChange_=this.onDescendantInputChange_.bind(this),this.onDescendantMonitorUpdate_=this.onDescendantMonitorUpdate_.bind(this),this.emitter=new u,this.blade_=null!=e?e:null,null===(t=this.blade_)||void 0===t||t.value("positions").emitter.on("change",this.onBladePositionsChange_),this.bcSet_=new ee(pe),this.bcSet_.emitter.on("add",this.onSetAdd_),this.bcSet_.emitter.on("remove",this.onSetRemove_)}get children(){return this.bcSet_.items}add(e,t){e.parent&&e.parent.remove(e),e.parent_=this,this.bcSet_.add(e,t)}remove(e){e.parent_=null,this.bcSet_.remove(e)}find(e){return this.bcSet_.allItems().filter((t=>t instanceof e))}onSetAdd_(e){this.updatePositions_();const t=e.target===e.root;if(this.emitter.emit("add",{bladeController:e.item,index:e.index,isRoot:t,sender:this}),!t)return;const i=e.item;if(i.viewProps.emitter.on("change",this.onChildViewPropsChange_),i.blade.value("positions").emitter.on("change",this.onChildPositionsChange_),i.viewProps.handleDispose(this.onChildDispose_),i instanceof ie)i.binding.emitter.on("change",this.onChildInputChange_);else if(i instanceof re)i.binding.emitter.on("update",this.onChildMonitorUpdate_);else if(i instanceof K)i.value.emitter.on("change",this.onChildValueChange_);else{const e=ue(i);if(e){const t=e.emitter;t.on("layout",this.onDescendantLayout_),t.on("inputchange",this.onDescendantInputChange_),t.on("monitorupdate",this.onDescendantMonitorUpdate_)}}}onSetRemove_(e){this.updatePositions_();const t=e.target===e.root;if(this.emitter.emit("remove",{bladeController:e.item,isRoot:t,sender:this}),!t)return;const i=e.item;if(i instanceof ie)i.binding.emitter.off("change",this.onChildInputChange_);else if(i instanceof re)i.binding.emitter.off("update",this.onChildMonitorUpdate_);else if(i instanceof K)i.value.emitter.off("change",this.onChildValueChange_);else{const e=ue(i);if(e){const t=e.emitter;t.off("layout",this.onDescendantLayout_),t.off("inputchange",this.onDescendantInputChange_),t.off("monitorupdate",this.onDescendantMonitorUpdate_)}}}updatePositions_(){const e=this.bcSet_.items.filter((e=>!e.viewProps.get("hidden"))),t=e[0],i=e[e.length-1];this.bcSet_.items.forEach((e=>{const n=[];e===t&&(n.push("first"),this.blade_&&!this.blade_.get("positions").includes("veryfirst")||n.push("veryfirst")),e===i&&(n.push("last"),this.blade_&&!this.blade_.get("positions").includes("verylast")||n.push("verylast")),e.blade.set("positions",n)}))}onChildPositionsChange_(){this.updatePositions_(),this.emitter.emit("layout",{sender:this})}onChildViewPropsChange_(e){this.updatePositions_(),this.emitter.emit("layout",{sender:this})}onChildDispose_(){this.bcSet_.items.filter((e=>e.viewProps.get("disposed"))).forEach((e=>{this.bcSet_.remove(e)}))}onChildInputChange_(e){const t=function(e,t){for(let i=0;i<e.length;i++){const n=e[i];if(n instanceof ie&&n.binding===t)return n}return null}(this.find(ie),e.sender);if(!t)throw c.shouldNeverHappen();this.emitter.emit("inputchange",{bladeController:t,options:e.options,sender:this})}onChildMonitorUpdate_(e){const t=function(e,t){for(let i=0;i<e.length;i++){const n=e[i];if(n instanceof re&&n.binding===t)return n}return null}(this.find(re),e.sender);if(!t)throw c.shouldNeverHappen();this.emitter.emit("monitorupdate",{bladeController:t,sender:this})}onChildValueChange_(e){const t=function(e,t){for(let i=0;i<e.length;i++){const n=e[i];if(n instanceof K&&n.value===t)return n}return null}(this.find(K),e.sender);if(!t)throw c.shouldNeverHappen();this.emitter.emit("inputchange",{bladeController:t,options:e.options,sender:this})}onDescendantLayout_(e){this.updatePositions_(),this.emitter.emit("layout",{sender:this})}onDescendantInputChange_(e){this.emitter.emit("inputchange",{bladeController:e.bladeController,options:e.options,sender:this})}onDescendantMonitorUpdate_(e){this.emitter.emit("monitorupdate",{bladeController:e.bladeController,sender:this})}onBladePositionsChange_(){this.updatePositions_()}}class ge extends I{constructor(e,t){super(Object.assign(Object.assign({},t),{view:new he(e,{viewName:"brk",viewProps:t.viewProps})})),this.onRackAdd_=this.onRackAdd_.bind(this),this.onRackRemove_=this.onRackRemove_.bind(this);const i=new fe(t.root?void 0:t.blade);i.emitter.on("add",this.onRackAdd_),i.emitter.on("remove",this.onRackRemove_),this.rack=i,this.viewProps.handleDispose((()=>{for(let e=this.rack.children.length-1;e>=0;e--)this.rack.children[e].viewProps.set("disposed",!0)}))}onRackAdd_(e){e.isRoot&&N(this.view.element,e.bladeController.view.element,e.index)}onRackRemove_(e){e.isRoot&&V(e.bladeController.view.element)}}const me=f("cnt");class _e{constructor(e,t){this.className_=f(t.viewName||"fld"),this.element=e.createElement("div"),this.element.classList.add(this.className_(),me()),t.viewProps.bindClassModifiers(this.element),this.foldable_=t.foldable,this.foldable_.bindExpandedClass(this.element,this.className_(void 0,"expanded")),_(this.foldable_,"completed",v(this.element,this.className_(void 0,"cpl")));const i=e.createElement("button");i.classList.add(this.className_("b")),_(t.props,"title",(e=>{o(e)?this.element.classList.add(this.className_(void 0,"not")):this.element.classList.remove(this.className_(void 0,"not"))})),t.viewProps.bindDisabled(i),this.element.appendChild(i),this.buttonElement=i;const n=e.createElement("div");n.classList.add(this.className_("t")),b(t.props.value("title"),n),this.buttonElement.appendChild(n),this.titleElement=n;const r=e.createElement("div");r.classList.add(this.className_("m")),this.buttonElement.appendChild(r);const s=t.containerElement;s.classList.add(this.className_("c")),this.element.appendChild(s),this.containerElement=s}}class ve extends de{constructor(e,t){var i;const n=Y.create(null===(i=t.expanded)||void 0===i||i),r=new ge(e,{blade:t.blade,root:t.root,viewProps:t.viewProps});super(Object.assign(Object.assign({},t),{rackController:r,view:new _e(e,{containerElement:r.view.element,foldable:n,props:t.props,viewName:t.root?"rot":void 0,viewProps:t.viewProps})})),this.onTitleClick_=this.onTitleClick_.bind(this),this.props=t.props,this.foldable=n,Z(this.foldable,this.view.containerElement),this.view.buttonElement.addEventListener("click",this.onTitleClick_)}get document(){return this.view.element.ownerDocument}onTitleClick_(){this.foldable.set("expanded",!this.foldable.get("expanded"))}}const be={id:"folder",type:"blade",accept(e){const t=T,i=A(e,{title:t.required.string,view:t.required.constant("folder"),expanded:t.optional.boolean});return i?{params:i}:null},controller:e=>new ve(e.document,{blade:e.blade,expanded:e.params.expanded,props:E.fromObject({title:e.params.title}),viewProps:e.viewProps}),api:e=>e.controller instanceof ve?new ce(e.controller,e.pool):null};class we extends K{constructor(e,t){const i=t.valueController.viewProps;super(Object.assign(Object.assign({},t),{value:t.valueController.value,view:new W(e,{props:t.props,viewProps:i}),viewProps:i})),this.props=t.props,this.valueController=t.valueController,this.view.valueElement.appendChild(this.valueController.view.element)}}class ye extends t{}const xe=f("spr");class $e{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(xe()),t.viewProps.bindClassModifiers(this.element);const i=e.createElement("hr");i.classList.add(xe("r")),this.element.appendChild(i)}}class Ce extends I{constructor(e,t){super(Object.assign(Object.assign({},t),{view:new $e(e,{viewProps:t.viewProps})}))}}const Se={id:"separator",type:"blade",accept(e){const t=A(e,{view:T.required.constant("separator")});return t?{params:t}:null},controller:e=>new Ce(e.document,{blade:e.blade,viewProps:e.viewProps}),api:e=>e.controller instanceof Ce?new ye(e.controller):null},Ee=f("");function Pe(e,t){return v(e,Ee(void 0,t))}class ke extends E{constructor(e){super(e)}static create(e){var t,i;const n=null!=e?e:{},r={disabled:null!==(t=n.disabled)&&void 0!==t&&t,disposed:!1,hidden:null!==(i=n.hidden)&&void 0!==i&&i},s=E.createCore(r);return new ke(s)}bindClassModifiers(e){_(this,"disabled",Pe(e,"disabled")),_(this,"hidden",Pe(e,"hidden"))}bindDisabled(e){_(this,"disabled",(t=>{e.disabled=t}))}bindTabIndex(e){_(this,"disabled",(t=>{e.tabIndex=t?-1:0}))}handleDispose(e){this.value("disposed").emitter.on("change",(t=>{t&&e()}))}}const Te=f("tbi");class Ae{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(Te()),t.viewProps.bindClassModifiers(this.element),_(t.props,"selected",(e=>{e?this.element.classList.add(Te(void 0,"sel")):this.element.classList.remove(Te(void 0,"sel"))}));const i=e.createElement("button");i.classList.add(Te("b")),t.viewProps.bindDisabled(i),this.element.appendChild(i),this.buttonElement=i;const n=e.createElement("div");n.classList.add(Te("t")),b(t.props.value("title"),n),this.buttonElement.appendChild(n),this.titleElement=n}}class De{constructor(e,t){this.emitter=new u,this.onClick_=this.onClick_.bind(this),this.props=t.props,this.viewProps=t.viewProps,this.view=new Ae(e,{props:t.props,viewProps:t.viewProps}),this.view.buttonElement.addEventListener("click",this.onClick_)}onClick_(){this.emitter.emit("click",{sender:this})}}class Re{constructor(e,t){this.onItemClick_=this.onItemClick_.bind(this),this.ic_=new De(e,{props:t.itemProps,viewProps:ke.create()}),this.ic_.emitter.on("click",this.onItemClick_),this.cc_=new ge(e,{blade:X(),viewProps:ke.create()}),this.props=t.props,_(this.props,"selected",(e=>{this.itemController.props.set("selected",e),this.contentController.viewProps.set("hidden",!e)}))}get itemController(){return this.ic_}get contentController(){return this.cc_}onItemClick_(){this.props.set("selected",!0)}}class Ie{constructor(e,t){this.controller_=e,this.rackApi_=t}get title(){var e;return null!==(e=this.controller_.itemController.props.get("title"))&&void 0!==e?e:""}set title(e){this.controller_.itemController.props.set("title",e)}get selected(){return this.controller_.props.get("selected")}set selected(e){this.controller_.props.set("selected",e)}get children(){return this.rackApi_.children}addButton(e){return this.rackApi_.addButton(e)}addFolder(e){return this.rackApi_.addFolder(e)}addSeparator(e){return this.rackApi_.addSeparator(e)}addTab(e){return this.rackApi_.addTab(e)}add(e,t){this.rackApi_.add(e,t)}remove(e){this.rackApi_.remove(e)}addInput(e,t,i){return this.rackApi_.addInput(e,t,i)}addMonitor(e,t,i){return this.rackApi_.addMonitor(e,t,i)}addBlade(e){return this.rackApi_.addBlade(e)}}class Me extends J{constructor(e,t){super(e,new le(e.rackController,t)),this.onPageAdd_=this.onPageAdd_.bind(this),this.onPageRemove_=this.onPageRemove_.bind(this),this.emitter_=new u,this.pageApiMap_=new Map,this.rackApi_.on("change",(e=>{this.emitter_.emit("change",{event:e})})),this.rackApi_.on("update",(e=>{this.emitter_.emit("update",{event:e})})),this.controller_.pageSet.emitter.on("add",this.onPageAdd_),this.controller_.pageSet.emitter.on("remove",this.onPageRemove_),this.controller_.pageSet.items.forEach((e=>{this.setUpPageApi_(e)}))}get pages(){return this.controller_.pageSet.items.map((e=>{const t=this.pageApiMap_.get(e);if(!t)throw c.shouldNeverHappen();return t}))}addPage(e){const t=this.controller_.view.element.ownerDocument,i=new Re(t,{itemProps:E.fromObject({selected:!1,title:e.title}),props:E.fromObject({selected:!1})});this.controller_.add(i,e.index);const n=this.pageApiMap_.get(i);if(!n)throw c.shouldNeverHappen();return n}removePage(e){this.controller_.remove(e)}on(e,t){const i=t.bind(this);return this.emitter_.on(e,(e=>{i(e.event)})),this}setUpPageApi_(e){const t=this.rackApi_.apiSet_.find((t=>t.controller_===e.contentController));if(!t)throw c.shouldNeverHappen();const i=new Ie(e,t);this.pageApiMap_.set(e,i)}onPageAdd_(e){this.setUpPageApi_(e.item)}onPageRemove_(e){if(!this.pageApiMap_.get(e.item))throw c.shouldNeverHappen();this.pageApiMap_.delete(e.item)}}const Le=f("tab");class Be{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(Le(),me()),t.viewProps.bindClassModifiers(this.element),m(t.empty,v(this.element,Le(void 0,"nop")));const i=e.createElement("div");i.classList.add(Le("i")),this.element.appendChild(i),this.itemsElement=i;const n=t.contentsElement;n.classList.add(Le("c")),this.element.appendChild(n),this.contentsElement=n}}class Fe extends de{constructor(e,t){const i=new ge(e,{blade:t.blade,viewProps:t.viewProps}),n=S(!0);super({blade:t.blade,rackController:i,view:new Be(e,{contentsElement:i.view.element,empty:n,viewProps:t.viewProps})}),this.onPageAdd_=this.onPageAdd_.bind(this),this.onPageRemove_=this.onPageRemove_.bind(this),this.onPageSelectedChange_=this.onPageSelectedChange_.bind(this),this.pageSet_=new ee((()=>null)),this.pageSet_.emitter.on("add",this.onPageAdd_),this.pageSet_.emitter.on("remove",this.onPageRemove_),this.empty_=n,this.applyPages_()}get pageSet(){return this.pageSet_}add(e,t){this.pageSet_.add(e,null!=t?t:this.pageSet_.items.length)}remove(e){this.pageSet_.remove(this.pageSet_.items[e])}applyPages_(){this.keepSelection_(),this.empty_.rawValue=0===this.pageSet_.items.length}onPageAdd_(e){const t=e.item;N(this.view.itemsElement,t.itemController.view.element,e.index),this.rackController.rack.add(t.contentController,e.index),t.props.value("selected").emitter.on("change",this.onPageSelectedChange_),this.applyPages_()}onPageRemove_(e){const t=e.item;V(t.itemController.view.element),this.rackController.rack.remove(t.contentController),t.props.value("selected").emitter.off("change",this.onPageSelectedChange_),this.applyPages_()}keepSelection_(){if(0===this.pageSet_.items.length)return;const e=this.pageSet_.items.findIndex((e=>e.props.get("selected")));e<0?this.pageSet_.items.forEach(((e,t)=>{e.props.set("selected",0===t)})):this.pageSet_.items.forEach(((t,i)=>{t.props.set("selected",i===e)}))}onPageSelectedChange_(e){if(e.rawValue){const t=this.pageSet_.items.findIndex((t=>t.props.value("selected")===e.sender));this.pageSet_.items.forEach(((e,i)=>{e.props.set("selected",i===t)}))}else this.keepSelection_()}}const Oe={id:"tab",type:"blade",accept(e){const t=T,i=A(e,{pages:t.required.array(t.required.object({title:t.required.string})),view:t.required.constant("tab")});return i&&0!==i.pages.length?{params:i}:null},controller(e){const t=new Fe(e.document,{blade:e.blade,viewProps:e.viewProps});return e.params.pages.forEach((i=>{const n=new Re(e.document,{itemProps:E.fromObject({selected:!1,title:i.title}),props:E.fromObject({selected:!1})});t.add(n)})),t},api:e=>e.controller instanceof Fe?new Me(e.controller,e.pool):null};class ze{constructor(){this.disabled=!1,this.emitter=new u}dispose(){}tick(){this.disabled||this.emitter.emit("tick",{sender:this})}}class Ne{constructor(e,t){this.disabled_=!1,this.timerId_=null,this.onTick_=this.onTick_.bind(this),this.doc_=e,this.emitter=new u,this.interval_=t,this.setTimer_()}get disabled(){return this.disabled_}set disabled(e){this.disabled_=e,this.disabled_?this.clearTimer_():this.setTimer_()}dispose(){this.clearTimer_()}clearTimer_(){if(null===this.timerId_)return;const e=this.doc_.defaultView;e&&e.clearInterval(this.timerId_),this.timerId_=null}setTimer_(){if(this.clearTimer_(),this.interval_<=0)return;const e=this.doc_.defaultView;e&&(this.timerId_=e.setInterval(this.onTick_,this.interval_))}onTick_(){this.disabled_||this.emitter.emit("tick",{sender:this})}}class Ve{constructor(e){this.constraints=e}constrain(e){return this.constraints.reduce(((e,t)=>t.constrain(e)),e)}}function Ue(e,t){if(e instanceof t)return e;if(e instanceof Ve){const i=e.constraints.reduce(((e,i)=>e||(i instanceof t?i:null)),null);if(i)return i}return null}class He{constructor(e){this.options=e}constrain(e){const t=this.options;return 0===t.length||t.filter((t=>t.value===e)).length>0?e:t[0].value}}class je{constructor(e){this.maxValue=e.max,this.minValue=e.min}constrain(e){let t=e;return o(this.minValue)||(t=Math.max(t,this.minValue)),o(this.maxValue)||(t=Math.min(t,this.maxValue)),t}}class We{constructor(e){this.step=e}constrain(e){return(e<0?-Math.round(-e/this.step):Math.round(e/this.step))*this.step}}const Ge=f("lst");class qe{constructor(e,t){this.onValueChange_=this.onValueChange_.bind(this),this.props_=t.props,this.element=e.createElement("div"),this.element.classList.add(Ge()),t.viewProps.bindClassModifiers(this.element);const i=e.createElement("select");i.classList.add(Ge("s")),_(this.props_,"options",(t=>{U(i),t.forEach(((t,n)=>{const r=e.createElement("option");r.dataset.index=String(n),r.textContent=t.text,r.value=String(t.value),i.appendChild(r)}))})),t.viewProps.bindDisabled(i),this.element.appendChild(i),this.selectElement=i;const n=e.createElement("div");n.classList.add(Ge("m")),n.appendChild(z(e,"dropdown")),this.element.appendChild(n),t.value.emitter.on("change",this.onValueChange_),this.value_=t.value,this.update_()}update_(){this.selectElement.value=String(this.value_.rawValue)}onValueChange_(){this.update_()}}class Ke{constructor(e,t){this.onSelectChange_=this.onSelectChange_.bind(this),this.props=t.props,this.value=t.value,this.viewProps=t.viewProps,this.view=new qe(e,{props:this.props,value:this.value,viewProps:this.viewProps}),this.view.selectElement.addEventListener("change",this.onSelectChange_)}onSelectChange_(e){const t=e.currentTarget.selectedOptions.item(0);if(!t)return;const i=Number(t.dataset.index);this.value.rawValue=this.props.get("options")[i].value}}const Xe=f("pop");class Ye{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(Xe()),t.viewProps.bindClassModifiers(this.element),m(t.shows,v(this.element,Xe(void 0,"v")))}}class Qe{constructor(e,t){this.shows=S(!1),this.viewProps=t.viewProps,this.view=new Ye(e,{shows:this.shows,viewProps:this.viewProps})}}const Ze=f("txt");class Je{constructor(e,t){this.onChange_=this.onChange_.bind(this),this.element=e.createElement("div"),this.element.classList.add(Ze()),t.viewProps.bindClassModifiers(this.element),this.props_=t.props,this.props_.emitter.on("change",this.onChange_);const i=e.createElement("input");i.classList.add(Ze("i")),i.type="text",t.viewProps.bindDisabled(i),this.element.appendChild(i),this.inputElement=i,t.value.emitter.on("change",this.onChange_),this.value_=t.value,this.refresh()}refresh(){const e=this.props_.get("formatter");this.inputElement.value=e(this.value_.rawValue)}onChange_(){this.refresh()}}class et{constructor(e,t){this.onInputChange_=this.onInputChange_.bind(this),this.parser_=t.parser,this.props=t.props,this.value=t.value,this.viewProps=t.viewProps,this.view=new Je(e,{props:t.props,value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_)}onInputChange_(e){const t=e.currentTarget.value,i=this.parser_(t);o(i)||(this.value.rawValue=i),this.view.refresh()}}function tt(e){return"false"!==e&&!!e}function it(e){return function(e){return String(e)}(e)}class nt{constructor(e){this.text=e}evaluate(){return Number(this.text)}toString(){return this.text}}const rt={"**":(e,t)=>Math.pow(e,t),"*":(e,t)=>e*t,"/":(e,t)=>e/t,"%":(e,t)=>e%t,"+":(e,t)=>e+t,"-":(e,t)=>e-t,"<<":(e,t)=>e<<t,">>":(e,t)=>e>>t,">>>":(e,t)=>e>>>t,"&":(e,t)=>e&t,"^":(e,t)=>e^t,"|":(e,t)=>e|t};class st{constructor(e,t,i){this.left=t,this.operator=e,this.right=i}evaluate(){const e=rt[this.operator];if(!e)throw new Error(`unexpected binary operator: '${this.operator}`);return e(this.left.evaluate(),this.right.evaluate())}toString(){return["b(",this.left.toString(),this.operator,this.right.toString(),")"].join(" ")}}const ot={"+":e=>e,"-":e=>-e,"~":e=>~e};class at{constructor(e,t){this.operator=e,this.expression=t}evaluate(){const e=ot[this.operator];if(!e)throw new Error(`unexpected unary operator: '${this.operator}`);return e(this.expression.evaluate())}toString(){return["u(",this.operator,this.expression.toString(),")"].join(" ")}}function lt(e){return(t,i)=>{for(let n=0;n<e.length;n++){const r=e[n](t,i);if(""!==r)return r}return""}}function ct(e,t){var i;const n=e.substr(t).match(/^\s+/);return null!==(i=n&&n[0])&&void 0!==i?i:""}function dt(e,t){var i;const n=e.substr(t).match(/^[0-9]+/);return null!==(i=n&&n[0])&&void 0!==i?i:""}function ht(e,t){const i=e.substr(t,1);if(t+=1,"e"!==i.toLowerCase())return"";const n=function(e,t){const i=dt(e,t);if(""!==i)return i;const n=e.substr(t,1);if("-"!==n&&"+"!==n)return"";const r=dt(e,t+=1);return""===r?"":n+r}(e,t);return""===n?"":i+n}function ut(e,t){const i=e.substr(t,1);if("0"===i)return i;const n=function(e,t){const i=e.substr(t,1);return i.match(/^[1-9]$/)?i:""}(e,t);return t+=n.length,""===n?"":n+dt(e,t)}const pt=lt([function(e,t){const i=ut(e,t);if(t+=i.length,""===i)return"";const n=e.substr(t,1);if(t+=n.length,"."!==n)return"";const r=dt(e,t);return i+n+r+ht(e,t+=r.length)},function(e,t){const i=e.substr(t,1);if(t+=i.length,"."!==i)return"";const n=dt(e,t);return t+=n.length,""===n?"":i+n+ht(e,t)},function(e,t){const i=ut(e,t);return t+=i.length,""===i?"":i+ht(e,t)}]),ft=lt([function(e,t){const i=e.substr(t,2);if(t+=i.length,"0b"!==i.toLowerCase())return"";const n=function(e,t){var i;const n=e.substr(t).match(/^[01]+/);return null!==(i=n&&n[0])&&void 0!==i?i:""}(e,t);return""===n?"":i+n},function(e,t){const i=e.substr(t,2);if(t+=i.length,"0o"!==i.toLowerCase())return"";const n=function(e,t){var i;const n=e.substr(t).match(/^[0-7]+/);return null!==(i=n&&n[0])&&void 0!==i?i:""}(e,t);return""===n?"":i+n},function(e,t){const i=e.substr(t,2);if(t+=i.length,"0x"!==i.toLowerCase())return"";const n=function(e,t){var i;const n=e.substr(t).match(/^[0-9a-f]+/i);return null!==(i=n&&n[0])&&void 0!==i?i:""}(e,t);return""===n?"":i+n}]),gt=lt([ft,pt]);function mt(e,t){return function(e,t){const i=gt(e,t);return t+=i.length,""===i?null:{evaluable:new nt(i),cursor:t}}(e,t)||function(e,t){const i=e.substr(t,1);if(t+=i.length,"("!==i)return null;const n=bt(e,t);if(!n)return null;t=n.cursor,t+=ct(e,t).length;const r=e.substr(t,1);return t+=r.length,")"!==r?null:{evaluable:n.evaluable,cursor:t}}(e,t)}function _t(e,t,i){i+=ct(t,i).length;const n=e.filter((e=>t.startsWith(e,i)))[0];return n?(i+=n.length,{cursor:i+=ct(t,i).length,operator:n}):null}const vt=[["**"],["*","/","%"],["+","-"],["<<",">>>",">>"],["&"],["^"],["|"]].reduce(((e,t)=>function(e,t){return(i,n)=>{const r=e(i,n);if(!r)return null;n=r.cursor;let s=r.evaluable;for(;;){const r=_t(t,i,n);if(!r)break;n=r.cursor;const o=e(i,n);if(!o)return null;n=o.cursor,s=new st(r.operator,s,o.evaluable)}return s?{cursor:n,evaluable:s}:null}}(e,t)),(function e(t,i){const n=mt(t,i);if(n)return n;const r=t.substr(i,1);if(i+=r.length,"+"!==r&&"-"!==r&&"~"!==r)return null;const s=e(t,i);return s?{cursor:i=s.cursor,evaluable:new at(r,s.evaluable)}:null}));function bt(e,t){return t+=ct(e,t).length,vt(e,t)}function wt(e){var t;const i=function(e){const t=bt(e,0);return t?t.cursor+ct(e,t.cursor).length!==e.length?null:t.evaluable:null}(e);return null!==(t=null==i?void 0:i.evaluate())&&void 0!==t?t:null}function yt(e){if("number"==typeof e)return e;if("string"==typeof e){const t=wt(e);if(!o(t))return t}return 0}function xt(e){return String(e)}function $t(e){return t=>t.toFixed(Math.max(Math.min(e,20),0))}const Ct=$t(0);function St(e){return Ct(e)+"%"}function Et(e){return String(e)}function Pt(e){return e}function kt(e,t){for(;e.length<t;)e.push(void 0)}function Tt(e){const t=[];return kt(t,e),S(t)}function At(e){const t=e.indexOf(void 0);return t<0?e:e.slice(0,t)}function Dt({primary:e,secondary:t,forward:i,backward:n}){let r=!1;function s(e){r||(r=!0,e(),r=!1)}e.emitter.on("change",(n=>{s((()=>{t.setRawValue(i(e,t),n.options)}))})),t.emitter.on("change",(r=>{s((()=>{e.setRawValue(n(e,t),r.options)})),s((()=>{t.setRawValue(i(e,t),r.options)}))})),s((()=>{t.setRawValue(i(e,t),{forceEmit:!1,last:!0})}))}function Rt(e,t){const i=e*(t.altKey?.1:1)*(t.shiftKey?10:1);return t.upKey?+i:t.downKey?-i:0}function It(e){return{altKey:e.altKey,downKey:"ArrowDown"===e.key,shiftKey:e.shiftKey,upKey:"ArrowUp"===e.key}}function Mt(e){return{altKey:e.altKey,downKey:"ArrowLeft"===e.key,shiftKey:e.shiftKey,upKey:"ArrowRight"===e.key}}function Lt(e){return function(e){return"ArrowUp"===e||"ArrowDown"===e}(e)||"ArrowLeft"===e||"ArrowRight"===e}function Bt(e,t){const i=t.ownerDocument.defaultView,n=t.getBoundingClientRect();return{x:e.pageX-((i&&i.scrollX||0)+n.left),y:e.pageY-((i&&i.scrollY||0)+n.top)}}class Ft{constructor(e){this.lastTouch_=null,this.onDocumentMouseMove_=this.onDocumentMouseMove_.bind(this),this.onDocumentMouseUp_=this.onDocumentMouseUp_.bind(this),this.onMouseDown_=this.onMouseDown_.bind(this),this.onTouchEnd_=this.onTouchEnd_.bind(this),this.onTouchMove_=this.onTouchMove_.bind(this),this.onTouchStart_=this.onTouchStart_.bind(this),this.elem_=e,this.emitter=new u,e.addEventListener("touchstart",this.onTouchStart_,{passive:!1}),e.addEventListener("touchmove",this.onTouchMove_,{passive:!0}),e.addEventListener("touchend",this.onTouchEnd_),e.addEventListener("mousedown",this.onMouseDown_)}computePosition_(e){const t=this.elem_.getBoundingClientRect();return{bounds:{width:t.width,height:t.height},point:e?{x:e.x,y:e.y}:null}}onMouseDown_(e){var t;e.preventDefault(),null===(t=e.currentTarget)||void 0===t||t.focus();const i=this.elem_.ownerDocument;i.addEventListener("mousemove",this.onDocumentMouseMove_),i.addEventListener("mouseup",this.onDocumentMouseUp_),this.emitter.emit("down",{altKey:e.altKey,data:this.computePosition_(Bt(e,this.elem_)),sender:this,shiftKey:e.shiftKey})}onDocumentMouseMove_(e){this.emitter.emit("move",{altKey:e.altKey,data:this.computePosition_(Bt(e,this.elem_)),sender:this,shiftKey:e.shiftKey})}onDocumentMouseUp_(e){const t=this.elem_.ownerDocument;t.removeEventListener("mousemove",this.onDocumentMouseMove_),t.removeEventListener("mouseup",this.onDocumentMouseUp_),this.emitter.emit("up",{altKey:e.altKey,data:this.computePosition_(Bt(e,this.elem_)),sender:this,shiftKey:e.shiftKey})}onTouchStart_(e){e.preventDefault();const t=e.targetTouches.item(0),i=this.elem_.getBoundingClientRect();this.emitter.emit("down",{altKey:e.altKey,data:this.computePosition_(t?{x:t.clientX-i.left,y:t.clientY-i.top}:void 0),sender:this,shiftKey:e.shiftKey}),this.lastTouch_=t}onTouchMove_(e){const t=e.targetTouches.item(0),i=this.elem_.getBoundingClientRect();this.emitter.emit("move",{altKey:e.altKey,data:this.computePosition_(t?{x:t.clientX-i.left,y:t.clientY-i.top}:void 0),sender:this,shiftKey:e.shiftKey}),this.lastTouch_=t}onTouchEnd_(e){var t;const i=null!==(t=e.targetTouches.item(0))&&void 0!==t?t:this.lastTouch_,n=this.elem_.getBoundingClientRect();this.emitter.emit("up",{altKey:e.altKey,data:this.computePosition_(i?{x:i.clientX-n.left,y:i.clientY-n.top}:void 0),sender:this,shiftKey:e.shiftKey})}}function Ot(e,t,i,n,r){return n+(e-t)/(i-t)*(r-n)}function zt(e){return String(e.toFixed(10)).split(".")[1].replace(/0+$/,"").length}function Nt(e,t,i){return Math.min(Math.max(e,t),i)}function Vt(e,t){return(e%t+t)%t}const Ut=f("txt");class Ht{constructor(e,t){this.onChange_=this.onChange_.bind(this),this.props_=t.props,this.props_.emitter.on("change",this.onChange_),this.element=e.createElement("div"),this.element.classList.add(Ut(),Ut(void 0,"num")),t.arrayPosition&&this.element.classList.add(Ut(void 0,t.arrayPosition)),t.viewProps.bindClassModifiers(this.element);const i=e.createElement("input");i.classList.add(Ut("i")),i.type="text",t.viewProps.bindDisabled(i),this.element.appendChild(i),this.inputElement=i,this.onDraggingChange_=this.onDraggingChange_.bind(this),this.dragging_=t.dragging,this.dragging_.emitter.on("change",this.onDraggingChange_),this.element.classList.add(Ut()),this.inputElement.classList.add(Ut("i"));const n=e.createElement("div");n.classList.add(Ut("k")),this.element.appendChild(n),this.knobElement=n;const r=e.createElementNS(M,"svg");r.classList.add(Ut("g")),this.knobElement.appendChild(r);const s=e.createElementNS(M,"path");s.classList.add(Ut("gb")),r.appendChild(s),this.guideBodyElem_=s;const o=e.createElementNS(M,"path");o.classList.add(Ut("gh")),r.appendChild(o),this.guideHeadElem_=o;const a=e.createElement("div");a.classList.add(f("tt")()),this.knobElement.appendChild(a),this.tooltipElem_=a,t.value.emitter.on("change",this.onChange_),this.value=t.value,this.refresh()}onDraggingChange_(e){if(null===e.rawValue)return void this.element.classList.remove(Ut(void 0,"drg"));this.element.classList.add(Ut(void 0,"drg"));const t=e.rawValue/this.props_.get("draggingScale"),i=t+(t>0?-1:t<0?1:0),n=Nt(-i,-4,4);this.guideHeadElem_.setAttributeNS(null,"d",[`M ${i+n},0 L${i},4 L${i+n},8`,`M ${t},-1 L${t},9`].join(" ")),this.guideBodyElem_.setAttributeNS(null,"d",`M 0,4 L${t},4`);const r=this.props_.get("formatter");this.tooltipElem_.textContent=r(this.value.rawValue),this.tooltipElem_.style.left=`${t}px`}refresh(){const e=this.props_.get("formatter");this.inputElement.value=e(this.value.rawValue)}onChange_(){this.refresh()}}class jt{constructor(e,t){this.originRawValue_=0,this.onInputChange_=this.onInputChange_.bind(this),this.onInputKeyDown_=this.onInputKeyDown_.bind(this),this.onInputKeyUp_=this.onInputKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.baseStep_=t.baseStep,this.parser_=t.parser,this.props=t.props,this.value=t.value,this.viewProps=t.viewProps,this.dragging_=S(null),this.view=new Ht(e,{arrayPosition:t.arrayPosition,dragging:this.dragging_,props:this.props,value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_),this.view.inputElement.addEventListener("keydown",this.onInputKeyDown_),this.view.inputElement.addEventListener("keyup",this.onInputKeyUp_);const i=new Ft(this.view.knobElement);i.emitter.on("down",this.onPointerDown_),i.emitter.on("move",this.onPointerMove_),i.emitter.on("up",this.onPointerUp_)}onInputChange_(e){const t=e.currentTarget.value,i=this.parser_(t);o(i)||(this.value.rawValue=i),this.view.refresh()}onInputKeyDown_(e){const t=Rt(this.baseStep_,It(e));0!==t&&this.value.setRawValue(this.value.rawValue+t,{forceEmit:!1,last:!1})}onInputKeyUp_(e){0!==Rt(this.baseStep_,It(e))&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}onPointerDown_(){this.originRawValue_=this.value.rawValue,this.dragging_.rawValue=0}computeDraggingValue_(e){if(!e.point)return null;const t=e.point.x-e.bounds.width/2;return this.originRawValue_+t*this.props.get("draggingScale")}onPointerMove_(e){const t=this.computeDraggingValue_(e.data);null!==t&&(this.value.setRawValue(t,{forceEmit:!1,last:!1}),this.dragging_.rawValue=this.value.rawValue-this.originRawValue_)}onPointerUp_(e){const t=this.computeDraggingValue_(e.data);null!==t&&(this.value.setRawValue(t,{forceEmit:!0,last:!0}),this.dragging_.rawValue=null)}}const Wt=f("sld");class Gt{constructor(e,t){this.onChange_=this.onChange_.bind(this),this.props_=t.props,this.props_.emitter.on("change",this.onChange_),this.element=e.createElement("div"),this.element.classList.add(Wt()),t.viewProps.bindClassModifiers(this.element);const i=e.createElement("div");i.classList.add(Wt("t")),t.viewProps.bindTabIndex(i),this.element.appendChild(i),this.trackElement=i;const n=e.createElement("div");n.classList.add(Wt("k")),this.trackElement.appendChild(n),this.knobElement=n,t.value.emitter.on("change",this.onChange_),this.value=t.value,this.update_()}update_(){const e=Nt(Ot(this.value.rawValue,this.props_.get("minValue"),this.props_.get("maxValue"),0,100),0,100);this.knobElement.style.width=`${e}%`}onChange_(){this.update_()}}class qt{constructor(e,t){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDownOrMove_=this.onPointerDownOrMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.baseStep_=t.baseStep,this.value=t.value,this.viewProps=t.viewProps,this.props=t.props,this.view=new Gt(e,{props:this.props,value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Ft(this.view.trackElement),this.ptHandler_.emitter.on("down",this.onPointerDownOrMove_),this.ptHandler_.emitter.on("move",this.onPointerDownOrMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.trackElement.addEventListener("keydown",this.onKeyDown_),this.view.trackElement.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(e,t){e.point&&this.value.setRawValue(Ot(Nt(e.point.x,0,e.bounds.width),0,e.bounds.width,this.props.get("minValue"),this.props.get("maxValue")),t)}onPointerDownOrMove_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerUp_(e){this.handlePointerEvent_(e.data,{forceEmit:!0,last:!0})}onKeyDown_(e){const t=Rt(this.baseStep_,Mt(e));0!==t&&this.value.setRawValue(this.value.rawValue+t,{forceEmit:!1,last:!1})}onKeyUp_(e){0!==Rt(this.baseStep_,Mt(e))&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}const Kt=f("sldtxt");class Xt{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(Kt());const i=e.createElement("div");i.classList.add(Kt("s")),this.sliderView_=t.sliderView,i.appendChild(this.sliderView_.element),this.element.appendChild(i);const n=e.createElement("div");n.classList.add(Kt("t")),this.textView_=t.textView,n.appendChild(this.textView_.element),this.element.appendChild(n)}}class Yt{constructor(e,t){this.value=t.value,this.viewProps=t.viewProps,this.sliderC_=new qt(e,{baseStep:t.baseStep,props:t.sliderProps,value:t.value,viewProps:this.viewProps}),this.textC_=new jt(e,{baseStep:t.baseStep,parser:t.parser,props:t.textProps,value:t.value,viewProps:t.viewProps}),this.view=new Xt(e,{sliderView:this.sliderC_.view,textView:this.textC_.view})}get sliderController(){return this.sliderC_}get textController(){return this.textC_}}function Qt(e,t){e.write(t)}function Zt(e){const t=T;return Array.isArray(e)?t.required.array(t.required.object({text:t.required.string,value:t.required.raw}))(e).value:"object"==typeof e?t.required.raw(e).value:void 0}function Jt(e){if("inline"===e||"popup"===e)return e}function ei(e){const t=T;return t.required.object({max:t.optional.number,min:t.optional.number,step:t.optional.number})(e).value}function ti(e){if(Array.isArray(e))return e;const t=[];return Object.keys(e).forEach((i=>{t.push({text:i,value:e[i]})})),t}function ii(e){return o(e)?null:new He(ti(e))}function ni(e){const t=e?Ue(e,He):null;return t?t.options:null}function ri(e,t){const i=e&&Ue(e,We);return i?zt(i.step):Math.max(zt(t),2)}function si(e){const t=function(e){const t=e?Ue(e,We):null;return t?t.step:null}(e);return null!=t?t:1}function oi(e,t){var i;const n=e&&Ue(e,We),r=Math.abs(null!==(i=null==n?void 0:n.step)&&void 0!==i?i:t);return 0===r?.1:Math.pow(10,Math.floor(Math.log10(r))-1)}const ai=f("ckb");class li{constructor(e,t){this.onValueChange_=this.onValueChange_.bind(this),this.element=e.createElement("div"),this.element.classList.add(ai()),t.viewProps.bindClassModifiers(this.element);const i=e.createElement("label");i.classList.add(ai("l")),this.element.appendChild(i);const n=e.createElement("input");n.classList.add(ai("i")),n.type="checkbox",i.appendChild(n),this.inputElement=n,t.viewProps.bindDisabled(this.inputElement);const r=e.createElement("div");r.classList.add(ai("w")),i.appendChild(r);const s=z(e,"check");r.appendChild(s),t.value.emitter.on("change",this.onValueChange_),this.value=t.value,this.update_()}update_(){this.inputElement.checked=this.value.rawValue}onValueChange_(){this.update_()}}class ci{constructor(e,t){this.onInputChange_=this.onInputChange_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.view=new li(e,{value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_)}onInputChange_(e){const t=e.currentTarget;this.value.rawValue=t.checked}}const di={id:"input-bool",type:"input",accept:(e,t)=>{if("boolean"!=typeof e)return null;const i=A(t,{options:T.optional.custom(Zt)});return i?{initialValue:e,params:i}:null},binding:{reader:e=>tt,constraint:e=>function(e){const t=[],i=ii(e.options);return i&&t.push(i),new Ve(t)}(e.params),writer:e=>Qt},controller:e=>{var t;const i=e.document,n=e.value,r=e.constraint;return r&&Ue(r,He)?new Ke(i,{props:E.fromObject({options:null!==(t=ni(r))&&void 0!==t?t:[]}),value:n,viewProps:e.viewProps}):new ci(i,{value:n,viewProps:e.viewProps})}},hi=f("col");class ui{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(hi()),t.foldable.bindExpandedClass(this.element,hi(void 0,"expanded")),_(t.foldable,"completed",v(this.element,hi(void 0,"cpl")));const i=e.createElement("div");i.classList.add(hi("h")),this.element.appendChild(i);const n=e.createElement("div");n.classList.add(hi("s")),i.appendChild(n),this.swatchElement=n;const r=e.createElement("div");if(r.classList.add(hi("t")),i.appendChild(r),this.textElement=r,"inline"===t.pickerLayout){const t=e.createElement("div");t.classList.add(hi("p")),this.element.appendChild(t),this.pickerElement=t}else this.pickerElement=null}}function pi(e,t,i){const n=Vt(e,360),r=Nt(t/100,0,1),s=Nt(i/100,0,1),o=s*r,a=o*(1-Math.abs(n/60%2-1)),l=s-o;let c,d,h;return[c,d,h]=n>=0&&n<60?[o,a,0]:n>=60&&n<120?[a,o,0]:n>=120&&n<180?[0,o,a]:n>=180&&n<240?[0,a,o]:n>=240&&n<300?[a,0,o]:[o,0,a],[255*(c+l),255*(d+l),255*(h+l)]}function fi(e){return[e[0],e[1],e[2]]}function gi(e,t){return[e[0],e[1],e[2],t]}const mi={hsl:{hsl:(e,t,i)=>[e,t,i],hsv:function(e,t,i){const n=i+t*(100-Math.abs(2*i-100))/200;return[e,0!==n?t*(100-Math.abs(2*i-100))/n:0,i+t*(100-Math.abs(2*i-100))/200]},rgb:function(e,t,i){const n=(e%360+360)%360,r=Nt(t/100,0,1),s=Nt(i/100,0,1),o=(1-Math.abs(2*s-1))*r,a=o*(1-Math.abs(n/60%2-1)),l=s-o/2;let c,d,h;return[c,d,h]=n>=0&&n<60?[o,a,0]:n>=60&&n<120?[a,o,0]:n>=120&&n<180?[0,o,a]:n>=180&&n<240?[0,a,o]:n>=240&&n<300?[a,0,o]:[o,0,a],[255*(c+l),255*(d+l),255*(h+l)]}},hsv:{hsl:function(e,t,i){const n=100-Math.abs(i*(200-t)/100-100);return[e,0!==n?t*i/n:0,i*(200-t)/200]},hsv:(e,t,i)=>[e,t,i],rgb:pi},rgb:{hsl:function(e,t,i){const n=Nt(e/255,0,1),r=Nt(t/255,0,1),s=Nt(i/255,0,1),o=Math.max(n,r,s),a=Math.min(n,r,s),l=o-a;let c=0,d=0;const h=(a+o)/2;return 0!==l&&(d=l/(1-Math.abs(o+a-1)),c=n===o?(r-s)/l:r===o?2+(s-n)/l:4+(n-r)/l,c=c/6+(c<0?1:0)),[360*c,100*d,100*h]},hsv:function(e,t,i){const n=Nt(e/255,0,1),r=Nt(t/255,0,1),s=Nt(i/255,0,1),o=Math.max(n,r,s),a=o-Math.min(n,r,s);let l;return l=0===a?0:o===n?((r-s)/a%6+6)%6*60:o===r?60*((s-n)/a+2):60*((n-r)/a+4),[l,100*(0===o?0:a/o),100*o]},rgb:(e,t,i)=>[e,t,i]}},_i={hsl:e=>{var t;return[Vt(e[0],360),Nt(e[1],0,100),Nt(e[2],0,100),Nt(null!==(t=e[3])&&void 0!==t?t:1,0,1)]},hsv:e=>{var t;return[Vt(e[0],360),Nt(e[1],0,100),Nt(e[2],0,100),Nt(null!==(t=e[3])&&void 0!==t?t:1,0,1)]},rgb:e=>{var t;return[Nt(e[0],0,255),Nt(e[1],0,255),Nt(e[2],0,255),Nt(null!==(t=e[3])&&void 0!==t?t:1,0,1)]}};function vi(e,t){return"object"==typeof e&&!o(e)&&t in e&&"number"==typeof e[t]}class bi{constructor(e,t){this.mode_=t,this.comps_=_i[t](e)}static black(){return new bi([0,0,0],"rgb")}static fromObject(e){const t="a"in e?[e.r,e.g,e.b,e.a]:[e.r,e.g,e.b];return new bi(t,"rgb")}static toRgbaObject(e){return e.toRgbaObject()}static isRgbColorObject(e){return vi(e,"r")&&vi(e,"g")&&vi(e,"b")}static isRgbaColorObject(e){return this.isRgbColorObject(e)&&vi(e,"a")}static isColorObject(e){return this.isRgbColorObject(e)}static equals(e,t){if(e.mode_!==t.mode_)return!1;const i=e.comps_,n=t.comps_;for(let e=0;e<i.length;e++)if(i[e]!==n[e])return!1;return!0}get mode(){return this.mode_}getComponents(e){var t,i,n;return gi((t=fi(this.comps_),i=this.mode_,n=e||this.mode_,mi[i][n](...t)),this.comps_[3])}toRgbaObject(){const e=this.getComponents("rgb");return{r:e[0],g:e[1],b:e[2],a:e[3]}}}const wi=f("colp");class yi{constructor(e,t){this.alphaViews_=null,this.element=e.createElement("div"),this.element.classList.add(wi());const i=e.createElement("div");i.classList.add(wi("hsv"));const n=e.createElement("div");n.classList.add(wi("sv")),this.svPaletteView_=t.svPaletteView,n.appendChild(this.svPaletteView_.element),i.appendChild(n);const r=e.createElement("div");r.classList.add(wi("h")),this.hPaletteView_=t.hPaletteView,r.appendChild(this.hPaletteView_.element),i.appendChild(r),this.element.appendChild(i);const s=e.createElement("div");if(s.classList.add(wi("rgb")),this.textView_=t.textView,s.appendChild(this.textView_.element),this.element.appendChild(s),t.alphaViews){this.alphaViews_={palette:t.alphaViews.palette,text:t.alphaViews.text};const i=e.createElement("div");i.classList.add(wi("a"));const n=e.createElement("div");n.classList.add(wi("ap")),n.appendChild(this.alphaViews_.palette.element),i.appendChild(n);const r=e.createElement("div");r.classList.add(wi("at")),r.appendChild(this.alphaViews_.text.element),i.appendChild(r),this.element.appendChild(i)}}get allFocusableElements(){const e=[this.svPaletteView_.element,this.hPaletteView_.element,this.textView_.modeSelectElement,...this.textView_.textViews.map((e=>e.inputElement))];return this.alphaViews_&&e.push(this.alphaViews_.palette.element,this.alphaViews_.text.inputElement),e}}function xi(e){const t=T;return A(e,{alpha:t.optional.boolean,expanded:t.optional.boolean,picker:t.optional.custom(Jt)})}function $i(e){return e?.1:1}function Ci(e,t){const i=e.match(/^(.+)%$/);return i?Math.min(.01*parseFloat(i[1])*t,t):Math.min(parseFloat(e),t)}const Si={deg:e=>e,grad:e=>360*e/400,rad:e=>360*e/(2*Math.PI),turn:e=>360*e};function Ei(e){const t=e.match(/^([0-9.]+?)(deg|grad|rad|turn)$/);if(!t)return parseFloat(e);const i=parseFloat(t[1]),n=t[2];return Si[n](i)}const Pi={"func.rgb":e=>{const t=e.match(/^rgb\(\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!t)return null;const i=[Ci(t[1],255),Ci(t[2],255),Ci(t[3],255)];return isNaN(i[0])||isNaN(i[1])||isNaN(i[2])?null:new bi(i,"rgb")},"func.rgba":e=>{const t=e.match(/^rgba\(\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!t)return null;const i=[Ci(t[1],255),Ci(t[2],255),Ci(t[3],255),Ci(t[4],1)];return isNaN(i[0])||isNaN(i[1])||isNaN(i[2])||isNaN(i[3])?null:new bi(i,"rgb")},"func.hsl":e=>{const t=e.match(/^hsl\(\s*([0-9A-Fa-f.]+(?:deg|grad|rad|turn)?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!t)return null;const i=[Ei(t[1]),Ci(t[2],100),Ci(t[3],100)];return isNaN(i[0])||isNaN(i[1])||isNaN(i[2])?null:new bi(i,"hsl")},"func.hsla":e=>{const t=e.match(/^hsla\(\s*([0-9A-Fa-f.]+(?:deg|grad|rad|turn)?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!t)return null;const i=[Ei(t[1]),Ci(t[2],100),Ci(t[3],100),Ci(t[4],1)];return isNaN(i[0])||isNaN(i[1])||isNaN(i[2])||isNaN(i[3])?null:new bi(i,"hsl")},"hex.rgb":e=>{const t=e.match(/^#([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])$/);if(t)return new bi([parseInt(t[1]+t[1],16),parseInt(t[2]+t[2],16),parseInt(t[3]+t[3],16)],"rgb");const i=e.match(/^(?:#|0x)([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})$/);return i?new bi([parseInt(i[1],16),parseInt(i[2],16),parseInt(i[3],16)],"rgb"):null},"hex.rgba":e=>{const t=e.match(/^#?([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])$/);if(t)return new bi([parseInt(t[1]+t[1],16),parseInt(t[2]+t[2],16),parseInt(t[3]+t[3],16),Ot(parseInt(t[4]+t[4],16),0,255,0,1)],"rgb");const i=e.match(/^(?:#|0x)?([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})$/);return i?new bi([parseInt(i[1],16),parseInt(i[2],16),parseInt(i[3],16),Ot(parseInt(i[4],16),0,255,0,1)],"rgb"):null}};function ki(e){return Object.keys(Pi).reduce(((t,i)=>t||((0,Pi[i])(e)?i:null)),null)}const Ti=e=>{const t=ki(e);return t?Pi[t](e):null};function Ai(e){return"func.hsla"===e||"func.rgba"===e||"hex.rgba"===e}function Di(e){if("string"==typeof e){const t=Ti(e);if(t)return t}return bi.black()}function Ri(e){const t=Nt(Math.floor(e),0,255).toString(16);return 1===t.length?`0${t}`:t}function Ii(e,t="#"){return`${t}${fi(e.getComponents("rgb")).map(Ri).join("")}`}function Mi(e,t="#"){const i=e.getComponents("rgb");return`${t}${[i[0],i[1],i[2],255*i[3]].map(Ri).join("")}`}function Li(e){const t=$t(0);return`rgb(${fi(e.getComponents("rgb")).map((e=>t(e))).join(", ")})`}function Bi(e){const t=$t(2),i=$t(0);return`rgba(${e.getComponents("rgb").map(((e,n)=>(3===n?t:i)(e))).join(", ")})`}const Fi={"func.hsl":function(e){const t=[$t(0),St,St];return`hsl(${fi(e.getComponents("hsl")).map(((e,i)=>t[i](e))).join(", ")})`},"func.hsla":function(e){const t=[$t(0),St,St,$t(2)];return`hsla(${e.getComponents("hsl").map(((e,i)=>t[i](e))).join(", ")})`},"func.rgb":Li,"func.rgba":Bi,"hex.rgb":Ii,"hex.rgba":Mi};function Oi(e){return Fi[e]}const zi=f("apl");class Ni{constructor(e,t){this.onValueChange_=this.onValueChange_.bind(this),this.value=t.value,this.value.emitter.on("change",this.onValueChange_),this.element=e.createElement("div"),this.element.classList.add(zi()),t.viewProps.bindTabIndex(this.element);const i=e.createElement("div");i.classList.add(zi("b")),this.element.appendChild(i);const n=e.createElement("div");n.classList.add(zi("c")),i.appendChild(n),this.colorElem_=n;const r=e.createElement("div");r.classList.add(zi("m")),this.element.appendChild(r),this.markerElem_=r;const s=e.createElement("div");s.classList.add(zi("p")),this.markerElem_.appendChild(s),this.previewElem_=s,this.update_()}update_(){const e=this.value.rawValue,t=e.getComponents("rgb"),i=new bi([t[0],t[1],t[2],0],"rgb"),n=new bi([t[0],t[1],t[2],255],"rgb"),r=["to right",Bi(i),Bi(n)];this.colorElem_.style.background=`linear-gradient(${r.join(",")})`,this.previewElem_.style.backgroundColor=Bi(e);const s=Ot(t[3],0,1,0,100);this.markerElem_.style.left=`${s}%`}onValueChange_(){this.update_()}}class Vi{constructor(e,t){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.view=new Ni(e,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Ft(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(e,t){if(!e.point)return;const i=e.point.x/e.bounds.width,n=this.value.rawValue,[r,s,o]=n.getComponents("hsv");this.value.setRawValue(new bi([r,s,o,i],"hsv"),t)}onPointerDown_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerMove_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerUp_(e){this.handlePointerEvent_(e.data,{forceEmit:!0,last:!0})}onKeyDown_(e){const t=Rt($i(!0),Mt(e));if(0===t)return;const i=this.value.rawValue,[n,r,s,o]=i.getComponents("hsv");this.value.setRawValue(new bi([n,r,s,o+t],"hsv"),{forceEmit:!1,last:!1})}onKeyUp_(e){0!==Rt($i(!0),Mt(e))&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}const Ui=f("coltxt");class Hi{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(Ui());const i=e.createElement("div");i.classList.add(Ui("m")),this.modeElem_=function(e){const t=e.createElement("select");return t.appendChild([{text:"RGB",value:"rgb"},{text:"HSL",value:"hsl"},{text:"HSV",value:"hsv"}].reduce(((t,i)=>{const n=e.createElement("option");return n.textContent=i.text,n.value=i.value,t.appendChild(n),t}),e.createDocumentFragment())),t}(e),this.modeElem_.classList.add(Ui("ms")),i.appendChild(this.modeSelectElement);const n=e.createElement("div");n.classList.add(Ui("mm")),n.appendChild(z(e,"dropdown")),i.appendChild(n),this.element.appendChild(i);const r=e.createElement("div");r.classList.add(Ui("w")),this.element.appendChild(r),this.textsElem_=r,this.textViews_=t.textViews,this.applyTextViews_(),m(t.colorMode,(e=>{this.modeElem_.value=e}))}get modeSelectElement(){return this.modeElem_}get textViews(){return this.textViews_}set textViews(e){this.textViews_=e,this.applyTextViews_()}applyTextViews_(){U(this.textsElem_);const e=this.element.ownerDocument;this.textViews_.forEach((t=>{const i=e.createElement("div");i.classList.add(Ui("c")),i.appendChild(t.element),this.textsElem_.appendChild(i)}))}}const ji=$t(0),Wi={rgb:()=>new je({min:0,max:255}),hsl:e=>new je(0===e?{min:0,max:360}:{min:0,max:100}),hsv:e=>new je(0===e?{min:0,max:360}:{min:0,max:100})};function Gi(e,t,i){return new jt(e,{arrayPosition:0===i?"fst":2===i?"lst":"mid",baseStep:$i(!1),parser:t.parser,props:E.fromObject({draggingScale:1,formatter:ji}),value:S(0,{constraint:Wi[t.colorMode](i)}),viewProps:t.viewProps})}class qi{constructor(e,t){this.onModeSelectChange_=this.onModeSelectChange_.bind(this),this.parser_=t.parser,this.value=t.value,this.viewProps=t.viewProps,this.colorMode=S(this.value.rawValue.mode),this.ccs_=this.createComponentControllers_(e),this.view=new Hi(e,{colorMode:this.colorMode,textViews:[this.ccs_[0].view,this.ccs_[1].view,this.ccs_[2].view]}),this.view.modeSelectElement.addEventListener("change",this.onModeSelectChange_)}createComponentControllers_(e){const t={colorMode:this.colorMode.rawValue,parser:this.parser_,viewProps:this.viewProps},i=[Gi(e,t,0),Gi(e,t,1),Gi(e,t,2)];return i.forEach(((e,t)=>{Dt({primary:this.value,secondary:e.value,forward:e=>e.rawValue.getComponents(this.colorMode.rawValue)[t],backward:(e,i)=>{const n=this.colorMode.rawValue,r=e.rawValue.getComponents(n);return r[t]=i.rawValue,new bi(gi(fi(r),r[3]),n)}})})),i}onModeSelectChange_(e){const t=e.currentTarget;this.colorMode.rawValue=t.value,this.ccs_=this.createComponentControllers_(this.view.element.ownerDocument),this.view.textViews=[this.ccs_[0].view,this.ccs_[1].view,this.ccs_[2].view]}}const Ki=f("hpl");class Xi{constructor(e,t){this.onValueChange_=this.onValueChange_.bind(this),this.value=t.value,this.value.emitter.on("change",this.onValueChange_),this.element=e.createElement("div"),this.element.classList.add(Ki()),t.viewProps.bindTabIndex(this.element);const i=e.createElement("div");i.classList.add(Ki("c")),this.element.appendChild(i);const n=e.createElement("div");n.classList.add(Ki("m")),this.element.appendChild(n),this.markerElem_=n,this.update_()}update_(){const e=this.value.rawValue,[t]=e.getComponents("hsv");this.markerElem_.style.backgroundColor=Li(new bi([t,100,100],"hsv"));const i=Ot(t,0,360,0,100);this.markerElem_.style.left=`${i}%`}onValueChange_(){this.update_()}}class Yi{constructor(e,t){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.view=new Xi(e,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Ft(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(e,t){if(!e.point)return;const i=Ot(e.point.x,0,e.bounds.width,0,360),n=this.value.rawValue,[,r,s,o]=n.getComponents("hsv");this.value.setRawValue(new bi([i,r,s,o],"hsv"),t)}onPointerDown_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerMove_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerUp_(e){this.handlePointerEvent_(e.data,{forceEmit:!0,last:!0})}onKeyDown_(e){const t=Rt($i(!1),Mt(e));if(0===t)return;const i=this.value.rawValue,[n,r,s,o]=i.getComponents("hsv");this.value.setRawValue(new bi([n+t,r,s,o],"hsv"),{forceEmit:!1,last:!1})}onKeyUp_(e){0!==Rt($i(!1),Mt(e))&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}const Qi=f("svp");class Zi{constructor(e,t){this.onValueChange_=this.onValueChange_.bind(this),this.value=t.value,this.value.emitter.on("change",this.onValueChange_),this.element=e.createElement("div"),this.element.classList.add(Qi()),t.viewProps.bindTabIndex(this.element);const i=e.createElement("canvas");i.height=64,i.width=64,i.classList.add(Qi("c")),this.element.appendChild(i),this.canvasElement=i;const n=e.createElement("div");n.classList.add(Qi("m")),this.element.appendChild(n),this.markerElem_=n,this.update_()}update_(){const e=function(e){const t=e.ownerDocument.defaultView;return t&&"document"in t?e.getContext("2d"):null}(this.canvasElement);if(!e)return;const t=this.value.rawValue.getComponents("hsv"),i=this.canvasElement.width,n=this.canvasElement.height,r=e.getImageData(0,0,i,n),s=r.data;for(let e=0;e<n;e++)for(let r=0;r<i;r++){const o=Ot(r,0,i,0,100),a=Ot(e,0,n,100,0),l=pi(t[0],o,a),c=4*(e*i+r);s[c]=l[0],s[c+1]=l[1],s[c+2]=l[2],s[c+3]=255}e.putImageData(r,0,0);const o=Ot(t[1],0,100,0,100);this.markerElem_.style.left=`${o}%`;const a=Ot(t[2],0,100,100,0);this.markerElem_.style.top=`${a}%`}onValueChange_(){this.update_()}}class Ji{constructor(e,t){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.view=new Zi(e,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Ft(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(e,t){if(!e.point)return;const i=Ot(e.point.x,0,e.bounds.width,0,100),n=Ot(e.point.y,0,e.bounds.height,100,0),[r,,,s]=this.value.rawValue.getComponents("hsv");this.value.setRawValue(new bi([r,i,n,s],"hsv"),t)}onPointerDown_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerMove_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerUp_(e){this.handlePointerEvent_(e.data,{forceEmit:!0,last:!0})}onKeyDown_(e){Lt(e.key)&&e.preventDefault();const[t,i,n,r]=this.value.rawValue.getComponents("hsv"),s=$i(!1),o=Rt(s,Mt(e)),a=Rt(s,It(e));0===o&&0===a||this.value.setRawValue(new bi([t,i+o,n+a,r],"hsv"),{forceEmit:!1,last:!1})}onKeyUp_(e){const t=$i(!1),i=Rt(t,Mt(e)),n=Rt(t,It(e));0===i&&0===n||this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}class en{constructor(e,t){this.value=t.value,this.viewProps=t.viewProps,this.hPaletteC_=new Yi(e,{value:this.value,viewProps:this.viewProps}),this.svPaletteC_=new Ji(e,{value:this.value,viewProps:this.viewProps}),this.alphaIcs_=t.supportsAlpha?{palette:new Vi(e,{value:this.value,viewProps:this.viewProps}),text:new jt(e,{parser:wt,baseStep:.1,props:E.fromObject({draggingScale:.01,formatter:$t(2)}),value:S(0,{constraint:new je({min:0,max:1})}),viewProps:this.viewProps})}:null,this.alphaIcs_&&Dt({primary:this.value,secondary:this.alphaIcs_.text.value,forward:e=>e.rawValue.getComponents()[3],backward:(e,t)=>{const i=e.rawValue.getComponents();return i[3]=t.rawValue,new bi(i,e.rawValue.mode)}}),this.textC_=new qi(e,{parser:wt,value:this.value,viewProps:this.viewProps}),this.view=new yi(e,{alphaViews:this.alphaIcs_?{palette:this.alphaIcs_.palette.view,text:this.alphaIcs_.text.view}:null,hPaletteView:this.hPaletteC_.view,supportsAlpha:t.supportsAlpha,svPaletteView:this.svPaletteC_.view,textView:this.textC_.view})}get textController(){return this.textC_}}const tn=f("colsw");class nn{constructor(e,t){this.onValueChange_=this.onValueChange_.bind(this),t.value.emitter.on("change",this.onValueChange_),this.value=t.value,this.element=e.createElement("div"),this.element.classList.add(tn()),t.viewProps.bindClassModifiers(this.element);const i=e.createElement("div");i.classList.add(tn("sw")),this.element.appendChild(i),this.swatchElem_=i;const n=e.createElement("button");n.classList.add(tn("b")),t.viewProps.bindDisabled(n),this.element.appendChild(n),this.buttonElement=n,this.update_()}update_(){const e=this.value.rawValue;this.swatchElem_.style.backgroundColor=Mi(e)}onValueChange_(){this.update_()}}class rn{constructor(e,t){this.value=t.value,this.viewProps=t.viewProps,this.view=new nn(e,{value:this.value,viewProps:this.viewProps})}}class sn{constructor(e,t){this.onButtonBlur_=this.onButtonBlur_.bind(this),this.onButtonClick_=this.onButtonClick_.bind(this),this.onPopupChildBlur_=this.onPopupChildBlur_.bind(this),this.onPopupChildKeydown_=this.onPopupChildKeydown_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.foldable_=Y.create(t.expanded),this.swatchC_=new rn(e,{value:this.value,viewProps:this.viewProps});const i=this.swatchC_.view.buttonElement;i.addEventListener("blur",this.onButtonBlur_),i.addEventListener("click",this.onButtonClick_),this.textC_=new et(e,{parser:t.parser,props:E.fromObject({formatter:t.formatter}),value:this.value,viewProps:this.viewProps}),this.view=new ui(e,{foldable:this.foldable_,pickerLayout:t.pickerLayout}),this.view.swatchElement.appendChild(this.swatchC_.view.element),this.view.textElement.appendChild(this.textC_.view.element),this.popC_="popup"===t.pickerLayout?new Qe(e,{viewProps:this.viewProps}):null;const n=new en(e,{supportsAlpha:t.supportsAlpha,value:this.value,viewProps:this.viewProps});n.view.allFocusableElements.forEach((e=>{e.addEventListener("blur",this.onPopupChildBlur_),e.addEventListener("keydown",this.onPopupChildKeydown_)})),this.pickerC_=n,this.popC_?(this.view.element.appendChild(this.popC_.view.element),this.popC_.view.element.appendChild(n.view.element),Dt({primary:this.foldable_.value("expanded"),secondary:this.popC_.shows,forward:e=>e.rawValue,backward:(e,t)=>t.rawValue})):this.view.pickerElement&&(this.view.pickerElement.appendChild(this.pickerC_.view.element),Z(this.foldable_,this.view.pickerElement))}get textController(){return this.textC_}onButtonBlur_(e){if(!this.popC_)return;const t=this.view.element,i=e.relatedTarget;i&&t.contains(i)||(this.popC_.shows.rawValue=!1)}onButtonClick_(){this.foldable_.set("expanded",!this.foldable_.get("expanded")),this.foldable_.get("expanded")&&this.pickerC_.view.allFocusableElements[0].focus()}onPopupChildBlur_(e){if(!this.popC_)return;const t=this.popC_.view.element,i=H(e);i&&t.contains(i)||i&&i===this.swatchC_.view.buttonElement&&!B(t.ownerDocument)||(this.popC_.shows.rawValue=!1)}onPopupChildKeydown_(e){this.popC_?"Escape"===e.key&&(this.popC_.shows.rawValue=!1):this.view.pickerElement&&"Escape"===e.key&&this.swatchC_.view.buttonElement.focus()}}function on(e){return bi.isColorObject(e)?bi.fromObject(e):bi.black()}function an(e){return fi(e.getComponents("rgb")).reduce(((e,t)=>e<<8|255&Math.floor(t)),0)}function ln(e){return e.getComponents("rgb").reduce(((e,t,i)=>e<<8|255&Math.floor(3===i?255*t:t)),0)>>>0}function cn(e){var t;return"number"!=typeof e?bi.black():new bi([(t=e)>>16&255,t>>8&255,255&t],"rgb")}function dn(e){var t;return"number"!=typeof e?bi.black():new bi([(t=e)>>24&255,t>>16&255,t>>8&255,Ot(255&t,0,255,0,1)],"rgb")}function hn(e,t){const i=t.toRgbaObject();e.writeProperty("r",i.r),e.writeProperty("g",i.g),e.writeProperty("b",i.b),e.writeProperty("a",i.a)}function un(e,t){const i=t.toRgbaObject();e.writeProperty("r",i.r),e.writeProperty("g",i.g),e.writeProperty("b",i.b)}function pn(e){return"alpha"in e&&!0===e.alpha}function fn(e){return e?e=>Mi(e,"0x"):e=>Ii(e,"0x")}const gn={id:"input-color-number",type:"input",accept:(e,t)=>{if("number"!=typeof e)return null;if(!("view"in t))return null;if("color"!==t.view)return null;const i=xi(t);return i?{initialValue:e,params:i}:null},binding:{reader:e=>pn(e.params)?dn:cn,equals:bi.equals,writer:e=>function(e){const t=e?ln:an;return(e,i)=>{Qt(e,t(i))}}(pn(e.params))},controller:e=>{const t=pn(e.params),i="expanded"in e.params?e.params.expanded:void 0,n="picker"in e.params?e.params.picker:void 0;return new sn(e.document,{expanded:null!=i&&i,formatter:fn(t),parser:Ti,pickerLayout:null!=n?n:"popup",supportsAlpha:t,value:e.value,viewProps:e.viewProps})}},mn={id:"input-color-object",type:"input",accept:(e,t)=>{if(!bi.isColorObject(e))return null;const i=xi(t);return i?{initialValue:e,params:i}:null},binding:{reader:e=>on,equals:bi.equals,writer:e=>{var t;return t=e.initialValue,bi.isRgbaColorObject(t)?hn:un}},controller:e=>{const t=bi.isRgbaColorObject(e.initialValue),i="expanded"in e.params?e.params.expanded:void 0,n="picker"in e.params?e.params.picker:void 0,r=t?Mi:Ii;return new sn(e.document,{expanded:null!=i&&i,formatter:r,parser:Ti,pickerLayout:null!=n?n:"popup",supportsAlpha:t,value:e.value,viewProps:e.viewProps})}},_n={id:"input-color-string",type:"input",accept:(e,t)=>{if("string"!=typeof e)return null;if("view"in t&&"text"===t.view)return null;if(!ki(e))return null;const i=xi(t);return i?{initialValue:e,params:i}:null},binding:{reader:e=>Di,equals:bi.equals,writer:e=>{const t=ki(e.initialValue);if(!t)throw c.shouldNeverHappen();return function(e){const t=Oi(e);return(e,i)=>{Qt(e,t(i))}}(t)}},controller:e=>{const t=ki(e.initialValue);if(!t)throw c.shouldNeverHappen();const i=Oi(t),n="expanded"in e.params?e.params.expanded:void 0,r="picker"in e.params?e.params.picker:void 0;return new sn(e.document,{expanded:null!=n&&n,formatter:i,parser:Ti,pickerLayout:null!=r?r:"popup",supportsAlpha:Ai(t),value:e.value,viewProps:e.viewProps})}};class vn{constructor(e){this.components=e.components,this.asm_=e.assembly}constrain(e){const t=this.asm_.toComponents(e).map(((e,t)=>{var i,n;return null!==(n=null===(i=this.components[t])||void 0===i?void 0:i.constrain(e))&&void 0!==n?n:e}));return this.asm_.fromComponents(t)}}const bn=f("pndtxt");class wn{constructor(e,t){this.textViews=t.textViews,this.element=e.createElement("div"),this.element.classList.add(bn()),this.textViews.forEach((t=>{const i=e.createElement("div");i.classList.add(bn("a")),i.appendChild(t.element),this.element.appendChild(i)}))}}class yn{constructor(e,t){this.value=t.value,this.viewProps=t.viewProps,this.acs_=t.axes.map(((i,n)=>function(e,t,i){return new jt(e,{arrayPosition:0===i?"fst":i===t.axes.length-1?"lst":"mid",baseStep:t.axes[i].baseStep,parser:t.parser,props:t.axes[i].textProps,value:S(0,{constraint:t.axes[i].constraint}),viewProps:t.viewProps})}(e,t,n))),this.acs_.forEach(((e,i)=>{Dt({primary:this.value,secondary:e.value,forward:e=>t.assembly.toComponents(e.rawValue)[i],backward:(e,n)=>{const r=t.assembly.toComponents(e.rawValue);return r[i]=n.rawValue,t.assembly.fromComponents(r)}})})),this.view=new wn(e,{textViews:this.acs_.map((e=>e.view))})}}function xn(e){const t=[],i=function(e){return"step"in e&&!o(e.step)?new We(e.step):null}(e);i&&t.push(i);const n=function(e){return"max"in e&&!o(e.max)||"min"in e&&!o(e.min)?new je({max:e.max,min:e.min}):null}(e);n&&t.push(n);const r=ii(e.options);return r&&t.push(r),new Ve(t)}function $n(e){const[t,i]=function(e){const t=e?Ue(e,je):null;return t?[t.minValue,t.maxValue]:[void 0,void 0]}(e);return[null!=t?t:0,null!=i?i:100]}const Cn={id:"input-number",type:"input",accept:(e,t)=>{if("number"!=typeof e)return null;const i=T,n=A(t,{format:i.optional.function,max:i.optional.number,min:i.optional.number,options:i.optional.custom(Zt),step:i.optional.number});return n?{initialValue:e,params:n}:null},binding:{reader:e=>yt,constraint:e=>xn(e.params),writer:e=>Qt},controller:e=>{var t,i;const n=e.value,r=e.constraint;if(r&&Ue(r,He))return new Ke(e.document,{props:E.fromObject({options:null!==(t=ni(r))&&void 0!==t?t:[]}),value:n,viewProps:e.viewProps});const s=null!==(i="format"in e.params?e.params.format:void 0)&&void 0!==i?i:$t(ri(r,n.rawValue));if(r&&Ue(r,je)){const[t,i]=$n(r);return new Yt(e.document,{baseStep:si(r),parser:wt,sliderProps:E.fromObject({maxValue:i,minValue:t}),textProps:E.fromObject({draggingScale:oi(r,n.rawValue),formatter:s}),value:n,viewProps:e.viewProps})}return new jt(e.document,{baseStep:si(r),parser:wt,props:E.fromObject({draggingScale:oi(r,n.rawValue),formatter:s}),value:n,viewProps:e.viewProps})}};class Sn{constructor(e=0,t=0){this.x=e,this.y=t}getComponents(){return[this.x,this.y]}static isObject(e){if(o(e))return!1;const t=e.x,i=e.y;return"number"==typeof t&&"number"==typeof i}static equals(e,t){return e.x===t.x&&e.y===t.y}toObject(){return{x:this.x,y:this.y}}}const En={toComponents:e=>e.getComponents(),fromComponents:e=>new Sn(...e)},Pn=f("p2d");class kn{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(Pn()),t.viewProps.bindClassModifiers(this.element),m(t.expanded,v(this.element,Pn(void 0,"expanded")));const i=e.createElement("div");i.classList.add(Pn("h")),this.element.appendChild(i);const n=e.createElement("button");n.classList.add(Pn("b")),n.appendChild(z(e,"p2dpad")),t.viewProps.bindDisabled(n),i.appendChild(n),this.buttonElement=n;const r=e.createElement("div");if(r.classList.add(Pn("t")),i.appendChild(r),this.textElement=r,"inline"===t.pickerLayout){const t=e.createElement("div");t.classList.add(Pn("p")),this.element.appendChild(t),this.pickerElement=t}else this.pickerElement=null}}const Tn=f("p2dp");class An{constructor(e,t){this.onFoldableChange_=this.onFoldableChange_.bind(this),this.onValueChange_=this.onValueChange_.bind(this),this.invertsY_=t.invertsY,this.maxValue_=t.maxValue,this.element=e.createElement("div"),this.element.classList.add(Tn()),"popup"===t.layout&&this.element.classList.add(Tn(void 0,"p"));const i=e.createElement("div");i.classList.add(Tn("p")),t.viewProps.bindTabIndex(i),this.element.appendChild(i),this.padElement=i;const n=e.createElementNS(M,"svg");n.classList.add(Tn("g")),this.padElement.appendChild(n),this.svgElem_=n;const r=e.createElementNS(M,"line");r.classList.add(Tn("ax")),r.setAttributeNS(null,"x1","0"),r.setAttributeNS(null,"y1","50%"),r.setAttributeNS(null,"x2","100%"),r.setAttributeNS(null,"y2","50%"),this.svgElem_.appendChild(r);const s=e.createElementNS(M,"line");s.classList.add(Tn("ax")),s.setAttributeNS(null,"x1","50%"),s.setAttributeNS(null,"y1","0"),s.setAttributeNS(null,"x2","50%"),s.setAttributeNS(null,"y2","100%"),this.svgElem_.appendChild(s);const o=e.createElementNS(M,"line");o.classList.add(Tn("l")),o.setAttributeNS(null,"x1","50%"),o.setAttributeNS(null,"y1","50%"),this.svgElem_.appendChild(o),this.lineElem_=o;const a=e.createElement("div");a.classList.add(Tn("m")),this.padElement.appendChild(a),this.markerElem_=a,t.value.emitter.on("change",this.onValueChange_),this.value=t.value,this.update_()}get allFocusableElements(){return[this.padElement]}update_(){const[e,t]=this.value.rawValue.getComponents(),i=this.maxValue_,n=Ot(e,-i,+i,0,100),r=Ot(t,-i,+i,0,100),s=this.invertsY_?100-r:r;this.lineElem_.setAttributeNS(null,"x2",`${n}%`),this.lineElem_.setAttributeNS(null,"y2",`${s}%`),this.markerElem_.style.left=`${n}%`,this.markerElem_.style.top=`${s}%`}onValueChange_(){this.update_()}onFoldableChange_(){this.update_()}}function Dn(e,t,i){return[Rt(t[0],Mt(e)),Rt(t[1],It(e))*(i?1:-1)]}class Rn{constructor(e,t){this.onPadKeyDown_=this.onPadKeyDown_.bind(this),this.onPadKeyUp_=this.onPadKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.baseSteps_=t.baseSteps,this.maxValue_=t.maxValue,this.invertsY_=t.invertsY,this.view=new An(e,{invertsY:this.invertsY_,layout:t.layout,maxValue:this.maxValue_,value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Ft(this.view.padElement),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.padElement.addEventListener("keydown",this.onPadKeyDown_),this.view.padElement.addEventListener("keyup",this.onPadKeyUp_)}handlePointerEvent_(e,t){if(!e.point)return;const i=this.maxValue_,n=Ot(e.point.x,0,e.bounds.width,-i,+i),r=Ot(this.invertsY_?e.bounds.height-e.point.y:e.point.y,0,e.bounds.height,-i,+i);this.value.setRawValue(new Sn(n,r),t)}onPointerDown_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerMove_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerUp_(e){this.handlePointerEvent_(e.data,{forceEmit:!0,last:!0})}onPadKeyDown_(e){Lt(e.key)&&e.preventDefault();const[t,i]=Dn(e,this.baseSteps_,this.invertsY_);0===t&&0===i||this.value.setRawValue(new Sn(this.value.rawValue.x+t,this.value.rawValue.y+i),{forceEmit:!1,last:!1})}onPadKeyUp_(e){const[t,i]=Dn(e,this.baseSteps_,this.invertsY_);0===t&&0===i||this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}class In{constructor(e,t){var i,n;this.onPopupChildBlur_=this.onPopupChildBlur_.bind(this),this.onPopupChildKeydown_=this.onPopupChildKeydown_.bind(this),this.onPadButtonBlur_=this.onPadButtonBlur_.bind(this),this.onPadButtonClick_=this.onPadButtonClick_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.foldable_=Y.create(t.expanded),this.popC_="popup"===t.pickerLayout?new Qe(e,{viewProps:this.viewProps}):null;const r=new Rn(e,{baseSteps:[t.axes[0].baseStep,t.axes[1].baseStep],invertsY:t.invertsY,layout:t.pickerLayout,maxValue:t.maxValue,value:this.value,viewProps:this.viewProps});r.view.allFocusableElements.forEach((e=>{e.addEventListener("blur",this.onPopupChildBlur_),e.addEventListener("keydown",this.onPopupChildKeydown_)})),this.pickerC_=r,this.textC_=new yn(e,{assembly:En,axes:t.axes,parser:t.parser,value:this.value,viewProps:this.viewProps}),this.view=new kn(e,{expanded:this.foldable_.value("expanded"),pickerLayout:t.pickerLayout,viewProps:this.viewProps}),this.view.textElement.appendChild(this.textC_.view.element),null===(i=this.view.buttonElement)||void 0===i||i.addEventListener("blur",this.onPadButtonBlur_),null===(n=this.view.buttonElement)||void 0===n||n.addEventListener("click",this.onPadButtonClick_),this.popC_?(this.view.element.appendChild(this.popC_.view.element),this.popC_.view.element.appendChild(this.pickerC_.view.element),Dt({primary:this.foldable_.value("expanded"),secondary:this.popC_.shows,forward:e=>e.rawValue,backward:(e,t)=>t.rawValue})):this.view.pickerElement&&(this.view.pickerElement.appendChild(this.pickerC_.view.element),Z(this.foldable_,this.view.pickerElement))}onPadButtonBlur_(e){if(!this.popC_)return;const t=this.view.element,i=e.relatedTarget;i&&t.contains(i)||(this.popC_.shows.rawValue=!1)}onPadButtonClick_(){this.foldable_.set("expanded",!this.foldable_.get("expanded")),this.foldable_.get("expanded")&&this.pickerC_.view.allFocusableElements[0].focus()}onPopupChildBlur_(e){if(!this.popC_)return;const t=this.popC_.view.element,i=H(e);i&&t.contains(i)||i&&i===this.view.buttonElement&&!B(t.ownerDocument)||(this.popC_.shows.rawValue=!1)}onPopupChildKeydown_(e){this.popC_?"Escape"===e.key&&(this.popC_.shows.rawValue=!1):this.view.pickerElement&&"Escape"===e.key&&this.view.buttonElement.focus()}}function Mn(e){return Sn.isObject(e)?new Sn(e.x,e.y):new Sn}function Ln(e,t){e.writeProperty("x",t.x),e.writeProperty("y",t.y)}function Bn(e){if(!e)return;const t=[];return o(e.step)||t.push(new We(e.step)),o(e.max)&&o(e.min)||t.push(new je({max:e.max,min:e.min})),new Ve(t)}function Fn(e,t){const i=e&&Ue(e,je);if(i)return Math.max(Math.abs(i.minValue||0),Math.abs(i.maxValue||0));const n=si(e);return Math.max(10*Math.abs(n),10*Math.abs(t))}function On(e,t){const i=t instanceof vn?t.components[0]:void 0,n=t instanceof vn?t.components[1]:void 0,r=Fn(i,e.x),s=Fn(n,e.y);return Math.max(r,s)}function zn(e,t){return{baseStep:si(t),constraint:t,textProps:E.fromObject({draggingScale:oi(t,e),formatter:$t(ri(t,e))})}}function Nn(e){if(!("y"in e))return!1;const t=e.y;return!!t&&"inverted"in t&&!!t.inverted}const Vn={id:"input-point2d",type:"input",accept:(e,t)=>{if(!Sn.isObject(e))return null;const i=T,n=A(t,{expanded:i.optional.boolean,picker:i.optional.custom(Jt),x:i.optional.custom(ei),y:i.optional.object({inverted:i.optional.boolean,max:i.optional.number,min:i.optional.number,step:i.optional.number})});return n?{initialValue:e,params:n}:null},binding:{reader:e=>Mn,constraint:e=>{var t;return t=e.params,new vn({assembly:En,components:[Bn("x"in t?t.x:void 0),Bn("y"in t?t.y:void 0)]})},equals:Sn.equals,writer:e=>Ln},controller:e=>{const t=e.document,i=e.value,n=e.constraint;if(!(n instanceof vn))throw c.shouldNeverHappen();const r="expanded"in e.params?e.params.expanded:void 0,s="picker"in e.params?e.params.picker:void 0;return new In(t,{axes:[zn(i.rawValue.x,n.components[0]),zn(i.rawValue.y,n.components[1])],expanded:null!=r&&r,invertsY:Nn(e.params),maxValue:On(i.rawValue,n),parser:wt,pickerLayout:null!=s?s:"popup",value:i,viewProps:e.viewProps})}};class Un{constructor(e=0,t=0,i=0){this.x=e,this.y=t,this.z=i}getComponents(){return[this.x,this.y,this.z]}static isObject(e){if(o(e))return!1;const t=e.x,i=e.y,n=e.z;return"number"==typeof t&&"number"==typeof i&&"number"==typeof n}static equals(e,t){return e.x===t.x&&e.y===t.y&&e.z===t.z}toObject(){return{x:this.x,y:this.y,z:this.z}}}const Hn={toComponents:e=>e.getComponents(),fromComponents:e=>new Un(...e)};function jn(e){return Un.isObject(e)?new Un(e.x,e.y,e.z):new Un}function Wn(e,t){e.writeProperty("x",t.x),e.writeProperty("y",t.y),e.writeProperty("z",t.z)}function Gn(e){if(!e)return;const t=[];return o(e.step)||t.push(new We(e.step)),o(e.max)&&o(e.min)||t.push(new je({max:e.max,min:e.min})),new Ve(t)}function qn(e,t){return{baseStep:si(t),constraint:t,textProps:E.fromObject({draggingScale:oi(t,e),formatter:$t(ri(t,e))})}}const Kn={id:"input-point3d",type:"input",accept:(e,t)=>{if(!Un.isObject(e))return null;const i=T,n=A(t,{x:i.optional.custom(ei),y:i.optional.custom(ei),z:i.optional.custom(ei)});return n?{initialValue:e,params:n}:null},binding:{reader:e=>jn,constraint:e=>{var t;return t=e.params,new vn({assembly:Hn,components:[Gn("x"in t?t.x:void 0),Gn("y"in t?t.y:void 0),Gn("z"in t?t.z:void 0)]})},equals:Un.equals,writer:e=>Wn},controller:e=>{const t=e.value,i=e.constraint;if(!(i instanceof vn))throw c.shouldNeverHappen();return new yn(e.document,{assembly:Hn,axes:[qn(t.rawValue.x,i.components[0]),qn(t.rawValue.y,i.components[1]),qn(t.rawValue.z,i.components[2])],parser:wt,value:t,viewProps:e.viewProps})}};class Xn{constructor(e=0,t=0,i=0,n=0){this.x=e,this.y=t,this.z=i,this.w=n}getComponents(){return[this.x,this.y,this.z,this.w]}static isObject(e){if(o(e))return!1;const t=e.x,i=e.y,n=e.z,r=e.w;return"number"==typeof t&&"number"==typeof i&&"number"==typeof n&&"number"==typeof r}static equals(e,t){return e.x===t.x&&e.y===t.y&&e.z===t.z&&e.w===t.w}toObject(){return{x:this.x,y:this.y,z:this.z,w:this.w}}}const Yn={toComponents:e=>e.getComponents(),fromComponents:e=>new Xn(...e)};function Qn(e){return Xn.isObject(e)?new Xn(e.x,e.y,e.z,e.w):new Xn}function Zn(e,t){e.writeProperty("x",t.x),e.writeProperty("y",t.y),e.writeProperty("z",t.z),e.writeProperty("w",t.w)}function Jn(e){if(!e)return;const t=[];return o(e.step)||t.push(new We(e.step)),o(e.max)&&o(e.min)||t.push(new je({max:e.max,min:e.min})),new Ve(t)}const er={id:"input-point4d",type:"input",accept:(e,t)=>{if(!Xn.isObject(e))return null;const i=T,n=A(t,{x:i.optional.custom(ei),y:i.optional.custom(ei),z:i.optional.custom(ei),w:i.optional.custom(ei)});return n?{initialValue:e,params:n}:null},binding:{reader:e=>Qn,constraint:e=>{var t;return t=e.params,new vn({assembly:Yn,components:[Jn("x"in t?t.x:void 0),Jn("y"in t?t.y:void 0),Jn("z"in t?t.z:void 0),Jn("w"in t?t.w:void 0)]})},equals:Xn.equals,writer:e=>Zn},controller:e=>{const t=e.value,i=e.constraint;if(!(i instanceof vn))throw c.shouldNeverHappen();return new yn(e.document,{assembly:Yn,axes:t.rawValue.getComponents().map(((e,t)=>{var n,r;return n=e,{baseStep:si(r=i.components[t]),constraint:r,textProps:E.fromObject({draggingScale:oi(r,n),formatter:$t(ri(r,n))})}})),parser:wt,value:t,viewProps:e.viewProps})}},tr={id:"input-string",type:"input",accept:(e,t)=>{if("string"!=typeof e)return null;const i=A(t,{options:T.optional.custom(Zt)});return i?{initialValue:e,params:i}:null},binding:{reader:e=>Et,constraint:e=>function(e){const t=[],i=ii(e.options);return i&&t.push(i),new Ve(t)}(e.params),writer:e=>Qt},controller:e=>{var t;const i=e.document,n=e.value,r=e.constraint;return r&&Ue(r,He)?new Ke(i,{props:E.fromObject({options:null!==(t=ni(r))&&void 0!==t?t:[]}),value:n,viewProps:e.viewProps}):new et(i,{parser:e=>e,props:E.fromObject({formatter:Pt}),value:n,viewProps:e.viewProps})}},ir={defaultInterval:200,defaultLineCount:3},nr=f("mll");class rr{constructor(e,t){this.onValueUpdate_=this.onValueUpdate_.bind(this),this.formatter_=t.formatter,this.element=e.createElement("div"),this.element.classList.add(nr()),t.viewProps.bindClassModifiers(this.element);const i=e.createElement("textarea");i.classList.add(nr("i")),i.style.height=`calc(var(--bld-us) * ${t.lineCount})`,i.readOnly=!0,t.viewProps.bindDisabled(i),this.element.appendChild(i),this.textareaElem_=i,t.value.emitter.on("change",this.onValueUpdate_),this.value=t.value,this.update_()}update_(){const e=this.textareaElem_,t=e.scrollTop===e.scrollHeight-e.clientHeight,i=[];this.value.rawValue.forEach((e=>{void 0!==e&&i.push(this.formatter_(e))})),e.textContent=i.join("\n"),t&&(e.scrollTop=e.scrollHeight)}onValueUpdate_(){this.update_()}}class sr{constructor(e,t){this.value=t.value,this.viewProps=t.viewProps,this.view=new rr(e,{formatter:t.formatter,lineCount:t.lineCount,value:this.value,viewProps:this.viewProps})}}const or=f("sgl");class ar{constructor(e,t){this.onValueUpdate_=this.onValueUpdate_.bind(this),this.formatter_=t.formatter,this.element=e.createElement("div"),this.element.classList.add(or()),t.viewProps.bindClassModifiers(this.element);const i=e.createElement("input");i.classList.add(or("i")),i.readOnly=!0,i.type="text",t.viewProps.bindDisabled(i),this.element.appendChild(i),this.inputElement=i,t.value.emitter.on("change",this.onValueUpdate_),this.value=t.value,this.update_()}update_(){const e=this.value.rawValue,t=e[e.length-1];this.inputElement.value=void 0!==t?this.formatter_(t):""}onValueUpdate_(){this.update_()}}class lr{constructor(e,t){this.value=t.value,this.viewProps=t.viewProps,this.view=new ar(e,{formatter:t.formatter,value:this.value,viewProps:this.viewProps})}}const cr={id:"monitor-bool",type:"monitor",accept:(e,t)=>{if("boolean"!=typeof e)return null;const i=A(t,{lineCount:T.optional.number});return i?{initialValue:e,params:i}:null},binding:{reader:e=>tt},controller:e=>{var t;return 1===e.value.rawValue.length?new lr(e.document,{formatter:it,value:e.value,viewProps:e.viewProps}):new sr(e.document,{formatter:it,lineCount:null!==(t=e.params.lineCount)&&void 0!==t?t:ir.defaultLineCount,value:e.value,viewProps:e.viewProps})}};class dr{constructor(){this.emitter=new u,this.index_=-1}get index(){return this.index_}set index(e){this.index_!==e&&(this.index_=e,this.emitter.emit("change",{index:e,sender:this}))}}const hr=f("grl");class ur{constructor(e,t){this.onCursorChange_=this.onCursorChange_.bind(this),this.onValueUpdate_=this.onValueUpdate_.bind(this),this.element=e.createElement("div"),this.element.classList.add(hr()),t.viewProps.bindClassModifiers(this.element),this.formatter_=t.formatter,this.minValue_=t.minValue,this.maxValue_=t.maxValue,this.cursor_=t.cursor,this.cursor_.emitter.on("change",this.onCursorChange_);const i=e.createElementNS(M,"svg");i.classList.add(hr("g")),i.style.height=`calc(var(--bld-us) * ${t.lineCount})`,this.element.appendChild(i),this.svgElem_=i;const n=e.createElementNS(M,"polyline");this.svgElem_.appendChild(n),this.lineElem_=n;const r=e.createElement("div");r.classList.add(hr("t"),f("tt")()),this.element.appendChild(r),this.tooltipElem_=r,t.value.emitter.on("change",this.onValueUpdate_),this.value=t.value,this.update_()}get graphElement(){return this.svgElem_}update_(){const e=this.svgElem_.getBoundingClientRect(),t=this.value.rawValue.length-1,i=this.minValue_,n=this.maxValue_,r=[];this.value.rawValue.forEach(((s,o)=>{if(void 0===s)return;const a=Ot(o,0,t,0,e.width),l=Ot(s,i,n,e.height,0);r.push([a,l].join(","))})),this.lineElem_.setAttributeNS(null,"points",r.join(" "));const s=this.tooltipElem_,o=this.value.rawValue[this.cursor_.index];if(void 0===o)return void s.classList.remove(hr("t","a"));const a=Ot(this.cursor_.index,0,t,0,e.width),l=Ot(o,i,n,e.height,0);s.style.left=`${a}px`,s.style.top=`${l}px`,s.textContent=`${this.formatter_(o)}`,s.classList.contains(hr("t","a"))||(s.classList.add(hr("t","a"),hr("t","in")),L(s),s.classList.remove(hr("t","in")))}onValueUpdate_(){this.update_()}onCursorChange_(){this.update_()}}class pr{constructor(e,t){if(this.onGraphMouseMove_=this.onGraphMouseMove_.bind(this),this.onGraphMouseLeave_=this.onGraphMouseLeave_.bind(this),this.onGraphPointerDown_=this.onGraphPointerDown_.bind(this),this.onGraphPointerMove_=this.onGraphPointerMove_.bind(this),this.onGraphPointerUp_=this.onGraphPointerUp_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.cursor_=new dr,this.view=new ur(e,{cursor:this.cursor_,formatter:t.formatter,lineCount:t.lineCount,maxValue:t.maxValue,minValue:t.minValue,value:this.value,viewProps:this.viewProps}),B(e)){const e=new Ft(this.view.element);e.emitter.on("down",this.onGraphPointerDown_),e.emitter.on("move",this.onGraphPointerMove_),e.emitter.on("up",this.onGraphPointerUp_)}else this.view.element.addEventListener("mousemove",this.onGraphMouseMove_),this.view.element.addEventListener("mouseleave",this.onGraphMouseLeave_)}onGraphMouseLeave_(){this.cursor_.index=-1}onGraphMouseMove_(e){const t=this.view.element.getBoundingClientRect();this.cursor_.index=Math.floor(Ot(e.offsetX,0,t.width,0,this.value.rawValue.length))}onGraphPointerDown_(e){this.onGraphPointerMove_(e)}onGraphPointerMove_(e){e.data.point?this.cursor_.index=Math.floor(Ot(e.data.point.x,0,e.data.bounds.width,0,this.value.rawValue.length)):this.cursor_.index=-1}onGraphPointerUp_(){this.cursor_.index=-1}}function fr(e){return"format"in e&&!o(e.format)?e.format:$t(2)}function gr(e){return"view"in e&&"graph"===e.view}const mr={id:"monitor-number",type:"monitor",accept:(e,t)=>{if("number"!=typeof e)return null;const i=T,n=A(t,{format:i.optional.function,lineCount:i.optional.number,max:i.optional.number,min:i.optional.number,view:i.optional.string});return n?{initialValue:e,params:n}:null},binding:{defaultBufferSize:e=>gr(e)?64:1,reader:e=>yt},controller:e=>gr(e.params)?function(e){var t,i,n;return new pr(e.document,{formatter:fr(e.params),lineCount:null!==(t=e.params.lineCount)&&void 0!==t?t:ir.defaultLineCount,maxValue:null!==(i="max"in e.params?e.params.max:null)&&void 0!==i?i:100,minValue:null!==(n="min"in e.params?e.params.min:null)&&void 0!==n?n:0,value:e.value,viewProps:e.viewProps})}(e):function(e){var t;return 1===e.value.rawValue.length?new lr(e.document,{formatter:fr(e.params),value:e.value,viewProps:e.viewProps}):new sr(e.document,{formatter:fr(e.params),lineCount:null!==(t=e.params.lineCount)&&void 0!==t?t:ir.defaultLineCount,value:e.value,viewProps:e.viewProps})}(e)},_r={id:"monitor-string",type:"monitor",accept:(e,t)=>{if("string"!=typeof e)return null;const i=T,n=A(t,{lineCount:i.optional.number,multiline:i.optional.boolean});return n?{initialValue:e,params:n}:null},binding:{reader:e=>Et},controller:e=>{var t;const i=e.value;return i.rawValue.length>1||"multiline"in e.params&&e.params.multiline?new sr(e.document,{formatter:Pt,lineCount:null!==(t=e.params.lineCount)&&void 0!==t?t:ir.defaultLineCount,value:i,viewProps:e.viewProps}):new lr(e.document,{formatter:Pt,value:i,viewProps:e.viewProps})}};class vr{constructor(e){this.onValueChange_=this.onValueChange_.bind(this),this.reader=e.reader,this.writer=e.writer,this.emitter=new u,this.value=e.value,this.value.emitter.on("change",this.onValueChange_),this.target=e.target,this.read()}read(){const e=this.target.read();void 0!==e&&(this.value.rawValue=this.reader(e))}write_(e){this.writer(this.target,e)}onValueChange_(e){this.write_(e.rawValue),this.emitter.emit("change",{options:e.options,rawValue:e.rawValue,sender:this})}}class br{constructor(e){this.onTick_=this.onTick_.bind(this),this.reader_=e.reader,this.target=e.target,this.emitter=new u,this.value=e.value,this.ticker=e.ticker,this.ticker.emitter.on("tick",this.onTick_),this.read()}dispose(){this.ticker.dispose()}read(){const e=this.target.read();if(void 0===e)return;const t=this.value.rawValue,i=this.reader_(e);this.value.rawValue=function(e,t){const i=[...At(e),t];return i.length>e.length?i.splice(0,i.length-e.length):kt(i,e.length),i}(t,i),this.emitter.emit("update",{rawValue:i,sender:this})}onTick_(e){this.read()}}function wr(e,t){return 0===t?new ze:new Ne(e,null!=t?t:ir.defaultInterval)}class yr{constructor(){this.pluginsMap_={blades:[],inputs:[],monitors:[]}}getAll(){return[...this.pluginsMap_.blades,...this.pluginsMap_.inputs,...this.pluginsMap_.monitors]}register(e){"blade"===e.type?this.pluginsMap_.blades.unshift(e):"input"===e.type?this.pluginsMap_.inputs.unshift(e):"monitor"===e.type&&this.pluginsMap_.monitors.unshift(e)}createInput(e,t,i){if(o(t.read()))throw new c({context:{key:t.key},type:"nomatchingcontroller"});const n=this.pluginsMap_.inputs.reduce(((n,r)=>n||function(e,t){const i=e.accept(t.target.read(),t.params);if(o(i))return null;const n=T,r={target:t.target,initialValue:i.initialValue,params:i.params},s=e.binding.reader(r),a=e.binding.constraint?e.binding.constraint(r):void 0,l=S(s(i.initialValue),{constraint:a,equals:e.binding.equals}),c=new vr({reader:s,target:t.target,value:l,writer:e.binding.writer(r)}),d=n.optional.boolean(t.params.disabled).value,h=n.optional.boolean(t.params.hidden).value,u=e.controller({constraint:a,document:t.document,initialValue:i.initialValue,params:i.params,value:c.value,viewProps:ke.create({disabled:d,hidden:h})}),p=n.optional.string(t.params.label).value;return new ie(t.document,{binding:c,blade:X(),props:E.fromObject({label:p||t.target.key}),valueController:u})}(r,{document:e,target:t,params:i})),null);if(n)return n;throw new c({context:{key:t.key},type:"nomatchingcontroller"})}createMonitor(e,t,i){const n=this.pluginsMap_.monitors.reduce(((n,r)=>n||function(e,t){var i,n,r;const s=T,a=e.accept(t.target.read(),t.params);if(o(a))return null;const l={target:t.target,initialValue:a.initialValue,params:a.params},c=e.binding.reader(l),d=null!==(n=null!==(i=s.optional.number(t.params.bufferSize).value)&&void 0!==i?i:e.binding.defaultBufferSize&&e.binding.defaultBufferSize(a.params))&&void 0!==n?n:1,h=s.optional.number(t.params.interval).value,u=new br({reader:c,target:t.target,ticker:wr(t.document,h),value:Tt(d)}),p=s.optional.boolean(t.params.disabled).value,f=s.optional.boolean(t.params.hidden).value,g=e.controller({document:t.document,params:a.params,value:u.value,viewProps:ke.create({disabled:p,hidden:f})}),m=null!==(r=s.optional.string(t.params.label).value)&&void 0!==r?r:t.target.key;return new re(t.document,{binding:u,blade:X(),props:E.fromObject({label:m}),valueController:g})}(r,{document:e,params:i,target:t})),null);if(n)return n;throw new c({context:{key:t.key},type:"nomatchingcontroller"})}createBlade(e,t){const i=this.pluginsMap_.blades.reduce(((i,n)=>i||function(e,t){const i=e.accept(t.params);if(!i)return null;const n=T.optional.boolean(t.params.disabled).value,r=T.optional.boolean(t.params.hidden).value;return e.controller({blade:X(),document:t.document,params:Object.assign(Object.assign({},i.params),{disabled:n,hidden:r}),viewProps:ke.create({disabled:n,hidden:r})})}(n,{document:e,params:t})),null);if(!i)throw new c({type:"nomatchingview",context:{params:t}});return i}createBladeApi(e){if(e instanceof ie)return new te(e);if(e instanceof re)return new ne(e);if(e instanceof ge)return new le(e,this);const t=this.pluginsMap_.blades.reduce(((t,i)=>t||i.api({controller:e,pool:this})),null);if(!t)throw c.shouldNeverHappen();return t}}class xr extends t{constructor(e){super(e),this.emitter_=new u,this.controller_.valueController.value.emitter.on("change",(e=>{this.emitter_.emit("change",{event:new n(this,e.rawValue)})}))}get label(){return this.controller_.props.get("label")}set label(e){this.controller_.props.set("label",e)}get options(){return this.controller_.valueController.props.get("options")}set options(e){this.controller_.valueController.props.set("options",e)}get value(){return this.controller_.valueController.value.rawValue}set value(e){this.controller_.valueController.value.rawValue=e}on(e,t){const i=t.bind(this);return this.emitter_.on(e,(e=>{i(e.event)})),this}}class $r extends t{constructor(e){super(e),this.emitter_=new u,this.controller_.valueController.value.emitter.on("change",(e=>{this.emitter_.emit("change",{event:new n(this,e.rawValue)})}))}get label(){return this.controller_.props.get("label")}set label(e){this.controller_.props.set("label",e)}get maxValue(){return this.controller_.valueController.sliderController.props.get("maxValue")}set maxValue(e){this.controller_.valueController.sliderController.props.set("maxValue",e)}get minValue(){return this.controller_.valueController.sliderController.props.get("minValue")}set minValue(e){this.controller_.valueController.sliderController.props.set("minValue",e)}get value(){return this.controller_.valueController.value.rawValue}set value(e){this.controller_.valueController.value.rawValue=e}on(e,t){const i=t.bind(this);return this.emitter_.on(e,(e=>{i(e.event)})),this}}class Cr extends t{constructor(e){super(e),this.emitter_=new u,this.controller_.valueController.value.emitter.on("change",(e=>{this.emitter_.emit("change",{event:new n(this,e.rawValue)})}))}get label(){return this.controller_.props.get("label")}set label(e){this.controller_.props.set("label",e)}get formatter(){return this.controller_.valueController.props.get("formatter")}set formatter(e){this.controller_.valueController.props.set("formatter",e)}get value(){return this.controller_.valueController.value.rawValue}set value(e){this.controller_.valueController.value.rawValue=e}on(e,t){const i=t.bind(this);return this.emitter_.on(e,(e=>{i(e.event)})),this}}const Sr={id:"list",type:"blade",accept(e){const t=T,i=A(e,{options:t.required.custom(Zt),value:t.required.raw,view:t.required.constant("list"),label:t.optional.string});return i?{params:i}:null},controller(e){const t=new Ke(e.document,{props:E.fromObject({options:ti(e.params.options)}),value:S(e.params.value),viewProps:e.viewProps});return new we(e.document,{blade:e.blade,props:E.fromObject({label:e.params.label}),valueController:t})},api:e=>e.controller instanceof we&&e.controller.valueController instanceof Ke?new xr(e.controller):null};class Er extends ce{constructor(e,t){super(e,t)}get element(){return this.controller_.view.element}importPreset(e){(function(e,t){e.forEach((e=>{const i=t[e.presetKey];void 0!==i&&e.write(i)}))})(this.controller_.rackController.rack.find(ie).map((e=>e.binding.target)),e),this.refresh()}exportPreset(){return this.controller_.rackController.rack.find(ie).map((e=>e.binding.target)).reduce(((e,t)=>Object.assign(e,{[t.presetKey]:t.read()})),{})}refresh(){this.controller_.rackController.rack.find(ie).forEach((e=>{e.binding.read()})),this.controller_.rackController.rack.find(re).forEach((e=>{e.binding.read()}))}}class Pr extends ve{constructor(e,t){super(e,{expanded:t.expanded,blade:t.blade,props:t.props,root:!0,viewProps:t.viewProps})}}const kr={id:"slider",type:"blade",accept(e){const t=T,i=A(e,{max:t.required.number,min:t.required.number,view:t.required.constant("slider"),format:t.optional.function,label:t.optional.string,value:t.optional.number});return i?{params:i}:null},controller(e){var t,i;const n=null!==(t=e.params.value)&&void 0!==t?t:0,r=new Yt(e.document,{baseStep:1,parser:wt,sliderProps:E.fromObject({maxValue:e.params.max,minValue:e.params.min}),textProps:E.fromObject({draggingScale:oi(void 0,n),formatter:null!==(i=e.params.format)&&void 0!==i?i:xt}),value:S(n),viewProps:e.viewProps});return new we(e.document,{blade:e.blade,props:E.fromObject({label:e.params.label}),valueController:r})},api:e=>e.controller instanceof we&&e.controller.valueController instanceof Yt?new $r(e.controller):null},Tr={id:"text",type:"blade",accept(e){const t=T,i=A(e,{parse:t.required.function,value:t.required.raw,view:t.required.constant("text"),format:t.optional.function,label:t.optional.string});return i?{params:i}:null},controller(e){var t;const i=new et(e.document,{parser:e.params.parse,props:E.fromObject({formatter:null!==(t=e.params.format)&&void 0!==t?t:e=>String(e)}),value:S(e.params.value),viewProps:e.viewProps});return new we(e.document,{blade:e.blade,props:E.fromObject({label:e.params.label}),valueController:i})},api:e=>e.controller instanceof we&&e.controller.valueController instanceof et?new Cr(e.controller):null};function Ar(e,t,i){if(e.querySelector(`style[data-tp-style=${t}]`))return;const n=e.createElement("style");n.dataset.tpStyle=t,n.textContent=i,e.head.appendChild(n)}const Dr=new class{constructor(e){const[t,i]=e.split("-"),n=t.split(".");this.major=parseInt(n[0],10),this.minor=parseInt(n[1],10),this.patch=parseInt(n[2],10),this.prerelease=null!=i?i:null}toString(){const e=[this.major,this.minor,this.patch].join(".");return null!==this.prerelease?[e,this.prerelease].join("-"):e}}("3.0.7");e.BladeApi=t,e.ButtonApi=h,e.FolderApi=ce,e.InputBindingApi=te,e.ListApi=xr,e.MonitorBindingApi=ne,e.Pane=class extends Er{constructor(e){var t;const i=e||{},n=null!==(t=i.document)&&void 0!==t?t:F(),r=function(){const e=new yr;return[Vn,Kn,er,tr,Cn,_n,mn,gn,di,cr,_r,mr,q,be,Se,Oe].forEach((t=>{e.register(t)})),e}();super(new Pr(n,{expanded:i.expanded,blade:X(),props:E.fromObject({title:i.title}),viewProps:ke.create()}),r),this.pool_=r,this.containerElem_=i.container||function(e){const t=e.createElement("div");return t.classList.add(f("dfw")()),e.body&&e.body.appendChild(t),t}(n),this.containerElem_.appendChild(this.element),this.doc_=n,this.usesDefaultWrapper_=!i.container,this.setUpDefaultPlugins_()}get document(){if(!this.doc_)throw c.alreadyDisposed();return this.doc_}dispose(){const e=this.containerElem_;if(!e)throw c.alreadyDisposed();if(this.usesDefaultWrapper_){const t=e.parentElement;t&&t.removeChild(e)}this.containerElem_=null,this.doc_=null,super.dispose()}registerPlugin(e){("plugin"in e?[e.plugin]:"plugins"in e?e.plugins:[]).forEach((e=>{this.pool_.register(e),this.embedPluginStyle_(e)}))}embedPluginStyle_(e){e.css&&Ar(this.document,`plugin-${e.id}`,e.css)}setUpDefaultPlugins_(){Ar(this.document,"default",".tp-lstv_s,.tp-btnv_b,.tp-p2dv_b,.tp-colswv_sw,.tp-p2dpv_p,.tp-txtv_i,.tp-grlv_g,.tp-sglv_i,.tp-mllv_i,.tp-fldv_b,.tp-rotv_b,.tp-ckbv_i,.tp-coltxtv_ms,.tp-tbiv_b{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border-width:0;font-family:inherit;font-size:inherit;font-weight:inherit;margin:0;outline:none;padding:0}.tp-lstv_s,.tp-btnv_b,.tp-p2dv_b{background-color:var(--btn-bg);border-radius:var(--elm-br);color:var(--btn-fg);cursor:pointer;display:block;font-weight:bold;height:var(--bld-us);line-height:var(--bld-us);overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.tp-lstv_s:hover,.tp-btnv_b:hover,.tp-p2dv_b:hover{background-color:var(--btn-bg-h)}.tp-lstv_s:focus,.tp-btnv_b:focus,.tp-p2dv_b:focus{background-color:var(--btn-bg-f)}.tp-lstv_s:active,.tp-btnv_b:active,.tp-p2dv_b:active{background-color:var(--btn-bg-a)}.tp-lstv_s:disabled,.tp-btnv_b:disabled,.tp-p2dv_b:disabled{opacity:0.5}.tp-colswv_sw,.tp-p2dpv_p,.tp-txtv_i{background-color:var(--in-bg);border-radius:var(--elm-br);box-sizing:border-box;color:var(--in-fg);font-family:inherit;height:var(--bld-us);line-height:var(--bld-us);min-width:0;width:100%}.tp-colswv_sw:hover,.tp-p2dpv_p:hover,.tp-txtv_i:hover{background-color:var(--in-bg-h)}.tp-colswv_sw:focus,.tp-p2dpv_p:focus,.tp-txtv_i:focus{background-color:var(--in-bg-f)}.tp-colswv_sw:active,.tp-p2dpv_p:active,.tp-txtv_i:active{background-color:var(--in-bg-a)}.tp-colswv_sw:disabled,.tp-p2dpv_p:disabled,.tp-txtv_i:disabled{opacity:0.5}.tp-grlv_g,.tp-sglv_i,.tp-mllv_i{background-color:var(--mo-bg);border-radius:var(--elm-br);box-sizing:border-box;color:var(--mo-fg);height:var(--bld-us);width:100%}.tp-rotv{--font-family: var(--tp-font-family, Roboto Mono,Source Code Pro,Menlo,Courier,monospace);--bs-br: var(--tp-base-border-radius, 6px);--cnt-h-p: var(--tp-container-horizontal-padding, 4px);--cnt-v-p: var(--tp-container-vertical-padding, 4px);--elm-br: var(--tp-element-border-radius, 2px);--bld-s: var(--tp-blade-spacing, 4px);--bld-us: var(--tp-blade-unit-size, 20px);--bs-bg: var(--tp-base-background-color, #2f3137);--bs-sh: var(--tp-base-shadow-color, rgba(0,0,0,0.2));--btn-bg: var(--tp-button-background-color, #adafb8);--btn-bg-a: var(--tp-button-background-color-active, #d6d7db);--btn-bg-f: var(--tp-button-background-color-focus, #c8cad0);--btn-bg-h: var(--tp-button-background-color-hover, #bbbcc4);--btn-fg: var(--tp-button-foreground-color, #2f3137);--cnt-bg: var(--tp-container-background-color, rgba(187,188,196,0.1));--cnt-bg-a: var(--tp-container-background-color-active, rgba(187,188,196,0.25));--cnt-bg-f: var(--tp-container-background-color-focus, rgba(187,188,196,0.2));--cnt-bg-h: var(--tp-container-background-color-hover, rgba(187,188,196,0.15));--cnt-fg: var(--tp-container-foreground-color, #bbbcc4);--in-bg: var(--tp-input-background-color, rgba(187,188,196,0.1));--in-bg-a: var(--tp-input-background-color-active, rgba(187,188,196,0.25));--in-bg-f: var(--tp-input-background-color-focus, rgba(187,188,196,0.2));--in-bg-h: var(--tp-input-background-color-hover, rgba(187,188,196,0.15));--in-fg: var(--tp-input-foreground-color, #bbbcc4);--lbl-fg: var(--tp-label-foreground-color, rgba(187,188,196,0.7));--mo-bg: var(--tp-monitor-background-color, rgba(0,0,0,0.2));--mo-fg: var(--tp-monitor-foreground-color, rgba(187,188,196,0.7));--grv-fg: var(--tp-groove-foreground-color, rgba(0,0,0,0.2))}.tp-fldv_c>.tp-cntv.tp-v-lst,.tp-tabv_c .tp-brkv>.tp-cntv.tp-v-lst,.tp-rotv_c>.tp-cntv.tp-v-lst{margin-bottom:calc(-1 * var(--cnt-v-p))}.tp-fldv_c>.tp-fldv.tp-v-lst .tp-fldv_c,.tp-tabv_c .tp-brkv>.tp-fldv.tp-v-lst .tp-fldv_c,.tp-rotv_c>.tp-fldv.tp-v-lst .tp-fldv_c{border-bottom-left-radius:0}.tp-fldv_c>.tp-fldv.tp-v-lst .tp-fldv_b,.tp-tabv_c .tp-brkv>.tp-fldv.tp-v-lst .tp-fldv_b,.tp-rotv_c>.tp-fldv.tp-v-lst .tp-fldv_b{border-bottom-left-radius:0}.tp-fldv_c>*:not(.tp-v-fst),.tp-tabv_c .tp-brkv>*:not(.tp-v-fst),.tp-rotv_c>*:not(.tp-v-fst){margin-top:var(--bld-s)}.tp-fldv_c>.tp-sprv:not(.tp-v-fst),.tp-tabv_c .tp-brkv>.tp-sprv:not(.tp-v-fst),.tp-rotv_c>.tp-sprv:not(.tp-v-fst),.tp-fldv_c>.tp-cntv:not(.tp-v-fst),.tp-tabv_c .tp-brkv>.tp-cntv:not(.tp-v-fst),.tp-rotv_c>.tp-cntv:not(.tp-v-fst){margin-top:var(--cnt-v-p)}.tp-fldv_c>.tp-sprv+*:not(.tp-v-hidden),.tp-tabv_c .tp-brkv>.tp-sprv+*:not(.tp-v-hidden),.tp-rotv_c>.tp-sprv+*:not(.tp-v-hidden),.tp-fldv_c>.tp-cntv+*:not(.tp-v-hidden),.tp-tabv_c .tp-brkv>.tp-cntv+*:not(.tp-v-hidden),.tp-rotv_c>.tp-cntv+*:not(.tp-v-hidden){margin-top:var(--cnt-v-p)}.tp-fldv_c>.tp-sprv:not(.tp-v-hidden)+.tp-sprv,.tp-tabv_c .tp-brkv>.tp-sprv:not(.tp-v-hidden)+.tp-sprv,.tp-rotv_c>.tp-sprv:not(.tp-v-hidden)+.tp-sprv,.tp-fldv_c>.tp-cntv:not(.tp-v-hidden)+.tp-cntv,.tp-tabv_c .tp-brkv>.tp-cntv:not(.tp-v-hidden)+.tp-cntv,.tp-rotv_c>.tp-cntv:not(.tp-v-hidden)+.tp-cntv{margin-top:0}.tp-fldv_c>.tp-cntv,.tp-tabv_c .tp-brkv>.tp-cntv{margin-left:4px}.tp-fldv_c>.tp-fldv>.tp-fldv_b,.tp-tabv_c .tp-brkv>.tp-fldv>.tp-fldv_b{border-top-left-radius:var(--elm-br);border-bottom-left-radius:var(--elm-br)}.tp-fldv_c>.tp-fldv.tp-fldv-expanded>.tp-fldv_b,.tp-tabv_c .tp-brkv>.tp-fldv.tp-fldv-expanded>.tp-fldv_b{border-bottom-left-radius:0}.tp-fldv_c .tp-fldv>.tp-fldv_c,.tp-tabv_c .tp-brkv .tp-fldv>.tp-fldv_c{border-bottom-left-radius:var(--elm-br)}.tp-fldv_c>.tp-tabv>.tp-tabv_i,.tp-tabv_c .tp-brkv>.tp-tabv>.tp-tabv_i{border-top-left-radius:var(--elm-br)}.tp-fldv_c .tp-tabv>.tp-tabv_c,.tp-tabv_c .tp-brkv .tp-tabv>.tp-tabv_c{border-bottom-left-radius:var(--elm-br)}.tp-fldv_b,.tp-rotv_b{background-color:var(--cnt-bg);color:var(--cnt-fg);cursor:pointer;display:block;height:calc(var(--bld-us) + 4px);line-height:calc(var(--bld-us) + 4px);overflow:hidden;padding-left:var(--cnt-h-p);padding-right:calc(2px * 2 + var(--bld-us) + var(--cnt-h-p));position:relative;text-align:left;text-overflow:ellipsis;white-space:nowrap;width:100%;transition:border-radius .2s ease-in-out .2s}.tp-fldv_b:hover,.tp-rotv_b:hover{background-color:var(--cnt-bg-h)}.tp-fldv_b:focus,.tp-rotv_b:focus{background-color:var(--cnt-bg-f)}.tp-fldv_b:active,.tp-rotv_b:active{background-color:var(--cnt-bg-a)}.tp-fldv_b:disabled,.tp-rotv_b:disabled{opacity:0.5}.tp-fldv_m,.tp-rotv_m{background:linear-gradient(to left, var(--cnt-fg), var(--cnt-fg) 2px, transparent 2px, transparent 4px, var(--cnt-fg) 4px);border-radius:2px;bottom:0;content:'';display:block;height:6px;right:calc(var(--cnt-h-p) + (var(--bld-us) + 4px - 6px) / 2 - 2px);margin:auto;opacity:0.5;position:absolute;top:0;transform:rotate(90deg);transition:transform .2s ease-in-out;width:6px}.tp-fldv.tp-fldv-expanded>.tp-fldv_b>.tp-fldv_m,.tp-rotv.tp-rotv-expanded .tp-rotv_m{transform:none}.tp-fldv_c,.tp-rotv_c{box-sizing:border-box;height:0;opacity:0;overflow:hidden;padding-bottom:0;padding-top:0;position:relative;transition:height .2s ease-in-out,opacity .2s linear,padding .2s ease-in-out}.tp-fldv.tp-fldv-cpl:not(.tp-fldv-expanded)>.tp-fldv_c,.tp-rotv.tp-rotv-cpl:not(.tp-rotv-expanded) .tp-rotv_c{display:none}.tp-fldv.tp-fldv-expanded>.tp-fldv_c,.tp-rotv.tp-rotv-expanded .tp-rotv_c{opacity:1;padding-bottom:var(--cnt-v-p);padding-top:var(--cnt-v-p);transform:none;overflow:visible;transition:height .2s ease-in-out,opacity .2s linear .2s,padding .2s ease-in-out}.tp-coltxtv_m,.tp-lstv{position:relative}.tp-lstv_s{padding:0 20px 0 4px;width:100%}.tp-coltxtv_mm,.tp-lstv_m{bottom:0;margin:auto;pointer-events:none;position:absolute;right:2px;top:0}.tp-coltxtv_mm svg,.tp-lstv_m svg{bottom:0;height:16px;margin:auto;position:absolute;right:0;top:0;width:16px}.tp-coltxtv_mm svg path,.tp-lstv_m svg path{fill:currentColor}.tp-coltxtv_w,.tp-pndtxtv{display:flex}.tp-coltxtv_c,.tp-pndtxtv_a{width:100%}.tp-coltxtv_c+.tp-coltxtv_c,.tp-pndtxtv_a+.tp-coltxtv_c,.tp-coltxtv_c+.tp-pndtxtv_a,.tp-pndtxtv_a+.tp-pndtxtv_a{margin-left:2px}.tp-btnv_b{width:100%}.tp-btnv_t{text-align:center}.tp-ckbv_l{display:block;position:relative}.tp-ckbv_i{left:0;opacity:0;position:absolute;top:0}.tp-ckbv_w{background-color:var(--in-bg);border-radius:var(--elm-br);cursor:pointer;display:block;height:var(--bld-us);position:relative;width:var(--bld-us)}.tp-ckbv_w svg{bottom:0;display:block;height:16px;left:0;margin:auto;opacity:0;position:absolute;right:0;top:0;width:16px}.tp-ckbv_w svg path{fill:none;stroke:var(--in-fg);stroke-width:2}.tp-ckbv_i:hover+.tp-ckbv_w{background-color:var(--in-bg-h)}.tp-ckbv_i:focus+.tp-ckbv_w{background-color:var(--in-bg-f)}.tp-ckbv_i:active+.tp-ckbv_w{background-color:var(--in-bg-a)}.tp-ckbv_i:checked+.tp-ckbv_w svg{opacity:1}.tp-ckbv.tp-v-disabled .tp-ckbv_w{opacity:0.5}.tp-colv{position:relative}.tp-colv_h{display:flex}.tp-colv_s{flex-grow:0;flex-shrink:0;width:var(--bld-us)}.tp-colv_t{flex:1;margin-left:4px}.tp-colv_p{height:0;margin-top:0;opacity:0;overflow:hidden;transition:height .2s ease-in-out,opacity .2s linear,margin .2s ease-in-out}.tp-colv.tp-colv-cpl .tp-colv_p{overflow:visible}.tp-colv.tp-colv-expanded .tp-colv_p{margin-top:var(--bld-s);opacity:1}.tp-colv .tp-popv{left:calc(-1 * var(--cnt-h-p));right:calc(-1 * var(--cnt-h-p));top:var(--bld-us)}.tp-colpv_h,.tp-colpv_ap{margin-left:6px;margin-right:6px}.tp-colpv_h{margin-top:var(--bld-s)}.tp-colpv_rgb{display:flex;margin-top:var(--bld-s);width:100%}.tp-colpv_a{display:flex;margin-top:var(--cnt-v-p);padding-top:calc(var(--cnt-v-p) + 2px);position:relative}.tp-colpv_a:before{background-color:var(--grv-fg);content:'';height:2px;left:calc(-1 * var(--cnt-h-p));position:absolute;right:calc(-1 * var(--cnt-h-p));top:0}.tp-colpv_ap{align-items:center;display:flex;flex:3}.tp-colpv_at{flex:1;margin-left:4px}.tp-svpv{border-radius:var(--elm-br);outline:none;overflow:hidden;position:relative}.tp-svpv_c{cursor:crosshair;display:block;height:calc(var(--bld-us) * 4);width:100%}.tp-svpv_m{border-radius:100%;border:rgba(255,255,255,0.75) solid 2px;box-sizing:border-box;filter:drop-shadow(0 0 1px rgba(0,0,0,0.3));height:12px;margin-left:-6px;margin-top:-6px;pointer-events:none;position:absolute;width:12px}.tp-svpv:focus .tp-svpv_m{border-color:#fff}.tp-hplv{cursor:pointer;height:var(--bld-us);outline:none;position:relative}.tp-hplv_c{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAAABCAYAAABubagXAAAAQ0lEQVQoU2P8z8Dwn0GCgQEDi2OK/RBgYHjBgIpfovFh8j8YBIgzFGQxuqEgPhaDOT5gOhPkdCxOZeBg+IDFZZiGAgCaSSMYtcRHLgAAAABJRU5ErkJggg==);background-position:left top;background-repeat:no-repeat;background-size:100% 100%;border-radius:2px;display:block;height:4px;left:0;margin-top:-2px;position:absolute;top:50%;width:100%}.tp-hplv_m{border-radius:var(--elm-br);border:rgba(255,255,255,0.75) solid 2px;box-shadow:0 0 2px rgba(0,0,0,0.1);box-sizing:border-box;height:12px;left:50%;margin-left:-6px;margin-top:-6px;pointer-events:none;position:absolute;top:50%;width:12px}.tp-hplv:focus .tp-hplv_m{border-color:#fff}.tp-aplv{cursor:pointer;height:var(--bld-us);outline:none;position:relative;width:100%}.tp-aplv_b{background-color:#fff;background-image:linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%),linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%);background-size:4px 4px;background-position:0 0,2px 2px;border-radius:2px;display:block;height:4px;left:0;margin-top:-2px;overflow:hidden;position:absolute;top:50%;width:100%}.tp-aplv_c{bottom:0;left:0;position:absolute;right:0;top:0}.tp-aplv_m{background-color:#fff;background-image:linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%),linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%);background-size:12px 12px;background-position:0 0,6px 6px;border-radius:var(--elm-br);box-shadow:0 0 2px rgba(0,0,0,0.1);height:12px;left:50%;margin-left:-6px;margin-top:-6px;overflow:hidden;pointer-events:none;position:absolute;top:50%;width:12px}.tp-aplv_p{border-radius:var(--elm-br);border:rgba(255,255,255,0.75) solid 2px;box-sizing:border-box;bottom:0;left:0;position:absolute;right:0;top:0}.tp-aplv:focus .tp-aplv_p{border-color:#fff}.tp-colswv{background-color:#fff;background-image:linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%),linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%);background-size:10px 10px;background-position:0 0,5px 5px;border-radius:var(--elm-br)}.tp-colswv.tp-v-disabled{opacity:0.5}.tp-colswv_b{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border-width:0;cursor:pointer;display:block;height:var(--bld-us);left:0;margin:0;outline:none;padding:0;position:absolute;top:0;width:var(--bld-us)}.tp-colswv_b:focus::after{border:rgba(255,255,255,0.75) solid 2px;border-radius:var(--elm-br);bottom:0;content:'';display:block;left:0;position:absolute;right:0;top:0}.tp-coltxtv{display:flex;width:100%}.tp-coltxtv_m{margin-right:4px}.tp-coltxtv_ms{border-radius:var(--elm-br);color:var(--lbl-fg);cursor:pointer;height:var(--bld-us);line-height:var(--bld-us);padding:0 18px 0 4px}.tp-coltxtv_ms:hover{background-color:var(--in-bg-h)}.tp-coltxtv_ms:focus{background-color:var(--in-bg-f)}.tp-coltxtv_ms:active{background-color:var(--in-bg-a)}.tp-coltxtv_mm{color:var(--lbl-fg)}.tp-coltxtv_w{flex:1}.tp-dfwv{position:absolute;top:8px;right:8px;width:256px}.tp-fldv.tp-fldv-not .tp-fldv_b{display:none}.tp-fldv_t{padding-left:4px}.tp-fldv_c{border-left:var(--cnt-bg) solid 4px}.tp-fldv_b:hover+.tp-fldv_c{border-left-color:var(--cnt-bg-h)}.tp-fldv_b:focus+.tp-fldv_c{border-left-color:var(--cnt-bg-f)}.tp-fldv_b:active+.tp-fldv_c{border-left-color:var(--cnt-bg-a)}.tp-grlv{position:relative}.tp-grlv_g{display:block;height:calc(var(--bld-us) * 3)}.tp-grlv_g polyline{fill:none;stroke:var(--mo-fg);stroke-linejoin:round}.tp-grlv_t{margin-top:-4px;transition:left 0.05s, top 0.05s;visibility:hidden}.tp-grlv_t.tp-grlv_t-a{visibility:visible}.tp-grlv_t.tp-grlv_t-in{transition:none}.tp-grlv.tp-v-disabled .tp-grlv_g{opacity:0.5}.tp-grlv .tp-ttv{background-color:var(--mo-fg)}.tp-grlv .tp-ttv::before{border-top-color:var(--mo-fg)}.tp-lblv{align-items:center;display:flex;line-height:1.3;padding-left:var(--cnt-h-p);padding-right:var(--cnt-h-p)}.tp-lblv.tp-lblv-nol{display:block}.tp-lblv_l{color:var(--lbl-fg);flex:1;-webkit-hyphens:auto;-ms-hyphens:auto;hyphens:auto;overflow:hidden;padding-left:4px;padding-right:16px}.tp-lblv.tp-v-disabled .tp-lblv_l{opacity:0.5}.tp-lblv.tp-lblv-nol .tp-lblv_l{display:none}.tp-lblv_v{align-self:flex-start;flex-grow:0;flex-shrink:0;width:160px}.tp-lblv.tp-lblv-nol .tp-lblv_v{width:100%}.tp-lstv_s{padding:0 20px 0 4px;width:100%}.tp-lstv_m{color:var(--btn-fg)}.tp-sglv_i{padding:0 4px}.tp-sglv.tp-v-disabled .tp-sglv_i{opacity:0.5}.tp-mllv_i{display:block;height:calc(var(--bld-us) * 3);line-height:var(--bld-us);padding:0 4px;resize:none;white-space:pre}.tp-mllv.tp-v-disabled .tp-mllv_i{opacity:0.5}.tp-p2dv{position:relative}.tp-p2dv_h{display:flex}.tp-p2dv_b{height:var(--bld-us);margin-right:4px;position:relative;width:var(--bld-us)}.tp-p2dv_b svg{display:block;height:16px;left:50%;margin-left:-8px;margin-top:-8px;position:absolute;top:50%;width:16px}.tp-p2dv_b svg path{stroke:currentColor;stroke-width:2}.tp-p2dv_b svg circle{fill:currentColor}.tp-p2dv_t{flex:1}.tp-p2dv_p{height:0;margin-top:0;opacity:0;overflow:hidden;transition:height .2s ease-in-out,opacity .2s linear,margin .2s ease-in-out}.tp-p2dv.tp-p2dv-expanded .tp-p2dv_p{margin-top:var(--bld-s);opacity:1}.tp-p2dv .tp-popv{left:calc(-1 * var(--cnt-h-p));right:calc(-1 * var(--cnt-h-p));top:var(--bld-us)}.tp-p2dpv{padding-left:calc(var(--bld-us) + 4px)}.tp-p2dpv_p{cursor:crosshair;height:0;overflow:hidden;padding-bottom:100%;position:relative}.tp-p2dpv_g{display:block;height:100%;left:0;pointer-events:none;position:absolute;top:0;width:100%}.tp-p2dpv_ax{opacity:0.1;stroke:var(--in-fg);stroke-dasharray:1}.tp-p2dpv_l{opacity:0.5;stroke:var(--in-fg);stroke-dasharray:1}.tp-p2dpv_m{border:var(--in-fg) solid 1px;border-radius:50%;box-sizing:border-box;height:4px;margin-left:-2px;margin-top:-2px;position:absolute;width:4px}.tp-p2dpv_p:focus .tp-p2dpv_m{background-color:var(--in-fg);border-width:0}.tp-popv{background-color:var(--bs-bg);border-radius:6px;box-shadow:0 2px 4px var(--bs-sh);display:none;max-width:168px;padding:var(--cnt-v-p) var(--cnt-h-p);position:absolute;visibility:hidden;z-index:1000}.tp-popv.tp-popv-v{display:block;visibility:visible}.tp-sprv_r{background-color:var(--grv-fg);border-width:0;display:block;height:2px;margin:0;width:100%}.tp-sldv.tp-v-disabled{opacity:0.5}.tp-sldv_t{box-sizing:border-box;cursor:pointer;height:var(--bld-us);margin:0 6px;outline:none;position:relative}.tp-sldv_t::before{background-color:var(--in-bg);border-radius:1px;bottom:0;content:'';display:block;height:2px;left:0;margin:auto;position:absolute;right:0;top:0}.tp-sldv_k{height:100%;left:0;position:absolute;top:0}.tp-sldv_k::before{background-color:var(--in-fg);border-radius:1px;bottom:0;content:'';display:block;height:2px;left:0;margin-bottom:auto;margin-top:auto;position:absolute;right:0;top:0}.tp-sldv_k::after{background-color:var(--btn-bg);border-radius:var(--elm-br);bottom:0;content:'';display:block;height:12px;margin-bottom:auto;margin-top:auto;position:absolute;right:-6px;top:0;width:12px}.tp-sldv_t:hover .tp-sldv_k::after{background-color:var(--btn-bg-h)}.tp-sldv_t:focus .tp-sldv_k::after{background-color:var(--btn-bg-f)}.tp-sldv_t:active .tp-sldv_k::after{background-color:var(--btn-bg-a)}.tp-sldtxtv{display:flex}.tp-sldtxtv_s{flex:2}.tp-sldtxtv_t{flex:1;margin-left:4px}.tp-tabv.tp-v-disabled{opacity:0.5}.tp-tabv_i{align-items:flex-end;display:flex;overflow:hidden}.tp-tabv.tp-tabv-nop .tp-tabv_i{height:calc(var(--bld-us) + 4px);position:relative}.tp-tabv.tp-tabv-nop .tp-tabv_i::before{background-color:var(--cnt-bg);bottom:0;content:'';height:2px;left:0;position:absolute;right:0}.tp-tabv_c{border-left:var(--cnt-bg) solid 4px;padding-bottom:var(--cnt-v-p);padding-top:var(--cnt-v-p)}.tp-tbiv{flex:1;min-width:0;position:relative}.tp-tbiv+.tp-tbiv{margin-left:2px}.tp-tbiv+.tp-tbiv::before{background-color:var(--cnt-bg);bottom:0;content:'';height:2px;left:-2px;position:absolute;width:2px}.tp-tbiv_b{background-color:var(--cnt-bg);display:block;padding-left:calc(var(--cnt-h-p) + 4px);padding-right:calc(var(--cnt-h-p) + 4px);width:100%}.tp-tbiv_b:hover{background-color:var(--cnt-bg-h)}.tp-tbiv_b:focus{background-color:var(--cnt-bg-f)}.tp-tbiv_b:active{background-color:var(--cnt-bg-a)}.tp-tbiv_b:disabled{opacity:0.5}.tp-tbiv_t{color:var(--cnt-fg);height:calc(var(--bld-us) + 4px);line-height:calc(var(--bld-us) + 4px);opacity:0.5;overflow:hidden;text-overflow:ellipsis}.tp-tbiv.tp-tbiv-sel .tp-tbiv_t{opacity:1}.tp-txtv{position:relative}.tp-txtv_i{padding:0 4px}.tp-txtv.tp-txtv-fst .tp-txtv_i{border-bottom-right-radius:0;border-top-right-radius:0}.tp-txtv.tp-txtv-mid .tp-txtv_i{border-radius:0}.tp-txtv.tp-txtv-lst .tp-txtv_i{border-bottom-left-radius:0;border-top-left-radius:0}.tp-txtv.tp-txtv-num .tp-txtv_i{text-align:right}.tp-txtv.tp-txtv-drg .tp-txtv_i{opacity:0.3}.tp-txtv_k{cursor:pointer;height:100%;left:-3px;position:absolute;top:0;width:12px}.tp-txtv_k::before{background-color:var(--in-fg);border-radius:1px;bottom:0;content:'';height:calc(var(--bld-us) - 4px);left:50%;margin-bottom:auto;margin-left:-1px;margin-top:auto;opacity:0.1;position:absolute;top:0;transition:border-radius 0.1s, height 0.1s, transform 0.1s, width 0.1s;width:2px}.tp-txtv_k:hover::before,.tp-txtv.tp-txtv-drg .tp-txtv_k::before{opacity:1}.tp-txtv.tp-txtv-drg .tp-txtv_k::before{border-radius:50%;height:4px;transform:translateX(-1px);width:4px}.tp-txtv_g{bottom:0;display:block;height:8px;left:50%;margin:auto;overflow:visible;pointer-events:none;position:absolute;top:0;visibility:hidden;width:100%}.tp-txtv.tp-txtv-drg .tp-txtv_g{visibility:visible}.tp-txtv_gb{fill:none;stroke:var(--in-fg);stroke-dasharray:1}.tp-txtv_gh{fill:none;stroke:var(--in-fg)}.tp-txtv .tp-ttv{margin-left:6px;visibility:hidden}.tp-txtv.tp-txtv-drg .tp-ttv{visibility:visible}.tp-ttv{background-color:var(--in-fg);border-radius:var(--elm-br);color:var(--bs-bg);padding:2px 4px;pointer-events:none;position:absolute;transform:translate(-50%, -100%)}.tp-ttv::before{border-color:var(--in-fg) transparent transparent transparent;border-style:solid;border-width:2px;box-sizing:border-box;content:'';font-size:0.9em;height:4px;left:50%;margin-left:-2px;position:absolute;top:100%;width:4px}.tp-rotv{background-color:var(--bs-bg);border-radius:var(--bs-br);box-shadow:0 2px 4px var(--bs-sh);font-family:var(--font-family);font-size:11px;font-weight:500;line-height:1;text-align:left}.tp-rotv_b{border-bottom-left-radius:var(--bs-br);border-bottom-right-radius:var(--bs-br);border-top-left-radius:var(--bs-br);border-top-right-radius:var(--bs-br);padding-left:calc(2px * 2 + var(--bld-us) + var(--cnt-h-p));text-align:center}.tp-rotv.tp-rotv-expanded .tp-rotv_b{border-bottom-left-radius:0;border-bottom-right-radius:0}.tp-rotv.tp-rotv-not .tp-rotv_b{display:none}.tp-rotv_c>.tp-fldv.tp-v-lst>.tp-fldv_c,.tp-rotv_c>.tp-tabv.tp-v-lst>.tp-tabv_c{border-bottom-left-radius:var(--bs-br);border-bottom-right-radius:var(--bs-br)}.tp-rotv_c>.tp-fldv.tp-v-lst:not(.tp-fldv-expanded)>.tp-fldv_b{border-bottom-left-radius:var(--bs-br);border-bottom-right-radius:var(--bs-br)}.tp-rotv_c .tp-fldv.tp-v-vlst:not(.tp-fldv-expanded)>.tp-fldv_b{border-bottom-right-radius:var(--bs-br)}.tp-rotv.tp-rotv-not .tp-rotv_c>.tp-fldv.tp-v-fst{margin-top:calc(-1 * var(--cnt-v-p))}.tp-rotv.tp-rotv-not .tp-rotv_c>.tp-fldv.tp-v-fst>.tp-fldv_b{border-top-left-radius:var(--bs-br);border-top-right-radius:var(--bs-br)}.tp-rotv.tp-rotv-not .tp-rotv_c>.tp-tabv.tp-v-fst{margin-top:calc(-1 * var(--cnt-v-p))}.tp-rotv.tp-rotv-not .tp-rotv_c>.tp-tabv.tp-v-fst>.tp-tabv_i{border-top-left-radius:var(--bs-br);border-top-right-radius:var(--bs-br)}.tp-rotv.tp-v-disabled,.tp-rotv .tp-v-disabled{pointer-events:none}.tp-rotv.tp-v-hidden,.tp-rotv .tp-v-hidden{display:none}"),this.pool_.getAll().forEach((e=>{this.embedPluginStyle_(e)})),this.registerPlugin({plugins:[kr,Sr,Oe,Tr]})}},e.SeparatorApi=ye,e.SliderApi=$r,e.TabApi=Me,e.TabPageApi=Ie,e.TextApi=Cr,e.TpChangeEvent=n,e.VERSION=Dr,Object.defineProperty(e,"__esModule",{value:!0})}(t)},excalibur:e=>{e.exports=t1}},t={};function i(n){var r=t[n];if(void 0!==r)return r.exports;var s=t[n]={exports:{}};return e[n].call(s.exports,s,s.exports,i),s.exports}i.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return i.d(t,{a:t}),t},i.d=(e,t)=>{for(var n in t)i.o(t,n)&&!i.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var n={};return(()=>{i.r(n),i.d(n,{DevTool:()=>s});var e=i("excalibur"),t=i("./node_modules/tweakpane/dist/tweakpane.js"),r=i("./picker-system.ts");class s{constructor(e){this.engine=e,this.pointerPos={x:0,y:0},this.highlightedEntities=[-1],this.selectedEntity=null,this.selectedEntityId=-1,this.pane=new t.Pane({title:"Excalibur Dev Tools",expanded:!0});const i=document.createElement("style");i.innerText=".excalibur-tweakpane-custom { width: 405px; }",document.head.appendChild(i),this.pane.element.parentElement.classList.add("excalibur-tweakpane-custom"),this._buildMain(),this.tabs=this.pane.addTab({pages:[{title:"Entity"},{title:"Screen"},{title:"Camera"},{title:"Clock"},{title:"Timers"},{title:"Physics"},{title:"Settings"}]}),this.selectedEntityTab=this.tabs.pages[0],this.screenTab=this.tabs.pages[1],this.cameraTab=this.tabs.pages[2],this.clockTab=this.tabs.pages[3],this.timerTab=this.tabs.pages[4],this.physicsTab=this.tabs.pages[5],this.debugTab=this.tabs.pages[6],this._installPickerSystemIfNeeded(e.currentScene),e.debug.transform.showPosition=!0,e.debug.entity.showName=!0,this.selectedEntityFolder=this.selectedEntityTab.addFolder({title:"Selected"}),this._buildScreenTab(),this._buildCameraTab(),this._buildClockTab(),this._buildTimersTab(),this._buildPhysicsTab(),this._buildDebugSettingsTab(),setInterval((()=>{this.update(this)}),30),this.addListeners()}addListeners(){this.engine.canvas.addEventListener("click",(()=>{-1!==this.highlightedEntities[0]&&this.selectEntityById(this.highlightedEntities[0])}))}selectEntityById(t){const i=this.engine;this.selectedEntityId=t,this.selectedEntity=i.currentScene.world.entityManager.getById(t),this._buildEntityUI(this.selectedEntity);const n=this.selectedEntity.get(e.TransformComponent);this._buildTransformUI(n);const r=this.selectedEntity.get(e.MotionComponent);if(this._buildMotionUI(r),this.selectedEntity instanceof e.ParticleEmitter)this._buildParticleEmitterUI(this.selectedEntity);else{const t=this.selectedEntity.get(e.GraphicsComponent);this._buildGraphicsUI(t);const i=this.selectedEntity.get(e.ColliderComponent),n=this.selectedEntity.get(e.BodyComponent);this._buildColliderUI(i,n)}}update(e){const t=e.engine,i=t.input.pointers.primary.lastWorldPos;this.pointerPos.x=i.x,this.pointerPos.y=i.y,this.pointerPosInput.refresh();const n=[...this.pickerSystem.lastFrameEntityToPointers.keys(),...this.pickerSystem.currentFrameEntityToPointers.keys()];0===n.length&&(n.push(-1),n.push(this.selectedEntityId)),this.highlightedEntities=n,t.debug.filter.useFilter=!0,t.debug.filter.ids=n,this.currentResolution.width===t.screen.resolution.width&&this.currentResolution.height===t.screen.resolution.height&&this.currentViewport.width===t.screen.viewport.width&&this.currentViewport.height===t.screen.viewport.height||(this.resolutionText.dispose(),this.viewportText.dispose(),this.resolutionText=this.screenFolder.addBlade({view:"text",label:"resolution",value:`(${t.screen.resolution.width}x${t.screen.resolution.height})`,parse:e=>String(e),index:0}),this.viewportText=this.screenFolder.addBlade({view:"text",label:"viewport",value:`(${t.screen.viewport.width.toFixed(0)}x${t.screen.viewport.height.toFixed(0)})`,parse:e=>String(e),index:1})),this._buildTimersTab()}_installPickerSystemIfNeeded(e){this.pickerSystem=e.world.systemManager.get(r.PickerSystem),this.pickerSystem||(this.pickerSystem=new r.PickerSystem,e.world.systemManager.addSystem(this.pickerSystem))}_buildMain(){this.pane.addInput({debug:!1},"debug").on("change",(()=>{this.engine.toggleDebug()})),this.pane.addMonitor(this.engine.clock.fpsSampler,"fps",{view:"graph",label:"fps (0 - 120)",min:0,max:120});let e,t="",i=[];for(let e in this.engine.scenes)this.engine.currentScene===this.engine.scenes[e]&&(t=e),i.push({text:e,value:e});this.pane.addBlade({view:"list",label:"current scene",options:i,value:t}).on("change",(t=>{this.engine.goToScene(t.value),this._installPickerSystemIfNeeded(this.engine.currentScene),e.dispose(),e=this.pane.addBlade({view:"text",label:"number of entities",value:this.engine.currentScene.world.entityManager.entities.length,parse:e=>String(e),index:3})})),e=this.pane.addBlade({view:"text",label:"number of entities",value:this.engine.currentScene.world.entityManager.entities.length,parse:e=>String(e),index:3}),this.pointerPos={x:10,y:10},this.pointerPosInput=this.pane.addInput(this,"pointerPos",{label:"pointer pos (world)"}),this.pane.addInput(this,"selectedEntityId",{label:"Select By Id"}).on("change",(e=>this.selectEntityById(e.value)))}_buildEntityUI(t){var i,n;this.selectedEntityFolder&&(this.selectedEntityFolder.dispose(),this.selectedEntityFolder=this.selectedEntityTab.addFolder({title:"Selected"})),this.selectedEntityFolder.addBlade({view:"text",label:"id",value:t.id.toString(),parse:e=>String(e)}),this.selectedEntityFolder.addInput(this.selectedEntity,"name"),this.selectedEntityFolder.addBlade({view:"text",label:"tags",value:t.tags.join(",")||"none",parse:e=>String(e)}),t instanceof e.Actor&&t.color&&this.selectedEntityFolder.addInput(this.selectedEntity,"color").on("change",(i=>{t.color=new e.Color(i.value.r,i.value.g,i.value.b,i.value.a)})),this.selectedEntityFolder.addBlade({view:"text",label:"parent",value:t.parent?`(${null===(i=t.parent)||void 0===i?void 0:i.id}) ${null===(n=t.parent)||void 0===n?void 0:n.name}`:"none",parse:e=>String(e)}),this.selectedEntityFolder.addBlade({view:"list",label:"children",options:t.children.map((e=>({text:`(${e.id}) ${e.name}`,value:e.id}))),value:t.children.length?t.children[0].id:"none"}),this.selectedEntityFolder.addButton({title:"Kill Entity"}).on("click",(e=>{this.selectedEntity.kill(),this.selectedEntityFolder.dispose(),this.selectedEntityFolder=this.selectedEntityTab.addFolder({title:"Selected"})}))}_buildColliderUI(t,i){var n,r;if(t){const s=this.selectedEntityFolder.addFolder({title:"Collider & Body"});s.addBlade({view:"text",label:"type",value:null!==(r=null===(n=t.get())||void 0===n?void 0:n.constructor.name)&&void 0!==r?r:"none",parse:e=>String(e)}),i&&(s.addBlade({view:"list",label:"collisionType",options:[e.CollisionType.Active,e.CollisionType.Fixed,e.CollisionType.Passive,e.CollisionType.PreventCollision].map((e=>({text:e,value:e}))),value:i.collisionType}).on("change",(e=>{i.collisionType=e.value})),s.addBlade({view:"list",label:"collisionGroup",options:[e.CollisionGroup.All,...e.CollisionGroupManager.groups].map((e=>({text:e.name,value:e}))),value:i.group}).on("change",(e=>{i.group=e.value})))}}_buildParticleEmitterUI(e){const t=this.selectedEntityFolder.addFolder({title:"Particles"});t.addInput(e,"isEmitting"),t.addInput(e,"emitRate"),t.addInput(e,"fadeFlag"),t.addInput(e,"particleLife",{min:100,max:1e4,step:100}),t.addInput(e,"width"),t.addInput(e,"height"),t.addInput(e,"minVel"),t.addInput(e,"maxVel"),t.addInput(e,"minAngle",{min:0,max:2*Math.PI,step:.1}),t.addInput(e,"maxAngle",{min:0,max:2*Math.PI,step:.1}),t.addInput(e,"minSize"),t.addInput(e,"maxSize"),t.addInput(e,"beginColor"),t.addInput(e,"endColor"),t.addInput(e,"opacity",{min:0,max:1,step:.01}),t.addInput(e,"randomRotation"),t.addInput(e,"particleRotationalVelocity")}_buildGraphicsUI(e){var t;if(e){const i=this.selectedEntityFolder.addFolder({title:"Graphics"});i.addInput(e,"anchor"),i.addInput(e,"opacity",{min:0,max:1,step:.05}),i.addInput(e,"visible");const n=[],r=[],s=e.current.map((e=>e.graphic)),o=[];let a=0;for(let t in e.graphics)n.push({text:t,value:a++}),r.push(e.graphics[t]),o.push(e.graphics[t]);let l=0;for(let e of s)-1===o.indexOf(e)&&(n.push({text:"anonymous"+l++,value:a}),r.push(e));i.addBlade({view:"list",label:"graphics",options:n,value:r.indexOf(null===(t=e.current[0])||void 0===t?void 0:t.graphic)}).on("change",(t=>{e.use(r[t.value])}))}}_buildMotionUI(e){if(e){const t=this.selectedEntityFolder.addFolder({title:"Motion"});t.addInput(e,"vel"),t.addInput(e,"acc"),t.addInput(e,"angularVelocity",{step:.1}),t.addInput(e,"scaleFactor"),t.addInput(e,"inertia")}}_buildTransformUI(t){if(t){const i=this.selectedEntityFolder.addFolder({title:"Transform"});i.addBlade({view:"list",label:"coord plane",options:[e.CoordPlane.World,e.CoordPlane.Screen].map((e=>({text:e,value:e}))),value:t.coordPlane}).on("change",(e=>t.coordPlane=e.value));const n=i.addInput(t,"pos"),r=i.addInput(t,"rotation",{min:0,max:2*Math.PI}),s=i.addInput(t,"scale");i.addSeparator();const o=i.addInput(t,"globalPos",{label:"global pos"}),a=i.addInput(t,"globalRotation",{label:"global rot",min:0,max:2*Math.PI}),l=i.addInput(t,"globalScale",{label:"global pos"});o.on("change",(()=>n.refresh())),n.on("change",(()=>o.refresh())),a.on("change",(()=>r.refresh())),r.on("change",(()=>a.refresh())),l.on("change",(()=>s.refresh())),s.on("change",(()=>l.refresh())),i.addInput(t,"z",{label:"z-index"})}}_buildScreenTab(){this.screenFolder=this.screenTab.addFolder({title:"Screen"}),this.currentResolution=this.engine.screen.resolution,this.currentViewport=this.engine.screen.viewport,this.resolutionText=this.screenFolder.addBlade({view:"text",label:"resolution",value:`(${this.engine.screen.resolution.width}x${this.engine.screen.resolution.height})`,parse:e=>String(e),index:0}),this.viewportText=this.screenFolder.addBlade({view:"text",label:"viewport",value:`(${this.engine.screen.viewport.width.toFixed(0)}x${this.engine.screen.viewport.height.toFixed(0)})`,parse:e=>String(e),index:1}),this.screenFolder.addButton({title:"Fullscreen"}).on("click",(()=>{this.engine.screen.goFullScreen()})),this.screenFolder.addSeparator();const t=this.screenFolder.addBlade({view:"list",label:"Color Blindness Mode",options:[e.ColorBlindnessMode.Deuteranope,e.ColorBlindnessMode.Protanope,e.ColorBlindnessMode.Tritanope].map((e=>({text:e,value:e}))),value:e.ColorBlindnessMode.Deuteranope}),i={simulate:!1};this.screenFolder.addInput(i,"simulate"),this.screenFolder.addButton({title:"Apply"}).on("click",(()=>{i.simulate?this.engine.debug.colorBlindMode.simulate(t.value):this.engine.debug.colorBlindMode.correct(t.value)})),this.screenFolder.addButton({title:"Clear"}).on("click",(()=>{this.engine.debug.colorBlindMode.clear()}))}_buildCameraTab(){const e=this.cameraTab.addFolder({title:"Camera"});e.addInput(this.engine.currentScene.camera,"zoom",{min:.01,max:10,step:.1}),e.addInput(this.engine.currentScene.camera,"pos")}_buildClockTab(){const t=this.clockTab.addFolder({title:"Clock"});let i=this.engine.clock instanceof e.TestClock,n=16;const r=t.addButton({title:"step",disabled:!i,index:2}).on("click",(()=>this.engine.clock.step(n)));t.addBlade({view:"slider",label:"step (ms)",min:1,max:100,step:16,value:n}).on("change",(e=>n=e.value)),t.addButton({title:"Use Test Clock",index:0}).on("click",(()=>{this.engine.debug.useTestClock(),i=!0,r.disabled=!1})),t.addButton({title:"Use Standard Clock",index:1}).on("click",(()=>{this.engine.debug.useStandardClock(),i=!1,r.disabled=!0})),this.pane.addSeparator();const s=t.addButton({title:"Stop",disabled:!1}),o=t.addButton({title:"Start",disabled:!0});s.on("click",(()=>{this.engine.clock.stop(),o.disabled=!1,s.disabled=!0})),o.on("click",(()=>{this.engine.clock.start(),s.disabled=!1,o.disabled=!0}))}_buildTimersTab(){this.timerTab,this._timersFolder&&this._timersFolder.dispose(),this._timersFolder=this.timerTab.addFolder({title:"Timers"});for(let e of this.engine.currentScene.timers){let t=e.repeats&&-1===e.maxNumberOfRepeats?"repeats":e._numberOfTicks+1+" of "+(-1===e.maxNumberOfRepeats?1:e.maxNumberOfRepeats);e.isRunning||(t="stopped"),e.complete&&(t="complete"),this._timersFolder.addBlade({view:"text",label:`timer(${e.id})`,value:`${t} next(${e.timeToNextAction.toFixed(0)}ms)`,parse:e=>String(e)})}}_buildPhysicsTab(){const t=this.physicsTab,i={};for(let t in e.Physics)i[t]=e.Physics[t];t.addInput(i,"enabled").on("change",(t=>e.Physics.enabled=t.value)),t.addInput(i,"acc");const n=t.addInput(i,"collisionResolutionStrategy");t.addButton({title:"Use Arcade"}).on("click",(()=>{e.Physics.useArcadePhysics(),i.collisionResolutionStrategy=e.Physics.collisionResolutionStrategy,n.refresh()})),t.addButton({title:"Use Realistic"}).on("click",(()=>{e.Physics.useRealisticPhysics(),i.collisionResolutionStrategy=e.Physics.collisionResolutionStrategy,n.refresh()})),t.addInput(i,"bodiesCanSleepByDefault").on("change",(t=>e.Physics.bodiesCanSleepByDefault=t.value)),t.addInput(i,"warmStart").on("change",(t=>e.Physics.warmStart=t.value)),t.addInput(i,"sleepEpsilon",{min:.01,max:2,step:.05}).on("change",(t=>e.Physics.sleepEpsilon=t.value)),t.addInput(i,"wakeThreshold",{min:.01,max:2,step:.05}).on("change",(t=>e.Physics.wakeThreshold=t.value)),t.addInput(i,"positionIterations",{min:1,max:30,step:1}).on("change",(t=>e.Physics.positionIterations=t.value)),t.addInput(i,"velocityIterations",{min:1,max:30,step:1}).on("change",(t=>e.Physics.velocityIterations=t.value)),t.addInput(i,"checkForFastBodies").on("change",(t=>e.Physics.checkForFastBodies=t.value))}_buildDebugSettingsTab(){const e=this.debugTab;for(let t of["entity","transform","motion","body","collider","physics","graphics","camera"]){let i=e.addFolder({title:t});if(this.engine.debug[t])for(let e in this.engine.debug[t])if(e)if(e.toLocaleLowerCase().includes("color"))i.addInput(this.engine.debug[t],e);else{if(Array.isArray(this.engine.debug[t][e]))continue;i.addInput(this.engine.debug[t],e)}}}}})(),n})();var $a4c493de23d91c5d$var$ARR_EACH=Array.prototype.forEach,$a4c493de23d91c5d$var$ARR_SLICE=Array.prototype.slice,$a4c493de23d91c5d$var$Common={BREAK:{},extend:function(e){return this.each($a4c493de23d91c5d$var$ARR_SLICE.call(arguments,1),(function(t){(this.isObject(t)?Object.keys(t):[]).forEach(function(i){this.isUndefined(t[i])||(e[i]=t[i])}.bind(this))}),this),e},defaults:function(e){return this.each($a4c493de23d91c5d$var$ARR_SLICE.call(arguments,1),(function(t){(this.isObject(t)?Object.keys(t):[]).forEach(function(i){this.isUndefined(e[i])&&(e[i]=t[i])}.bind(this))}),this),e},compose:function(){var e=$a4c493de23d91c5d$var$ARR_SLICE.call(arguments);return function(){for(var t=$a4c493de23d91c5d$var$ARR_SLICE.call(arguments),i=e.length-1;i>=0;i--)t=[e[i].apply(this,t)];return t[0]}},each:function(e,t,i){if(e)if($a4c493de23d91c5d$var$ARR_EACH&&e.forEach&&e.forEach===$a4c493de23d91c5d$var$ARR_EACH)e.forEach(t,i);else if(e.length===e.length+0){var n,r=void 0;for(r=0,n=e.length;r<n;r++)if(r in e&&t.call(i,e[r],r)===this.BREAK)return}else for(var s in e)if(t.call(i,e[s],s)===this.BREAK)return},defer:function(e){setTimeout(e,0)},debounce:function(e,t,i){var n=void 0;return function(){var r=this,s=arguments;function o(){n=null,i||e.apply(r,s)}var a=i||!n;clearTimeout(n),n=setTimeout(o,t),a&&e.apply(r,s)}},toArray:function(e){return e.toArray?e.toArray():$a4c493de23d91c5d$var$ARR_SLICE.call(e)},isUndefined:function(e){return void 0===e},isNull:function(e){return null===e},isNaN:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){return isNaN(e)})),isArray:Array.isArray||function(e){return e.constructor===Array},isObject:function(e){return e===Object(e)},isNumber:function(e){return e===e+0},isString:function(e){return e===e+""},isBoolean:function(e){return!1===e||!0===e},isFunction:function(e){return e instanceof Function}},$a4c493de23d91c5d$var$INTERPRETATIONS=[{litmus:$a4c493de23d91c5d$var$Common.isString,conversions:{THREE_CHAR_HEX:{read:function(e){var t=e.match(/^#([A-F0-9])([A-F0-9])([A-F0-9])$/i);return null!==t&&{space:"HEX",hex:parseInt("0x"+t[1].toString()+t[1].toString()+t[2].toString()+t[2].toString()+t[3].toString()+t[3].toString(),0)}},write:$a4c493de23d91c5d$var$colorToString},SIX_CHAR_HEX:{read:function(e){var t=e.match(/^#([A-F0-9]{6})$/i);return null!==t&&{space:"HEX",hex:parseInt("0x"+t[1].toString(),0)}},write:$a4c493de23d91c5d$var$colorToString},CSS_RGB:{read:function(e){var t=e.match(/^rgb\(\s*(\S+)\s*,\s*(\S+)\s*,\s*(\S+)\s*\)/);return null!==t&&{space:"RGB",r:parseFloat(t[1]),g:parseFloat(t[2]),b:parseFloat(t[3])}},write:$a4c493de23d91c5d$var$colorToString},CSS_RGBA:{read:function(e){var t=e.match(/^rgba\(\s*(\S+)\s*,\s*(\S+)\s*,\s*(\S+)\s*,\s*(\S+)\s*\)/);return null!==t&&{space:"RGB",r:parseFloat(t[1]),g:parseFloat(t[2]),b:parseFloat(t[3]),a:parseFloat(t[4])}},write:$a4c493de23d91c5d$var$colorToString}}},{litmus:$a4c493de23d91c5d$var$Common.isNumber,conversions:{HEX:{read:function(e){return{space:"HEX",hex:e,conversionName:"HEX"}},write:function(e){return e.hex}}}},{litmus:$a4c493de23d91c5d$var$Common.isArray,conversions:{RGB_ARRAY:{read:function(e){return 3===e.length&&{space:"RGB",r:e[0],g:e[1],b:e[2]}},write:function(e){return[e.r,e.g,e.b]}},RGBA_ARRAY:{read:function(e){return 4===e.length&&{space:"RGB",r:e[0],g:e[1],b:e[2],a:e[3]}},write:function(e){return[e.r,e.g,e.b,e.a]}}}},{litmus:$a4c493de23d91c5d$var$Common.isObject,conversions:{RGBA_OBJ:{read:function(e){return!!($a4c493de23d91c5d$var$Common.isNumber(e.r)&&$a4c493de23d91c5d$var$Common.isNumber(e.g)&&$a4c493de23d91c5d$var$Common.isNumber(e.b)&&$a4c493de23d91c5d$var$Common.isNumber(e.a))&&{space:"RGB",r:e.r,g:e.g,b:e.b,a:e.a}},write:function(e){return{r:e.r,g:e.g,b:e.b,a:e.a}}},RGB_OBJ:{read:function(e){return!!($a4c493de23d91c5d$var$Common.isNumber(e.r)&&$a4c493de23d91c5d$var$Common.isNumber(e.g)&&$a4c493de23d91c5d$var$Common.isNumber(e.b))&&{space:"RGB",r:e.r,g:e.g,b:e.b}},write:function(e){return{r:e.r,g:e.g,b:e.b}}},HSVA_OBJ:{read:function(e){return!!($a4c493de23d91c5d$var$Common.isNumber(e.h)&&$a4c493de23d91c5d$var$Common.isNumber(e.s)&&$a4c493de23d91c5d$var$Common.isNumber(e.v)&&$a4c493de23d91c5d$var$Common.isNumber(e.a))&&{space:"HSV",h:e.h,s:e.s,v:e.v,a:e.a}},write:function(e){return{h:e.h,s:e.s,v:e.v,a:e.a}}},HSV_OBJ:{read:function(e){return!!($a4c493de23d91c5d$var$Common.isNumber(e.h)&&$a4c493de23d91c5d$var$Common.isNumber(e.s)&&$a4c493de23d91c5d$var$Common.isNumber(e.v))&&{space:"HSV",h:e.h,s:e.s,v:e.v}},write:function(e){return{h:e.h,s:e.s,v:e.v}}}}}],$a4c493de23d91c5d$var$result=void 0,$a4c493de23d91c5d$var$toReturn=void 0,$a4c493de23d91c5d$var$interpret=function(){$a4c493de23d91c5d$var$toReturn=!1;var e=arguments.length>1?$a4c493de23d91c5d$var$Common.toArray(arguments):arguments[0];return $a4c493de23d91c5d$var$Common.each($a4c493de23d91c5d$var$INTERPRETATIONS,(function(t){if(t.litmus(e))return $a4c493de23d91c5d$var$Common.each(t.conversions,(function(t,i){if($a4c493de23d91c5d$var$result=t.read(e),!1===$a4c493de23d91c5d$var$toReturn&&!1!==$a4c493de23d91c5d$var$result)return $a4c493de23d91c5d$var$toReturn=$a4c493de23d91c5d$var$result,$a4c493de23d91c5d$var$result.conversionName=i,$a4c493de23d91c5d$var$result.conversion=t,$a4c493de23d91c5d$var$Common.BREAK})),$a4c493de23d91c5d$var$Common.BREAK})),$a4c493de23d91c5d$var$toReturn},$a4c493de23d91c5d$var$tmpComponent=void 0,$a4c493de23d91c5d$var$ColorMath={hsv_to_rgb:function(e,t,i){var n=Math.floor(e/60)%6,r=e/60-Math.floor(e/60),s=i*(1-t),o=i*(1-r*t),a=i*(1-(1-r)*t),l=[[i,a,s],[o,i,s],[s,i,a],[s,o,i],[a,s,i],[i,s,o]][n];return{r:255*l[0],g:255*l[1],b:255*l[2]}},rgb_to_hsv:function(e,t,i){var n=Math.min(e,t,i),r=Math.max(e,t,i),s=r-n,o=void 0;return 0===r?{h:NaN,s:0,v:0}:(o=e===r?(t-i)/s:t===r?2+(i-e)/s:4+(e-t)/s,(o/=6)<0&&(o+=1),{h:360*o,s:s/r,v:r/255})},rgb_to_hex:function(e,t,i){var n=this.hex_with_component(0,2,e);return n=this.hex_with_component(n,1,t),n=this.hex_with_component(n,0,i)},component_from_hex:function(e,t){return e>>8*t&255},hex_with_component:function(e,t,i){return i<<($a4c493de23d91c5d$var$tmpComponent=8*t)|e&~(255<<$a4c493de23d91c5d$var$tmpComponent)}},$a4c493de23d91c5d$var$_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},$a4c493de23d91c5d$var$classCallCheck=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},$a4c493de23d91c5d$var$createClass=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),$a4c493de23d91c5d$var$get=function e(t,i,n){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,i);if(void 0===r){var s=Object.getPrototypeOf(t);return null===s?void 0:e(s,i,n)}if("value"in r)return r.value;var o=r.get;return void 0!==o?o.call(n):void 0},$a4c493de23d91c5d$var$inherits=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)},$a4c493de23d91c5d$var$possibleConstructorReturn=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t},$a4c493de23d91c5d$var$Color=function(){function e(){if($a4c493de23d91c5d$var$classCallCheck(this,e),this.__state=$a4c493de23d91c5d$var$interpret.apply(this,arguments),!1===this.__state)throw new Error("Failed to interpret color arguments");this.__state.a=this.__state.a||1}return $a4c493de23d91c5d$var$createClass(e,[{key:"toString",value:function(){return $a4c493de23d91c5d$var$colorToString(this)}},{key:"toHexString",value:function(){return $a4c493de23d91c5d$var$colorToString(this,!0)}},{key:"toOriginal",value:function(){return this.__state.conversion.write(this)}}]),e}();function $a4c493de23d91c5d$var$defineRGBComponent(e,t,i){Object.defineProperty(e,t,{get:function(){return"RGB"===this.__state.space||$a4c493de23d91c5d$var$Color.recalculateRGB(this,t,i),this.__state[t]},set:function(e){"RGB"!==this.__state.space&&($a4c493de23d91c5d$var$Color.recalculateRGB(this,t,i),this.__state.space="RGB"),this.__state[t]=e}})}function $a4c493de23d91c5d$var$defineHSVComponent(e,t){Object.defineProperty(e,t,{get:function(){return"HSV"===this.__state.space||$a4c493de23d91c5d$var$Color.recalculateHSV(this),this.__state[t]},set:function(e){"HSV"!==this.__state.space&&($a4c493de23d91c5d$var$Color.recalculateHSV(this),this.__state.space="HSV"),this.__state[t]=e}})}$a4c493de23d91c5d$var$Color.recalculateRGB=function(e,t,i){if("HEX"===e.__state.space)e.__state[t]=$a4c493de23d91c5d$var$ColorMath.component_from_hex(e.__state.hex,i);else{if("HSV"!==e.__state.space)throw new Error("Corrupted color state");$a4c493de23d91c5d$var$Common.extend(e.__state,$a4c493de23d91c5d$var$ColorMath.hsv_to_rgb(e.__state.h,e.__state.s,e.__state.v))}},$a4c493de23d91c5d$var$Color.recalculateHSV=function(e){var t=$a4c493de23d91c5d$var$ColorMath.rgb_to_hsv(e.r,e.g,e.b);$a4c493de23d91c5d$var$Common.extend(e.__state,{s:t.s,v:t.v}),$a4c493de23d91c5d$var$Common.isNaN(t.h)?$a4c493de23d91c5d$var$Common.isUndefined(e.__state.h)&&(e.__state.h=0):e.__state.h=t.h},$a4c493de23d91c5d$var$Color.COMPONENTS=["r","g","b","h","s","v","hex","a"],$a4c493de23d91c5d$var$defineRGBComponent($a4c493de23d91c5d$var$Color.prototype,"r",2),$a4c493de23d91c5d$var$defineRGBComponent($a4c493de23d91c5d$var$Color.prototype,"g",1),$a4c493de23d91c5d$var$defineRGBComponent($a4c493de23d91c5d$var$Color.prototype,"b",0),$a4c493de23d91c5d$var$defineHSVComponent($a4c493de23d91c5d$var$Color.prototype,"h"),$a4c493de23d91c5d$var$defineHSVComponent($a4c493de23d91c5d$var$Color.prototype,"s"),$a4c493de23d91c5d$var$defineHSVComponent($a4c493de23d91c5d$var$Color.prototype,"v"),Object.defineProperty($a4c493de23d91c5d$var$Color.prototype,"a",{get:function(){return this.__state.a},set:function(e){this.__state.a=e}}),Object.defineProperty($a4c493de23d91c5d$var$Color.prototype,"hex",{get:function(){return"HEX"!==this.__state.space&&(this.__state.hex=$a4c493de23d91c5d$var$ColorMath.rgb_to_hex(this.r,this.g,this.b),this.__state.space="HEX"),this.__state.hex},set:function(e){this.__state.space="HEX",this.__state.hex=e}});var $a4c493de23d91c5d$var$Controller=function(){function e(t,i){$a4c493de23d91c5d$var$classCallCheck(this,e),this.initialValue=t[i],this.domElement=document.createElement("div"),this.object=t,this.property=i,this.__onChange=void 0,this.__onFinishChange=void 0}return $a4c493de23d91c5d$var$createClass(e,[{key:"onChange",value:function(e){return this.__onChange=e,this}},{key:"onFinishChange",value:function(e){return this.__onFinishChange=e,this}},{key:"setValue",value:function(e){return this.object[this.property]=e,this.__onChange&&this.__onChange.call(this,e),this.updateDisplay(),this}},{key:"getValue",value:function(){return this.object[this.property]}},{key:"updateDisplay",value:function(){return this}},{key:"isModified",value:function(){return this.initialValue!==this.getValue()}}]),e}(),$a4c493de23d91c5d$var$EVENT_MAP={HTMLEvents:["change"],MouseEvents:["click","mousemove","mousedown","mouseup","mouseover"],KeyboardEvents:["keydown"]},$a4c493de23d91c5d$var$EVENT_MAP_INV={};$a4c493de23d91c5d$var$Common.each($a4c493de23d91c5d$var$EVENT_MAP,(function(e,t){$a4c493de23d91c5d$var$Common.each(e,(function(e){$a4c493de23d91c5d$var$EVENT_MAP_INV[e]=t}))}));var $a4c493de23d91c5d$var$CSS_VALUE_PIXELS=/(\d+(\.\d+)?)px/;function $a4c493de23d91c5d$var$cssValueToPixels(e){if("0"===e||$a4c493de23d91c5d$var$Common.isUndefined(e))return 0;var t=e.match($a4c493de23d91c5d$var$CSS_VALUE_PIXELS);return $a4c493de23d91c5d$var$Common.isNull(t)?0:parseFloat(t[1])}var $a4c493de23d91c5d$var$dom={makeSelectable:function(e,t){void 0!==e&&void 0!==e.style&&(e.onselectstart=t?function(){return!1}:function(){},e.style.MozUserSelect=t?"auto":"none",e.style.KhtmlUserSelect=t?"auto":"none",e.unselectable=t?"on":"off")},makeFullscreen:function(e,t,i){var n=i,r=t;$a4c493de23d91c5d$var$Common.isUndefined(r)&&(r=!0),$a4c493de23d91c5d$var$Common.isUndefined(n)&&(n=!0),e.style.position="absolute",r&&(e.style.left=0,e.style.right=0),n&&(e.style.top=0,e.style.bottom=0)},fakeEvent:function(e,t,i,n){var r=i||{},s=$a4c493de23d91c5d$var$EVENT_MAP_INV[t];if(!s)throw new Error("Event type "+t+" not supported.");var o=document.createEvent(s);switch(s){case"MouseEvents":var a=r.x||r.clientX||0,l=r.y||r.clientY||0;o.initMouseEvent(t,r.bubbles||!1,r.cancelable||!0,window,r.clickCount||1,0,0,a,l,!1,!1,!1,!1,0,null);break;case"KeyboardEvents":var c=o.initKeyboardEvent||o.initKeyEvent;$a4c493de23d91c5d$var$Common.defaults(r,{cancelable:!0,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,keyCode:void 0,charCode:void 0}),c(t,r.bubbles||!1,r.cancelable,window,r.ctrlKey,r.altKey,r.shiftKey,r.metaKey,r.keyCode,r.charCode);break;default:o.initEvent(t,r.bubbles||!1,r.cancelable||!0)}$a4c493de23d91c5d$var$Common.defaults(o,n),e.dispatchEvent(o)},bind:function(e,t,i,n){var r=n||!1;return e.addEventListener?e.addEventListener(t,i,r):e.attachEvent&&e.attachEvent("on"+t,i),$a4c493de23d91c5d$var$dom},unbind:function(e,t,i,n){var r=n||!1;return e.removeEventListener?e.removeEventListener(t,i,r):e.detachEvent&&e.detachEvent("on"+t,i),$a4c493de23d91c5d$var$dom},addClass:function(e,t){if(void 0===e.className)e.className=t;else if(e.className!==t){var i=e.className.split(/ +/);-1===i.indexOf(t)&&(i.push(t),e.className=i.join(" ").replace(/^\s+/,"").replace(/\s+$/,""))}return $a4c493de23d91c5d$var$dom},removeClass:function(e,t){if(t)if(e.className===t)e.removeAttribute("class");else{var i=e.className.split(/ +/),n=i.indexOf(t);-1!==n&&(i.splice(n,1),e.className=i.join(" "))}else e.className=void 0;return $a4c493de23d91c5d$var$dom},hasClass:function(e,t){return new RegExp("(?:^|\\s+)"+t+"(?:\\s+|$)").test(e.className)||!1},getWidth:function(e){var t=getComputedStyle(e);return $a4c493de23d91c5d$var$cssValueToPixels(t["border-left-width"])+$a4c493de23d91c5d$var$cssValueToPixels(t["border-right-width"])+$a4c493de23d91c5d$var$cssValueToPixels(t["padding-left"])+$a4c493de23d91c5d$var$cssValueToPixels(t["padding-right"])+$a4c493de23d91c5d$var$cssValueToPixels(t.width)},getHeight:function(e){var t=getComputedStyle(e);return $a4c493de23d91c5d$var$cssValueToPixels(t["border-top-width"])+$a4c493de23d91c5d$var$cssValueToPixels(t["border-bottom-width"])+$a4c493de23d91c5d$var$cssValueToPixels(t["padding-top"])+$a4c493de23d91c5d$var$cssValueToPixels(t["padding-bottom"])+$a4c493de23d91c5d$var$cssValueToPixels(t.height)},getOffset:function(e){var t=e,i={left:0,top:0};if(t.offsetParent)do{i.left+=t.offsetLeft,i.top+=t.offsetTop,t=t.offsetParent}while(t);return i},isActive:function(e){return e===document.activeElement&&(e.type||e.href)}},$a4c493de23d91c5d$var$BooleanController=function(e){function t(e,i){$a4c493de23d91c5d$var$classCallCheck(this,t);var n=$a4c493de23d91c5d$var$possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,i)),r=n;return n.__prev=n.getValue(),n.__checkbox=document.createElement("input"),n.__checkbox.setAttribute("type","checkbox"),$a4c493de23d91c5d$var$dom.bind(n.__checkbox,"change",(function(){r.setValue(!r.__prev)}),!1),n.domElement.appendChild(n.__checkbox),n.updateDisplay(),n}return $a4c493de23d91c5d$var$inherits(t,$a4c493de23d91c5d$var$Controller),$a4c493de23d91c5d$var$createClass(t,[{key:"setValue",value:function(e){var i=$a4c493de23d91c5d$var$get(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"setValue",this).call(this,e);return this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),this.__prev=this.getValue(),i}},{key:"updateDisplay",value:function(){return!0===this.getValue()?(this.__checkbox.setAttribute("checked","checked"),this.__checkbox.checked=!0,this.__prev=!0):(this.__checkbox.checked=!1,this.__prev=!1),$a4c493de23d91c5d$var$get(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updateDisplay",this).call(this)}}]),t}(),$a4c493de23d91c5d$var$OptionController=function(e){function t(e,i,n){$a4c493de23d91c5d$var$classCallCheck(this,t);var r=$a4c493de23d91c5d$var$possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,i)),s=n,o=r;if(r.__select=document.createElement("select"),$a4c493de23d91c5d$var$Common.isArray(s)){var a={};$a4c493de23d91c5d$var$Common.each(s,(function(e){a[e]=e})),s=a}return $a4c493de23d91c5d$var$Common.each(s,(function(e,t){var i=document.createElement("option");i.innerHTML=t,i.setAttribute("value",e),o.__select.appendChild(i)})),r.updateDisplay(),$a4c493de23d91c5d$var$dom.bind(r.__select,"change",(function(){var e=this.options[this.selectedIndex].value;o.setValue(e)})),r.domElement.appendChild(r.__select),r}return $a4c493de23d91c5d$var$inherits(t,$a4c493de23d91c5d$var$Controller),$a4c493de23d91c5d$var$createClass(t,[{key:"setValue",value:function(e){var i=$a4c493de23d91c5d$var$get(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"setValue",this).call(this,e);return this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),i}},{key:"updateDisplay",value:function(){return $a4c493de23d91c5d$var$dom.isActive(this.__select)?this:(this.__select.value=this.getValue(),$a4c493de23d91c5d$var$get(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updateDisplay",this).call(this))}}]),t}(),$a4c493de23d91c5d$var$StringController=function(e){function t(e,i){$a4c493de23d91c5d$var$classCallCheck(this,t);var n=$a4c493de23d91c5d$var$possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,i)),r=n;function s(){r.setValue(r.__input.value)}return n.__input=document.createElement("input"),n.__input.setAttribute("type","text"),$a4c493de23d91c5d$var$dom.bind(n.__input,"keyup",s),$a4c493de23d91c5d$var$dom.bind(n.__input,"change",s),$a4c493de23d91c5d$var$dom.bind(n.__input,"blur",(function(){r.__onFinishChange&&r.__onFinishChange.call(r,r.getValue())})),$a4c493de23d91c5d$var$dom.bind(n.__input,"keydown",(function(e){13===e.keyCode&&this.blur()})),n.updateDisplay(),n.domElement.appendChild(n.__input),n}return $a4c493de23d91c5d$var$inherits(t,$a4c493de23d91c5d$var$Controller),$a4c493de23d91c5d$var$createClass(t,[{key:"updateDisplay",value:function(){return $a4c493de23d91c5d$var$dom.isActive(this.__input)||(this.__input.value=this.getValue()),$a4c493de23d91c5d$var$get(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updateDisplay",this).call(this)}}]),t}();function $a4c493de23d91c5d$var$numDecimals(e){var t=e.toString();return t.indexOf(".")>-1?t.length-t.indexOf(".")-1:0}var $a4c493de23d91c5d$var$NumberController=function(e){function t(e,i,n){$a4c493de23d91c5d$var$classCallCheck(this,t);var r=$a4c493de23d91c5d$var$possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,i)),s=n||{};return r.__min=s.min,r.__max=s.max,r.__step=s.step,$a4c493de23d91c5d$var$Common.isUndefined(r.__step)?0===r.initialValue?r.__impliedStep=1:r.__impliedStep=Math.pow(10,Math.floor(Math.log(Math.abs(r.initialValue))/Math.LN10))/10:r.__impliedStep=r.__step,r.__precision=$a4c493de23d91c5d$var$numDecimals(r.__impliedStep),r}return $a4c493de23d91c5d$var$inherits(t,$a4c493de23d91c5d$var$Controller),$a4c493de23d91c5d$var$createClass(t,[{key:"setValue",value:function(e){var i=e;return void 0!==this.__min&&i<this.__min?i=this.__min:void 0!==this.__max&&i>this.__max&&(i=this.__max),void 0!==this.__step&&i%this.__step!=0&&(i=Math.round(i/this.__step)*this.__step),$a4c493de23d91c5d$var$get(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"setValue",this).call(this,i)}},{key:"min",value:function(e){return this.__min=e,this}},{key:"max",value:function(e){return this.__max=e,this}},{key:"step",value:function(e){return this.__step=e,this.__impliedStep=e,this.__precision=$a4c493de23d91c5d$var$numDecimals(e),this}}]),t}();function $a4c493de23d91c5d$var$roundToDecimal(e,t){var i=Math.pow(10,t);return Math.round(e*i)/i}var $a4c493de23d91c5d$var$NumberControllerBox=function(e){function t(e,i,n){$a4c493de23d91c5d$var$classCallCheck(this,t);var r=$a4c493de23d91c5d$var$possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,i,n));r.__truncationSuspended=!1;var s=r,o=void 0;function a(){s.__onFinishChange&&s.__onFinishChange.call(s,s.getValue())}function l(e){var t=o-e.clientY;s.setValue(s.getValue()+t*s.__impliedStep),o=e.clientY}function c(){$a4c493de23d91c5d$var$dom.unbind(window,"mousemove",l),$a4c493de23d91c5d$var$dom.unbind(window,"mouseup",c),a()}return r.__input=document.createElement("input"),r.__input.setAttribute("type","text"),$a4c493de23d91c5d$var$dom.bind(r.__input,"change",(function(){var e=parseFloat(s.__input.value);$a4c493de23d91c5d$var$Common.isNaN(e)||s.setValue(e)})),$a4c493de23d91c5d$var$dom.bind(r.__input,"blur",(function(){a()})),$a4c493de23d91c5d$var$dom.bind(r.__input,"mousedown",(function(e){$a4c493de23d91c5d$var$dom.bind(window,"mousemove",l),$a4c493de23d91c5d$var$dom.bind(window,"mouseup",c),o=e.clientY})),$a4c493de23d91c5d$var$dom.bind(r.__input,"keydown",(function(e){13===e.keyCode&&(s.__truncationSuspended=!0,this.blur(),s.__truncationSuspended=!1,a())})),r.updateDisplay(),r.domElement.appendChild(r.__input),r}return $a4c493de23d91c5d$var$inherits(t,$a4c493de23d91c5d$var$NumberController),$a4c493de23d91c5d$var$createClass(t,[{key:"updateDisplay",value:function(){return this.__input.value=this.__truncationSuspended?this.getValue():$a4c493de23d91c5d$var$roundToDecimal(this.getValue(),this.__precision),$a4c493de23d91c5d$var$get(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updateDisplay",this).call(this)}}]),t}();function $a4c493de23d91c5d$var$map(e,t,i,n,r){return n+(e-t)/(i-t)*(r-n)}var $a4c493de23d91c5d$var$NumberControllerSlider=function(e){function t(e,i,n,r,s){$a4c493de23d91c5d$var$classCallCheck(this,t);var o=$a4c493de23d91c5d$var$possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,i,{min:n,max:r,step:s})),a=o;function l(e){e.preventDefault();var t=a.__background.getBoundingClientRect();return a.setValue($a4c493de23d91c5d$var$map(e.clientX,t.left,t.right,a.__min,a.__max)),!1}function c(){$a4c493de23d91c5d$var$dom.unbind(window,"mousemove",l),$a4c493de23d91c5d$var$dom.unbind(window,"mouseup",c),a.__onFinishChange&&a.__onFinishChange.call(a,a.getValue())}function d(e){var t=e.touches[0].clientX,i=a.__background.getBoundingClientRect();a.setValue($a4c493de23d91c5d$var$map(t,i.left,i.right,a.__min,a.__max))}function h(){$a4c493de23d91c5d$var$dom.unbind(window,"touchmove",d),$a4c493de23d91c5d$var$dom.unbind(window,"touchend",h),a.__onFinishChange&&a.__onFinishChange.call(a,a.getValue())}return o.__background=document.createElement("div"),o.__foreground=document.createElement("div"),$a4c493de23d91c5d$var$dom.bind(o.__background,"mousedown",(function(e){document.activeElement.blur(),$a4c493de23d91c5d$var$dom.bind(window,"mousemove",l),$a4c493de23d91c5d$var$dom.bind(window,"mouseup",c),l(e)})),$a4c493de23d91c5d$var$dom.bind(o.__background,"touchstart",(function(e){if(1!==e.touches.length)return;$a4c493de23d91c5d$var$dom.bind(window,"touchmove",d),$a4c493de23d91c5d$var$dom.bind(window,"touchend",h),d(e)})),$a4c493de23d91c5d$var$dom.addClass(o.__background,"slider"),$a4c493de23d91c5d$var$dom.addClass(o.__foreground,"slider-fg"),o.updateDisplay(),o.__background.appendChild(o.__foreground),o.domElement.appendChild(o.__background),o}return $a4c493de23d91c5d$var$inherits(t,$a4c493de23d91c5d$var$NumberController),$a4c493de23d91c5d$var$createClass(t,[{key:"updateDisplay",value:function(){var e=(this.getValue()-this.__min)/(this.__max-this.__min);return this.__foreground.style.width=100*e+"%",$a4c493de23d91c5d$var$get(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updateDisplay",this).call(this)}}]),t}(),$a4c493de23d91c5d$var$FunctionController=function(e){function t(e,i,n){$a4c493de23d91c5d$var$classCallCheck(this,t);var r=$a4c493de23d91c5d$var$possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,i)),s=r;return r.__button=document.createElement("div"),r.__button.innerHTML=void 0===n?"Fire":n,$a4c493de23d91c5d$var$dom.bind(r.__button,"click",(function(e){return e.preventDefault(),s.fire(),!1})),$a4c493de23d91c5d$var$dom.addClass(r.__button,"button"),r.domElement.appendChild(r.__button),r}return $a4c493de23d91c5d$var$inherits(t,$a4c493de23d91c5d$var$Controller),$a4c493de23d91c5d$var$createClass(t,[{key:"fire",value:function(){this.__onChange&&this.__onChange.call(this),this.getValue().call(this.object),this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue())}}]),t}(),$a4c493de23d91c5d$var$ColorController=function(e){function t(e,i){$a4c493de23d91c5d$var$classCallCheck(this,t);var n=$a4c493de23d91c5d$var$possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,i));n.__color=new $a4c493de23d91c5d$var$Color(n.getValue()),n.__temp=new $a4c493de23d91c5d$var$Color(0);var r=n;n.domElement=document.createElement("div"),$a4c493de23d91c5d$var$dom.makeSelectable(n.domElement,!1),n.__selector=document.createElement("div"),n.__selector.className="selector",n.__saturation_field=document.createElement("div"),n.__saturation_field.className="saturation-field",n.__field_knob=document.createElement("div"),n.__field_knob.className="field-knob",n.__field_knob_border="2px solid ",n.__hue_knob=document.createElement("div"),n.__hue_knob.className="hue-knob",n.__hue_field=document.createElement("div"),n.__hue_field.className="hue-field",n.__input=document.createElement("input"),n.__input.type="text",n.__input_textShadow="0 1px 1px ",$a4c493de23d91c5d$var$dom.bind(n.__input,"keydown",(function(e){13===e.keyCode&&d.call(this)})),$a4c493de23d91c5d$var$dom.bind(n.__input,"blur",d),$a4c493de23d91c5d$var$dom.bind(n.__selector,"mousedown",(function(){$a4c493de23d91c5d$var$dom.addClass(this,"drag").bind(window,"mouseup",(function(){$a4c493de23d91c5d$var$dom.removeClass(r.__selector,"drag")}))})),$a4c493de23d91c5d$var$dom.bind(n.__selector,"touchstart",(function(){$a4c493de23d91c5d$var$dom.addClass(this,"drag").bind(window,"touchend",(function(){$a4c493de23d91c5d$var$dom.removeClass(r.__selector,"drag")}))}));var s=document.createElement("div");function o(e){u(e),$a4c493de23d91c5d$var$dom.bind(window,"mousemove",u),$a4c493de23d91c5d$var$dom.bind(window,"touchmove",u),$a4c493de23d91c5d$var$dom.bind(window,"mouseup",l),$a4c493de23d91c5d$var$dom.bind(window,"touchend",l)}function a(e){p(e),$a4c493de23d91c5d$var$dom.bind(window,"mousemove",p),$a4c493de23d91c5d$var$dom.bind(window,"touchmove",p),$a4c493de23d91c5d$var$dom.bind(window,"mouseup",c),$a4c493de23d91c5d$var$dom.bind(window,"touchend",c)}function l(){$a4c493de23d91c5d$var$dom.unbind(window,"mousemove",u),$a4c493de23d91c5d$var$dom.unbind(window,"touchmove",u),$a4c493de23d91c5d$var$dom.unbind(window,"mouseup",l),$a4c493de23d91c5d$var$dom.unbind(window,"touchend",l),h()}function c(){$a4c493de23d91c5d$var$dom.unbind(window,"mousemove",p),$a4c493de23d91c5d$var$dom.unbind(window,"touchmove",p),$a4c493de23d91c5d$var$dom.unbind(window,"mouseup",c),$a4c493de23d91c5d$var$dom.unbind(window,"touchend",c),h()}function d(){var e=$a4c493de23d91c5d$var$interpret(this.value);!1!==e?(r.__color.__state=e,r.setValue(r.__color.toOriginal())):this.value=r.__color.toString()}function h(){r.__onFinishChange&&r.__onFinishChange.call(r,r.__color.toOriginal())}function u(e){-1===e.type.indexOf("touch")&&e.preventDefault();var t=r.__saturation_field.getBoundingClientRect(),i=e.touches&&e.touches[0]||e,n=i.clientX,s=i.clientY,o=(n-t.left)/(t.right-t.left),a=1-(s-t.top)/(t.bottom-t.top);return a>1?a=1:a<0&&(a=0),o>1?o=1:o<0&&(o=0),r.__color.v=a,r.__color.s=o,r.setValue(r.__color.toOriginal()),!1}function p(e){-1===e.type.indexOf("touch")&&e.preventDefault();var t=r.__hue_field.getBoundingClientRect(),i=1-((e.touches&&e.touches[0]||e).clientY-t.top)/(t.bottom-t.top);return i>1?i=1:i<0&&(i=0),r.__color.h=360*i,r.setValue(r.__color.toOriginal()),!1}return $a4c493de23d91c5d$var$Common.extend(n.__selector.style,{width:"122px",height:"102px",padding:"3px",backgroundColor:"#222",boxShadow:"0px 1px 3px rgba(0,0,0,0.3)"}),$a4c493de23d91c5d$var$Common.extend(n.__field_knob.style,{position:"absolute",width:"12px",height:"12px",border:n.__field_knob_border+(n.__color.v<.5?"#fff":"#000"),boxShadow:"0px 1px 3px rgba(0,0,0,0.5)",borderRadius:"12px",zIndex:1}),$a4c493de23d91c5d$var$Common.extend(n.__hue_knob.style,{position:"absolute",width:"15px",height:"2px",borderRight:"4px solid #fff",zIndex:1}),$a4c493de23d91c5d$var$Common.extend(n.__saturation_field.style,{width:"100px",height:"100px",border:"1px solid #555",marginRight:"3px",display:"inline-block",cursor:"pointer"}),$a4c493de23d91c5d$var$Common.extend(s.style,{width:"100%",height:"100%",background:"none"}),$a4c493de23d91c5d$var$linearGradient(s,"top","rgba(0,0,0,0)","#000"),$a4c493de23d91c5d$var$Common.extend(n.__hue_field.style,{width:"15px",height:"100px",border:"1px solid #555",cursor:"ns-resize",position:"absolute",top:"3px",right:"3px"}),$a4c493de23d91c5d$var$hueGradient(n.__hue_field),$a4c493de23d91c5d$var$Common.extend(n.__input.style,{outline:"none",textAlign:"center",color:"#fff",border:0,fontWeight:"bold",textShadow:n.__input_textShadow+"rgba(0,0,0,0.7)"}),$a4c493de23d91c5d$var$dom.bind(n.__saturation_field,"mousedown",o),$a4c493de23d91c5d$var$dom.bind(n.__saturation_field,"touchstart",o),$a4c493de23d91c5d$var$dom.bind(n.__field_knob,"mousedown",o),$a4c493de23d91c5d$var$dom.bind(n.__field_knob,"touchstart",o),$a4c493de23d91c5d$var$dom.bind(n.__hue_field,"mousedown",a),$a4c493de23d91c5d$var$dom.bind(n.__hue_field,"touchstart",a),n.__saturation_field.appendChild(s),n.__selector.appendChild(n.__field_knob),n.__selector.appendChild(n.__saturation_field),n.__selector.appendChild(n.__hue_field),n.__hue_field.appendChild(n.__hue_knob),n.domElement.appendChild(n.__input),n.domElement.appendChild(n.__selector),n.updateDisplay(),n}return $a4c493de23d91c5d$var$inherits(t,$a4c493de23d91c5d$var$Controller),$a4c493de23d91c5d$var$createClass(t,[{key:"updateDisplay",value:function(){var e=$a4c493de23d91c5d$var$interpret(this.getValue());if(!1!==e){var t=!1;$a4c493de23d91c5d$var$Common.each($a4c493de23d91c5d$var$Color.COMPONENTS,(function(i){if(!$a4c493de23d91c5d$var$Common.isUndefined(e[i])&&!$a4c493de23d91c5d$var$Common.isUndefined(this.__color.__state[i])&&e[i]!==this.__color.__state[i])return t=!0,{}}),this),t&&$a4c493de23d91c5d$var$Common.extend(this.__color.__state,e)}$a4c493de23d91c5d$var$Common.extend(this.__temp.__state,this.__color.__state),this.__temp.a=1;var i=this.__color.v<.5||this.__color.s>.5?255:0,n=255-i;$a4c493de23d91c5d$var$Common.extend(this.__field_knob.style,{marginLeft:100*this.__color.s-7+"px",marginTop:100*(1-this.__color.v)-7+"px",backgroundColor:this.__temp.toHexString(),border:this.__field_knob_border+"rgb("+i+","+i+","+i+")"}),this.__hue_knob.style.marginTop=100*(1-this.__color.h/360)+"px",this.__temp.s=1,this.__temp.v=1,$a4c493de23d91c5d$var$linearGradient(this.__saturation_field,"left","#fff",this.__temp.toHexString()),this.__input.value=this.__color.toString(),$a4c493de23d91c5d$var$Common.extend(this.__input.style,{backgroundColor:this.__color.toHexString(),color:"rgb("+i+","+i+","+i+")",textShadow:this.__input_textShadow+"rgba("+n+","+n+","+n+",.7)"})}}]),t}(),$a4c493de23d91c5d$var$vendors=["-moz-","-o-","-webkit-","-ms-",""];function $a4c493de23d91c5d$var$linearGradient(e,t,i,n){e.style.background="",$a4c493de23d91c5d$var$Common.each($a4c493de23d91c5d$var$vendors,(function(r){e.style.cssText+="background: "+r+"linear-gradient("+t+", "+i+" 0%, "+n+" 100%); "}))}function $a4c493de23d91c5d$var$hueGradient(e){e.style.background="",e.style.cssText+="background: -moz-linear-gradient(top,  #ff0000 0%, #ff00ff 17%, #0000ff 34%, #00ffff 50%, #00ff00 67%, #ffff00 84%, #ff0000 100%);",e.style.cssText+="background: -webkit-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",e.style.cssText+="background: -o-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",e.style.cssText+="background: -ms-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",e.style.cssText+="background: linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);"}var $a4c493de23d91c5d$var$css={load:function(e,t){var i=t||document,n=i.createElement("link");n.type="text/css",n.rel="stylesheet",n.href=e,i.getElementsByTagName("head")[0].appendChild(n)},inject:function(e,t){var i=t||document,n=document.createElement("style");n.type="text/css",n.innerHTML=e;var r=i.getElementsByTagName("head")[0];try{r.appendChild(n)}catch(e){}}},$a4c493de23d91c5d$var$saveDialogContents='<div id="dg-save" class="dg dialogue">\n\n  Here\'s the new load parameter for your <code>GUI</code>\'s constructor:\n\n  <textarea id="dg-new-constructor"></textarea>\n\n  <div id="dg-save-locally">\n\n    <input id="dg-local-storage" type="checkbox"/> Automatically save\n    values to <code>localStorage</code> on exit.\n\n    <div id="dg-local-explain">The values saved to <code>localStorage</code> will\n      override those passed to <code>dat.GUI</code>\'s constructor. This makes it\n      easier to work incrementally, but <code>localStorage</code> is fragile,\n      and your friends may not see the same values you do.\n\n    </div>\n\n  </div>\n\n</div>',$a4c493de23d91c5d$var$ControllerFactory=function(e,t){var i=e[t];return $a4c493de23d91c5d$var$Common.isArray(arguments[2])||$a4c493de23d91c5d$var$Common.isObject(arguments[2])?new $a4c493de23d91c5d$var$OptionController(e,t,arguments[2]):$a4c493de23d91c5d$var$Common.isNumber(i)?$a4c493de23d91c5d$var$Common.isNumber(arguments[2])&&$a4c493de23d91c5d$var$Common.isNumber(arguments[3])?$a4c493de23d91c5d$var$Common.isNumber(arguments[4])?new $a4c493de23d91c5d$var$NumberControllerSlider(e,t,arguments[2],arguments[3],arguments[4]):new $a4c493de23d91c5d$var$NumberControllerSlider(e,t,arguments[2],arguments[3]):$a4c493de23d91c5d$var$Common.isNumber(arguments[4])?new $a4c493de23d91c5d$var$NumberControllerBox(e,t,{min:arguments[2],max:arguments[3],step:arguments[4]}):new $a4c493de23d91c5d$var$NumberControllerBox(e,t,{min:arguments[2],max:arguments[3]}):$a4c493de23d91c5d$var$Common.isString(i)?new $a4c493de23d91c5d$var$StringController(e,t):$a4c493de23d91c5d$var$Common.isFunction(i)?new $a4c493de23d91c5d$var$FunctionController(e,t,""):$a4c493de23d91c5d$var$Common.isBoolean(i)?new $a4c493de23d91c5d$var$BooleanController(e,t):null};function $a4c493de23d91c5d$var$requestAnimationFrame(e){setTimeout(e,1e3/60)}var $a4c493de23d91c5d$var$requestAnimationFrame$1=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||$a4c493de23d91c5d$var$requestAnimationFrame,$a4c493de23d91c5d$var$CenteredDiv=function(){function e(){$a4c493de23d91c5d$var$classCallCheck(this,e),this.backgroundElement=document.createElement("div"),$a4c493de23d91c5d$var$Common.extend(this.backgroundElement.style,{backgroundColor:"rgba(0,0,0,0.8)",top:0,left:0,display:"none",zIndex:"1000",opacity:0,WebkitTransition:"opacity 0.2s linear",transition:"opacity 0.2s linear"}),$a4c493de23d91c5d$var$dom.makeFullscreen(this.backgroundElement),this.backgroundElement.style.position="fixed",this.domElement=document.createElement("div"),$a4c493de23d91c5d$var$Common.extend(this.domElement.style,{position:"fixed",display:"none",zIndex:"1001",opacity:0,WebkitTransition:"-webkit-transform 0.2s ease-out, opacity 0.2s linear",transition:"transform 0.2s ease-out, opacity 0.2s linear"}),document.body.appendChild(this.backgroundElement),document.body.appendChild(this.domElement);var t=this;$a4c493de23d91c5d$var$dom.bind(this.backgroundElement,"click",(function(){t.hide()}))}return $a4c493de23d91c5d$var$createClass(e,[{key:"show",value:function(){var e=this;this.backgroundElement.style.display="block",this.domElement.style.display="block",this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)",this.layout(),$a4c493de23d91c5d$var$Common.defer((function(){e.backgroundElement.style.opacity=1,e.domElement.style.opacity=1,e.domElement.style.webkitTransform="scale(1)"}))}},{key:"hide",value:function(){var e=this,t=function t(){e.domElement.style.display="none",e.backgroundElement.style.display="none",$a4c493de23d91c5d$var$dom.unbind(e.domElement,"webkitTransitionEnd",t),$a4c493de23d91c5d$var$dom.unbind(e.domElement,"transitionend",t),$a4c493de23d91c5d$var$dom.unbind(e.domElement,"oTransitionEnd",t)};$a4c493de23d91c5d$var$dom.bind(this.domElement,"webkitTransitionEnd",t),$a4c493de23d91c5d$var$dom.bind(this.domElement,"transitionend",t),$a4c493de23d91c5d$var$dom.bind(this.domElement,"oTransitionEnd",t),this.backgroundElement.style.opacity=0,this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)"}},{key:"layout",value:function(){this.domElement.style.left=window.innerWidth/2-$a4c493de23d91c5d$var$dom.getWidth(this.domElement)/2+"px",this.domElement.style.top=window.innerHeight/2-$a4c493de23d91c5d$var$dom.getHeight(this.domElement)/2+"px"}}]),e}(),$a4c493de23d91c5d$var$styleSheet=$a4c493de23d91c5d$var$___$insertStyle(".dg ul{list-style:none;margin:0;padding:0;width:100%;clear:both}.dg.ac{position:fixed;top:0;left:0;right:0;height:0;z-index:0}.dg:not(.ac) .main{overflow:hidden}.dg.main{-webkit-transition:opacity .1s linear;-o-transition:opacity .1s linear;-moz-transition:opacity .1s linear;transition:opacity .1s linear}.dg.main.taller-than-window{overflow-y:auto}.dg.main.taller-than-window .close-button{opacity:1;margin-top:-1px;border-top:1px solid #2c2c2c}.dg.main ul.closed .close-button{opacity:1 !important}.dg.main:hover .close-button,.dg.main .close-button.drag{opacity:1}.dg.main .close-button{-webkit-transition:opacity .1s linear;-o-transition:opacity .1s linear;-moz-transition:opacity .1s linear;transition:opacity .1s linear;border:0;line-height:19px;height:20px;cursor:pointer;text-align:center;background-color:#000}.dg.main .close-button.close-top{position:relative}.dg.main .close-button.close-bottom{position:absolute}.dg.main .close-button:hover{background-color:#111}.dg.a{float:right;margin-right:15px;overflow-y:visible}.dg.a.has-save>ul.close-top{margin-top:0}.dg.a.has-save>ul.close-bottom{margin-top:27px}.dg.a.has-save>ul.closed{margin-top:0}.dg.a .save-row{top:0;z-index:1002}.dg.a .save-row.close-top{position:relative}.dg.a .save-row.close-bottom{position:fixed}.dg li{-webkit-transition:height .1s ease-out;-o-transition:height .1s ease-out;-moz-transition:height .1s ease-out;transition:height .1s ease-out;-webkit-transition:overflow .1s linear;-o-transition:overflow .1s linear;-moz-transition:overflow .1s linear;transition:overflow .1s linear}.dg li:not(.folder){cursor:auto;height:27px;line-height:27px;padding:0 4px 0 5px}.dg li.folder{padding:0;border-left:4px solid rgba(0,0,0,0)}.dg li.title{cursor:pointer;margin-left:-4px}.dg .closed li:not(.title),.dg .closed ul li,.dg .closed ul li>*{height:0;overflow:hidden;border:0}.dg .cr{clear:both;padding-left:3px;height:27px;overflow:hidden}.dg .property-name{cursor:default;float:left;clear:left;width:40%;overflow:hidden;text-overflow:ellipsis}.dg .cr.function .property-name{width:100%}.dg .c{float:left;width:60%;position:relative}.dg .c input[type=text]{border:0;margin-top:4px;padding:3px;width:100%;float:right}.dg .has-slider input[type=text]{width:30%;margin-left:0}.dg .slider{float:left;width:66%;margin-left:-5px;margin-right:0;height:19px;margin-top:4px}.dg .slider-fg{height:100%}.dg .c input[type=checkbox]{margin-top:7px}.dg .c select{margin-top:5px}.dg .cr.function,.dg .cr.function .property-name,.dg .cr.function *,.dg .cr.boolean,.dg .cr.boolean *{cursor:pointer}.dg .cr.color{overflow:visible}.dg .selector{display:none;position:absolute;margin-left:-9px;margin-top:23px;z-index:10}.dg .c:hover .selector,.dg .selector.drag{display:block}.dg li.save-row{padding:0}.dg li.save-row .button{display:inline-block;padding:0px 6px}.dg.dialogue{background-color:#222;width:460px;padding:15px;font-size:13px;line-height:15px}#dg-new-constructor{padding:10px;color:#222;font-family:Monaco, monospace;font-size:10px;border:0;resize:none;box-shadow:inset 1px 1px 1px #888;word-wrap:break-word;margin:12px 0;display:block;width:440px;overflow-y:scroll;height:100px;position:relative}#dg-local-explain{display:none;font-size:11px;line-height:17px;border-radius:3px;background-color:#333;padding:8px;margin-top:10px}#dg-local-explain code{font-size:10px}#dat-gui-save-locally{display:none}.dg{color:#eee;font:11px 'Lucida Grande', sans-serif;text-shadow:0 -1px 0 #111}.dg.main::-webkit-scrollbar{width:5px;background:#1a1a1a}.dg.main::-webkit-scrollbar-corner{height:0;display:none}.dg.main::-webkit-scrollbar-thumb{border-radius:5px;background:#676767}.dg li:not(.folder){background:#1a1a1a;border-bottom:1px solid #2c2c2c}.dg li.save-row{line-height:25px;background:#dad5cb;border:0}.dg li.save-row select{margin-left:5px;width:108px}.dg li.save-row .button{margin-left:5px;margin-top:1px;border-radius:2px;font-size:9px;line-height:7px;padding:4px 4px 5px 4px;background:#c5bdad;color:#fff;text-shadow:0 1px 0 #b0a58f;box-shadow:0 -1px 0 #b0a58f;cursor:pointer}.dg li.save-row .button.gears{background:#c5bdad url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAANCAYAAAB/9ZQ7AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAQJJREFUeNpiYKAU/P//PwGIC/ApCABiBSAW+I8AClAcgKxQ4T9hoMAEUrxx2QSGN6+egDX+/vWT4e7N82AMYoPAx/evwWoYoSYbACX2s7KxCxzcsezDh3evFoDEBYTEEqycggWAzA9AuUSQQgeYPa9fPv6/YWm/Acx5IPb7ty/fw+QZblw67vDs8R0YHyQhgObx+yAJkBqmG5dPPDh1aPOGR/eugW0G4vlIoTIfyFcA+QekhhHJhPdQxbiAIguMBTQZrPD7108M6roWYDFQiIAAv6Aow/1bFwXgis+f2LUAynwoIaNcz8XNx3Dl7MEJUDGQpx9gtQ8YCueB+D26OECAAQDadt7e46D42QAAAABJRU5ErkJggg==) 2px 1px no-repeat;height:7px;width:8px}.dg li.save-row .button:hover{background-color:#bab19e;box-shadow:0 -1px 0 #b0a58f}.dg li.folder{border-bottom:0}.dg li.title{padding-left:16px;background:#000 url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlI+hKgFxoCgAOw==) 6px 10px no-repeat;cursor:pointer;border-bottom:1px solid rgba(255,255,255,0.2)}.dg .closed li.title{background-image:url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlGIWqMCbWAEAOw==)}.dg .cr.boolean{border-left:3px solid #806787}.dg .cr.color{border-left:3px solid}.dg .cr.function{border-left:3px solid #e61d5f}.dg .cr.number{border-left:3px solid #2FA1D6}.dg .cr.number input[type=text]{color:#2FA1D6}.dg .cr.string{border-left:3px solid #1ed36f}.dg .cr.string input[type=text]{color:#1ed36f}.dg .cr.function:hover,.dg .cr.boolean:hover{background:#111}.dg .c input[type=text]{background:#303030;outline:none}.dg .c input[type=text]:hover{background:#3c3c3c}.dg .c input[type=text]:focus{background:#494949;color:#fff}.dg .c .slider{background:#303030;cursor:ew-resize}.dg .c .slider-fg{background:#2FA1D6;max-width:100%}.dg .c .slider:hover{background:#3c3c3c}.dg .c .slider:hover .slider-fg{background:#44abda}\n");$a4c493de23d91c5d$var$css.inject($a4c493de23d91c5d$var$styleSheet);var $a4c493de23d91c5d$var$CSS_NAMESPACE="dg",$a4c493de23d91c5d$var$HIDE_KEY_CODE=72,$a4c493de23d91c5d$var$CLOSE_BUTTON_HEIGHT=20,$a4c493de23d91c5d$var$DEFAULT_DEFAULT_PRESET_NAME="Default",$a4c493de23d91c5d$var$SUPPORTS_LOCAL_STORAGE=function(){try{return!!window.localStorage}catch(e){return!1}}(),$a4c493de23d91c5d$var$SAVE_DIALOGUE=void 0,$a4c493de23d91c5d$var$autoPlaceVirgin=!0,$a4c493de23d91c5d$var$autoPlaceContainer=void 0,$a4c493de23d91c5d$var$hide=!1,$a4c493de23d91c5d$var$hideableGuis=[],$a4c493de23d91c5d$var$GUI=function e(t){var i=this,n=t||{};this.domElement=document.createElement("div"),this.__ul=document.createElement("ul"),this.domElement.appendChild(this.__ul),$a4c493de23d91c5d$var$dom.addClass(this.domElement,$a4c493de23d91c5d$var$CSS_NAMESPACE),this.__folders={},this.__controllers=[],this.__rememberedObjects=[],this.__rememberedObjectIndecesToControllers=[],this.__listening=[],n=$a4c493de23d91c5d$var$Common.defaults(n,{closeOnTop:!1,autoPlace:!0,width:e.DEFAULT_WIDTH}),n=$a4c493de23d91c5d$var$Common.defaults(n,{resizable:n.autoPlace,hideable:n.autoPlace}),$a4c493de23d91c5d$var$Common.isUndefined(n.load)?n.load={preset:$a4c493de23d91c5d$var$DEFAULT_DEFAULT_PRESET_NAME}:n.preset&&(n.load.preset=n.preset),$a4c493de23d91c5d$var$Common.isUndefined(n.parent)&&n.hideable&&$a4c493de23d91c5d$var$hideableGuis.push(this),n.resizable=$a4c493de23d91c5d$var$Common.isUndefined(n.parent)&&n.resizable,n.autoPlace&&$a4c493de23d91c5d$var$Common.isUndefined(n.scrollable)&&(n.scrollable=!0);var r,s=$a4c493de23d91c5d$var$SUPPORTS_LOCAL_STORAGE&&"true"===localStorage.getItem($a4c493de23d91c5d$var$getLocalStorageHash(this,"isLocal")),o=void 0,a=void 0;if(Object.defineProperties(this,{parent:{get:function(){return n.parent}},scrollable:{get:function(){return n.scrollable}},autoPlace:{get:function(){return n.autoPlace}},closeOnTop:{get:function(){return n.closeOnTop}},preset:{get:function(){return i.parent?i.getRoot().preset:n.load.preset},set:function(e){i.parent?i.getRoot().preset=e:n.load.preset=e,$a4c493de23d91c5d$var$setPresetSelectIndex(this),i.revert()}},width:{get:function(){return n.width},set:function(e){n.width=e,$a4c493de23d91c5d$var$setWidth(i,e)}},name:{get:function(){return n.name},set:function(e){n.name=e,a&&(a.innerHTML=n.name)}},closed:{get:function(){return n.closed},set:function(t){n.closed=t,n.closed?$a4c493de23d91c5d$var$dom.addClass(i.__ul,e.CLASS_CLOSED):$a4c493de23d91c5d$var$dom.removeClass(i.__ul,e.CLASS_CLOSED),this.onResize(),i.__closeButton&&(i.__closeButton.innerHTML=t?e.TEXT_OPEN:e.TEXT_CLOSED)}},load:{get:function(){return n.load}},useLocalStorage:{get:function(){return s},set:function(e){$a4c493de23d91c5d$var$SUPPORTS_LOCAL_STORAGE&&(s=e,e?$a4c493de23d91c5d$var$dom.bind(window,"unload",o):$a4c493de23d91c5d$var$dom.unbind(window,"unload",o),localStorage.setItem($a4c493de23d91c5d$var$getLocalStorageHash(i,"isLocal"),e))}}}),$a4c493de23d91c5d$var$Common.isUndefined(n.parent)){if(this.closed=n.closed||!1,$a4c493de23d91c5d$var$dom.addClass(this.domElement,e.CLASS_MAIN),$a4c493de23d91c5d$var$dom.makeSelectable(this.domElement,!1),$a4c493de23d91c5d$var$SUPPORTS_LOCAL_STORAGE&&s){i.useLocalStorage=!0;var l=localStorage.getItem($a4c493de23d91c5d$var$getLocalStorageHash(this,"gui"));l&&(n.load=JSON.parse(l))}this.__closeButton=document.createElement("div"),this.__closeButton.innerHTML=e.TEXT_CLOSED,$a4c493de23d91c5d$var$dom.addClass(this.__closeButton,e.CLASS_CLOSE_BUTTON),n.closeOnTop?($a4c493de23d91c5d$var$dom.addClass(this.__closeButton,e.CLASS_CLOSE_TOP),this.domElement.insertBefore(this.__closeButton,this.domElement.childNodes[0])):($a4c493de23d91c5d$var$dom.addClass(this.__closeButton,e.CLASS_CLOSE_BOTTOM),this.domElement.appendChild(this.__closeButton)),$a4c493de23d91c5d$var$dom.bind(this.__closeButton,"click",(function(){i.closed=!i.closed}))}else{void 0===n.closed&&(n.closed=!0);var c=document.createTextNode(n.name);$a4c493de23d91c5d$var$dom.addClass(c,"controller-name"),a=$a4c493de23d91c5d$var$addRow(i,c);$a4c493de23d91c5d$var$dom.addClass(this.__ul,e.CLASS_CLOSED),$a4c493de23d91c5d$var$dom.addClass(a,"title"),$a4c493de23d91c5d$var$dom.bind(a,"click",(function(e){return e.preventDefault(),i.closed=!i.closed,!1})),n.closed||(this.closed=!1)}n.autoPlace&&($a4c493de23d91c5d$var$Common.isUndefined(n.parent)&&($a4c493de23d91c5d$var$autoPlaceVirgin&&($a4c493de23d91c5d$var$autoPlaceContainer=document.createElement("div"),$a4c493de23d91c5d$var$dom.addClass($a4c493de23d91c5d$var$autoPlaceContainer,$a4c493de23d91c5d$var$CSS_NAMESPACE),$a4c493de23d91c5d$var$dom.addClass($a4c493de23d91c5d$var$autoPlaceContainer,e.CLASS_AUTO_PLACE_CONTAINER),document.body.appendChild($a4c493de23d91c5d$var$autoPlaceContainer),$a4c493de23d91c5d$var$autoPlaceVirgin=!1),$a4c493de23d91c5d$var$autoPlaceContainer.appendChild(this.domElement),$a4c493de23d91c5d$var$dom.addClass(this.domElement,e.CLASS_AUTO_PLACE)),this.parent||$a4c493de23d91c5d$var$setWidth(i,n.width)),this.__resizeHandler=function(){i.onResizeDebounced()},$a4c493de23d91c5d$var$dom.bind(window,"resize",this.__resizeHandler),$a4c493de23d91c5d$var$dom.bind(this.__ul,"webkitTransitionEnd",this.__resizeHandler),$a4c493de23d91c5d$var$dom.bind(this.__ul,"transitionend",this.__resizeHandler),$a4c493de23d91c5d$var$dom.bind(this.__ul,"oTransitionEnd",this.__resizeHandler),this.onResize(),n.resizable&&$a4c493de23d91c5d$var$addResizeHandle(this),o=function(){$a4c493de23d91c5d$var$SUPPORTS_LOCAL_STORAGE&&"true"===localStorage.getItem($a4c493de23d91c5d$var$getLocalStorageHash(i,"isLocal"))&&localStorage.setItem($a4c493de23d91c5d$var$getLocalStorageHash(i,"gui"),JSON.stringify(i.getSaveObject()))},this.saveToLocalStorageIfPossible=o,n.parent||((r=i.getRoot()).width+=1,$a4c493de23d91c5d$var$Common.defer((function(){r.width-=1})))};function $a4c493de23d91c5d$var$addRow(e,t,i){var n=document.createElement("li");return t&&n.appendChild(t),i?e.__ul.insertBefore(n,i):e.__ul.appendChild(n),e.onResize(),n}function $a4c493de23d91c5d$var$removeListeners(e){$a4c493de23d91c5d$var$dom.unbind(window,"resize",e.__resizeHandler),e.saveToLocalStorageIfPossible&&$a4c493de23d91c5d$var$dom.unbind(window,"unload",e.saveToLocalStorageIfPossible)}function $a4c493de23d91c5d$var$markPresetModified(e,t){var i=e.__preset_select[e.__preset_select.selectedIndex];i.innerHTML=t?i.value+"*":i.value}function $a4c493de23d91c5d$var$augmentController(e,t,i){if(i.__li=t,i.__gui=e,$a4c493de23d91c5d$var$Common.extend(i,{options:function(t){if(arguments.length>1){var n=i.__li.nextElementSibling;return i.remove(),$a4c493de23d91c5d$var$_add(e,i.object,i.property,{before:n,factoryArgs:[$a4c493de23d91c5d$var$Common.toArray(arguments)]})}if($a4c493de23d91c5d$var$Common.isArray(t)||$a4c493de23d91c5d$var$Common.isObject(t)){var r=i.__li.nextElementSibling;return i.remove(),$a4c493de23d91c5d$var$_add(e,i.object,i.property,{before:r,factoryArgs:[t]})}},name:function(e){return i.__li.firstElementChild.firstElementChild.innerHTML=e,i},listen:function(){return i.__gui.listen(i),i},remove:function(){return i.__gui.remove(i),i}}),i instanceof $a4c493de23d91c5d$var$NumberControllerSlider){var n=new $a4c493de23d91c5d$var$NumberControllerBox(i.object,i.property,{min:i.__min,max:i.__max,step:i.__step});$a4c493de23d91c5d$var$Common.each(["updateDisplay","onChange","onFinishChange","step","min","max"],(function(e){var t=i[e],r=n[e];i[e]=n[e]=function(){var e=Array.prototype.slice.call(arguments);return r.apply(n,e),t.apply(i,e)}})),$a4c493de23d91c5d$var$dom.addClass(t,"has-slider"),i.domElement.insertBefore(n.domElement,i.domElement.firstElementChild)}else if(i instanceof $a4c493de23d91c5d$var$NumberControllerBox){var r=function(t){if($a4c493de23d91c5d$var$Common.isNumber(i.__min)&&$a4c493de23d91c5d$var$Common.isNumber(i.__max)){var n=i.__li.firstElementChild.firstElementChild.innerHTML,r=i.__gui.__listening.indexOf(i)>-1;i.remove();var s=$a4c493de23d91c5d$var$_add(e,i.object,i.property,{before:i.__li.nextElementSibling,factoryArgs:[i.__min,i.__max,i.__step]});return s.name(n),r&&s.listen(),s}return t};i.min=$a4c493de23d91c5d$var$Common.compose(r,i.min),i.max=$a4c493de23d91c5d$var$Common.compose(r,i.max)}else i instanceof $a4c493de23d91c5d$var$BooleanController?($a4c493de23d91c5d$var$dom.bind(t,"click",(function(){$a4c493de23d91c5d$var$dom.fakeEvent(i.__checkbox,"click")})),$a4c493de23d91c5d$var$dom.bind(i.__checkbox,"click",(function(e){e.stopPropagation()}))):i instanceof $a4c493de23d91c5d$var$FunctionController?($a4c493de23d91c5d$var$dom.bind(t,"click",(function(){$a4c493de23d91c5d$var$dom.fakeEvent(i.__button,"click")})),$a4c493de23d91c5d$var$dom.bind(t,"mouseover",(function(){$a4c493de23d91c5d$var$dom.addClass(i.__button,"hover")})),$a4c493de23d91c5d$var$dom.bind(t,"mouseout",(function(){$a4c493de23d91c5d$var$dom.removeClass(i.__button,"hover")}))):i instanceof $a4c493de23d91c5d$var$ColorController&&($a4c493de23d91c5d$var$dom.addClass(t,"color"),i.updateDisplay=$a4c493de23d91c5d$var$Common.compose((function(e){return t.style.borderLeftColor=i.__color.toString(),e}),i.updateDisplay),i.updateDisplay());i.setValue=$a4c493de23d91c5d$var$Common.compose((function(t){return e.getRoot().__preset_select&&i.isModified()&&$a4c493de23d91c5d$var$markPresetModified(e.getRoot(),!0),t}),i.setValue)}function $a4c493de23d91c5d$var$recallSavedValue(e,t){var i=e.getRoot(),n=i.__rememberedObjects.indexOf(t.object);if(-1!==n){var r=i.__rememberedObjectIndecesToControllers[n];if(void 0===r&&(r={},i.__rememberedObjectIndecesToControllers[n]=r),r[t.property]=t,i.load&&i.load.remembered){var s=i.load.remembered,o=void 0;if(s[e.preset])o=s[e.preset];else{if(!s[$a4c493de23d91c5d$var$DEFAULT_DEFAULT_PRESET_NAME])return;o=s[$a4c493de23d91c5d$var$DEFAULT_DEFAULT_PRESET_NAME]}if(o[n]&&void 0!==o[n][t.property]){var a=o[n][t.property];t.initialValue=a,t.setValue(a)}}}}function $a4c493de23d91c5d$var$_add(e,t,i,n){if(void 0===t[i])throw new Error('Object "'+t+'" has no property "'+i+'"');var r=void 0;if(n.color)r=new $a4c493de23d91c5d$var$ColorController(t,i);else{var s=[t,i].concat(n.factoryArgs);r=$a4c493de23d91c5d$var$ControllerFactory.apply(e,s)}n.before instanceof $a4c493de23d91c5d$var$Controller&&(n.before=n.before.__li),$a4c493de23d91c5d$var$recallSavedValue(e,r),$a4c493de23d91c5d$var$dom.addClass(r.domElement,"c");var o=document.createElement("span");$a4c493de23d91c5d$var$dom.addClass(o,"property-name"),o.innerHTML=r.property;var a=document.createElement("div");a.appendChild(o),a.appendChild(r.domElement);var l=$a4c493de23d91c5d$var$addRow(e,a,n.before);return $a4c493de23d91c5d$var$dom.addClass(l,$a4c493de23d91c5d$var$GUI.CLASS_CONTROLLER_ROW),r instanceof $a4c493de23d91c5d$var$ColorController?$a4c493de23d91c5d$var$dom.addClass(l,"color"):$a4c493de23d91c5d$var$dom.addClass(l,$a4c493de23d91c5d$var$_typeof(r.getValue())),$a4c493de23d91c5d$var$augmentController(e,l,r),e.__controllers.push(r),r}function $a4c493de23d91c5d$var$getLocalStorageHash(e,t){return document.location.href+"."+t}function $a4c493de23d91c5d$var$addPresetOption(e,t,i){var n=document.createElement("option");n.innerHTML=t,n.value=t,e.__preset_select.appendChild(n),i&&(e.__preset_select.selectedIndex=e.__preset_select.length-1)}function $a4c493de23d91c5d$var$showHideExplain(e,t){t.style.display=e.useLocalStorage?"block":"none"}function $a4c493de23d91c5d$var$addSaveMenu(e){var t=e.__save_row=document.createElement("li");$a4c493de23d91c5d$var$dom.addClass(e.domElement,"has-save"),e.__ul.insertBefore(t,e.__ul.firstChild),$a4c493de23d91c5d$var$dom.addClass(t,"save-row");var i=document.createElement("span");i.innerHTML="&nbsp;",$a4c493de23d91c5d$var$dom.addClass(i,"button gears");var n=document.createElement("span");n.innerHTML="Save",$a4c493de23d91c5d$var$dom.addClass(n,"button"),$a4c493de23d91c5d$var$dom.addClass(n,"save");var r=document.createElement("span");r.innerHTML="New",$a4c493de23d91c5d$var$dom.addClass(r,"button"),$a4c493de23d91c5d$var$dom.addClass(r,"save-as");var s=document.createElement("span");s.innerHTML="Revert",$a4c493de23d91c5d$var$dom.addClass(s,"button"),$a4c493de23d91c5d$var$dom.addClass(s,"revert");var o=e.__preset_select=document.createElement("select");if(e.load&&e.load.remembered?$a4c493de23d91c5d$var$Common.each(e.load.remembered,(function(t,i){$a4c493de23d91c5d$var$addPresetOption(e,i,i===e.preset)})):$a4c493de23d91c5d$var$addPresetOption(e,$a4c493de23d91c5d$var$DEFAULT_DEFAULT_PRESET_NAME,!1),$a4c493de23d91c5d$var$dom.bind(o,"change",(function(){for(var t=0;t<e.__preset_select.length;t++)e.__preset_select[t].innerHTML=e.__preset_select[t].value;e.preset=this.value})),t.appendChild(o),t.appendChild(i),t.appendChild(n),t.appendChild(r),t.appendChild(s),$a4c493de23d91c5d$var$SUPPORTS_LOCAL_STORAGE){var a=document.getElementById("dg-local-explain"),l=document.getElementById("dg-local-storage");document.getElementById("dg-save-locally").style.display="block","true"===localStorage.getItem($a4c493de23d91c5d$var$getLocalStorageHash(e,"isLocal"))&&l.setAttribute("checked","checked"),$a4c493de23d91c5d$var$showHideExplain(e,a),$a4c493de23d91c5d$var$dom.bind(l,"change",(function(){e.useLocalStorage=!e.useLocalStorage,$a4c493de23d91c5d$var$showHideExplain(e,a)}))}var c=document.getElementById("dg-new-constructor");$a4c493de23d91c5d$var$dom.bind(c,"keydown",(function(e){!e.metaKey||67!==e.which&&67!==e.keyCode||$a4c493de23d91c5d$var$SAVE_DIALOGUE.hide()})),$a4c493de23d91c5d$var$dom.bind(i,"click",(function(){c.innerHTML=JSON.stringify(e.getSaveObject(),void 0,2),$a4c493de23d91c5d$var$SAVE_DIALOGUE.show(),c.focus(),c.select()})),$a4c493de23d91c5d$var$dom.bind(n,"click",(function(){e.save()})),$a4c493de23d91c5d$var$dom.bind(r,"click",(function(){var t=prompt("Enter a new preset name.");t&&e.saveAs(t)})),$a4c493de23d91c5d$var$dom.bind(s,"click",(function(){e.revert()}))}function $a4c493de23d91c5d$var$addResizeHandle(e){var t=void 0;function i(i){return i.preventDefault(),e.width+=t-i.clientX,e.onResize(),t=i.clientX,!1}function n(){$a4c493de23d91c5d$var$dom.removeClass(e.__closeButton,$a4c493de23d91c5d$var$GUI.CLASS_DRAG),$a4c493de23d91c5d$var$dom.unbind(window,"mousemove",i),$a4c493de23d91c5d$var$dom.unbind(window,"mouseup",n)}function r(r){return r.preventDefault(),t=r.clientX,$a4c493de23d91c5d$var$dom.addClass(e.__closeButton,$a4c493de23d91c5d$var$GUI.CLASS_DRAG),$a4c493de23d91c5d$var$dom.bind(window,"mousemove",i),$a4c493de23d91c5d$var$dom.bind(window,"mouseup",n),!1}e.__resize_handle=document.createElement("div"),$a4c493de23d91c5d$var$Common.extend(e.__resize_handle.style,{width:"6px",marginLeft:"-3px",height:"200px",cursor:"ew-resize",position:"absolute"}),$a4c493de23d91c5d$var$dom.bind(e.__resize_handle,"mousedown",r),$a4c493de23d91c5d$var$dom.bind(e.__closeButton,"mousedown",r),e.domElement.insertBefore(e.__resize_handle,e.domElement.firstElementChild)}function $a4c493de23d91c5d$var$setWidth(e,t){e.domElement.style.width=t+"px",e.__save_row&&e.autoPlace&&(e.__save_row.style.width=t+"px"),e.__closeButton&&(e.__closeButton.style.width=t+"px")}function $a4c493de23d91c5d$var$getCurrentPreset(e,t){var i={};return $a4c493de23d91c5d$var$Common.each(e.__rememberedObjects,(function(n,r){var s={},o=e.__rememberedObjectIndecesToControllers[r];$a4c493de23d91c5d$var$Common.each(o,(function(e,i){s[i]=t?e.initialValue:e.getValue()})),i[r]=s})),i}function $a4c493de23d91c5d$var$setPresetSelectIndex(e){for(var t=0;t<e.__preset_select.length;t++)e.__preset_select[t].value===e.preset&&(e.__preset_select.selectedIndex=t)}function $a4c493de23d91c5d$var$updateDisplays(e){0!==e.length&&$a4c493de23d91c5d$var$requestAnimationFrame$1.call(window,(function(){$a4c493de23d91c5d$var$updateDisplays(e)})),$a4c493de23d91c5d$var$Common.each(e,(function(e){e.updateDisplay()}))}$a4c493de23d91c5d$var$GUI.toggleHide=function(){$a4c493de23d91c5d$var$hide=!$a4c493de23d91c5d$var$hide,$a4c493de23d91c5d$var$Common.each($a4c493de23d91c5d$var$hideableGuis,(function(e){e.domElement.style.display=$a4c493de23d91c5d$var$hide?"none":""}))},$a4c493de23d91c5d$var$GUI.CLASS_AUTO_PLACE="a",$a4c493de23d91c5d$var$GUI.CLASS_AUTO_PLACE_CONTAINER="ac",$a4c493de23d91c5d$var$GUI.CLASS_MAIN="main",$a4c493de23d91c5d$var$GUI.CLASS_CONTROLLER_ROW="cr",$a4c493de23d91c5d$var$GUI.CLASS_TOO_TALL="taller-than-window",$a4c493de23d91c5d$var$GUI.CLASS_CLOSED="closed",$a4c493de23d91c5d$var$GUI.CLASS_CLOSE_BUTTON="close-button",$a4c493de23d91c5d$var$GUI.CLASS_CLOSE_TOP="close-top",$a4c493de23d91c5d$var$GUI.CLASS_CLOSE_BOTTOM="close-bottom",$a4c493de23d91c5d$var$GUI.CLASS_DRAG="drag",$a4c493de23d91c5d$var$GUI.DEFAULT_WIDTH=245,$a4c493de23d91c5d$var$GUI.TEXT_CLOSED="Close Controls",$a4c493de23d91c5d$var$GUI.TEXT_OPEN="Open Controls",$a4c493de23d91c5d$var$GUI._keydownHandler=function(e){"text"===document.activeElement.type||e.which!==$a4c493de23d91c5d$var$HIDE_KEY_CODE&&e.keyCode!==$a4c493de23d91c5d$var$HIDE_KEY_CODE||$a4c493de23d91c5d$var$GUI.toggleHide()},$a4c493de23d91c5d$var$dom.bind(window,"keydown",$a4c493de23d91c5d$var$GUI._keydownHandler,!1),$a4c493de23d91c5d$var$Common.extend($a4c493de23d91c5d$var$GUI.prototype,{add:function(e,t){return $a4c493de23d91c5d$var$_add(this,e,t,{factoryArgs:Array.prototype.slice.call(arguments,2)})},addColor:function(e,t){return $a4c493de23d91c5d$var$_add(this,e,t,{color:!0})},remove:function(e){this.__ul.removeChild(e.__li),this.__controllers.splice(this.__controllers.indexOf(e),1);var t=this;$a4c493de23d91c5d$var$Common.defer((function(){t.onResize()}))},destroy:function(){if(this.parent)throw new Error("Only the root GUI should be removed with .destroy(). For subfolders, use gui.removeFolder(folder) instead.");this.autoPlace&&$a4c493de23d91c5d$var$autoPlaceContainer.removeChild(this.domElement);var e=this;$a4c493de23d91c5d$var$Common.each(this.__folders,(function(t){e.removeFolder(t)})),$a4c493de23d91c5d$var$dom.unbind(window,"keydown",$a4c493de23d91c5d$var$GUI._keydownHandler,!1),$a4c493de23d91c5d$var$removeListeners(this)},addFolder:function(e){if(void 0!==this.__folders[e])throw new Error('You already have a folder in this GUI by the name "'+e+'"');var t={name:e,parent:this};t.autoPlace=this.autoPlace,this.load&&this.load.folders&&this.load.folders[e]&&(t.closed=this.load.folders[e].closed,t.load=this.load.folders[e]);var i=new $a4c493de23d91c5d$var$GUI(t);this.__folders[e]=i;var n=$a4c493de23d91c5d$var$addRow(this,i.domElement);return $a4c493de23d91c5d$var$dom.addClass(n,"folder"),i},removeFolder:function(e){this.__ul.removeChild(e.domElement.parentElement),delete this.__folders[e.name],this.load&&this.load.folders&&this.load.folders[e.name]&&delete this.load.folders[e.name],$a4c493de23d91c5d$var$removeListeners(e);var t=this;$a4c493de23d91c5d$var$Common.each(e.__folders,(function(t){e.removeFolder(t)})),$a4c493de23d91c5d$var$Common.defer((function(){t.onResize()}))},open:function(){this.closed=!1},close:function(){this.closed=!0},hide:function(){this.domElement.style.display="none"},show:function(){this.domElement.style.display=""},onResize:function(){var e=this.getRoot();if(e.scrollable){var t=$a4c493de23d91c5d$var$dom.getOffset(e.__ul).top,i=0;$a4c493de23d91c5d$var$Common.each(e.__ul.childNodes,(function(t){e.autoPlace&&t===e.__save_row||(i+=$a4c493de23d91c5d$var$dom.getHeight(t))})),window.innerHeight-t-$a4c493de23d91c5d$var$CLOSE_BUTTON_HEIGHT<i?($a4c493de23d91c5d$var$dom.addClass(e.domElement,$a4c493de23d91c5d$var$GUI.CLASS_TOO_TALL),e.__ul.style.height=window.innerHeight-t-$a4c493de23d91c5d$var$CLOSE_BUTTON_HEIGHT+"px"):($a4c493de23d91c5d$var$dom.removeClass(e.domElement,$a4c493de23d91c5d$var$GUI.CLASS_TOO_TALL),e.__ul.style.height="auto")}e.__resize_handle&&$a4c493de23d91c5d$var$Common.defer((function(){e.__resize_handle.style.height=e.__ul.offsetHeight+"px"})),e.__closeButton&&(e.__closeButton.style.width=e.width+"px")},onResizeDebounced:$a4c493de23d91c5d$var$Common.debounce((function(){this.onResize()}),50),remember:function(){if($a4c493de23d91c5d$var$Common.isUndefined($a4c493de23d91c5d$var$SAVE_DIALOGUE)&&(($a4c493de23d91c5d$var$SAVE_DIALOGUE=new $a4c493de23d91c5d$var$CenteredDiv).domElement.innerHTML=$a4c493de23d91c5d$var$saveDialogContents),this.parent)throw new Error("You can only call remember on a top level GUI.");var e=this;$a4c493de23d91c5d$var$Common.each(Array.prototype.slice.call(arguments),(function(t){0===e.__rememberedObjects.length&&$a4c493de23d91c5d$var$addSaveMenu(e),-1===e.__rememberedObjects.indexOf(t)&&e.__rememberedObjects.push(t)})),this.autoPlace&&$a4c493de23d91c5d$var$setWidth(this,this.width)},getRoot:function(){for(var e=this;e.parent;)e=e.parent;return e},getSaveObject:function(){var e=this.load;return e.closed=this.closed,this.__rememberedObjects.length>0&&(e.preset=this.preset,e.remembered||(e.remembered={}),e.remembered[this.preset]=$a4c493de23d91c5d$var$getCurrentPreset(this)),e.folders={},$a4c493de23d91c5d$var$Common.each(this.__folders,(function(t,i){e.folders[i]=t.getSaveObject()})),e},save:function(){this.load.remembered||(this.load.remembered={}),this.load.remembered[this.preset]=$a4c493de23d91c5d$var$getCurrentPreset(this),$a4c493de23d91c5d$var$markPresetModified(this,!1),this.saveToLocalStorageIfPossible()},saveAs:function(e){this.load.remembered||(this.load.remembered={},this.load.remembered[$a4c493de23d91c5d$var$DEFAULT_DEFAULT_PRESET_NAME]=$a4c493de23d91c5d$var$getCurrentPreset(this,!0)),this.load.remembered[e]=$a4c493de23d91c5d$var$getCurrentPreset(this),this.preset=e,$a4c493de23d91c5d$var$addPresetOption(this,e,!0),this.saveToLocalStorageIfPossible()},revert:function(e){$a4c493de23d91c5d$var$Common.each(this.__controllers,(function(t){this.getRoot().load.remembered?$a4c493de23d91c5d$var$recallSavedValue(e||this.getRoot(),t):t.setValue(t.initialValue),t.__onFinishChange&&t.__onFinishChange.call(t,t.getValue())}),this),$a4c493de23d91c5d$var$Common.each(this.__folders,(function(e){e.revert(e)})),e||$a4c493de23d91c5d$var$markPresetModified(this.getRoot(),!1)},listen:function(e){var t=0===this.__listening.length;this.__listening.push(e),t&&$a4c493de23d91c5d$var$updateDisplays(this.__listening)},updateDisplay:function(){$a4c493de23d91c5d$var$Common.each(this.__controllers,(function(e){e.updateDisplay()})),$a4c493de23d91c5d$var$Common.each(this.__folders,(function(e){e.updateDisplay()}))}});var $a4c493de23d91c5d$export$35e9368ef982300f={Color:$a4c493de23d91c5d$var$Color,math:$a4c493de23d91c5d$var$ColorMath,interpret:$a4c493de23d91c5d$var$interpret},$a4c493de23d91c5d$export$a6506504f799c5d5={Controller:$a4c493de23d91c5d$var$Controller,BooleanController:$a4c493de23d91c5d$var$BooleanController,OptionController:$a4c493de23d91c5d$var$OptionController,StringController:$a4c493de23d91c5d$var$StringController,NumberController:$a4c493de23d91c5d$var$NumberController,NumberControllerBox:$a4c493de23d91c5d$var$NumberControllerBox,NumberControllerSlider:$a4c493de23d91c5d$var$NumberControllerSlider,FunctionController:$a4c493de23d91c5d$var$FunctionController,ColorController:$a4c493de23d91c5d$var$ColorController},$a4c493de23d91c5d$export$df3a06d6289f983e={dom:$a4c493de23d91c5d$var$dom},$a4c493de23d91c5d$export$6367ea12ae86a4eb={GUI:$a4c493de23d91c5d$var$GUI},$a4c493de23d91c5d$export$983832d820c96993=$a4c493de23d91c5d$var$GUI,$a4c493de23d91c5d$var$index={color:$a4c493de23d91c5d$export$35e9368ef982300f,controllers:$a4c493de23d91c5d$export$a6506504f799c5d5,dom:$a4c493de23d91c5d$export$df3a06d6289f983e,gui:$a4c493de23d91c5d$export$6367ea12ae86a4eb,GUI:$a4c493de23d91c5d$export$983832d820c96993},$a4c493de23d91c5d$export$2e2bcd8739ae039=$a4c493de23d91c5d$var$index;const $ad2bcec7a0192558$var$getNumDigits=e=>(`${e}`.match(/\d/g)||[]).length,$ad2bcec7a0192558$var$buildGui=(e,t,i)=>{for(const n in i)if(i.hasOwnProperty(n)){let r=i[n];if("number"==typeof r){$ad2bcec7a0192558$var$getNumDigits(r);let e,s;if(r>-1&&r<1)e=.1,s=1;else{const t=$ad2bcec7a0192558$var$getNumDigits(Math.round(r));s=Math.pow(10,t),e=1}t.add(i,n,0,s).step(e)}else if("object"==typeof r){let i=t.addFolder(n);$ad2bcec7a0192558$var$buildGui(e,i,r)}else t.add(i,n)}};{const e=new $a4c493de23d91c5d$export$983832d820c96993({name:"Ludum 50"});let t=e.addFolder("Ludum 50");$ad2bcec7a0192558$var$buildGui(e,t,$9d936a2aecb96285$export$2e2bcd8739ae039)}$3d149cbfd3136500$export$add4fa36ca2fc569(),$613a632b39062363$export$a62869ddf53aa3e3.init();class $ad2bcec7a0192558$export$985739bfa5723e08 extends $jgD1p.Engine{showDevTool=$9d936a2aecb96285$export$2e2bcd8739ae039.ShowDevTool;constructor(){super({canvasElementId:"game",displayMode:$jgD1p.DisplayMode.FitScreen,antialiasing:!1,resolution:{width:$9d936a2aecb96285$export$2e2bcd8739ae039.grid.tileWidth*($9d936a2aecb96285$export$2e2bcd8739ae039.grid.width+$9d936a2aecb96285$export$2e2bcd8739ae039.grid.padding),height:$9d936a2aecb96285$export$2e2bcd8739ae039.grid.tileHeight*($9d936a2aecb96285$export$2e2bcd8739ae039.grid.height+$9d936a2aecb96285$export$2e2bcd8739ae039.grid.padding)}})}init(){this.startLevel();const e=new $jgD1p.Loader;for(const t of Object.values($7c4c300842bd4cf2$export$e9a269813a6315a4))e.addResource(t);this.start(e).then((()=>{this.screen.forceResize()}))}startLevel=()=>{const e=new $84ab826914df134a$export$ca664994d1d54bff;this.addScene("main",e),this.goToScene("main")};setupDevTool=()=>{if(this.showDevTool){this.devTool=new $d82f9d57af76c42b$exports.DevTool(this);let e=this.devTool.pane.addTab({pages:[{title:"Config"}]}).pages[0];const t=(i,n,r)=>{for(let s in i){if(r<=0)return;const o=(""===n?"":n+"_")+s;if(i[s]instanceof $jgD1p.Color)return void e.addInput(i,s,{label:o});"object"==typeof i[s]?t(i[s],o,r-1):e.addInput(i,s,{disabled:!0,label:o})}};t($9d936a2aecb96285$export$2e2bcd8739ae039,"",6)}}}const $ad2bcec7a0192558$export$119d2a93e2780362=new $ad2bcec7a0192558$export$985739bfa5723e08;$ad2bcec7a0192558$export$119d2a93e2780362.backgroundColor=$jgD1p.Color.fromHex("#eec39a"),$ad2bcec7a0192558$export$119d2a93e2780362.input.keyboard.on("release",(e=>{switch(e.key){case $jgD1p.Input.Keys.P:$ad2bcec7a0192558$export$119d2a93e2780362.isRunning()?($ad2bcec7a0192558$export$119d2a93e2780362.stop(),$jgD1p.Logger.getInstance().info("game paused")):($ad2bcec7a0192558$export$119d2a93e2780362.start(),$jgD1p.Logger.getInstance().info("game resumed"));break;case $jgD1p.Input.Keys.Semicolon:$ad2bcec7a0192558$export$119d2a93e2780362.toggleDebug();break;case $jgD1p.Input.Keys.Equal:$ad2bcec7a0192558$export$119d2a93e2780362.setupDevTool()}})),$ad2bcec7a0192558$export$119d2a93e2780362.init();var $jgD1p=parcelRequire("jgD1p");class $128d6f7911904d7e$export$e3425b961a6a8509{static moneyResource=$9d936a2aecb96285$export$2e2bcd8739ae039.player.startingMonies;static SubtractMoney(e){return!(this.moneyResource<e)&&(this.moneyResource-=e,this.updateDisplay(),!0)}static updateDisplay(){const e=document.getElementById("moneyContainer");e.style.visibility="visible";document.getElementById("moneyDisplay").innerText=`${this.moneyResource.toString()}`;const t=$ad2bcec7a0192558$export$119d2a93e2780362.screen.worldToScreenCoordinates($jgD1p.vec($9d936a2aecb96285$export$2e2bcd8739ae039.grid.tileWidth/2,$9d936a2aecb96285$export$2e2bcd8739ae039.grid.tileHeight/2));e.style.left=t.x.toString()+"px",e.style.top=t.y.toString()+"px"}static AddMoney(e){this.moneyResource+=e,this.updateDisplay()}}const $383a203830abe9d2$var$randFling=new $jgD1p.Random($9d936a2aecb96285$export$2e2bcd8739ae039.Seed);class $383a203830abe9d2$export$eba177f38926edac extends $jgD1p.Actor{healthBarOpacity=1;healthBarOpacityFade=3;constructor(e,t,i,n){super({name:"Base Tower",pos:t.tileMap.getTile(i,n).pos.add($jgD1p.vec($9d936a2aecb96285$export$2e2bcd8739ae039.grid.tileWidth/2,$9d936a2aecb96285$export$2e2bcd8739ae039.grid.tileHeight/2)),width:$9d936a2aecb96285$export$2e2bcd8739ae039.grid.tileWidth,height:$9d936a2aecb96285$export$2e2bcd8739ae039.grid.tileHeight,collisionType:$jgD1p.CollisionType.Fixed,collisionGroup:$jgD1p.CollisionGroup.collidesWith([$1536b058750c3eeb$export$eefe978c73a9a6.CollisionGroup]),color:$9d936a2aecb96285$export$2e2bcd8739ae039.tower[e].color}),this._grid=t,this._tile=t.tileMap.getTile(i,n),this.row=this._grid.tileMap.getRows()[n],this.type=e,this.maxHealth=$9d936a2aecb96285$export$2e2bcd8739ae039.tower[this.type].maxHealth,this.currentHp=this.maxHealth,this.cost=$9d936a2aecb96285$export$2e2bcd8739ae039.tower[this.type].cost;const r=$9d936a2aecb96285$export$2e2bcd8739ae039.tower[this.type].sprite?.toSprite();r&&this.graphics.use(r),this.beachball=$7c4c300842bd4cf2$export$e9a269813a6315a4.Beachball.toSprite(),this.beachball.scale=$jgD1p.vec(.5,.5),this.sand=$7c4c300842bd4cf2$export$e9a269813a6315a4.CompactedSand.toSprite(),this.bucketSheet=$jgD1p.SpriteSheet.fromImageSource({image:$7c4c300842bd4cf2$export$e9a269813a6315a4.BucketSheet,grid:{spriteWidth:64,spriteHeight:64,rows:1,columns:9}}),this.bucketLoadingFrames=4,this.bucketGlow=$jgD1p.Animation.fromSpriteSheet(this.bucketSheet,$jgD1p.range(5,8),200,$jgD1p.AnimationStrategy.Loop),this.healthBar=new $c1dde4dfd69f9e67$export$427ab9d1af813cd(this.maxHealth),this.addChild(this.healthBar),this.on("kill",(e=>this.onKill(e))),this.on("pointerdown",(e=>this.onClick(e)))}onInitialize(e){this._engine=e}hasEnemyToFireOn(){return null!=this.row.find((e=>$1536b058750c3eeb$export$eefe978c73a9a6.enemiesInTile(e)>0))}setSprite(){if(this.readyToFire()){const e=$9d936a2aecb96285$export$2e2bcd8739ae039.tower[this.type].spriteReady?.toSprite();e&&this.graphics.use(e)}else{const e=$9d936a2aecb96285$export$2e2bcd8739ae039.tower[this.type].sprite?.toSprite();e&&this.graphics.use(e)}}readyToFire(){return this._currentFireTimer<=0}_currentFireTimer=0;_resourceTimer=0;_resourceAvailable=!1;onPostUpdate(e,t){if(this._resourceTimer+=t/1e3,this._currentFireTimer-=t,this.isResourceType()){if(this._resourceTimer<=$9d936a2aecb96285$export$2e2bcd8739ae039.tower[this.type].resourceSpawnTimer&&!this._resourceAvailable){const e=this._resourceTimer/$9d936a2aecb96285$export$2e2bcd8739ae039.tower[this.type].resourceSpawnTimer,t=Math.floor(e*this.bucketLoadingFrames),i=this.bucketSheet.getSprite(t,0);i&&this.graphics.use(i)}this._resourceTimer>$9d936a2aecb96285$export$2e2bcd8739ae039.tower[this.type].resourceSpawnTimer&&!this._resourceAvailable&&(this._resourceTimer=0,this._resourceAvailable=!0,this.graphics.use(this.bucketGlow))}else this.readyToFire()&&(this.hasEnemyToFireOn()?(this.fire(),this._currentFireTimer=$9d936a2aecb96285$export$2e2bcd8739ae039.tower[this.type].baseTowerFireRateMs,this.setSprite()):(this._currentFireTimer=0,this.setSprite()))}isResourceType(){return 0!==$9d936a2aecb96285$export$2e2bcd8739ae039.tower[this.type].resourceSpawnTimer}onClick(e){if(this.isResourceType()&&this._resourceAvailable){$7c4c300842bd4cf2$export$e9a269813a6315a4.FxHarvestTower.play(),$128d6f7911904d7e$export$e3425b961a6a8509.AddMoney($9d936a2aecb96285$export$2e2bcd8739ae039.tower[this.type].resourceSpawnValue),this._resourceAvailable=!1,this._resourceTimer=0;const e=new $jgD1p.Actor({name:"Collected Sand",pos:this.pos,z:10});e.graphics.use(this.sand),this._engine.add(e),e.actions.easeTo($jgD1p.vec($9d936a2aecb96285$export$2e2bcd8739ae039.grid.tileWidth/2,$9d936a2aecb96285$export$2e2bcd8739ae039.grid.tileHeight/2),500,$jgD1p.EasingFunctions.EaseOutCubic).delay(200).callMethod((()=>{e.kill()}))}}onKill(e){const t=new $8a50fef1724e9620$export$252b2ceb7b3e3d5d(this.type,this._tile,this._grid,this.pos.x,this.pos.y);this._engine.add(t)}fire=()=>{if(!$9d936a2aecb96285$export$2e2bcd8739ae039.tower[this.type].firesBullets)return;const e=new $jgD1p.Actor({name:"Tower Bullet",pos:this.pos,vel:$jgD1p.vec($9d936a2aecb96285$export$2e2bcd8739ae039.tower[this.type].bulletSpeedPixelsPerSecond,0),radius:$9d936a2aecb96285$export$2e2bcd8739ae039.tower[this.type].bulletRadius,color:$jgD1p.Color.Black,angularVelocity:2*Math.PI,collisionGroup:$jgD1p.CollisionGroup.collidesWith([$1536b058750c3eeb$export$eefe978c73a9a6.CollisionGroup]),collisionType:$jgD1p.CollisionType.Passive});e.graphics.use(this.beachball),e.on("precollision",(t=>{t.other.takeDamage($9d936a2aecb96285$export$2e2bcd8739ae039.tower[this.type].bulletDamage),e.kill()})),e.on("exitviewport",(()=>{e.kill()})),this.playBulletFling(),this._engine.add(e)};playBulletFling(){$383a203830abe9d2$var$randFling.pickOne($7c4c300842bd4cf2$export$2af0f46a4934f77d).play()}takeDamage(e){this.currentHp-=e,this.healthBar.takeDamage(e),this.playTakeDamageSound(),this.currentHp<=0&&(this._tile.data.delete("tower"),this.kill())}playTakeDamageSound(){this.type,$7c4c300842bd4cf2$export$e9a269813a6315a4.FxImpactTowerByEnemy.play()}}let $383a203830abe9d2$export$13e3300c8755380c;!function(e){e.default="default",e.sandBucket="sandBucket",e.upgradeCatapult="upgradeCatapult",e.sandWall="sandWall"}($383a203830abe9d2$export$13e3300c8755380c||($383a203830abe9d2$export$13e3300c8755380c={}));var $acw62=parcelRequire("acw62");class $e1b6a5b0e8511258$export$9f42a7694f72b6c1 extends $acw62.Component{constructor(e){super(e),this.handleClick=this.handleClick.bind(this)}handleClick=e=>{e.preventDefault(),this.props.selectHandler(this.props.towerName)};render(){let e="tower";this.props.towerName==this.props.selectedTower&&(e+=" selected");let t=this.props.towerName;const i=$9d936a2aecb96285$export$2e2bcd8739ae039.tower[t].bulletDamage>0,n=$9d936a2aecb96285$export$2e2bcd8739ae039.tower[t].resourceSpawnValue>0;return $7b02d682eb115277$exports.jsx($7b02d682eb115277$exports.Fragment,{children:$7b02d682eb115277$exports.jsxs("div",{className:e,onClick:this.handleClick,children:[$7b02d682eb115277$exports.jsxs("div",{className:"imageOuter",children:[$7b02d682eb115277$exports.jsx("img",{className:"towerIcon",src:$9d936a2aecb96285$export$2e2bcd8739ae039.tower[t].sprite?.path?.toString()}),$7b02d682eb115277$exports.jsx("strong",{className:"towerName",children:$9d936a2aecb96285$export$2e2bcd8739ae039.tower[t].displayName})]}),$7b02d682eb115277$exports.jsxs("div",{className:"towerInfo",children:[$7b02d682eb115277$exports.jsxs("div",{className:"cost costs-sand",children:[$7b02d682eb115277$exports.jsx("img",{className:"towerInfoIcon",src:$7c4c300842bd4cf2$export$e9a269813a6315a4.CompactedSand.path.toString()}),$7b02d682eb115277$exports.jsx("div",{className:"costText",children:$9d936a2aecb96285$export$2e2bcd8739ae039.tower[t].cost})]}),i?$7b02d682eb115277$exports.jsxs("div",{className:"cost has-damage",children:[$7b02d682eb115277$exports.jsx("img",{className:"towerInfoIcon",src:$7c4c300842bd4cf2$export$e9a269813a6315a4.Beachball.path.toString()}),$7b02d682eb115277$exports.jsx("div",{className:"costText",children:$9d936a2aecb96285$export$2e2bcd8739ae039.tower[t].bulletDamage})]}):n?$7b02d682eb115277$exports.jsxs("div",{className:"cost makes-money",children:[$7b02d682eb115277$exports.jsx("img",{className:"towerInfoIcon",src:$7c4c300842bd4cf2$export$e9a269813a6315a4.CompactedSand.path.toString()}),$7b02d682eb115277$exports.jsxs("div",{className:"costText",children:["+",$9d936a2aecb96285$export$2e2bcd8739ae039.tower[t].resourceSpawnValue,"/",$9d936a2aecb96285$export$2e2bcd8739ae039.tower[t].resourceSpawnTimer,"s"]})]}):$7b02d682eb115277$exports.jsx($7b02d682eb115277$exports.Fragment,{}),$7b02d682eb115277$exports.jsxs("div",{className:"cost armor",children:[$7b02d682eb115277$exports.jsx("img",{className:"towerInfoIcon",src:$7c4c300842bd4cf2$export$e9a269813a6315a4.Sandwall.path.toString()}),$7b02d682eb115277$exports.jsx("div",{className:"costText",children:$9d936a2aecb96285$export$2e2bcd8739ae039.tower[t].maxHealth})]}),$7b02d682eb115277$exports.jsx("div",{className:"towerHoverText",children:$9d936a2aecb96285$export$2e2bcd8739ae039.tower[t].hoverText})]})]})})}}class $f9f92b69743c51b0$export$bb5bc7bd90feac4d extends $acw62.Component{constructor(e){super(e)}state={selectedTower:$383a203830abe9d2$export$13e3300c8755380c.default};selectedTower=()=>this.state.selectedTower;setSelectedTower=e=>{e!=this.state.selectedTower&&($7c4c300842bd4cf2$export$e9a269813a6315a4.UiPickTower.play(),this.setState({selectedTower:e}))};render(){return $7b02d682eb115277$exports.jsx("div",{id:"towerSelection",children:Object.keys($9d936a2aecb96285$export$2e2bcd8739ae039.tower).map((e=>$7b02d682eb115277$exports.jsx($e1b6a5b0e8511258$export$9f42a7694f72b6c1,{towerName:e.toString(),selectedTower:this.state.selectedTower.toString(),selectHandler:this.setSelectedTower},e)))})}}const $44ec820f1ba1b001$var$container=document.getElementById("reactUI"),$44ec820f1ba1b001$var$root=$7e96a608cb33bf79$export$882461b6382ed46c($44ec820f1ba1b001$var$container);$44ec820f1ba1b001$var$root.render($7b02d682eb115277$exports.jsx($f9f92b69743c51b0$export$bb5bc7bd90feac4d,{ref:e=>{window.TowerPickerUI=e}}));
//# sourceMappingURL=index.766176f6.js.map
